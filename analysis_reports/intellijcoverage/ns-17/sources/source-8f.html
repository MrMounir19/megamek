


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > SmallCraft</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.common</a>
</div>

<h1>Coverage Summary for Class: SmallCraft (megamek.common)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SmallCraft</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    1.6%
  </span>
  <span class="absValue">
    (1/64)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    2.8%
  </span>
  <span class="absValue">
    (13/466)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaAero - Copyright (C) 2007 Jay Lawson This program is free software; you
&nbsp; * can redistribute it and/or modify it under the terms of the GNU General
&nbsp; * Public License as published by the Free Software Foundation; either version 2
&nbsp; * of the License, or (at your option) any later version.
&nbsp; *
&nbsp; * This program is distributed in the hope that it will be useful, but WITHOUT
&nbsp; * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
&nbsp; * FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
&nbsp; * details.
&nbsp; */
&nbsp;/*
&nbsp; * Created on Jun 17, 2007
&nbsp; */
&nbsp;package megamek.common;
&nbsp;
&nbsp;import java.util.HashMap;
&nbsp;import java.util.Map;
&nbsp;
&nbsp;import megamek.common.options.OptionsConstants;
&nbsp;
&nbsp;/**
&nbsp; * @author Jay Lawson
&nbsp; */
<b class="nc">&nbsp;public class SmallCraft extends Aero {</b>
&nbsp;
&nbsp;    private static final long serialVersionUID = 6708788176436555036L;
&nbsp;    
&nbsp;    public static final int LOC_HULL = 4;
&nbsp;    
<b class="fc">&nbsp;    private static String[] LOCATION_ABBRS =</b>
&nbsp;        { &quot;NOS&quot;, &quot;LS&quot;, &quot;RS&quot;, &quot;AFT&quot;, &quot;HULL&quot; };
<b class="fc">&nbsp;    private static String[] LOCATION_NAMES =</b>
&nbsp;        { &quot;Nose&quot;, &quot;Left Side&quot;, &quot;Right Side&quot;, &quot;Aft&quot;, &quot;Hull&quot; };
&nbsp;
&nbsp;    // crew and passengers
<b class="nc">&nbsp;    private int nOfficers = 0;</b>
<b class="nc">&nbsp;    private int nGunners = 0;</b>
<b class="nc">&nbsp;    private int nBattleArmor = 0;</b>
<b class="nc">&nbsp;    private int nOtherPassenger = 0;</b>
&nbsp;    
&nbsp;    // Maps transported crew,passengers,marines to a host ship so we can match them up again post-game
<b class="nc">&nbsp;    private Map&lt;String,Integer&gt; nOtherCrew = new HashMap&lt;&gt;();</b>
<b class="nc">&nbsp;    private Map&lt;String,Integer&gt; passengers = new HashMap&lt;&gt;();</b>
<b class="nc">&nbsp;    private Map&lt;Integer,Integer&gt; nOtherMarines = new HashMap&lt;&gt;();</b>
&nbsp;    
&nbsp;    // escape pods and lifeboats
<b class="nc">&nbsp;    private int escapePods = 0;</b>
<b class="nc">&nbsp;    private int lifeBoats = 0;</b>
<b class="nc">&nbsp;    private int escapePodsLaunched = 0;</b>
<b class="nc">&nbsp;    private int lifeBoatsLaunched = 0;</b>
&nbsp;    
<b class="fc">&nbsp;    private static final TechAdvancement TA_SM_CRAFT = new TechAdvancement(TECH_BASE_ALL)</b>
<b class="fc">&nbsp;            .setAdvancement(DATE_NONE, 2350, 2400).setISApproximate(false, true, false)</b>
<b class="fc">&nbsp;            .setProductionFactions(F_TH).setTechRating(RATING_D)</b>
<b class="fc">&nbsp;            .setAvailability(RATING_D, RATING_E, RATING_D, RATING_D)</b>
<b class="fc">&nbsp;            .setStaticTechLevel(SimpleTechLevel.STANDARD);</b>
<b class="fc">&nbsp;    private static final TechAdvancement TA_SM_CRAFT_PRIMITIVE = new TechAdvancement(TECH_BASE_IS)</b>
<b class="fc">&nbsp;            .setISAdvancement(DATE_ES, 2200, DATE_NONE, 2400)</b>
<b class="fc">&nbsp;            .setISApproximate(false, true, false, false)</b>
<b class="fc">&nbsp;            .setProductionFactions(F_TA).setTechRating(RATING_D)</b>
<b class="fc">&nbsp;            .setAvailability(RATING_D, RATING_X, RATING_F, RATING_F)</b>
<b class="fc">&nbsp;            .setStaticTechLevel(SimpleTechLevel.STANDARD);</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public int getUnitType() {
<b class="nc">&nbsp;        return UnitType.SMALL_CRAFT;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public TechAdvancement getConstructionTechAdvancement() {
<b class="nc">&nbsp;        if (isPrimitive()) {</b>
<b class="nc">&nbsp;            return TA_SM_CRAFT_PRIMITIVE;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return TA_SM_CRAFT;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * @return Returns the autoEject setting (always off for large craft)
&nbsp;     */
&nbsp;    @Override
&nbsp;    public boolean isAutoEject() {
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public boolean isPrimitive() {
<b class="nc">&nbsp;        return getArmorType(LOC_NOSE) == EquipmentType.T_ARMOR_PRIMITIVE_AERO;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public void setNCrew(int crew) {
<b class="nc">&nbsp;        nCrew = crew;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;    
&nbsp;    public void setNOfficers(int officer) {
<b class="nc">&nbsp;        nOfficers = officer;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;    
&nbsp;    public void setNGunners(int gunners) {
<b class="nc">&nbsp;        nGunners = gunners;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;    
&nbsp;    @Override
&nbsp;    public void setNPassenger(int pass) {
<b class="nc">&nbsp;        nPassenger = pass;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setNBattleArmor(int ba) {
<b class="nc">&nbsp;        nBattleArmor = ba;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void setNMarines(int marines) {
<b class="nc">&nbsp;        nMarines = marines;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setNOtherPassenger(int other) {
<b class="nc">&nbsp;        nOtherPassenger = other;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public int getNCrew() {
<b class="nc">&nbsp;        return nCrew;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getNPassenger() {
<b class="nc">&nbsp;        return nPassenger;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public int getNOfficers() {
<b class="nc">&nbsp;        return nOfficers;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public int getNGunners() {
<b class="nc">&nbsp;        return nGunners;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public int getNBattleArmor() {
<b class="nc">&nbsp;        return nBattleArmor;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getNMarines() {
<b class="nc">&nbsp;        return nMarines;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getNOtherPassenger() {
<b class="nc">&nbsp;        return nOtherPassenger;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Returns a mapping of how many crewmembers from other units this unit is carrying
&nbsp;     * and what ship they&#39;re from by external ID 
&nbsp;     */
&nbsp;    public Map&lt;String,Integer&gt; getNOtherCrew() {
<b class="nc">&nbsp;        return nOtherCrew;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Convenience method to return all crew from other craft aboard from the above Map
&nbsp;     * @return
&nbsp;     */
&nbsp;    public int getTotalOtherCrew() {
<b class="nc">&nbsp;        int toReturn = 0;</b>
<b class="nc">&nbsp;        for (String name : getNOtherCrew().keySet()) {</b>
<b class="nc">&nbsp;            toReturn += getNOtherCrew().get(name);</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        return toReturn;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Adds a number of crewmembers from another ship keyed by that ship&#39;s external ID
&nbsp;     * @param id The external ID of the ship these crew came from
&nbsp;     * @param n The number to add
&nbsp;     */
&nbsp;    public void addNOtherCrew(String id, int n) {
<b class="nc">&nbsp;       if (nOtherCrew.containsKey(id)) {</b>
<b class="nc">&nbsp;           nOtherCrew.replace(id, nOtherCrew.get(id) + n);</b>
&nbsp;       } else {
<b class="nc">&nbsp;           nOtherCrew.put(id, n);</b>
&nbsp;       }
<b class="nc">&nbsp;    }</b>
&nbsp;    
&nbsp;    /**
&nbsp;     * Returns a mapping of how many passengers from other units this unit is carrying
&nbsp;     * and what ship they&#39;re from by external ID 
&nbsp;     */
&nbsp;    public Map&lt;String,Integer&gt; getPassengers() {
<b class="nc">&nbsp;        return passengers;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Convenience method to return all passengers aboard from the above Map
&nbsp;     * @return
&nbsp;     */
&nbsp;    public int getTotalPassengers() {
<b class="nc">&nbsp;        int toReturn = 0;</b>
<b class="nc">&nbsp;        for (String name : getPassengers().keySet()) {</b>
<b class="nc">&nbsp;            toReturn += getPassengers().get(name);</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        return toReturn;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Adds a number of passengers from another ship keyed by that ship&#39;s external ID
&nbsp;     * @param id The external ID of the ship these passengers came from
&nbsp;     * @param n The number to add
&nbsp;     */
&nbsp;    public void addPassengers(String id, int n) {
<b class="nc">&nbsp;       if (passengers.containsKey(id)) {</b>
<b class="nc">&nbsp;           passengers.replace(id, passengers.get(id) + n);</b>
&nbsp;       } else {
<b class="nc">&nbsp;           passengers.put(id, n);</b>
&nbsp;       }
<b class="nc">&nbsp;    }</b>
&nbsp;    
&nbsp;    public void setEscapePods(int n) {
<b class="nc">&nbsp;        escapePods = n;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public int getEscapePods() {
<b class="nc">&nbsp;        return escapePods;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Returns the total number of escape pods launched so far
&nbsp;     */
&nbsp;    @Override
&nbsp;    public int getLaunchedEscapePods() {
<b class="nc">&nbsp;        return escapePodsLaunched;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Updates the total number of escape pods launched so far
&nbsp;     * @param n The number to change
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void setLaunchedEscapePods(int n) {
<b class="nc">&nbsp;        escapePodsLaunched = n;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setLifeBoats(int n) {
<b class="nc">&nbsp;        lifeBoats = n;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public int getLifeBoats() {
<b class="nc">&nbsp;        return lifeBoats;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Returns the total number of life boats launched so far
&nbsp;     */
&nbsp;    @Override
&nbsp;    public int getLaunchedLifeBoats() {
<b class="nc">&nbsp;        return lifeBoatsLaunched;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Updates the total number of life boats launched so far
&nbsp;     * @param n The number to change
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void setLaunchedLifeBoats(int n) {
<b class="nc">&nbsp;        lifeBoatsLaunched = n;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;    
&nbsp;    @Override
&nbsp;    public double getStrategicFuelUse() {
<b class="nc">&nbsp;        if (isPrimitive()) {</b>
<b class="nc">&nbsp;            return 1.84 * primitiveFuelFactor();</b>
&nbsp;        }
<b class="nc">&nbsp;    	return 1.84;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public double primitiveFuelFactor() {
<b class="nc">&nbsp;        int year = getOriginalBuildYear();</b>
<b class="nc">&nbsp;        if (year &gt;= 2500) {</b>
<b class="nc">&nbsp;            return 1.0;</b>
<b class="nc">&nbsp;        } else if (year &gt;= 2400) {</b>
<b class="nc">&nbsp;            return 1.2;</b>
<b class="nc">&nbsp;        } else if (year &gt;= 2300) {</b>
<b class="nc">&nbsp;            return 1.4;</b>
<b class="nc">&nbsp;        } else if (year &gt;= 2251) {</b>
<b class="nc">&nbsp;            return 1.5;</b>
<b class="nc">&nbsp;        } else if (year &gt;= 2201) {</b>
<b class="nc">&nbsp;            return 1.7;</b>
<b class="nc">&nbsp;        } else if (year &gt;= 2151) {</b>
<b class="nc">&nbsp;            return 1.9;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return 2.2;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public String[] getLocationAbbrs() {
<b class="nc">&nbsp;        return LOCATION_ABBRS;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public String[] getLocationNames() {
<b class="nc">&nbsp;        return LOCATION_NAMES;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int locations() {
<b class="nc">&nbsp;        return 5;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getBodyLocation() {
<b class="nc">&nbsp;        return LOC_HULL;</b>
&nbsp;    }
&nbsp;
&nbsp;    // what is different - hit table is about it
&nbsp;    @Override
&nbsp;    public HitData rollHitLocation(int table, int side) {
&nbsp;
&nbsp;        /*
&nbsp;         * Unlike other units, ASFs determine potential crits based on the to-hit roll
&nbsp;         * so I need to set this potential value as well as return the to hit data
&nbsp;         */
&nbsp;
<b class="nc">&nbsp;        int roll = Compute.d6(2);</b>
&nbsp;
&nbsp;        // special rules for spheroids in atmosphere
&nbsp;        // http://www.classicbattletech.com/forums/index.php/topic,54077.0.html
<b class="nc">&nbsp;        if (isSpheroid() &amp;&amp; table != ToHitData.HIT_SPHEROID_CRASH &amp;&amp; </b>
<b class="nc">&nbsp;                !game.getBoard().inSpace()) {</b>
<b class="nc">&nbsp;            int preroll = Compute.d6(1);</b>
<b class="nc">&nbsp;            if ((table == ToHitData.HIT_ABOVE) &amp;&amp; (preroll &lt; 4)) {</b>
<b class="nc">&nbsp;                side = ToHitData.SIDE_FRONT;</b>
<b class="nc">&nbsp;            } else if ((table == ToHitData.HIT_BELOW) &amp;&amp; (preroll &lt; 4)) {</b>
<b class="nc">&nbsp;                side = ToHitData.SIDE_REAR;</b>
<b class="nc">&nbsp;            } else if (preroll == 1) {</b>
<b class="nc">&nbsp;                side = ToHitData.SIDE_FRONT;</b>
<b class="nc">&nbsp;            } else if (preroll == 6) {</b>
<b class="nc">&nbsp;                side = ToHitData.SIDE_REAR;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if ((table == ToHitData.HIT_ABOVE) || (table == ToHitData.HIT_BELOW)) {</b>
&nbsp;
&nbsp;            // have to decide which wing
<b class="nc">&nbsp;            int wingloc = LOC_RWING;</b>
<b class="nc">&nbsp;            int wingroll = Compute.d6(1);</b>
<b class="nc">&nbsp;            if (wingroll &gt; 3) {</b>
<b class="nc">&nbsp;                wingloc = LOC_LWING;</b>
&nbsp;            }
<b class="nc">&nbsp;            switch (roll) {</b>
&nbsp;                case 2:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 3:
<b class="nc">&nbsp;                    setPotCrit(CRIT_FCS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 4:
<b class="nc">&nbsp;                    setPotCrit(CRIT_SENSOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 5:
<b class="nc">&nbsp;                    setPotCrit(CRIT_RIGHT_THRUSTER);</b>
<b class="nc">&nbsp;                    if (wingroll &gt; 3) {</b>
<b class="nc">&nbsp;                        setPotCrit(CRIT_LEFT_THRUSTER);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    return new HitData(wingloc, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 6:
<b class="nc">&nbsp;                    setPotCrit(CRIT_CARGO);</b>
<b class="nc">&nbsp;                    return new HitData(wingloc, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 7:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(wingloc, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 8:
<b class="nc">&nbsp;                    setPotCrit(CRIT_DOOR);</b>
<b class="nc">&nbsp;                    return new HitData(wingloc, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 9:
<b class="nc">&nbsp;                    setPotCrit(CRIT_RIGHT_THRUSTER);</b>
<b class="nc">&nbsp;                    if (wingroll &gt; 3) {</b>
<b class="nc">&nbsp;                        setPotCrit(CRIT_LEFT_THRUSTER);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    return new HitData(wingloc, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 10:
<b class="nc">&nbsp;                    setPotCrit(CRIT_AVIONICS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 11:
<b class="nc">&nbsp;                    setPotCrit(CRIT_ENGINE);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 12:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (side == ToHitData.SIDE_FRONT) {</b>
&nbsp;            // normal front hits
<b class="nc">&nbsp;            switch (roll) {</b>
&nbsp;                case 2:
<b class="nc">&nbsp;                    setPotCrit(CRIT_CREW);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 3:
<b class="nc">&nbsp;                    setPotCrit(CRIT_AVIONICS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 4:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 5:
<b class="nc">&nbsp;                    setPotCrit(CRIT_RIGHT_THRUSTER);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 6:
<b class="nc">&nbsp;                    setPotCrit(CRIT_FCS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 7:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 8:
<b class="nc">&nbsp;                    setPotCrit(CRIT_CONTROL);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 9:
<b class="nc">&nbsp;                    setPotCrit(CRIT_LEFT_THRUSTER);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 10:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 11:
<b class="nc">&nbsp;                    setPotCrit(CRIT_SENSOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 12:
<b class="nc">&nbsp;                    setPotCrit(CRIT_KF_BOOM);</b>
&nbsp;                    // Primitve dropships without kf-boom take avionics hit instead (IO, p. 119).
<b class="nc">&nbsp;                    if ((this instanceof Dropship)</b>
<b class="nc">&nbsp;                            &amp;&amp; (((Dropship)this).getCollarType() == Dropship.COLLAR_NO_BOOM)) {</b>
<b class="nc">&nbsp;                        setPotCrit(CRIT_AVIONICS);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (side == ToHitData.SIDE_LEFT) {</b>
&nbsp;            // normal left-side hits
<b class="nc">&nbsp;            switch (roll) {</b>
&nbsp;                case 2:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 3:
<b class="nc">&nbsp;                    setPotCrit(CRIT_FCS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 4:
<b class="nc">&nbsp;                    setPotCrit(CRIT_SENSOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 5:
<b class="nc">&nbsp;                    setPotCrit(CRIT_LEFT_THRUSTER);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 6:
<b class="nc">&nbsp;                    setPotCrit(CRIT_CARGO);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 7:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 8:
<b class="nc">&nbsp;                    setPotCrit(CRIT_DOOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 9:
<b class="nc">&nbsp;                    setPotCrit(CRIT_LEFT_THRUSTER);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 10:
<b class="nc">&nbsp;                    setPotCrit(CRIT_AVIONICS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 11:
<b class="nc">&nbsp;                    setPotCrit(CRIT_ENGINE);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 12:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (side == ToHitData.SIDE_RIGHT) {</b>
&nbsp;            // normal right-side hits
<b class="nc">&nbsp;            switch (roll) {</b>
&nbsp;                case 2:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 3:
<b class="nc">&nbsp;                    setPotCrit(CRIT_FCS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 4:
<b class="nc">&nbsp;                    setPotCrit(CRIT_SENSOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 5:
<b class="nc">&nbsp;                    setPotCrit(CRIT_RIGHT_THRUSTER);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 6:
<b class="nc">&nbsp;                    setPotCrit(CRIT_CARGO);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 7:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 8:
<b class="nc">&nbsp;                    setPotCrit(CRIT_DOOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 9:
<b class="nc">&nbsp;                    setPotCrit(CRIT_RIGHT_THRUSTER);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 10:
<b class="nc">&nbsp;                    setPotCrit(CRIT_AVIONICS);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 11:
<b class="nc">&nbsp;                    setPotCrit(CRIT_ENGINE);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 12:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (side == ToHitData.SIDE_REAR) {</b>
&nbsp;            // normal aft hits
<b class="nc">&nbsp;            switch (roll) {</b>
&nbsp;                case 2:
<b class="nc">&nbsp;                    setPotCrit(CRIT_LIFE_SUPPORT);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 3:
<b class="nc">&nbsp;                    setPotCrit(CRIT_CONTROL);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 4:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 5:
<b class="nc">&nbsp;                    setPotCrit(CRIT_DOOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_RWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 6:
<b class="nc">&nbsp;                    setPotCrit(CRIT_ENGINE);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 7:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 8:
<b class="nc">&nbsp;                    setPotCrit(CRIT_DOCK_COLLAR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 9:
<b class="nc">&nbsp;                    setPotCrit(CRIT_DOOR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 10:
<b class="nc">&nbsp;                    setPotCrit(CRIT_WEAPON);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_LWING, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 11:
<b class="nc">&nbsp;                    setPotCrit(CRIT_GEAR);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;                case 12:
<b class="nc">&nbsp;                    setPotCrit(CRIT_FUEL_TANK);</b>
<b class="nc">&nbsp;                    return new HitData(LOC_AFT, false, HitData.EFFECT_NONE);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return new HitData(LOC_NOSE, false, HitData.EFFECT_NONE);</b>
&nbsp;    }
&nbsp;
&nbsp;    // weapon arcs
&nbsp;    @Override
&nbsp;    public int getWeaponArc(int wn) {
<b class="nc">&nbsp;        final Mounted mounted = getEquipment(wn);</b>
&nbsp;
<b class="nc">&nbsp;        int arc = Compute.ARC_NOSE;</b>
<b class="nc">&nbsp;        if (!isSpheroid()) {</b>
<b class="nc">&nbsp;            switch (mounted.getLocation()) {</b>
&nbsp;                case LOC_NOSE:
<b class="nc">&nbsp;                    if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                        arc = Compute.ARC_NOSE_WPL;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    arc = Compute.ARC_NOSE;</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case LOC_RWING:
<b class="nc">&nbsp;                    if (mounted.isRearMounted()) {</b>
<b class="nc">&nbsp;                        if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                            arc = Compute.ARC_RWINGA_WPL;</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        arc = Compute.ARC_RWINGA;</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                            arc = Compute.ARC_RWING_WPL;</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        arc = Compute.ARC_RWING;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case LOC_LWING:
<b class="nc">&nbsp;                    if (mounted.isRearMounted()) {</b>
<b class="nc">&nbsp;                        if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                            arc = Compute.ARC_LWINGA_WPL;</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        arc = Compute.ARC_LWINGA;</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                            arc = Compute.ARC_LWING_WPL;</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        arc = Compute.ARC_LWING;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case LOC_AFT:
<b class="nc">&nbsp;                    if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                        arc = Compute.ARC_AFT_WPL;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    arc = Compute.ARC_AFT;</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    arc = Compute.ARC_360;</b>
&nbsp;            }
&nbsp;        } else {
<b class="nc">&nbsp;            if ((game != null) &amp;&amp; game.getBoard().inSpace()) {</b>
<b class="nc">&nbsp;                switch (mounted.getLocation()) {</b>
&nbsp;                    case LOC_NOSE:
<b class="nc">&nbsp;                        if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                            arc = Compute.ARC_NOSE_WPL;</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        arc = Compute.ARC_NOSE;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case LOC_RWING:
<b class="nc">&nbsp;                        if (mounted.isRearMounted()) {</b>
<b class="nc">&nbsp;                            if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                                arc = Compute.ARC_RIGHTSIDEA_SPHERE_WPL;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
<b class="nc">&nbsp;                            arc = Compute.ARC_RIGHTSIDEA_SPHERE;</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                                arc = Compute.ARC_RIGHTSIDE_SPHERE_WPL;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
<b class="nc">&nbsp;                            arc = Compute.ARC_RIGHTSIDE_SPHERE;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case LOC_LWING:
<b class="nc">&nbsp;                        if (mounted.isRearMounted()) {</b>
<b class="nc">&nbsp;                            if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                                arc = Compute.ARC_LEFTSIDEA_SPHERE_WPL;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
<b class="nc">&nbsp;                            arc = Compute.ARC_LEFTSIDEA_SPHERE;</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                                arc = Compute.ARC_LEFTSIDE_SPHERE_WPL;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
<b class="nc">&nbsp;                            arc = Compute.ARC_LEFTSIDE_SPHERE;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case LOC_AFT:
<b class="nc">&nbsp;                        if (mounted.isInWaypointLaunchMode()) {</b>
<b class="nc">&nbsp;                            arc = Compute.ARC_AFT_WPL;</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        arc = Compute.ARC_AFT;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    default:
<b class="nc">&nbsp;                        arc = Compute.ARC_360;</b>
&nbsp;                }
&nbsp;            } else {
<b class="nc">&nbsp;                switch (mounted.getLocation()) {</b>
&nbsp;                    case LOC_NOSE:
<b class="nc">&nbsp;                        arc = Compute.ARC_360;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case LOC_RWING:
<b class="nc">&nbsp;                        arc = Compute.ARC_RIGHT_SPHERE_GROUND;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case LOC_LWING:
<b class="nc">&nbsp;                        arc = Compute.ARC_LEFT_SPHERE_GROUND;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    case LOC_AFT:
<b class="nc">&nbsp;                        arc = Compute.ARC_360;</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    default:
<b class="nc">&nbsp;                        arc = Compute.ARC_360;</b>
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return rollArcs(arc);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public int getArcswGuns() {
&nbsp;        // return the number
<b class="nc">&nbsp;        int nArcs = 0;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; locations(); i++) {</b>
<b class="nc">&nbsp;            if (hasWeaponInArc(i, false)) {</b>
<b class="nc">&nbsp;                nArcs++;</b>
&nbsp;            }
&nbsp;            // check for rear locations
<b class="nc">&nbsp;            if (hasWeaponInArc(i, true)) {</b>
<b class="nc">&nbsp;                nArcs++;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return nArcs;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean hasWeaponInArc(int loc, boolean rearMount) {
<b class="nc">&nbsp;        boolean hasWeapons = false;</b>
<b class="nc">&nbsp;        for (Mounted weap : getWeaponList()) {</b>
<b class="nc">&nbsp;            if ((weap.getLocation() == loc) &amp;&amp; (weap.isRearMounted() == rearMount)) {</b>
<b class="nc">&nbsp;                hasWeapons = true;</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        return hasWeapons;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public double getArmorWeight() {
&nbsp;        // first I need to subtract SI bonus from total armor. We need to retain the fractional part
&nbsp;        //  for primitive craft because the primitive multiplier is applied to both before rounding.
<b class="nc">&nbsp;        double armorPoints = getTotalOArmor();</b>
<b class="nc">&nbsp;        int freeSI = getSI() * (locations() - 1); // no armor in hull location</b>
<b class="nc">&nbsp;        if (isPrimitive()) {</b>
<b class="nc">&nbsp;            armorPoints -= freeSI * 0.66;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            armorPoints -= freeSI;</b>
&nbsp;        }
<b class="nc">&nbsp;        double armorPerTon = SmallCraft.armorPointsPerTon(getWeight(), isSpheroid(),</b>
<b class="nc">&nbsp;                getArmorType(0), TechConstants.isClan(getArmorTechLevel(0)));</b>
&nbsp;
<b class="nc">&nbsp;        return RoundWeight.nextHalfTon(armorPoints / armorPerTon);</b>
&nbsp;    }
&nbsp;    
&nbsp;    public static double armorPointsPerTon(double craftWeight, boolean spheroid, int at, boolean isClan) {
<b class="nc">&nbsp;        double base = 16.0;</b>
<b class="nc">&nbsp;        if (spheroid) {</b>
<b class="nc">&nbsp;            if (craftWeight &gt;= 65000) {</b>
<b class="nc">&nbsp;                base = 6.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 50000) {</b>
<b class="nc">&nbsp;                base = 8.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 35000) {</b>
<b class="nc">&nbsp;                base = 10.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 20000) {</b>
<b class="nc">&nbsp;                base = 12.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 12500) {</b>
<b class="nc">&nbsp;                base = 14.0;</b>
&nbsp;            }
&nbsp;        } else {
<b class="nc">&nbsp;            if (craftWeight &gt;= 25000) {</b>
<b class="nc">&nbsp;                base = 6.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 17500) {</b>
<b class="nc">&nbsp;                base = 8.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 12500) {</b>
<b class="nc">&nbsp;                base = 10.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 9500) {</b>
<b class="nc">&nbsp;                base = 12.0;</b>
<b class="nc">&nbsp;            } else if (craftWeight &gt;= 6000) {</b>
<b class="nc">&nbsp;                base = 14.0;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (isClan) {</b>
<b class="nc">&nbsp;            if (base &gt; 14) {</b>
<b class="nc">&nbsp;                base += 4;</b>
<b class="nc">&nbsp;            } else if (base &gt; 12) {</b>
<b class="nc">&nbsp;                base += 3;</b>
<b class="nc">&nbsp;            } else if (base &gt; 6) {</b>
<b class="nc">&nbsp;                base += 2;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                base += 1;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return base * EquipmentType.getArmorPointMultiplier(at, isClan);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * There is a mistake in some of the AT2r costs for some reason they added
&nbsp;     * ammo twice for a lot of the level 2 designs, leading to costs that are
&nbsp;     * too high
&nbsp;     */
&nbsp;    @Override
&nbsp;    public double getCost(boolean ignoreAmmo) {
&nbsp;
<b class="nc">&nbsp;        double cost = 0;</b>
&nbsp;
&nbsp;        // add in controls
&nbsp;        // bridge
<b class="nc">&nbsp;        cost += 200000 + (10 * weight);</b>
&nbsp;        // computer
<b class="nc">&nbsp;        cost += 200000;</b>
&nbsp;        // life support
<b class="nc">&nbsp;        cost += 5000 * (getNCrew() + getNPassenger());</b>
&nbsp;        // sensors
<b class="nc">&nbsp;        cost += 80000;</b>
&nbsp;        // fcs
<b class="nc">&nbsp;        cost += 100000;</b>
&nbsp;        // gunnery/control systems
<b class="nc">&nbsp;        cost += 10000 * getArcswGuns();</b>
&nbsp;
&nbsp;        // structural integrity
<b class="nc">&nbsp;        cost += 100000 * getSI();</b>
&nbsp;
&nbsp;        // additional flight systems (attitude thruster and landing gear)
<b class="nc">&nbsp;        cost += 25000 + (10 * getWeight());</b>
&nbsp;
&nbsp;        // engine
<b class="nc">&nbsp;        double engineMultiplier = 0.065;</b>
<b class="nc">&nbsp;        if (isClan()) {</b>
<b class="nc">&nbsp;            engineMultiplier = 0.061;</b>
&nbsp;        }
<b class="nc">&nbsp;        double engineWeight = getOriginalWalkMP() * weight * engineMultiplier;</b>
<b class="nc">&nbsp;        cost += engineWeight * 1000;</b>
&nbsp;        // drive unit
<b class="nc">&nbsp;        cost += (500 * getOriginalWalkMP() * weight) / 100.0;</b>
&nbsp;
&nbsp;        // fuel tanks
<b class="nc">&nbsp;        cost += (200 * getFuel()) / 80.0 * 1.02;</b>
&nbsp;
&nbsp;        // armor
<b class="nc">&nbsp;        cost += getArmorWeight() * EquipmentType.getArmorCost(armorType[0]);</b>
&nbsp;
&nbsp;        // heat sinks
<b class="nc">&nbsp;        int sinkCost = 2000 + (4000 * getHeatType());// == HEAT_DOUBLE ? 6000:</b>
&nbsp;        // 2000;
<b class="nc">&nbsp;        cost += sinkCost * getHeatSinks();</b>
&nbsp;
&nbsp;        // weapons
<b class="nc">&nbsp;        cost += getWeaponsAndEquipmentCost(ignoreAmmo);</b>
&nbsp;
<b class="nc">&nbsp;        return Math.round(cost * getPriceMultiplier());</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public double getPriceMultiplier() {
<b class="nc">&nbsp;        return 1 + (weight / 50f);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getMaxEngineHits() {
<b class="nc">&nbsp;        return 6;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public double getBVTypeModifier() {
<b class="nc">&nbsp;        return 1.0;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * need to check bay location before loading ammo
&nbsp;     */
&nbsp;    @Override
&nbsp;    public boolean loadWeapon(Mounted mounted, Mounted mountedAmmo) {
<b class="nc">&nbsp;        boolean success = false;</b>
<b class="nc">&nbsp;        WeaponType wtype = (WeaponType) mounted.getType();</b>
<b class="nc">&nbsp;        AmmoType atype = (AmmoType) mountedAmmo.getType();</b>
&nbsp;
<b class="nc">&nbsp;        if (mounted.getLocation() != mountedAmmo.getLocation()) {</b>
<b class="nc">&nbsp;            return success;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (mountedAmmo.isAmmoUsable() &amp;&amp; !wtype.hasFlag(WeaponType.F_ONESHOT) &amp;&amp; (atype.getAmmoType() == wtype.getAmmoType()) &amp;&amp; (atype.getRackSize() == wtype.getRackSize())) {</b>
<b class="nc">&nbsp;            mounted.setLinked(mountedAmmo);</b>
<b class="nc">&nbsp;            success = true;</b>
&nbsp;        }
<b class="nc">&nbsp;        return success;</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * (non-Javadoc)
&nbsp;     * @see megamek.common.Entity#getTotalCommGearTons()
&nbsp;     */
&nbsp;    @Override
&nbsp;    public int getTotalCommGearTons() {
<b class="nc">&nbsp;        return 3 + getExtraCommGearTons();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * All military small craft automatically have ECM if in space
&nbsp;     */
&nbsp;    @Override
&nbsp;    public boolean hasActiveECM() {
<b class="nc">&nbsp;        if (!game.getOptions().booleanOption(OptionsConstants.ADVAERORULES_STRATOPS_ECM) || !game.getBoard().inSpace()) {</b>
<b class="nc">&nbsp;            return super.hasActiveECM();</b>
&nbsp;        }
<b class="nc">&nbsp;        return getECMRange() &gt;= 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * What&#39;s the range of the ECM equipment?
&nbsp;     *
&nbsp;     * @return the &lt;code&gt;int&lt;/code&gt; range of this unit&#39;s ECM. This value will be
&nbsp;     *         &lt;code&gt;Entity.NONE&lt;/code&gt; if no ECM is active.
&nbsp;     */
&nbsp;    @Override
&nbsp;    public int getECMRange() {
<b class="nc">&nbsp;        if (!game.getOptions().booleanOption(OptionsConstants.ADVAERORULES_STRATOPS_ECM)</b>
<b class="nc">&nbsp;                || !game.getBoard().inSpace()) {</b>
<b class="nc">&nbsp;            return super.getECMRange();</b>
&nbsp;        }
<b class="nc">&nbsp;        if (!isMilitary()) {</b>
<b class="nc">&nbsp;            return Entity.NONE;</b>
&nbsp;        }
<b class="nc">&nbsp;        int range = -1;</b>
&nbsp;        // if the unit has an ECM unit, then the range might be extended by one
<b class="nc">&nbsp;        if (!isShutDown()) {</b>
<b class="nc">&nbsp;            for (Mounted m : getMisc()) {</b>
<b class="nc">&nbsp;                EquipmentType type = m.getType();</b>
<b class="nc">&nbsp;                if ((type instanceof MiscType) &amp;&amp; type.hasFlag(MiscType.F_ECM) &amp;&amp; !m.isInoperable()) {</b>
<b class="nc">&nbsp;                    if (type.hasFlag(MiscType.F_SINGLE_HEX_ECM)) {</b>
<b class="nc">&nbsp;                        range += 1;</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        range += 2;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;        // the range might be affected by sensor/FCS damage
<b class="nc">&nbsp;        range = range - getFCSHits() - getSensorHits();</b>
<b class="nc">&nbsp;        return range;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @return is the crew of this vessel protected from gravitational effects,
&nbsp;     *         see StratOps, pg. 36
&nbsp;     */
&nbsp;    @Override
&nbsp;    public boolean isCrewProtected() {
<b class="nc">&nbsp;        return isMilitary() &amp;&amp; (getOriginalWalkMP() &gt; 4);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Return the height of this small craft above the terrain.
&nbsp;     */
&nbsp;    @Override
&nbsp;    public int height() {
<b class="nc">&nbsp;        if (isAirborne()) {</b>
<b class="nc">&nbsp;            return 0;</b>
&nbsp;        }
<b class="nc">&nbsp;        return 1;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getBattleForceSize() {
&nbsp;        //The tables are on page 356 of StartOps
<b class="nc">&nbsp;        if (getWeight() &lt; 2500) {</b>
<b class="nc">&nbsp;            return 1;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (getWeight() &lt; 10000) {</b>
<b class="nc">&nbsp;            return 2;</b>
&nbsp;        }
<b class="nc">&nbsp;        return 3;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public int getNumBattleForceWeaponsLocations() {
<b class="nc">&nbsp;        return 4;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public String getBattleForceLocationName(int index) {
<b class="nc">&nbsp;        return getLocationAbbrs()[index];</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public double getBattleForceLocationMultiplier(int index, int location, boolean rearMounted) {
<b class="nc">&nbsp;        switch (index) {</b>
&nbsp;        case LOC_NOSE:
<b class="nc">&nbsp;            if (location == LOC_NOSE) {</b>
<b class="nc">&nbsp;                return 1.0;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (isSpheroid() &amp;&amp; (location == LOC_LWING || location == LOC_RWING)</b>
&nbsp;                    &amp;&amp; !rearMounted) {
<b class="nc">&nbsp;                return 0.5;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        case LOC_LWING:
&nbsp;        case LOC_RWING:
<b class="nc">&nbsp;            if (index == location) {</b>
<b class="nc">&nbsp;                if (isSpheroid()) {</b>
<b class="nc">&nbsp;                    return 0.5;</b>
&nbsp;                }
<b class="nc">&nbsp;                if (!rearMounted) {</b>
<b class="nc">&nbsp;                    return 1.0;</b>
&nbsp;                }
&nbsp;            }
&nbsp;            break;
&nbsp;        case LOC_AFT:
<b class="nc">&nbsp;            if (location == LOC_AFT) {</b>
<b class="nc">&nbsp;                return 1.0;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (rearMounted &amp;&amp; (location == LOC_LWING || location == LOC_RWING)) {</b>
<b class="nc">&nbsp;                return isSpheroid()? 0.5 : 1.0;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        }
<b class="nc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void addBattleForceSpecialAbilities(Map&lt;BattleForceSPA,Integer&gt; specialAbilities) {
<b class="nc">&nbsp;        super.addBattleForceSpecialAbilities(specialAbilities);</b>
<b class="nc">&nbsp;        specialAbilities.put(BattleForceSPA.LG, null);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public long getEntityType(){
<b class="nc">&nbsp;        return Entity.ETYPE_AERO | Entity.ETYPE_SMALL_CRAFT;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public boolean isFighter() {
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Do not recalculate walkMP when adding engine.
&nbsp;     */
&nbsp;    @Override
&nbsp;    protected int calculateWalk() {
<b class="nc">&nbsp;    	return walkMP;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
