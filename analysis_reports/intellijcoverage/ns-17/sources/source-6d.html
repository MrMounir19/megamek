


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > MechView</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.common</a>
</div>

<h1>Coverage Summary for Class: MechView (megamek.common)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">MechView</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/639)
  </span>
</td>
</tr>
  <tr>
    <td class="name">MechView$1</td>
  </tr>
  <tr>
    <td class="name">MechView$EmptyElement</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MechView$ItemList</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/21)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MechView$LabeledElement</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MechView$SingleLine</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MechView$TableElement</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/80)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MechView$Title</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MechView$ViewElement</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/50)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/757)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2000,2001,2002,2003,2004 Ben Mazur (bmazur@sev.org)
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;
&nbsp;/*
&nbsp; * MechView.java
&nbsp; *
&nbsp; * Created on January 20, 2003 by Ryan McConnell
&nbsp; */
&nbsp;
&nbsp;package megamek.common;
&nbsp;
&nbsp;import java.text.DecimalFormat;
&nbsp;import java.text.DecimalFormatSymbols;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Arrays;
&nbsp;import java.util.Collections;
&nbsp;import java.util.Enumeration;
&nbsp;import java.util.HashMap;
&nbsp;import java.util.Iterator;
&nbsp;import java.util.List;
&nbsp;import java.util.Map;
&nbsp;import java.util.StringJoiner;
&nbsp;import java.util.function.Function;
&nbsp;import java.util.stream.Collectors;
&nbsp;
&nbsp;import megamek.client.ui.Messages;
&nbsp;import megamek.common.options.IOption;
&nbsp;import megamek.common.options.IOptionGroup;
&nbsp;import megamek.common.options.PilotOptions;
&nbsp;import megamek.common.options.Quirks;
&nbsp;import megamek.common.weapons.bayweapons.BayWeapon;
&nbsp;import megamek.common.weapons.infantry.InfantryWeapon;
&nbsp;
&nbsp;/**
&nbsp; * A utility class for retrieving unit information in a formatted string.
&nbsp; * 
&nbsp; * The information is encoded in a series of classes that implement a common {@link ViewElement}
&nbsp; * interface, which can format the element either in html or in plain text.
&nbsp; * 
&nbsp; */
&nbsp;public class MechView {
&nbsp;    
&nbsp;    /**
&nbsp;     * Provides common interface for various ways to present data that can be formatted
&nbsp;     * either as HTML or as plain text.
&nbsp;     * 
&nbsp;     * @see MechView.SingleLine
&nbsp;     * @see MechView.LabeledElement
&nbsp;     * @see MechView.TableElement
&nbsp;     * @see MechView.ItemList
&nbsp;     * @see MechView.Title
&nbsp;     * @see MechView.EmptyElement
&nbsp;     */
&nbsp;    interface ViewElement {
&nbsp;        String toPlainText();
&nbsp;        String toHTML();
&nbsp;    }
&nbsp;    private Entity entity;
&nbsp;    private boolean isMech;
&nbsp;    private boolean isInf;
&nbsp;    private boolean isBA;
&nbsp;    private boolean isVehicle;
&nbsp;    private boolean isProto;
&nbsp;    private boolean isGunEmplacement;
&nbsp;    private boolean isAero;
&nbsp;    private boolean isConvFighter;
&nbsp;    @SuppressWarnings(&quot;unused&quot;)
&nbsp;    private boolean isFixedWingSupport;
&nbsp;    private boolean isSquadron;
&nbsp;    private boolean isSmallCraft;
&nbsp;    private boolean isJumpship;
&nbsp;    @SuppressWarnings(&quot;unused&quot;)
&nbsp;    private boolean isSpaceStation;
&nbsp;
<b class="nc">&nbsp;    private List&lt;ViewElement&gt; sHead = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;    private List&lt;ViewElement&gt; sBasic = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;    private List&lt;ViewElement&gt; sLoadout = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;    private List&lt;ViewElement&gt; sFluff = new ArrayList&lt;&gt;();</b>
&nbsp;    
&nbsp;    private boolean html;
&nbsp;
&nbsp;    /**
&nbsp;     * Compiles information about an {@link Entity} useful for showing a summary of its abilities.
&nbsp;     * Produced output formatted in html.
&nbsp;     * 
&nbsp;     * @param entity           The entity to summarize
&nbsp;     * @param showDetail       If true, shows individual weapons that make up weapon bays.
&nbsp;     */
&nbsp;    public MechView(Entity entity, boolean showDetail) {
<b class="nc">&nbsp;        this(entity, showDetail, false, true);</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Compiles information about an {@link Entity} useful for showing a summary of its abilities.
&nbsp;     * Produced output formatted in html.
&nbsp;     * 
&nbsp;     * @param entity           The entity to summarize
&nbsp;     * @param showDetail       If true, shows individual weapons that make up weapon bays.
&nbsp;     * @param useAlternateCost If true, uses alternate cost calculation. This primarily provides an
&nbsp;     *                         equipment-only cost for conventional infantry for MekHQ.
&nbsp;     */
&nbsp;    public MechView(Entity entity, boolean showDetail, boolean useAlternateCost) {
<b class="nc">&nbsp;        this(entity, showDetail, useAlternateCost, true);</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Compiles information about an {@link Entity} useful for showing a summary of its abilities.
&nbsp;     * 
&nbsp;     * @param entity           The entity to summarize
&nbsp;     * @param showDetail       If true, shows individual weapons that make up weapon bays.
&nbsp;     * @param useAlternateCost If true, uses alternate cost calculation. This primarily provides an
&nbsp;     *                         equipment-only cost for conventional infantry for MekHQ.
&nbsp;     * @param html             If true, produces output formatted as html. If false, formats output
&nbsp;     *                         as plain text.
&nbsp;     */
<b class="nc">&nbsp;    public MechView(Entity entity, boolean showDetail, boolean useAlternateCost, boolean html) {</b>
<b class="nc">&nbsp;        this.entity = entity;</b>
<b class="nc">&nbsp;        this.html = html;</b>
<b class="nc">&nbsp;        isMech = entity instanceof Mech;</b>
<b class="nc">&nbsp;        isInf = entity instanceof Infantry;</b>
<b class="nc">&nbsp;        isBA = entity instanceof BattleArmor;</b>
<b class="nc">&nbsp;        isVehicle = entity instanceof Tank;</b>
<b class="nc">&nbsp;        isProto = entity instanceof Protomech;</b>
<b class="nc">&nbsp;        isGunEmplacement = entity instanceof GunEmplacement;</b>
<b class="nc">&nbsp;        isAero = entity instanceof Aero;</b>
<b class="nc">&nbsp;        isConvFighter = entity instanceof ConvFighter;</b>
<b class="nc">&nbsp;        isFixedWingSupport = entity instanceof FixedWingSupport;</b>
<b class="nc">&nbsp;        isSquadron = entity instanceof FighterSquadron;</b>
<b class="nc">&nbsp;        isSmallCraft = entity instanceof SmallCraft;</b>
<b class="nc">&nbsp;        isJumpship = entity instanceof Jumpship;</b>
<b class="nc">&nbsp;        isSpaceStation = entity instanceof SpaceStation;</b>
&nbsp;
<b class="nc">&nbsp;        sLoadout.addAll(getWeapons(showDetail));</b>
<b class="nc">&nbsp;        sLoadout.add(new SingleLine());</b>
<b class="nc">&nbsp;        if ((!entity.usesWeaponBays() || !showDetail)</b>
<b class="nc">&nbsp;                &amp;&amp; entity.getAmmo().size() &gt; 0) {</b>
<b class="nc">&nbsp;            sLoadout.add(getAmmo());</b>
<b class="nc">&nbsp;            sLoadout.add(new SingleLine());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (entity instanceof IBomber) {</b>
<b class="nc">&nbsp;            sLoadout.addAll(getBombs());</b>
<b class="nc">&nbsp;            sLoadout.add(new SingleLine());</b>
&nbsp;        }
<b class="nc">&nbsp;        sLoadout.addAll(getMisc()); // has to occur before basic is processed</b>
<b class="nc">&nbsp;        sLoadout.add(new SingleLine());</b>
<b class="nc">&nbsp;        sLoadout.add(getFailed());</b>
<b class="nc">&nbsp;        sLoadout.add(new SingleLine());</b>
&nbsp;
<b class="nc">&nbsp;        if (isInf) {</b>
<b class="nc">&nbsp;            Infantry inf = (Infantry) entity;</b>
<b class="nc">&nbsp;            if (inf.getSpecializations() &gt; 0) {</b>
<b class="nc">&nbsp;                ItemList specList = new ItemList(&quot;Infantry Specializations&quot;);</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; Infantry.NUM_SPECIALIZATIONS; i++) {</b>
<b class="nc">&nbsp;                    int spec = 1 &lt;&lt; i;</b>
<b class="nc">&nbsp;                    if (inf.hasSpecialization(spec)) {</b>
<b class="nc">&nbsp;                        specList.addItem(Infantry.getSpecializationName(spec));</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                sLoadout.add(specList);</b>
&nbsp;            }
&nbsp;            
<b class="nc">&nbsp;            if (inf.getCrew() != null) {</b>
<b class="nc">&nbsp;	            ArrayList&lt;String&gt; augmentations = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;	            for (Enumeration&lt;IOption&gt; e = inf.getCrew().getOptions(PilotOptions.MD_ADVANTAGES);</b>
<b class="nc">&nbsp;	            		e.hasMoreElements();) {</b>
<b class="nc">&nbsp;	            	final IOption o = e.nextElement();</b>
<b class="nc">&nbsp;	            	if (o.booleanValue()) {</b>
<b class="nc">&nbsp;	            		augmentations.add(o.getDisplayableName());</b>
&nbsp;	            	}
<b class="nc">&nbsp;	            }</b>
<b class="nc">&nbsp;	            if (augmentations.size() &gt; 0) {</b>
<b class="nc">&nbsp;	                ItemList augList = new ItemList(&quot;Augmentations&quot;);</b>
<b class="nc">&nbsp;	            	for (String aug : augmentations) {</b>
<b class="nc">&nbsp;	            		augList.addItem(aug);</b>
<b class="nc">&nbsp;	            	}</b>
<b class="nc">&nbsp;	            	sLoadout.add(augList);</b>
&nbsp;	            }
&nbsp;            }
&nbsp;        }
&nbsp;        // sBasic.append(getFluffImage(entity)).append(&quot;&lt;br&gt;&quot;);
<b class="nc">&nbsp;        sHead.add(new Title(entity.getShortNameRaw()));</b>
<b class="nc">&nbsp;        String techLevel = entity.getStaticTechLevel().toString();</b>
<b class="nc">&nbsp;        if (entity.isMixedTech()) {</b>
<b class="nc">&nbsp;            if (entity.isClan()) {</b>
<b class="nc">&nbsp;                techLevel += Messages.getString(&quot;MechView.MixedClan&quot;);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                techLevel += Messages.getString(&quot;MechView.MixedIS&quot;);</b>
&nbsp;            }
&nbsp;        } else {
<b class="nc">&nbsp;            if (entity.isClan()) {</b>
<b class="nc">&nbsp;                techLevel += Messages.getString(&quot;MechView.Clan&quot;);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                techLevel += Messages.getString(&quot;MechView.IS&quot;);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        sHead.add(new LabeledElement(Messages.getString(&quot;MechView.BaseTechLevel&quot;), techLevel));</b>
<b class="nc">&nbsp;        if (!entity.isDesignValid()) {</b>
<b class="nc">&nbsp;            sHead.add(new SingleLine(Messages.getString(&quot;MechView.DesignInvalid&quot;)));</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        TableElement tpTable = new TableElement(2);</b>
<b class="nc">&nbsp;        tpTable.setColNames(Messages.getString(&quot;MechView.Level&quot;), Messages.getString(&quot;MechView.Era&quot;));</b>
<b class="nc">&nbsp;        tpTable.setJustification(TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_CENTER);</b>
<b class="nc">&nbsp;        tpTable.addRow(TechConstants.getSimpleLevelName(TechConstants.T_SIMPLE_EXPERIMENTAL),</b>
<b class="nc">&nbsp;                entity.getExperimentalRange());</b>
<b class="nc">&nbsp;        tpTable.addRow(TechConstants.getSimpleLevelName(TechConstants.T_SIMPLE_ADVANCED),</b>
<b class="nc">&nbsp;                entity.getAdvancedRange());</b>
<b class="nc">&nbsp;        tpTable.addRow(TechConstants.getSimpleLevelName(TechConstants.T_SIMPLE_STANDARD),</b>
<b class="nc">&nbsp;                entity.getStandardRange());</b>
<b class="nc">&nbsp;        String extinctRange = entity.getExtinctionRange();</b>
<b class="nc">&nbsp;        if (extinctRange.length() &gt; 1) {</b>
<b class="nc">&nbsp;            tpTable.addRow(Messages.getString(&quot;MechView.Extinct&quot;), extinctRange);</b>
&nbsp;        }
<b class="nc">&nbsp;        sHead.add(tpTable);</b>
&nbsp;            
<b class="nc">&nbsp;        sHead.add(new LabeledElement(Messages.getString(&quot;MechView.TechRating&quot;), entity.getFullRatingName()));</b>
<b class="nc">&nbsp;        sHead.add(new SingleLine());</b>
&nbsp;
<b class="nc">&nbsp;        if (!isInf) {</b>
<b class="nc">&nbsp;            sHead.add(new LabeledElement(Messages.getString(&quot;MechView.Weight&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    Math.round(entity.getWeight()) + Messages.getString(&quot;MechView.tons&quot;))); //$NON-NLS-1$</b>
&nbsp;        }
<b class="nc">&nbsp;        DecimalFormatSymbols unusualSymbols = new DecimalFormatSymbols();</b>
<b class="nc">&nbsp;        unusualSymbols.setDecimalSeparator(&#39;.&#39;);</b>
<b class="nc">&nbsp;        unusualSymbols.setGroupingSeparator(&#39;,&#39;);</b>
<b class="nc">&nbsp;        DecimalFormat dFormatter = new DecimalFormat(&quot;#,###.##&quot;, unusualSymbols); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        sHead.add(new LabeledElement(Messages.getString(&quot;MechView.BV&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                dFormatter.format(entity.calculateBattleValue(false,</b>
<b class="nc">&nbsp;                        null == entity.getCrew()))));</b>
<b class="nc">&nbsp;        double cost = entity.getCost(false);</b>
<b class="nc">&nbsp;        if(useAlternateCost &amp;&amp; entity.getAlternateCost() &gt; 0) {</b>
<b class="nc">&nbsp;            cost = entity.getAlternateCost();</b>
&nbsp;        }
<b class="nc">&nbsp;        sHead.add(new LabeledElement(Messages.getString(&quot;MechView.Cost&quot;), //$NON-NLS-1$//</b>
<b class="nc">&nbsp;                dFormatter.format(cost) + &quot; C-bills&quot;));</b>
<b class="nc">&nbsp;        if (!entity.getSource().isEmpty()) {</b>
<b class="nc">&nbsp;            sHead.add(new LabeledElement(Messages.getString(&quot;MechView.Source&quot;), entity.getSource())); //$NON-NLS-1$//</b>
&nbsp;        }
<b class="nc">&nbsp;        UnitRole role = UnitRoleHandler.getRoleFor(entity);</b>
<b class="nc">&nbsp;        if (role != UnitRole.UNDETERMINED) {</b>
<b class="nc">&nbsp;            sHead.add(new LabeledElement(&quot;Role&quot;, role.toString()));</b>
&nbsp;        }
&nbsp;
&nbsp;        //We may have altered the starting mode during configuration, so we save the current one here to restore it
<b class="nc">&nbsp;        int originalMode = entity.getConversionMode();</b>
<b class="nc">&nbsp;        entity.setConversionMode(0);</b>
<b class="nc">&nbsp;        if (!isGunEmplacement) {</b>
<b class="nc">&nbsp;            sBasic.add(new SingleLine());</b>
<b class="nc">&nbsp;            StringBuilder moveString = new StringBuilder();</b>
<b class="nc">&nbsp;            moveString.append(entity.getWalkMP()).append(&quot;/&quot;)</b>
<b class="nc">&nbsp;                .append(entity.getRunMPasString());</b>
<b class="nc">&nbsp;            if (entity.getJumpMP() &gt; 0) {</b>
<b class="nc">&nbsp;                moveString.append(&quot;/&quot;) //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        .append(entity.getJumpMP());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (entity.damagedJumpJets() &gt; 0) {</b>
<b class="nc">&nbsp;                moveString.append(&quot;&lt;font color=&#39;red&#39;&gt; (&quot;).append(entity.damagedJumpJets())</b>
<b class="nc">&nbsp;                        .append(&quot; damaged jump jets)&lt;/font&gt;&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (entity.getAllUMUCount() &gt; 0) {</b>
&nbsp;                // Add in Jump MP if it wasn&#39;t already printed
<b class="nc">&nbsp;                if (entity.getJumpMP() == 0) {</b>
<b class="nc">&nbsp;                    moveString.append(&quot;/0&quot;); //$NON-NLS-1$</b>
&nbsp;                }
<b class="nc">&nbsp;                moveString.append(&quot;/&quot;) //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        .append(entity.getActiveUMUCount());</b>
<b class="nc">&nbsp;                if ((entity.getAllUMUCount() - entity.getActiveUMUCount()) != 0) {</b>
<b class="nc">&nbsp;                    moveString.append(&quot;&lt;font color=&#39;red&#39;&gt; (&quot;)</b>
<b class="nc">&nbsp;                            .append(entity.getAllUMUCount() - entity.getActiveUMUCount())</b>
<b class="nc">&nbsp;                            .append(&quot; damaged UMUs)&lt;/font&gt;&quot;);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (isVehicle) {</b>
<b class="nc">&nbsp;                moveString.append(&quot; (&quot;).append(Messages</b>
<b class="nc">&nbsp;                            .getString(&quot;MovementType.&quot; + entity.getMovementModeAsString()))</b>
<b class="nc">&nbsp;                            .append(&quot;)&quot;);</b>
<b class="nc">&nbsp;                if ((((Tank) entity).getMotiveDamage() &gt; 0)</b>
<b class="nc">&nbsp;                        || (((Tank) entity).getMotivePenalty() &gt; 0)) {</b>
<b class="nc">&nbsp;                    moveString.append(&quot; &quot;).append(warningStart())</b>
<b class="nc">&nbsp;                        .append(&quot;(motive damage: -&quot;)</b>
<b class="nc">&nbsp;                        .append(((Tank) entity).getMotiveDamage())</b>
<b class="nc">&nbsp;                        .append(&quot;MP/-&quot;)</b>
<b class="nc">&nbsp;                        .append(((Tank) entity).getMotivePenalty())</b>
<b class="nc">&nbsp;                        .append(&quot; piloting)&quot;)</b>
<b class="nc">&nbsp;                        .append(warningEnd());</b>
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            // TODO : Add STOL message as part of the movement line
<b class="nc">&nbsp;            if (isConvFighter &amp;&amp; ((Aero) entity).isVSTOL()) {</b>
<b class="nc">&nbsp;                sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.Movement&quot;),</b>
<b class="nc">&nbsp;                        moveString.toString().concat(</b>
<b class="nc">&nbsp;                                String.format(&quot; (%s)&quot;, Messages.getString(&quot;MechView.VSTOL&quot;))))); //$NON-NLS-1$</b>
&nbsp;            } else {
<b class="nc">&nbsp;                sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.Movement&quot;), moveString.toString())); //$NON-NLS-1$</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (isBA &amp;&amp; ((BattleArmor) entity).isBurdened()) {</b>
<b class="nc">&nbsp;            sBasic.add(new SingleLine(italicsStart()</b>
<b class="nc">&nbsp;                    + Messages.getString(&quot;MechView.Burdened&quot;)</b>
<b class="nc">&nbsp;                    + italicsEnd())); //$NON-NLS-1$</b>
&nbsp;        }
<b class="nc">&nbsp;        if (isBA &amp;&amp; ((BattleArmor) entity).hasDWP()) {</b>
<b class="nc">&nbsp;            sBasic.add(new SingleLine(italicsStart()</b>
<b class="nc">&nbsp;                    + Messages.getString(&quot;MechView.DWPBurdened&quot;)</b>
<b class="nc">&nbsp;                    + italicsEnd())); //$NON-NLS-1$</b>
&nbsp;        }
<b class="nc">&nbsp;        if (entity instanceof QuadVee) {</b>
<b class="nc">&nbsp;            entity.setConversionMode(QuadVee.CONV_MODE_VEHICLE);</b>
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(Messages.getString(&quot;MovementType.&quot; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    + entity.getMovementModeAsString()),</b>
<b class="nc">&nbsp;                    entity.getWalkMP() + &quot;/&quot; + entity.getRunMPasString())); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            entity.setConversionMode(originalMode);</b>
<b class="nc">&nbsp;        } else if (entity instanceof LandAirMech) {</b>
<b class="nc">&nbsp;            if (((LandAirMech)entity).getLAMType() == LandAirMech.LAM_STANDARD) {</b>
<b class="nc">&nbsp;                sBasic.add(new LabeledElement(Messages.getString(&quot;MovementType.AirMech&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        ((LandAirMech) entity).getAirMechWalkMP() + &quot;/&quot;</b>
<b class="nc">&nbsp;                                + ((LandAirMech) entity).getAirMechRunMP() + &quot;/&quot;</b>
<b class="nc">&nbsp;                                + ((LandAirMech) entity).getAirMechCruiseMP() + &quot;/&quot;</b>
<b class="nc">&nbsp;                                + ((LandAirMech) entity).getAirMechFlankMP()));</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            entity.setConversionMode(LandAirMech.CONV_MODE_FIGHTER);</b>
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(Messages.getString(&quot;MovementType.Fighter&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    entity.getWalkMP() + &quot;/&quot; + entity.getRunMP())); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            entity.setConversionMode(originalMode);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (isMech || isVehicle</b>
&nbsp;                || (isAero &amp;&amp; !isSmallCraft &amp;&amp; !isJumpship &amp;&amp; !isSquadron)) {
<b class="nc">&nbsp;            String engineName = entity.hasEngine() ? entity.getEngine().getShortEngineName() : &quot;(none)&quot;;</b>
<b class="nc">&nbsp;            if (entity.getEngineHits() &gt; 0) {</b>
<b class="nc">&nbsp;                engineName += &quot; &quot; + warningStart() + &quot;(&quot; + entity.getEngineHits()</b>
<b class="nc">&nbsp;                        + &quot; hits)&quot; + warningEnd();</b>
&nbsp;            }
<b class="nc">&nbsp;            if (isMech &amp;&amp; entity.hasArmoredEngine()) {</b>
<b class="nc">&nbsp;                engineName += &quot; (armored)&quot;;</b>
&nbsp;            }
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.Engine&quot;), engineName)); //$NON-NLS-1$</b>
&nbsp;        }
<b class="nc">&nbsp;        if (!entity.hasPatchworkArmor() &amp;&amp; entity.hasBARArmor(1)) {</b>
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.BARRating&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    String.valueOf(entity.getBARRating(0))));</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (isAero &amp;&amp; !isConvFighter) {</b>
<b class="nc">&nbsp;            Aero a = (Aero) entity;</b>
<b class="nc">&nbsp;            StringBuilder hsString = new StringBuilder(String.valueOf(a.getHeatSinks()));</b>
<b class="nc">&nbsp;            if (a.getPodHeatSinks() &gt; 0) {</b>
<b class="nc">&nbsp;                hsString.append(&quot; (&quot;).append(a.getPodHeatSinks()).append(&quot; &quot;)</b>
<b class="nc">&nbsp;                    .append(Messages.getString(&quot;MechView.Pod&quot;)).append(&quot;)&quot;); //$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (a.getHeatCapacity() &gt; a.getHeatSinks()) {</b>
<b class="nc">&nbsp;                hsString.append(&quot; [&quot;) //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        .append(a.getHeatCapacity()).append(&quot;]&quot;); //$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (a.getHeatSinkHits() &gt; 0) {</b>
<b class="nc">&nbsp;                hsString.append(warningStart()).append(&quot; (&quot;).append(a.getHeatSinkHits())</b>
<b class="nc">&nbsp;                        .append(&quot; damaged)&quot;).append(warningEnd());</b>
&nbsp;            }
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.HeatSinks&quot;), hsString.toString())); //$NON-NLS-1$</b>
&nbsp;            
<b class="nc">&nbsp;            if (a.getCockpitType() != Mech.COCKPIT_STANDARD) {</b>
<b class="nc">&nbsp;                sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.Cockpit&quot;), // $NON-NLS-1$</b>
<b class="nc">&nbsp;                        a.getCockpitTypeString()));</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (isMech) {</b>
<b class="nc">&nbsp;            Mech aMech = (Mech) entity;</b>
<b class="nc">&nbsp;            StringBuilder hsString = new StringBuilder();</b>
<b class="nc">&nbsp;            hsString.append(aMech.heatSinks());</b>
<b class="nc">&nbsp;            if (aMech.getHeatCapacity() &gt; aMech.heatSinks()) {</b>
<b class="nc">&nbsp;                hsString.append(&quot; [&quot;) //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        .append(aMech.getHeatCapacity()).append(&quot;]&quot;); //$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (aMech.damagedHeatSinks() &gt; 0) {</b>
<b class="nc">&nbsp;                hsString.append(&quot; &quot;).append(warningStart()).append(&quot;(&quot;)</b>
<b class="nc">&nbsp;                        .append(aMech.damagedHeatSinks())</b>
<b class="nc">&nbsp;                        .append(&quot; damaged)&quot;).append(warningEnd());</b>
&nbsp;            }
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(aMech.getHeatSinkTypeName() + &quot;s&quot;, hsString.toString()));</b>
<b class="nc">&nbsp;            if ((aMech.getCockpitType() != Mech.COCKPIT_STANDARD)</b>
<b class="nc">&nbsp;                    || aMech.hasArmoredCockpit()) {</b>
<b class="nc">&nbsp;                sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.Cockpit&quot;),</b>
<b class="nc">&nbsp;                        aMech.getCockpitTypeString()</b>
<b class="nc">&nbsp;                                + (aMech.hasArmoredCockpit() ? &quot; (armored)&quot; : &quot;&quot;)));</b>
&nbsp;                                
&nbsp;            }
<b class="nc">&nbsp;            String gyroString = aMech.getGyroTypeString();</b>
<b class="nc">&nbsp;            if (aMech.getGyroHits() &gt; 0) {</b>
<b class="nc">&nbsp;                gyroString += &quot; &quot; + warningStart() + &quot;(&quot; + aMech.getGyroHits()</b>
<b class="nc">&nbsp;                    + &quot; hits)&quot; + warningEnd();</b>
&nbsp;            }
<b class="nc">&nbsp;            if (aMech.hasArmoredGyro()) {</b>
<b class="nc">&nbsp;                gyroString += &quot; (armored)&quot;;</b>
&nbsp;            }
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.Gyro&quot;), //$NON-NLS-1$</b>
&nbsp;                    gyroString));
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (isAero) {</b>
<b class="nc">&nbsp;            Aero a = (Aero) entity;</b>
<b class="nc">&nbsp;            if (!a.getCritDamageString().isEmpty()) {</b>
<b class="nc">&nbsp;                sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.SystemDamage&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        warningStart() + a.getCritDamageString() + warningEnd()));</b>
&nbsp;            }
&nbsp;            
<b class="nc">&nbsp;            String fuel = String.valueOf(a.getCurrentFuel());</b>
<b class="nc">&nbsp;            if (a.getCurrentFuel() &lt; a.getFuel()) {</b>
<b class="nc">&nbsp;                fuel += &quot;/&quot; + a.getFuel(); //$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.FuelPoints&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    String.format(Messages.getString(&quot;MechView.Fuel.format&quot;), fuel, a.getFuelTonnage()))); //$NON-NLS-1$</b>
&nbsp;
&nbsp;            //Display Strategic Fuel Use for Small Craft and up
<b class="nc">&nbsp;            if (isSmallCraft || isJumpship) {</b>
<b class="nc">&nbsp;                sBasic.add(new LabeledElement(Messages.getString(&quot;MechView.TonsPerBurnDay&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        String.format(&quot;%2.2f&quot;, a.getStrategicFuelUse()))); //$NON-NLS-1$</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (!isGunEmplacement) {</b>
<b class="nc">&nbsp;            sBasic.add(new SingleLine());</b>
<b class="nc">&nbsp;            if (isSquadron) {</b>
<b class="nc">&nbsp;                sBasic.addAll(getArmor());</b>
<b class="nc">&nbsp;            } else if (isAero) {</b>
<b class="nc">&nbsp;                sBasic.addAll(getSIandArmor());</b>
&nbsp;            } else {
<b class="nc">&nbsp;                sBasic.addAll(getInternalAndArmor());</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        sBasic.add(new SingleLine());</b>
&nbsp;        
<b class="nc">&nbsp;        StringJoiner quirksList = new StringJoiner(&quot;&lt;br/&gt;\n&quot;);</b>
<b class="nc">&nbsp;        Quirks quirks = entity.getQuirks();</b>
<b class="nc">&nbsp;        for (Enumeration&lt;IOptionGroup&gt; optionGroups = quirks.getGroups(); optionGroups.hasMoreElements();) {</b>
<b class="nc">&nbsp;            IOptionGroup group = optionGroups.nextElement();</b>
<b class="nc">&nbsp;            if (quirks.count(group.getKey()) &gt; 0) {</b>
<b class="nc">&nbsp;                for (Enumeration&lt;IOption&gt; options = group.getOptions(); options.hasMoreElements();) {</b>
<b class="nc">&nbsp;                    IOption option = options.nextElement();</b>
<b class="nc">&nbsp;                    if (option != null &amp;&amp; option.booleanValue()) {</b>
<b class="nc">&nbsp;                        quirksList.add(option.getDisplayableNameWithValue());</b>
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        if (quirksList.length() &gt; 0) {</b>
<b class="nc">&nbsp;            ItemList list = new ItemList(Messages.getString(&quot;MechView.Quirks&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            list.addItem(quirksList.toString());</b>
<b class="nc">&nbsp;            sFluff.add(list);</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        if (!entity.getFluff().getOverview().isEmpty()) {</b>
<b class="nc">&nbsp;            sFluff.add(new LabeledElement(&quot;Overview&quot;, entity.getFluff().getOverview()));</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        if (!entity.getFluff().getCapabilities().isEmpty()) {</b>
<b class="nc">&nbsp;            sFluff.add(new LabeledElement(&quot;Capabilities&quot;, entity.getFluff().getCapabilities()));</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        if (!entity.getFluff().getDeployment().isEmpty()) {</b>
<b class="nc">&nbsp;            sFluff.add(new LabeledElement(&quot;Deployment&quot;, entity.getFluff().getDeployment()));</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        if (!entity.getFluff().getHistory().isEmpty()) {</b>
<b class="nc">&nbsp;            sFluff.add(new LabeledElement(&quot;History&quot;, entity.getFluff().getHistory()));</b>
&nbsp;        }
<b class="nc">&nbsp;        sFluff.add(new SingleLine());</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Converts a list of {@link ViewElement}s to a String using the selected format.
&nbsp;     * 
&nbsp;     * @param section The elements to format.
&nbsp;     * @return        The formatted data.
&nbsp;     */
&nbsp;    private String getReadout(List&lt;ViewElement&gt; section) {
<b class="nc">&nbsp;        Function&lt;ViewElement,String&gt; mapper = html?</b>
<b class="nc">&nbsp;                ViewElement::toHTML : ViewElement::toPlainText;</b>
<b class="nc">&nbsp;        return section.stream().map(mapper).collect(Collectors.joining());</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * The head section includes the title (unit name), tech level and availability, tonnage, bv, and cost.
&nbsp;     * @return The data from the head section.
&nbsp;     */
&nbsp;    public String getMechReadoutHead() {
<b class="nc">&nbsp;        return getReadout(sHead);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * The basic section includes general details such as movement, system equipment (cockpit, gyro, etc.)
&nbsp;     * and armor.
&nbsp;     * @return The data from the basic section
&nbsp;     */
&nbsp;    public String getMechReadoutBasic() {
<b class="nc">&nbsp;        return getReadout(sBasic);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * The loadout includes weapons, ammo, and other equipment broken down by location.
&nbsp;     * @return The data from the loadout section.
&nbsp;     */
&nbsp;    public String getMechReadoutLoadout() {
<b class="nc">&nbsp;        return getReadout(sLoadout);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * The fluff section includes fluff details like unit history and deployment patterns
&nbsp;     * as well as quirks.
&nbsp;     * @return The data from the fluff section.
&nbsp;     */
&nbsp;    public String getMechReadoutFluff() {
<b class="nc">&nbsp;        return getReadout(sFluff);</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * @return A summary including all four sections. 
&nbsp;     */
&nbsp;    public String getMechReadout() {
<b class="nc">&nbsp;        String docStart = html?</b>
<b class="nc">&nbsp;                &quot;&lt;div style=\&quot;font:12pt monospaced\&quot;&gt;&quot; : &quot;&quot;;</b>
<b class="nc">&nbsp;        String docEnd = html?</b>
<b class="nc">&nbsp;                &quot;&lt;/div&gt;&quot; : &quot;&quot;;</b>
<b class="nc">&nbsp;        return docStart + getMechReadoutHead()</b>
<b class="nc">&nbsp;                + getMechReadoutBasic() + getMechReadoutLoadout()</b>
<b class="nc">&nbsp;                + getMechReadoutFluff() + docEnd;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ViewElement&gt; getInternalAndArmor() {
<b class="nc">&nbsp;        List&lt;ViewElement&gt; retVal = new ArrayList&lt;&gt;();</b>
&nbsp;        
<b class="nc">&nbsp;        int maxArmor = (entity.getTotalInternal() * 2) + 3;</b>
<b class="nc">&nbsp;        if (isInf &amp;&amp; !isBA) {</b>
<b class="nc">&nbsp;            Infantry inf = (Infantry) entity;</b>
<b class="nc">&nbsp;            retVal.add(new LabeledElement(Messages.getString(&quot;MechView.Men&quot;),</b>
<b class="nc">&nbsp;                    entity.getTotalInternal()</b>
<b class="nc">&nbsp;                            + &quot; (&quot; + inf.getSquadSize() + &quot;/&quot; + inf.getSquadN()</b>
&nbsp;                            + &quot;)&quot;));
<b class="nc">&nbsp;        } else {</b>
<b class="nc">&nbsp;            String internal = String.valueOf(entity.getTotalInternal());</b>
<b class="nc">&nbsp;            if (isMech) {</b>
<b class="nc">&nbsp;                internal += Messages.getString(&quot;MechView.&quot;</b>
<b class="nc">&nbsp;                        + EquipmentType.getStructureTypeName(entity</b>
<b class="nc">&nbsp;                                .getStructureType()));</b>
&nbsp;            }
<b class="nc">&nbsp;            retVal.add(new LabeledElement(Messages.getString(&quot;MechView.Internal&quot;), //$NON-NLS-1$</b>
&nbsp;                    internal));
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (isInf &amp;&amp; !isBA) {</b>
<b class="nc">&nbsp;            Infantry inf = (Infantry) entity;</b>
<b class="nc">&nbsp;            retVal.add(new LabeledElement(Messages.getString(&quot;MechView.Armor&quot;),</b>
<b class="nc">&nbsp;                    inf.getArmorDesc()));</b>
<b class="nc">&nbsp;        } else {</b>
<b class="nc">&nbsp;            String armor = String.valueOf(entity.getTotalArmor());</b>
<b class="nc">&nbsp;            if (isMech) {</b>
<b class="nc">&nbsp;                armor += &quot;/&quot; + maxArmor;//$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (!isInf &amp;&amp; !isProto &amp;&amp; !entity.hasPatchworkArmor()) {</b>
<b class="nc">&nbsp;                armor += Messages.getString(&quot;MechView.&quot;</b>
<b class="nc">&nbsp;                        + EquipmentType.getArmorTypeName(entity.getArmorType(1))</b>
<b class="nc">&nbsp;                                .trim());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (isBA) {</b>
<b class="nc">&nbsp;                armor += &quot; &quot; + EquipmentType.getBaArmorTypeName(entity.getArmorType(1))</b>
<b class="nc">&nbsp;                                .trim();</b>
&nbsp;            }
<b class="nc">&nbsp;            retVal.add(new LabeledElement(Messages.getString(&quot;MechView.Armor&quot;), //$NON-NLS-1$</b>
&nbsp;                    armor));
&nbsp;
&nbsp;        }
&nbsp;        // Walk through the entity&#39;s locations.
&nbsp;
<b class="nc">&nbsp;        if (!(isInf &amp;&amp; !isBA)) {</b>
<b class="nc">&nbsp;            TableElement locTable = new TableElement(5);</b>
<b class="nc">&nbsp;            locTable.setColNames(&quot;&quot;, &quot;Internal&quot;, &quot;Armor&quot;, &quot;&quot;, &quot;&quot;); // last two columns are patchwork armor and location damage</b>
<b class="nc">&nbsp;            locTable.setJustification(TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_RIGHT,</b>
&nbsp;                    TableElement.JUSTIFIED_RIGHT, TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_LEFT);
<b class="nc">&nbsp;            for (int loc = 0; loc &lt; entity.locations(); loc++) {</b>
&nbsp;                // Skip empty sections.
<b class="nc">&nbsp;                if (entity.getInternal(loc) == IArmorState.ARMOR_NA) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;                // Skip nonexistent turrets by vehicle type, as well as the
&nbsp;                // body location.
<b class="nc">&nbsp;                if (isVehicle) {</b>
<b class="nc">&nbsp;                    if (loc == Tank.LOC_BODY) {</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if ((loc == ((Tank) entity).getLocTurret())</b>
<b class="nc">&nbsp;                            &amp;&amp; ((Tank) entity).hasNoTurret()) {</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
&nbsp;
&nbsp;                }
<b class="nc">&nbsp;                String[] row = {entity.getLocationName(loc),</b>
<b class="nc">&nbsp;                        renderArmor(entity.getInternalForReal(loc), entity.getOInternal(loc), html),</b>
&nbsp;                        &quot;&quot;, &quot;&quot;, &quot;&quot; };
&nbsp;                
<b class="nc">&nbsp;                if (IArmorState.ARMOR_NA != entity.getArmorForReal(loc)) {</b>
<b class="nc">&nbsp;                    row[2] = renderArmor(entity.getArmorForReal(loc),</b>
<b class="nc">&nbsp;                            entity.getOArmor(loc), html);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (entity.hasPatchworkArmor()) {</b>
<b class="nc">&nbsp;                    row[3] = Messages.getString(&quot;MechView.&quot;</b>
<b class="nc">&nbsp;                            + EquipmentType.getArmorTypeName(entity</b>
<b class="nc">&nbsp;                                    .getArmorType(loc)).trim());</b>
<b class="nc">&nbsp;                    if (entity.hasBARArmor(loc)) {</b>
<b class="nc">&nbsp;                        row[3] += &quot; &quot; + Messages.getString(&quot;MechView.BARRating&quot;) //$NON-NLS-1$</b>
<b class="nc">&nbsp;                                + entity.getBARRating(loc);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                if (!entity.getLocationDamage(loc).isEmpty()) {</b>
<b class="nc">&nbsp;                    row[4] = warningStart() + entity.getLocationDamage(loc) + warningEnd();</b>
&nbsp;                }
<b class="nc">&nbsp;                locTable.addRow(row);</b>
<b class="nc">&nbsp;                if (entity.hasRearArmor(loc)) {</b>
<b class="nc">&nbsp;                    row = new String[] { entity.getLocationName(loc) + &quot; (rear)&quot;, &quot;&quot;,</b>
<b class="nc">&nbsp;                            renderArmor(entity.getArmorForReal(loc, true),</b>
<b class="nc">&nbsp;                                    entity.getOArmor(loc, true), html), &quot;&quot;, &quot;&quot;};</b>
<b class="nc">&nbsp;                    locTable.addRow(row);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            retVal.add(locTable);</b>
&nbsp;        }
<b class="nc">&nbsp;        return retVal;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ViewElement&gt; getSIandArmor() {
<b class="nc">&nbsp;        Aero a = (Aero) entity;</b>
&nbsp;
<b class="nc">&nbsp;        List&lt;ViewElement&gt; retVal = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        retVal.add(new LabeledElement(Messages.getString(&quot;MechView.SI&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                renderArmor(a.getSI(), a.get0SI(), html)));</b>
&nbsp;
&nbsp;        // if it is a jumpship get sail and KF integrity
<b class="nc">&nbsp;        if (isJumpship) {</b>
<b class="nc">&nbsp;            Jumpship js = (Jumpship) entity;</b>
&nbsp;
&nbsp;            // TODO: indicate damage.
<b class="nc">&nbsp;            if (js.hasSail()) {</b>
<b class="nc">&nbsp;                retVal.add(new LabeledElement(Messages.getString(&quot;MechView.SailIntegrity&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        String.valueOf(js.getSailIntegrity())));</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (js.getDriveCoreType() != Jumpship.DRIVE_CORE_NONE) {</b>
<b class="nc">&nbsp;                retVal.add(new LabeledElement(Messages.getString(&quot;MechView.KFIntegrity&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        String.valueOf(js.getKFIntegrity())));</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        String armor = String.valueOf(entity.isCapitalFighter()? a.getCapArmor() : a.getTotalArmor());</b>
<b class="nc">&nbsp;        if (isJumpship) {</b>
<b class="nc">&nbsp;            armor += Messages.getString(&quot;MechView.CapitalArmor&quot;);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (!entity.hasPatchworkArmor()) {</b>
<b class="nc">&nbsp;            armor += Messages.getString(&quot;MechView.&quot;</b>
<b class="nc">&nbsp;                    + EquipmentType.getArmorTypeName(entity.getArmorType(1))</b>
<b class="nc">&nbsp;                            .trim());</b>
&nbsp;        }
<b class="nc">&nbsp;        retVal.add(new LabeledElement(Messages.getString(&quot;MechView.Armor&quot;), //$NON-NLS-1$</b>
&nbsp;                armor));
&nbsp;
&nbsp;        // Walk through the entity&#39;s locations.
<b class="nc">&nbsp;        if (!entity.isCapitalFighter()) {</b>
<b class="nc">&nbsp;            TableElement locTable = new TableElement(3);</b>
<b class="nc">&nbsp;            locTable.setColNames(&quot;&quot;, &quot;Armor&quot;, &quot;&quot;);</b>
<b class="nc">&nbsp;            locTable.setJustification(TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_RIGHT,</b>
&nbsp;                    TableElement.JUSTIFIED_LEFT);
<b class="nc">&nbsp;            for (int loc = 0; loc &lt; entity.locations(); loc++) {</b>
&nbsp;
&nbsp;                // Skip empty sections.
<b class="nc">&nbsp;                if (IArmorState.ARMOR_NA == entity.getInternal(loc)) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;                // skip broadsides on warships
<b class="nc">&nbsp;                if (isJumpship &amp;&amp; (loc &gt;= Jumpship.LOC_HULL)) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                if (isSmallCraft &amp;&amp; (loc &gt;= SmallCraft.LOC_HULL)) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;                // skip the &quot;Wings&quot; location
<b class="nc">&nbsp;                if (!a.isLargeCraft() &amp;&amp; (loc &gt;= Aero.LOC_WINGS)) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                String[] row = { entity.getLocationName(loc), &quot;&quot;, &quot;&quot; };</b>
<b class="nc">&nbsp;                if (IArmorState.ARMOR_NA != entity.getArmor(loc)) {</b>
<b class="nc">&nbsp;                    row[1] = renderArmor(entity.getArmor(loc),</b>
<b class="nc">&nbsp;                            entity.getOArmor(loc), html);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (entity.hasPatchworkArmor()) {</b>
<b class="nc">&nbsp;                    row[2] = Messages.getString(&quot;MechView.&quot;</b>
<b class="nc">&nbsp;                            + EquipmentType.getArmorTypeName(entity</b>
<b class="nc">&nbsp;                                    .getArmorType(loc)).trim());</b>
<b class="nc">&nbsp;                    if (entity.hasBARArmor(loc)) {</b>
<b class="nc">&nbsp;                        row[2] += Messages.getString(&quot;MechView.BARRating&quot;) //$NON-NLS-1$</b>
<b class="nc">&nbsp;                                + entity.getBARRating(loc);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                locTable.addRow(row);</b>
&nbsp;            }
<b class="nc">&nbsp;            retVal.add(locTable);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return retVal;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ViewElement&gt; getArmor() {
<b class="nc">&nbsp;        FighterSquadron fs = (FighterSquadron) entity;</b>
&nbsp;
<b class="nc">&nbsp;        List&lt;ViewElement&gt; retVal = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        retVal.add(new LabeledElement(Messages.getString(&quot;MechView.Armor&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                String.valueOf(fs.getTotalArmor())));</b>
&nbsp;
<b class="nc">&nbsp;        retVal.add(new LabeledElement(Messages.getString(&quot;MechView.ActiveFighters&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                String.valueOf(fs.getActiveSubEntities().orElse(Collections.emptyList()).size())));</b>
&nbsp;
<b class="nc">&nbsp;        return retVal;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ViewElement&gt; getWeapons(boolean showDetail) {
&nbsp;
<b class="nc">&nbsp;        List&lt;ViewElement&gt; retVal = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        if (isInf &amp;&amp; !isBA) {</b>
<b class="nc">&nbsp;            Infantry inf = (Infantry) entity;</b>
<b class="nc">&nbsp;            retVal.add(new LabeledElement(&quot;Primary Weapon&quot;,</b>
<b class="nc">&nbsp;                    (null != inf.getPrimaryWeapon()) ?</b>
<b class="nc">&nbsp;                            inf.getPrimaryWeapon().getDesc() : &quot;None&quot;));</b>
<b class="nc">&nbsp;            retVal.add(new LabeledElement(&quot;Secondary Weapon&quot;,</b>
<b class="nc">&nbsp;                    (null != inf.getSecondaryWeapon()) ?</b>
<b class="nc">&nbsp;                            inf.getSecondaryWeapon().getDesc()</b>
<b class="nc">&nbsp;                                    + &quot; (&quot; + inf.getSecondaryN() + &quot;)&quot; : &quot;None&quot;));</b>
<b class="nc">&nbsp;            retVal.add(new LabeledElement(&quot;Damage per trooper&quot;,</b>
<b class="nc">&nbsp;                    String.format(&quot;%3.3f&quot;, inf.getDamagePerTrooper())));</b>
<b class="nc">&nbsp;            retVal.add(new SingleLine());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (entity.getWeaponList().size() &lt; 1) {</b>
<b class="nc">&nbsp;            return retVal;</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        TableElement wpnTable = new TableElement(4);</b>
<b class="nc">&nbsp;        wpnTable.setColNames(&quot;Weapons&quot;, &quot;Loc&quot;, &quot;Heat&quot;, entity.isOmni()? &quot;Omni&quot; : &quot;&quot;);</b>
<b class="nc">&nbsp;        wpnTable.setJustification(TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_CENTER,</b>
&nbsp;                TableElement.JUSTIFIED_CENTER, TableElement.JUSTIFIED_LEFT);
<b class="nc">&nbsp;        for (Mounted mounted : entity.getWeaponList()) {</b>
<b class="nc">&nbsp;            String[] row = new String[] { mounted.getDesc(),</b>
<b class="nc">&nbsp;                    entity.getLocationAbbr(mounted.getLocation()), &quot;&quot;, &quot;&quot; };</b>
<b class="nc">&nbsp;            WeaponType wtype = (WeaponType) mounted.getType();</b>
&nbsp;
<b class="nc">&nbsp;            if (entity.isClan()</b>
<b class="nc">&nbsp;                    &amp;&amp; (mounted.getType().getTechBase() == ITechnology.TECH_BASE_IS)) {</b>
<b class="nc">&nbsp;                row[0] += Messages.getString(&quot;MechView.IS&quot;); //$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (!entity.isClan()</b>
<b class="nc">&nbsp;                    &amp;&amp; (mounted.getType().getTechBase() == ITechnology.TECH_BASE_CLAN)) {</b>
<b class="nc">&nbsp;                row[0] += Messages.getString(&quot;MechView.Clan&quot;); //$NON-NLS-1$</b>
&nbsp;            }
&nbsp;            /*
&nbsp;             * TODO: this should probably go in the ammo table somewhere if
&nbsp;             * (wtype.hasFlag(WeaponType.F_ONESHOT)) { sWeapons.append(&quot; [&quot;)
&nbsp;             * //$NON-NLS-1$ .append(mounted.getLinked().getDesc()).append(&quot;]&quot;);
&nbsp;             * //$NON-NLS-1$ }
&nbsp;             */
&nbsp;
<b class="nc">&nbsp;            if (mounted.isSplit()) {</b>
<b class="nc">&nbsp;                row[1] += &quot;/&quot; + entity.getLocationAbbr(mounted // $NON-NLS-1$</b>
<b class="nc">&nbsp;                                .getSecondLocation());</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            int heat = wtype.getHeat();</b>
<b class="nc">&nbsp;            int bWeapDamaged = 0;</b>
<b class="nc">&nbsp;            if (wtype instanceof BayWeapon) {</b>
&nbsp;                // loop through weapons in bay and add up heat
<b class="nc">&nbsp;                heat = 0;</b>
<b class="nc">&nbsp;                for (int wId : mounted.getBayWeapons()) {</b>
<b class="nc">&nbsp;                    Mounted m = entity.getEquipment(wId);</b>
<b class="nc">&nbsp;                    if (null == m) {</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    heat = heat + m.getType().getHeat();</b>
<b class="nc">&nbsp;                    if(m.isDestroyed()) {</b>
<b class="nc">&nbsp;                        bWeapDamaged++;</b>
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
&nbsp;            }
<b class="nc">&nbsp;            row[2] = String.valueOf(heat);</b>
&nbsp;            
<b class="nc">&nbsp;            if (entity.isOmni()) {</b>
<b class="nc">&nbsp;                row[3] = mounted.isOmniPodMounted()?</b>
<b class="nc">&nbsp;            		Messages.getString(&quot;MechView.Pod&quot;) : //$NON-NLS-1$</b>
<b class="nc">&nbsp;            		Messages.getString(&quot;MechView.Fixed&quot;); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            } else if(wtype instanceof BayWeapon &amp;&amp; bWeapDamaged &gt; 0 &amp;&amp; !showDetail) {</b>
<b class="nc">&nbsp;                row[3] = warningStart() + Messages.getString(&quot;MechView.WeaponDamage&quot;)</b>
<b class="nc">&nbsp;                    + &quot;)&quot; + warningEnd();</b>
&nbsp;            }
<b class="nc">&nbsp;            if (mounted.isDestroyed()) {</b>
<b class="nc">&nbsp;                if (mounted.isRepairable()) {</b>
<b class="nc">&nbsp;                    wpnTable.addRowWithBgColor(&quot;yellow&quot;, row);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    wpnTable.addRowWithBgColor(&quot;red&quot;, row);</b>
&nbsp;                }
&nbsp;            } else {
<b class="nc">&nbsp;                wpnTable.addRow(row);</b>
&nbsp;            }
&nbsp;
&nbsp;            // if this is a weapon bay, then cycle through weapons and ammo           
<b class="nc">&nbsp;            if((wtype instanceof BayWeapon) &amp;&amp; showDetail) { </b>
<b class="nc">&nbsp;                for(int wId : mounted.getBayWeapons()) { </b>
<b class="nc">&nbsp;                    Mounted m = entity.getEquipment(wId);</b>
<b class="nc">&nbsp;                    if(null == m) { </b>
<b class="nc">&nbsp;                        continue; </b>
&nbsp;                    }
&nbsp;                    
<b class="nc">&nbsp;                    row = new String[] { m.getDesc(), &quot;&quot;, &quot;&quot;, &quot;&quot; };</b>
&nbsp;                      
<b class="nc">&nbsp;                    if (entity.isClan()</b>
<b class="nc">&nbsp;                            &amp;&amp; (mounted.getType().getTechBase() == ITechnology.TECH_BASE_IS)) {</b>
<b class="nc">&nbsp;                        row[0] += Messages.getString(&quot;MechView.IS&quot;); //$NON-NLS-1$</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if (!entity.isClan()</b>
<b class="nc">&nbsp;                            &amp;&amp; (mounted.getType().getTechBase() == ITechnology.TECH_BASE_CLAN)) {</b>
<b class="nc">&nbsp;                        row[0] += Messages.getString(&quot;MechView.Clan&quot;); //$NON-NLS-1$</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if (m.isDestroyed()) {</b>
<b class="nc">&nbsp;                        if (m.isRepairable()) {</b>
<b class="nc">&nbsp;                            wpnTable.addRowWithBgColor(&quot;yellow&quot;, row);</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            wpnTable.addRowWithBgColor(&quot;red&quot;, row);</b>
&nbsp;                        }
&nbsp;                    } else {
<b class="nc">&nbsp;                        wpnTable.addRow(row);</b>
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;                for(int aId : mounted.getBayAmmo()) {</b>
<b class="nc">&nbsp;                    Mounted m = entity.getEquipment(aId);</b>
<b class="nc">&nbsp;                    if(null == m) { </b>
<b class="nc">&nbsp;                        continue; </b>
&nbsp;                    }
&nbsp;                    // Ignore ammo for one-shot launchers
<b class="nc">&nbsp;                    if ((m.getLinkedBy() != null)</b>
<b class="nc">&nbsp;                            &amp;&amp; m.getLinkedBy().isOneShot()){</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if (mounted.getLocation() != Entity.LOC_NONE) {</b>
<b class="nc">&nbsp;                        row = new String[] { m.getName(), String.valueOf(m.getBaseShotsLeft()), &quot;&quot;, &quot;&quot; };</b>
<b class="nc">&nbsp;                        if (m.isDestroyed()) {</b>
<b class="nc">&nbsp;                            wpnTable.addRowWithBgColor(&quot;red&quot;, row);</b>
<b class="nc">&nbsp;                        } else if (m.getUsableShotsLeft() &lt; 1) {</b>
<b class="nc">&nbsp;                            wpnTable.addRowWithBgColor(&quot;yellow&quot;, row);</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            wpnTable.addRow(row);</b>
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        retVal.add(wpnTable);</b>
<b class="nc">&nbsp;        return retVal;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ViewElement getAmmo() {
<b class="nc">&nbsp;        TableElement ammoTable = new TableElement(4);</b>
<b class="nc">&nbsp;        ammoTable.setColNames(&quot;Ammo&quot;, &quot;Loc&quot;, &quot;Shots&quot;, entity.isOmni()? &quot;Omni&quot; : &quot;&quot;);</b>
<b class="nc">&nbsp;        ammoTable.setJustification(TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_CENTER,</b>
&nbsp;                TableElement.JUSTIFIED_RIGHT, TableElement.JUSTIFIED_LEFT);
&nbsp;
<b class="nc">&nbsp;        for (Mounted mounted : entity.getAmmo()) {</b>
&nbsp;            // Ignore ammo for one-shot launchers
<b class="nc">&nbsp;            if ((mounted.getLinkedBy() != null)</b>
<b class="nc">&nbsp;                    &amp;&amp; mounted.getLinkedBy().isOneShot()){</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
&nbsp;            // Ignore bay ammo bins for unused munition types
<b class="nc">&nbsp;            if (mounted.getSize() == 0) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
&nbsp;            
<b class="nc">&nbsp;            if (mounted.getLocation() == Entity.LOC_NONE) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
&nbsp;            
<b class="nc">&nbsp;            String[] row = { mounted.getName(), entity.getLocationAbbr(mounted.getLocation()),</b>
<b class="nc">&nbsp;                    String.valueOf(mounted.getBaseShotsLeft()), &quot;&quot; };</b>
<b class="nc">&nbsp;            if (entity.isOmni()) {</b>
<b class="nc">&nbsp;                row[3] = mounted.isOmniPodMounted()?</b>
<b class="nc">&nbsp;                        Messages.getString(&quot;MechView.Pod&quot;) : //$NON-NLS-1$</b>
<b class="nc">&nbsp;                            Messages.getString(&quot;MechView.Fixed&quot;); //$NON-NLS-1$</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (mounted.isDestroyed()) {</b>
<b class="nc">&nbsp;                ammoTable.addRowWithBgColor(&quot;red&quot;, row);</b>
<b class="nc">&nbsp;            } else if (mounted.getUsableShotsLeft() &lt; 1) {</b>
<b class="nc">&nbsp;                ammoTable.addRowWithBgColor(&quot;yellow&quot;, row);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                ammoTable.addRow(row);</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        if (entity.getWeightClass() == EntityWeightClass.WEIGHT_SMALL_SUPPORT) {</b>
<b class="nc">&nbsp;            for (Mounted mounted : entity.getWeaponList()) {</b>
<b class="nc">&nbsp;                String[] row = {mounted.getName(),</b>
<b class="nc">&nbsp;                        entity.getLocationAbbr(mounted.getLocation()),</b>
<b class="nc">&nbsp;                        String.valueOf((int) mounted.getSize() * ((InfantryWeapon) mounted.getType()).getShots()),</b>
&nbsp;                        &quot;&quot;};
<b class="nc">&nbsp;                if (entity.isOmni()) {</b>
<b class="nc">&nbsp;                    row[3] = mounted.isOmniPodMounted() ?</b>
<b class="nc">&nbsp;                            Messages.getString(&quot;MechView.Pod&quot;) : //$NON-NLS-1$</b>
<b class="nc">&nbsp;                            Messages.getString(&quot;MechView.Fixed&quot;); //$NON-NLS-1$</b>
&nbsp;                }
<b class="nc">&nbsp;                int shotsLeft = 0;</b>
<b class="nc">&nbsp;                for (Mounted current = mounted.getLinked(); current != null; current = current.getLinked()) {</b>
<b class="nc">&nbsp;                    shotsLeft += current.getUsableShotsLeft();</b>
&nbsp;                }
<b class="nc">&nbsp;                if (mounted.isDestroyed()) {</b>
<b class="nc">&nbsp;                    ammoTable.addRowWithBgColor(&quot;red&quot;, row);</b>
<b class="nc">&nbsp;                } else if (shotsLeft &lt; 1) {</b>
<b class="nc">&nbsp;                    ammoTable.addRowWithBgColor(&quot;yellow&quot;, row);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    ammoTable.addRow(row);</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        }
<b class="nc">&nbsp;        return ammoTable;</b>
&nbsp;    }
&nbsp;    
&nbsp;    
&nbsp;
&nbsp;    private List&lt;ViewElement&gt; getBombs() {
<b class="nc">&nbsp;        List&lt;ViewElement&gt; retVal = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;        IBomber b = (IBomber) entity;</b>
<b class="nc">&nbsp;        int[] choices = b.getBombChoices();</b>
<b class="nc">&nbsp;        for (int type = 0; type &lt; BombType.B_NUM; type++) {</b>
<b class="nc">&nbsp;            if (choices[type] &gt; 0) {</b>
<b class="nc">&nbsp;                retVal.add(new SingleLine(BombType.getBombName(type) + &quot; (&quot;</b>
&nbsp;                        + choices[type] + &quot;)&quot;));
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return retVal;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ViewElement&gt; getMisc() {
<b class="nc">&nbsp;        List&lt;ViewElement&gt; retVal = new ArrayList&lt;&gt;();</b>
&nbsp;        
<b class="nc">&nbsp;        TableElement miscTable = new TableElement(3);</b>
<b class="nc">&nbsp;        miscTable.setColNames(&quot;Equipment&quot;, &quot;Loc&quot;, entity.isOmni()? &quot;Omni&quot; : &quot;&quot;);</b>
<b class="nc">&nbsp;        miscTable.setJustification(TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_CENTER,</b>
&nbsp;                TableElement.JUSTIFIED_LEFT);
<b class="nc">&nbsp;        int nEquip = 0;</b>
<b class="nc">&nbsp;        for (Mounted mounted : entity.getMisc()) {</b>
<b class="nc">&nbsp;            String name = mounted.getName();</b>
<b class="nc">&nbsp;            if ((((mounted.getLocation() == Entity.LOC_NONE)</b>
&nbsp;                        // Mechs can have zero-slot equipment in LOC_NONE that needs to be shown.
<b class="nc">&nbsp;                        &amp;&amp; (!isMech || mounted.getCriticals() &gt; 0)))</b>
<b class="nc">&nbsp;                    || name.contains(&quot;Jump Jet&quot;)</b>
<b class="nc">&nbsp;                    || (name.contains(&quot;CASE&quot;)</b>
<b class="nc">&nbsp;                        &amp;&amp; !name.contains(&quot;II&quot;)</b>
<b class="nc">&nbsp;                        &amp;&amp; entity.isClan())</b>
<b class="nc">&nbsp;                    || (name.contains(&quot;Heat Sink&quot;) </b>
<b class="nc">&nbsp;                        &amp;&amp; !name.contains(&quot;Radical&quot;))</b>
<b class="nc">&nbsp;                    || EquipmentType.isArmorType(mounted.getType())</b>
<b class="nc">&nbsp;                    || EquipmentType.isStructureType(mounted.getType())) {</b>
&nbsp;                // These items are displayed elsewhere, so skip them here.
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            nEquip++;</b>
&nbsp;            
<b class="nc">&nbsp;            String[] row = { mounted.getDesc(), entity.getLocationAbbr(mounted.getLocation()), &quot;&quot; };</b>
<b class="nc">&nbsp;            if (entity.isClan()</b>
<b class="nc">&nbsp;                    &amp;&amp; (mounted.getType().getTechBase() == ITechnology.TECH_BASE_IS)) {</b>
<b class="nc">&nbsp;                row[0] += Messages.getString(&quot;MechView.IS&quot;); //$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (!entity.isClan()</b>
<b class="nc">&nbsp;                    &amp;&amp; (mounted.getType().getTechBase() == ITechnology.TECH_BASE_CLAN)) {</b>
<b class="nc">&nbsp;                row[0] += Messages.getString(&quot;MechView.Clan&quot;); //$NON-NLS-1$</b>
&nbsp;            }
&nbsp;            
<b class="nc">&nbsp;            if (entity.isOmni()) {</b>
<b class="nc">&nbsp;                row[2] = mounted.isOmniPodMounted()?</b>
<b class="nc">&nbsp;                        Messages.getString(&quot;MechView.Pod&quot;) : //$NON-NLS-1$</b>
<b class="nc">&nbsp;                            Messages.getString(&quot;MechView.Fixed&quot;); //$NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (mounted.isDestroyed()) {</b>
<b class="nc">&nbsp;                miscTable.addRowWithBgColor(&quot;red&quot;, row);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                miscTable.addRow(row);</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        if (nEquip &gt; 0) {</b>
<b class="nc">&nbsp;            retVal.add(miscTable);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        retVal.add(new SingleLine());</b>
<b class="nc">&nbsp;        String capacity = entity.getUnusedString(html);</b>
<b class="nc">&nbsp;        if ((capacity != null) &amp;&amp; (capacity.length() &gt; 0)) {</b>
&nbsp;            // The entries have already been formatted into a list, but we&#39;re still going to
&nbsp;            // format it as a list to get the items under the label.
<b class="nc">&nbsp;            ItemList list = new ItemList(Messages.getString(&quot;MechView.CarryingCapacity&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            list.addItem(capacity);</b>
<b class="nc">&nbsp;            retVal.add(list);</b>
<b class="nc">&nbsp;            retVal.add(new SingleLine());</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        if (isSmallCraft || isJumpship) {</b>
<b class="nc">&nbsp;            Aero a = (Aero)entity;</b>
&nbsp;            
<b class="nc">&nbsp;            TableElement crewTable = new TableElement(2);</b>
<b class="nc">&nbsp;            crewTable.setColNames(Messages.getString(&quot;MechView.Crew&quot;), &quot;&quot;);</b>
<b class="nc">&nbsp;            crewTable.setJustification(TableElement.JUSTIFIED_LEFT, TableElement.JUSTIFIED_RIGHT);</b>
<b class="nc">&nbsp;            crewTable.addRow(Messages.getString(&quot;MechView.Officers&quot;), String.valueOf(a.getNOfficers())); // $NON-NLS-1$</b>
<b class="nc">&nbsp;            crewTable.addRow(Messages.getString(&quot;MechView.Enlisted&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    String.valueOf(Math.max(a.getNCrew()</b>
<b class="nc">&nbsp;                    - a.getBayPersonnel() - a.getNGunners() - a.getNOfficers(), 0)));</b>
<b class="nc">&nbsp;            crewTable.addRow(Messages.getString(&quot;MechView.Gunners&quot;), String.valueOf(a.getNGunners())); // $NON-NLS-1$</b>
<b class="nc">&nbsp;            crewTable.addRow(Messages.getString(&quot;MechView.BayPersonnel&quot;), String.valueOf(a.getBayPersonnel())); // $NON-NLS-1$</b>
<b class="nc">&nbsp;            if (a.getNPassenger() &gt; 0) {</b>
<b class="nc">&nbsp;                crewTable.addRow(Messages.getString(&quot;MechView.Passengers&quot;), String.valueOf(a.getNPassenger())); // $NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (a.getNMarines() &gt; 0) {</b>
<b class="nc">&nbsp;                crewTable.addRow(Messages.getString(&quot;MechView.Marines&quot;), String.valueOf(a.getNMarines())); // $NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            if (a.getNBattleArmor() &gt; 0) {</b>
<b class="nc">&nbsp;                crewTable.addRow(Messages.getString(&quot;MechView.BAMarines&quot;), String.valueOf(a.getNBattleArmor())); // $NON-NLS-1$</b>
&nbsp;            }
<b class="nc">&nbsp;            retVal.add(crewTable);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (isVehicle &amp;&amp; ((Tank) entity).getExtraCrewSeats() &gt; 0) {</b>
<b class="nc">&nbsp;            retVal.add(new SingleLine(Messages.getString(&quot;MechView.ExtraCrewSeats&quot;)</b>
<b class="nc">&nbsp;                    + ((Tank) entity).getExtraCrewSeats()));</b>
&nbsp;        }
<b class="nc">&nbsp;        return retVal;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ViewElement getFailed() {
<b class="nc">&nbsp;        Iterator&lt;String&gt; eFailed = entity.getFailedEquipment();</b>
<b class="nc">&nbsp;        if (eFailed.hasNext()) {</b>
<b class="nc">&nbsp;            ItemList list = new ItemList(&quot;The following equipment slots failed to load:&quot;);</b>
<b class="nc">&nbsp;            while (eFailed.hasNext()) {</b>
<b class="nc">&nbsp;                list.addItem(eFailed.next());</b>
&nbsp;            }
<b class="nc">&nbsp;            return list;</b>
&nbsp;        }
<b class="nc">&nbsp;        return new EmptyElement();</b>
&nbsp;    }
&nbsp;
&nbsp;    private static String renderArmor(int nArmor, int origArmor, boolean html) {
<b class="nc">&nbsp;        double percentRemaining = ((double) nArmor) / ((double) origArmor);</b>
<b class="nc">&nbsp;        String armor = Integer.toString(nArmor);</b>
<b class="nc">&nbsp;        if (!html) {</b>
<b class="nc">&nbsp;            if (percentRemaining &lt; 0) {</b>
<b class="nc">&nbsp;                return &quot;X&quot;;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                return armor;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (percentRemaining &lt; 0) {</b>
<b class="nc">&nbsp;            return &quot;&lt;span style=&#39;color:white;background-color:black&#39;&gt;X&lt;/span&gt;&quot;;</b>
<b class="nc">&nbsp;        } else if (percentRemaining &lt;= .25) {</b>
<b class="nc">&nbsp;            return &quot;&lt;span style=&#39;color:white;background-color:red&#39;&gt;&quot; + armor + &quot;&lt;/span&gt;&quot;;</b>
<b class="nc">&nbsp;        } else if (percentRemaining &lt;= .75) {</b>
<b class="nc">&nbsp;            return &quot;&lt;span style=&#39;color:black;background-color:yellow&#39;&gt;&quot; + armor + &quot;&lt;/span&gt;&quot;;</b>
<b class="nc">&nbsp;        } else if (percentRemaining &lt; 1.00) {</b>
<b class="nc">&nbsp;            return &quot;&lt;span style=&#39;color:black;background-color:green&#39;&gt;&quot; + armor + &quot;&lt;/span&gt;&quot;;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return &quot;&lt;span style=&#39;color:black;background-color:white&#39;&gt;&quot; + armor + &quot;&lt;/span&gt;&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Used when an element is expected but the unit has no data for it. Outputs an empty string.
&nbsp;     */
<b class="nc">&nbsp;    private static class EmptyElement implements ViewElement {</b>
&nbsp;
&nbsp;        @Override
&nbsp;        public String toPlainText() {
<b class="nc">&nbsp;            return &quot;&quot;;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public String toHTML() {
<b class="nc">&nbsp;            return &quot;&quot;;</b>
&nbsp;        }
&nbsp;        
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Basic one-line entry consisting of a label, a colon, and a value. In html the label is bold.
&nbsp;     *
&nbsp;     */
&nbsp;    private static class LabeledElement implements ViewElement {
&nbsp;        private final String label;
&nbsp;        private final String value;
&nbsp;        
<b class="nc">&nbsp;        LabeledElement(String label, String value) {</b>
<b class="nc">&nbsp;            this.label = label;</b>
<b class="nc">&nbsp;            this.value = value;</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toPlainText() {
<b class="nc">&nbsp;            return label + &quot;: &quot; + value + &quot;\n&quot;;</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toHTML() {
<b class="nc">&nbsp;            return &quot;&lt;b&gt;&quot; + label + &quot;&lt;/b&gt;: &quot; + value + &quot;&lt;br/&gt;\n&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Data laid out in a table with named columns. The columns are left-justified by default,
&nbsp;     * but justification can be set for columns individually. Plain text output requires a monospace
&nbsp;     * font to line up correctly. For HTML output the background color of an individual row can be set.
&nbsp;     *
&nbsp;     */
&nbsp;    private static class TableElement implements ViewElement {
&nbsp;        
&nbsp;        static final int JUSTIFIED_LEFT   = 0;
&nbsp;        static final int JUSTIFIED_CENTER = 1;
&nbsp;        static final int JUSTIFIED_RIGHT  = 2;
&nbsp;        
&nbsp;        private final int[] justification;
&nbsp;        private final String[] colNames;
<b class="nc">&nbsp;        private final List&lt;String[]&gt; data = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;        private final Map&lt;Integer,Integer&gt; colWidth = new HashMap&lt;&gt;();</b>
<b class="nc">&nbsp;        private final Map&lt;Integer,String&gt; bgColors = new HashMap&lt;&gt;();</b>
&nbsp;        
<b class="nc">&nbsp;        TableElement(int colCount) {</b>
<b class="nc">&nbsp;            justification = new int[colCount];</b>
<b class="nc">&nbsp;            colNames = new String[colCount];</b>
<b class="nc">&nbsp;            Arrays.fill(colNames, &quot;&quot;);</b>
&nbsp;        }
&nbsp;        
&nbsp;        void setColNames(String... colNames) {
<b class="nc">&nbsp;            Arrays.fill(this.colNames, &quot;&quot;);</b>
<b class="nc">&nbsp;            System.arraycopy(colNames, 0, this.colNames, 0,</b>
<b class="nc">&nbsp;                    Math.min(colNames.length, this.colNames.length));</b>
<b class="nc">&nbsp;            colWidth.clear();</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; colNames.length; i++) {</b>
<b class="nc">&nbsp;                colWidth.put(i, colNames[i].length());</b>
&nbsp;            }
&nbsp;        }
&nbsp;        
&nbsp;        void setJustification(int... justification) {
<b class="nc">&nbsp;            Arrays.fill(this.justification, JUSTIFIED_LEFT);</b>
<b class="nc">&nbsp;            System.arraycopy(justification, 0, this.justification, 0,</b>
<b class="nc">&nbsp;                    Math.min(justification.length, this.justification.length));</b>
&nbsp;        }
&nbsp;        
&nbsp;        void addRow(String... row) {
<b class="nc">&nbsp;            data.add(row);</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; row.length; i++) {</b>
<b class="nc">&nbsp;                colWidth.merge(i, row[i].length(), Math::max);</b>
&nbsp;            }
&nbsp;        }
&nbsp;        
&nbsp;        void addRowWithBgColor(String color, String... row) {
<b class="nc">&nbsp;            addRow(row);</b>
<b class="nc">&nbsp;            bgColors.put(data.size() - 1, color);</b>
&nbsp;        }
&nbsp;        
&nbsp;        private String leftPad(String s, int fieldSize) {
<b class="nc">&nbsp;            if (fieldSize &gt; 0) {</b>
<b class="nc">&nbsp;                return String.format(&quot;%&quot; + fieldSize + &quot;s&quot;, s);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                return &quot;&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;        
&nbsp;        private String rightPad(String s, int fieldSize) {
<b class="nc">&nbsp;            if (fieldSize &gt; 0) {</b>
<b class="nc">&nbsp;                return String.format(&quot;%-&quot; + fieldSize + &quot;s&quot;, s);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                return &quot;&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;        
&nbsp;        private String center(String s, int fieldSize) {
<b class="nc">&nbsp;            int rightPadding = Math.max(fieldSize - s.length(), 0) / 2;</b>
<b class="nc">&nbsp;            return rightPad(leftPad(s, fieldSize - rightPadding), fieldSize);</b>
&nbsp;        }
&nbsp;        
&nbsp;        private String justify(int justification, String s, int fieldSize) {
<b class="nc">&nbsp;            if (justification == JUSTIFIED_CENTER) {</b>
<b class="nc">&nbsp;                return center(s, fieldSize);</b>
<b class="nc">&nbsp;            } else if (justification == JUSTIFIED_LEFT) {</b>
<b class="nc">&nbsp;                return rightPad(s, fieldSize);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                return leftPad(s, fieldSize);</b>
&nbsp;            }
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toPlainText() {
<b class="nc">&nbsp;            final String COL_PADDING = &quot;  &quot;;</b>
<b class="nc">&nbsp;            StringBuilder sb = new StringBuilder();</b>
<b class="nc">&nbsp;            for (int col = 0; col &lt; colNames.length; col++) {</b>
<b class="nc">&nbsp;                sb.append(justify(justification[col], colNames[col], colWidth.get(col)));</b>
<b class="nc">&nbsp;                if (col &lt; colNames.length - 1) {</b>
<b class="nc">&nbsp;                    sb.append(COL_PADDING);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            sb.append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;            if (colNames.length &gt; 0) {</b>
<b class="nc">&nbsp;                int w = sb.length() - 1;</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; w; i++) {</b>
<b class="nc">&nbsp;                    sb.append(&quot;-&quot;);</b>
&nbsp;                }
<b class="nc">&nbsp;                sb.append(&quot;\n&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            for (String[] row : data) {</b>
<b class="nc">&nbsp;                for (int col = 0; col &lt; row.length; col++) {</b>
<b class="nc">&nbsp;                    sb.append(justify(justification[col], row[col], colWidth.get(col)));</b>
<b class="nc">&nbsp;                    if (col &lt; row.length - 1) {</b>
<b class="nc">&nbsp;                        sb.append(COL_PADDING);</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;                sb.append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            return sb.toString();</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toHTML() {
<b class="nc">&nbsp;            StringBuilder sb = new StringBuilder(&quot;&lt;table cellspacing=\&quot;0\&quot; cellpadding=\&quot;2\&quot; border=\&quot;0\&quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            if (colNames.length &gt; 0) {</b>
<b class="nc">&nbsp;                sb.append(&quot;&lt;tr&gt;&quot;);</b>
<b class="nc">&nbsp;                for (int col = 0; col &lt; colNames.length; col++) {</b>
<b class="nc">&nbsp;                    if (justification[col] == JUSTIFIED_RIGHT) {</b>
<b class="nc">&nbsp;                        sb.append(&quot;&lt;th align=\&quot;right\&quot;&gt;&quot;);</b>
<b class="nc">&nbsp;                    } else if (justification[col] == JUSTIFIED_CENTER) {</b>
<b class="nc">&nbsp;                        sb.append(&quot;&lt;th align=\&quot;center\&quot;&gt;&quot;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        sb.append(&quot;&lt;th align=\&quot;left\&quot;&gt;&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    sb.append(colNames[col]).append(&quot;&lt;/th&gt;&quot;);</b>
&nbsp;                }
<b class="nc">&nbsp;                sb.append(&quot;&lt;/tr&gt;\n&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            for (int r = 0; r &lt; data.size(); r++) {</b>
<b class="nc">&nbsp;                if (bgColors.containsKey(r)) {</b>
<b class="nc">&nbsp;                    sb.append(&quot;&lt;tr bgcolor=\&quot;&quot;).append(bgColors.get(r)).append(&quot;\&quot;&gt;&quot;);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    sb.append(&quot;&lt;tr&gt;&quot;);</b>
&nbsp;                }
<b class="nc">&nbsp;                final String[] row = data.get(r);</b>
<b class="nc">&nbsp;                for (int col = 0; col &lt; row.length; col++) {</b>
<b class="nc">&nbsp;                    if (justification[col] == JUSTIFIED_RIGHT) {</b>
<b class="nc">&nbsp;                        sb.append(&quot;&lt;td align=\&quot;right\&quot;&gt;&quot;);</b>
<b class="nc">&nbsp;                    } else if (justification[col] == JUSTIFIED_CENTER) {</b>
<b class="nc">&nbsp;                        sb.append(&quot;&lt;td align=\&quot;center\&quot;&gt;&quot;);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        sb.append(&quot;&lt;td align=\&quot;left\&quot;&gt;&quot;);</b>
&nbsp;                    }
<b class="nc">&nbsp;                    sb.append(row[col]).append(&quot;&lt;/td&gt;&quot;);</b>
&nbsp;                }
<b class="nc">&nbsp;                sb.append(&quot;&lt;/tr&gt;\n&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            sb.append(&quot;&lt;/table&gt;\n&quot;);</b>
<b class="nc">&nbsp;            return sb.toString();</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Displays a label (bold for html output) followed by a column of items
&nbsp;     *
&nbsp;     */
&nbsp;    private static class ItemList implements ViewElement {
&nbsp;        private final String heading;
<b class="nc">&nbsp;        private final List&lt;String&gt; data = new ArrayList&lt;&gt;();</b>
&nbsp;        
<b class="nc">&nbsp;        ItemList(String heading) {</b>
<b class="nc">&nbsp;            this.heading = heading;</b>
&nbsp;        }
&nbsp;        
&nbsp;        void addItem(String item) {
<b class="nc">&nbsp;            data.add(item);</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toPlainText() {
<b class="nc">&nbsp;            StringBuilder sb = new StringBuilder();</b>
<b class="nc">&nbsp;            if (null != heading) {</b>
<b class="nc">&nbsp;                sb.append(heading).append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; heading.length(); i++) {</b>
<b class="nc">&nbsp;                    sb.append(&quot;-&quot;);</b>
&nbsp;                }
<b class="nc">&nbsp;                sb.append(&quot;\n&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            for (String item : data) {</b>
<b class="nc">&nbsp;                sb.append(item).append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            return sb.toString();</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toHTML() {
<b class="nc">&nbsp;            StringBuilder sb = new StringBuilder();</b>
<b class="nc">&nbsp;            if (null != heading) {</b>
<b class="nc">&nbsp;                sb.append(&quot;&lt;b&gt;&quot;).append(heading).append(&quot;&lt;/b&gt;&lt;br/&gt;\n&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            for (String item : data) {</b>
<b class="nc">&nbsp;                sb.append(item).append(&quot;&lt;br/&gt;\n&quot;);</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            return sb.toString();</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Displays a single line of text. The default constructor is used to insert a new line.
&nbsp;     */
&nbsp;    private static class SingleLine implements ViewElement {
&nbsp;        
&nbsp;        private final String value;
&nbsp;        
<b class="nc">&nbsp;        SingleLine(String value) {</b>
<b class="nc">&nbsp;            this.value = value;</b>
&nbsp;        }
&nbsp;        
&nbsp;        SingleLine() {
<b class="nc">&nbsp;            this(&quot;&quot;);</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toPlainText() {
<b class="nc">&nbsp;            return value + &quot;\n&quot;;</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toHTML() {
<b class="nc">&nbsp;            return value + &quot;&lt;br/&gt;\n&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Displays a single line in bold in a larger font in html. In plain text simply displays a single line.
&nbsp;     */
&nbsp;    private static class Title implements ViewElement {
&nbsp;        
&nbsp;        private final String title;
&nbsp;        
<b class="nc">&nbsp;        Title(String title) {</b>
<b class="nc">&nbsp;            this.title = title;</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toPlainText() {
<b class="nc">&nbsp;            return title + &quot;\n&quot;;</b>
&nbsp;        }
&nbsp;        
&nbsp;        @Override
&nbsp;        public String toHTML() {
<b class="nc">&nbsp;            return &quot;&lt;font size=\&quot;+1\&quot;&gt;&lt;b&gt;&quot; + title + &quot;&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;\n&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Marks warning text; in html the text is displayed in red. In plain text it is preceded and followed
&nbsp;     * by an asterisk.
&nbsp;     * @return A String that is used to mark the beginning of a warning.
&nbsp;     */
&nbsp;    private String warningStart() {
<b class="nc">&nbsp;        if (html) {</b>
<b class="nc">&nbsp;            return &quot;&lt;font color=\&quot;red\&quot;&gt;&quot;;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return &quot;*&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Returns the end element of the warning text.
&nbsp;     * @return A String that is used to mark the end of a warning.
&nbsp;     */
&nbsp;    private String warningEnd() {
<b class="nc">&nbsp;        if (html) {</b>
<b class="nc">&nbsp;            return &quot;&lt;/font&gt;&quot;;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return &quot;*&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Marks the beginning of a section of italicized text if using html output. For plain text
&nbsp;     * returns an empty String.
&nbsp;     * @return The starting element for italicized text.
&nbsp;     */
&nbsp;    private String italicsStart() {
<b class="nc">&nbsp;        if (html) {</b>
<b class="nc">&nbsp;            return &quot;&lt;i&gt;&quot;;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return &quot;&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Marks the end of a section of italicized text.
&nbsp;     * @return The ending element for italicized text.
&nbsp;     */
&nbsp;    private String italicsEnd() {
<b class="nc">&nbsp;        if (html) {</b>
<b class="nc">&nbsp;            return &quot;&lt;/i&gt;&quot;;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return &quot;&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
