


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > Crew</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.common</a>
</div>

<h1>Coverage Summary for Class: Crew (megamek.common)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Crew</td>
<td class="coverageStat">
  <span class="percent">
    9%
  </span>
  <span class="absValue">
    (13/144)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    13.9%
  </span>
  <span class="absValue">
    (73/527)
  </span>
</td>
</tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$0a6Zy4uL</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$0MnfEAMu</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$1oYrH6IH</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$26om4rGw</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$2NYGIhIA</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$30VKXZBb</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$3TS8JGBO</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$459XoBzn</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$4GuqVJ6a</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$4k7ClUSG</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$7CLpWpMy</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$8Fjh2KaZ</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$9aebSFTF</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$9H38D8hr</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$9yI5uNZx</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$ajHhGae9</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$AoxdNIaH</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$ARrFtAGz</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$BbxP4h4V</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$BpyYdC5e</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$bQZmmGcd</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$cEOaYpEI</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$CkJx4LSd</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$d5jjpbMm</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$DHPAv2I6</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$DTnbRD9D</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$DXwOsmHw</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$DYiZLvy9</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$ELSv7Htl</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$EnOFupAR</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$etl3z5Fa</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$EXkTgoTu</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$FEe3oe3l</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$FkFZ6klY</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$G1OBgE5Y</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$gaInTeuy</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$GcR9MVdK</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$GvmZdats</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$gvNwn3sd</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$gyo23u5C</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$H3peJdb7</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Ha3hjVmX</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$i5wJf1JN</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$iLYHruUe</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$iuz8wJXa</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$iyEMqCuU</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$j3HzXP5D</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$J40fhVSA</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$jAfsf8sI</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$jhdrDCik</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$jKsjNqqV</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$JRd8ozG3</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$JYuFUwG1</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$KGAdosM1</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$kigRBh55</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$KJ3Bn5NM</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Kqlqe0LI</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$kzbz3tOW</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$l5LWpXC1</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$mLp3lS9Z</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$mmir6w5s</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$MVelHRO4</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$N3owvwma</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$nCZV44yl</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$NiaWOK3u</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$nnfAEee5</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$NWa6XV6G</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$oo6i1hkg</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$OVmmsmJt</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$P6rns2Ff</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$p8jtFcVS</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$PDHmQ4E2</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$pXmem5uX</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$q0MNbcZP</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Q4qyu1Wq</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$q7ulfsbm</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Q9ISKXyb</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$qdvi1uZM</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$QFXfZro9</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$QHCRG7I4</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$qOilZREV</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$QSojJYZo</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$qtJ4adXo</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$QUGU8MzW</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$r3E6HocL</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$RgV2lokZ</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$RhlrwYcK</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$RISp6A9a</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Rlx2LBwJ</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$RnCwWetA</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$ROzqjp7h</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$S8Liz39M</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$safil5Uc</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$sCiM2vir</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$seP1mjEU</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$ShsU4h89</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$sj1TUfSQ</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$SMiwoOOI</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$SNbdwZvY</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$SUxlTCEo</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$sxCYeRNC</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$TAyVQ2Ft</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$TDnIMEqw</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$TSa9Gpvm</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$u5uEZ0ro</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$uRpEoUwF</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$V9l0mhWt</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$VarB0PyS</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Vg7qG67c</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$wHg9YaUc</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$wJrgMTRL</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$WprAiuSM</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$wuYaGLml</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$wvx6JZbk</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$wwbsnAoS</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$xAjbtJwG</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$xfm1ZfLP</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$xgztoueI</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$xKNZfDuX</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$xKo4RtuL</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Y8vjT78z</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$yJilIRQW</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$YkbVQp0K</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$yMHO3oaC</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$ysXfbBL3</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$yvt4GHBX</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Z52Lv5ys</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$Zjux6cRZ</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$zNLHuDw2</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$zyRghckx</td>
  </tr>
  <tr>
    <td class="name">Crew$MockitoMock$874361685$auxiliary$zzhmzA11</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    9%
  </span>
  <span class="absValue">
    (13/144)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    13.9%
  </span>
  <span class="absValue">
    (73/527)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp;* MegaMek -
&nbsp;* Copyright (C) 2000, 2001, 2002, 2003, 2004 Ben Mazur (bmazur@sev.org)
&nbsp;* Copyright (C) 2018 - The MegaMek Team. All Rights Reserved.
&nbsp;*
&nbsp;* This program is free software; you can redistribute it and/or modify it under
&nbsp;* the terms of the GNU General Public License as published by the Free Software
&nbsp;* Foundation; either version 2 of the License, or (at your option) any later
&nbsp;* version.
&nbsp;*
&nbsp;* This program is distributed in the hope that it will be useful, but WITHOUT
&nbsp;* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
&nbsp;* FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
&nbsp;* details.
&nbsp;*/
&nbsp;package megamek.common;
&nbsp;
&nbsp;import java.io.Serializable;
&nbsp;import java.util.Arrays;
&nbsp;import java.util.Enumeration;
&nbsp;import java.util.HashMap;
&nbsp;import java.util.Map;
&nbsp;import java.util.UUID;
&nbsp;import java.util.Vector;
&nbsp;
&nbsp;import megamek.client.generator.RandomGenderGenerator;
&nbsp;import megamek.common.enums.Gender;
&nbsp;import megamek.common.icons.AbstractIcon;
&nbsp;import megamek.common.icons.Portrait;
&nbsp;import megamek.common.options.IOption;
&nbsp;import megamek.common.options.IOptionGroup;
&nbsp;import megamek.common.options.OptionsConstants;
&nbsp;import megamek.common.options.PilotOptions;
&nbsp;import megamek.common.util.CrewSkillSummaryUtil;
&nbsp;
&nbsp;/**
&nbsp; *  Health status, skills, and miscellanea for an Entity crew.
&nbsp; *
&nbsp; *  While vehicle and vessel crews are treated as a single collective, with one set of skills,
&nbsp; *  some multi-crew cockpits (Tripod, QuadVee, dual, command console) require tracking the health
&nbsp; *  and skills of each crew member independently. These are referred to as &quot;slots&quot; and the slot
&nbsp; *  number corresponds to an array index for the appropriate field.
&nbsp; */
&nbsp;public class Crew implements Serializable {
&nbsp;    private static final long serialVersionUID = -141169182388269619L;
&nbsp;
&nbsp;    private Map&lt;Integer, Map&lt;String, String&gt;&gt; extraData;
&nbsp;
&nbsp;    private final CrewType crewType;
&nbsp;    private int size;
&nbsp;    private int currentSize;
&nbsp;
&nbsp;    private final String[] name;
&nbsp;    private final Gender[] gender;
&nbsp;
&nbsp;    private final int[] gunnery;
&nbsp;    private final int[] piloting;
&nbsp;    private final int[] hits; // hits taken
&nbsp;
&nbsp;    private final String[] nickname;
&nbsp;
&nbsp;    private final String[] externalId;
&nbsp;
&nbsp;    private final boolean[] unconscious;
&nbsp;    private final boolean[] dead;
&nbsp;    //Allow for the possibility that the unit is fielded with less than full crew.
&nbsp;    private final boolean[] missing;
&nbsp;
&nbsp;    //The following only apply to the entire crew.
&nbsp;    private boolean doomed; // scheduled to die at end of phase
&nbsp;    private boolean ejected;
&nbsp;
&nbsp;    // StratOps fatigue points
&nbsp;    private int fatigue;
&nbsp;    //also need to track turns for fatigue by pilot because some may have later deployment
&nbsp;    private int fatigueCount;
&nbsp;
&nbsp;    /**
&nbsp;     * Additional RPG Skills **
&nbsp;     */
&nbsp;    // MW3e uses 3 different gunnery skills
&nbsp;    private final int[] gunneryL;
&nbsp;    private final int[] gunneryM;
&nbsp;    private final int[] gunneryB;
&nbsp;
&nbsp;    // Separate artillery skill
&nbsp;    private final int[] artillery;
&nbsp;
&nbsp;    // init bonuses
&nbsp;    // bonus for individual initiative
&nbsp;    private int initBonus;
&nbsp;    // commander bonus
&nbsp;    private int commandBonus;
&nbsp;
&nbsp;    // a toughness bonus that is applied to all KO checks
&nbsp;    private final int[] toughness;
&nbsp;
&nbsp;    private int pilotPos;
&nbsp;    private int gunnerPos;
&nbsp;
&nbsp;    //Designate the slot index of the crew member that will fill in if the pilot or gunner is incapacitated.
&nbsp;    //This is only relevant for superheavy tripods, as other types have at most a single other option.
&nbsp;    private int backupPilot;
&nbsp;    private int backupGunner;
&nbsp;
&nbsp;    //For cockpit command console, we need to track which crew members have acted as the pilot, making them
&nbsp;    //ineligible to provide command bonus the next round.
&nbsp;    private final boolean[] actedThisTurn;
&nbsp;    //The crew slots in a command console can swap roles in the end phase of any turn.
&nbsp;    private boolean swapConsoleRoles;
&nbsp;
&nbsp;    /**
&nbsp;     * End RPG Skills **
&nbsp;     */
&nbsp;
&nbsp;    // these are only used on the server:
&nbsp;    private final boolean[] koThisRound; // did I go KO this game round?
&nbsp;
&nbsp;    //TODO: Allow individual crew to have SPAs, which involves determining which work for individuals
&nbsp;    //and which work for the entire unit.
<b class="fc">&nbsp;    private PilotOptions options = new PilotOptions();</b>
&nbsp;
&nbsp;    // pathway to pilot portrait
&nbsp;    private final String[] portraitCategory;
&nbsp;    private final String[] portraitFileName;
&nbsp;
&nbsp;    //SPA RangeMaster range bands
&nbsp;    public static final String RANGEMASTER_NONE = &quot;None&quot;;
&nbsp;    public static final String RANGEMASTER_MEDIUM = &quot;Medium&quot;;
&nbsp;    public static final String RANGEMASTER_LONG = &quot;Long&quot;;
&nbsp;    public static final String RANGEMASTER_EXTREME = &quot;Extreme&quot;;
&nbsp;
&nbsp;    // SPA Human TRO entity types
&nbsp;    public static final String HUMANTRO_NONE = &quot;None&quot;;
&nbsp;    public static final String HUMANTRO_MECH = &quot;Mek&quot;;
&nbsp;    public static final String HUMANTRO_AERO = &quot;Aero&quot;;
&nbsp;    public static final String HUMANTRO_VEE = &quot;Vee&quot;;
&nbsp;    public static final String HUMANTRO_BA = &quot;BA&quot;;
&nbsp;
&nbsp;    public static final String SPECIAL_NONE = &quot;None&quot;;
&nbsp;    public static final String SPECIAL_ENERGY = &quot;Energy&quot;;
&nbsp;    public static final String SPECIAL_BALLISTIC = &quot;Ballistic&quot;;
&nbsp;    public static final String SPECIAL_MISSILE = &quot;Missile&quot;;
&nbsp;
<b class="fc">&nbsp;    private static double[][] bvMod = new double[][]{</b>
&nbsp;            {2.42, 2.31, 2.21, 2.10, 1.93, 1.75, 1.68, 1.59, 1.50},
&nbsp;            {2.21, 2.11, 2.02, 1.92, 1.76, 1.60, 1.54, 1.46, 1.38},
&nbsp;            {1.93, 1.85, 1.76, 1.68, 1.54, 1.40, 1.35, 1.28, 1.21},
&nbsp;            {1.66, 1.58, 1.51, 1.44, 1.32, 1.20, 1.16, 1.10, 1.04},
&nbsp;            {1.38, 1.32, 1.26, 1.20, 1.10, 1.00, 0.95, 0.90, 0.85},
&nbsp;            {1.31, 1.19, 1.13, 1.08, 0.99, 0.90, 0.86, 0.81, 0.77},
&nbsp;            {1.24, 1.12, 1.07, 1.02, 0.94, 0.85, 0.81, 0.77, 0.72},
&nbsp;            {1.17, 1.06, 1.01, 0.96, 0.88, 0.80, 0.76, 0.72, 0.68},
&nbsp;            {1.10, 0.99, 0.95, 0.90, 0.83, 0.75, 0.71, 0.68, 0.64},
&nbsp;    };
<b class="fc">&nbsp;    private static double[][] alternateBvMod = new double[][]{</b>
&nbsp;            {2.70, 2.52, 2.34, 2.16, 1.98, 1.80, 1.75, 1.67, 1.59},
&nbsp;            {2.40, 2.24, 2.08, 1.98, 1.76, 1.60, 1.58, 1.51, 1.44},
&nbsp;            {2.10, 1.96, 1.82, 1.68, 1.54, 1.40, 1.33, 1.31, 1.25},
&nbsp;            {1.80, 1.68, 1.56, 1.44, 1.32, 1.20, 1.14, 1.08, 1.06},
&nbsp;            {1.50, 1.40, 1.30, 1.20, 1.10, 1.00, 0.95, 0.90, 0.85},
&nbsp;            {1.50, 1.35, 1.26, 1.17, 1.04, 0.90, 0.86, 0.81, 0.77},
&nbsp;            {1.43, 1.33, 1.19, 1.11, 0.98, 0.85, 0.81, 0.77, 0.72},
&nbsp;            {1.36, 1.26, 1.16, 1.04, 0.92, 0.80, 0.76, 0.72, 0.68},
&nbsp;            {1.28, 1.19, 1.10, 1.01, 0.86, 0.75, 0.71, 0.68, 0.64},
&nbsp;    };
&nbsp;
&nbsp;    //region extraData inner map keys
&nbsp;    public static final String MAP_GIVEN_NAME = &quot;givenName&quot;;
&nbsp;    public static final String MAP_SURNAME = &quot;surname&quot;;
&nbsp;    public static final String MAP_BLOODNAME = &quot;bloodname&quot;;
&nbsp;    public static final String MAP_PHENOTYPE = &quot;phenotype&quot;;
&nbsp;    //endregion extraData inner map keys
&nbsp;    /**
&nbsp;     * The number of hits that a pilot can take before he dies.
&nbsp;     */
&nbsp;    static public final int DEATH = 6;
&nbsp;
&nbsp;    /**
&nbsp;     * Defines the maximum value a Crew can have in any skill
&nbsp;     */
&nbsp;    static public final int MAX_SKILL = 8;
&nbsp;
&nbsp;    /**
&nbsp;     * Creates a nameless P5/G4 crew of the given size.
&nbsp;     *
&nbsp;     * @param crewType the crew type to use.
&nbsp;     */
&nbsp;    public Crew(CrewType crewType) {
<b class="fc">&nbsp;        this(crewType, &quot;Unnamed&quot;, crewType.getCrewSlots(), 4, 5, Gender.FEMALE, null);</b>
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @param name     the name of the crew or commander.
&nbsp;     * @param size     the crew size.
&nbsp;     * @param gunnery  the crew&#39;s Gunnery skill.
&nbsp;     * @param piloting the crew&#39;s Piloting or Driving skill.
&nbsp;     * @deprecated by multi-crew cockpit support. Replaced by {@link #Crew(CrewType, String, int, int, int, Gender, Map)}.
&nbsp;     *
&nbsp;     * Creates a basic crew for a self-piloted unit. Using this constructor for a naval vessel will
&nbsp;     * result in a secondary target modifier for additional targets past the first.
&nbsp;     */
&nbsp;    @Deprecated
&nbsp;    public Crew(String name, int size, int gunnery, int piloting) {
<b class="nc">&nbsp;        this(CrewType.SINGLE, name, size, gunnery, gunnery, gunnery, piloting, null);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @param crewType the type of crew
&nbsp;     * @param name     the name of the crew or commander.
&nbsp;     * @param size     the crew size.
&nbsp;     * @param gunnery  the crew&#39;s Gunnery skill.
&nbsp;     * @param piloting the crew&#39;s Piloting or Driving skill.
&nbsp;     * @deprecated by gender support. Replaced by {@link #Crew(CrewType, String, int, int, int, Gender, Map)}.
&nbsp;     */
&nbsp;    @Deprecated //18-Feb-2020 as part of the addition of gender to MegaMek
&nbsp;    public Crew(CrewType crewType, String name, int size, int gunnery, int piloting) {
<b class="nc">&nbsp;        this(crewType, name, size, gunnery, gunnery, gunnery, piloting, null);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @param crewType the type of crew.
&nbsp;     * @param name     the name of the crew or commander.
&nbsp;     * @param size     the crew size.
&nbsp;     * @param gunneryL the crew&#39;s &quot;laser&quot; Gunnery skill.
&nbsp;     * @param gunneryM the crew&#39;s &quot;missile&quot; Gunnery skill.
&nbsp;     * @param gunneryB the crew&#39;s &quot;ballistic&quot; Gunnery skill.
&nbsp;     * @param piloting the crew&#39;s Piloting or Driving skill.
&nbsp;     * @deprecated by gender support. Replaced by {@link #Crew(CrewType, String, int, int, int, int, int, Gender, Map)}.
&nbsp;     */
&nbsp;    @Deprecated //18-Feb-2020 as part of the addition of gender to MegaMek
&nbsp;    public Crew(CrewType crewType, String name, int size, int gunneryL, int gunneryM, int gunneryB,
&nbsp;                int piloting) {
<b class="nc">&nbsp;        this(crewType, name, size, gunneryL, gunneryM, gunneryB, piloting, null);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @param crewType  the type of crew.
&nbsp;     * @param name      the name of the crew or commander.
&nbsp;     * @param size      the crew size.
&nbsp;     * @param gunneryL  the crew&#39;s &quot;laser&quot; Gunnery skill.
&nbsp;     * @param gunneryM  the crew&#39;s &quot;missile&quot; Gunnery skill.
&nbsp;     * @param gunneryB  the crew&#39;s &quot;ballistic&quot; Gunnery skill.
&nbsp;     * @param piloting  the crew&#39;s Piloting or Driving skill.
&nbsp;     * @param extraData any extra data passed to be stored with this Crew.
&nbsp;     * @deprecated by gender support. Replaced by {@link #Crew(CrewType, String, int, int, int, int, int, Gender, Map)}.
&nbsp;     */
&nbsp;    @Deprecated //18-Feb-2020 as part of the addition of gender to MegaMek
&nbsp;    public Crew(CrewType crewType, String name, int size, int gunneryL, int gunneryM, int gunneryB,
&nbsp;                int piloting, Map&lt;Integer, Map&lt;String, String&gt;&gt; extraData) {
<b class="nc">&nbsp;        this(crewType, name, size, gunneryL, gunneryM, gunneryB, piloting, RandomGenderGenerator.generate(), extraData);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @param crewType  the type of crew
&nbsp;     * @param name      the name of the crew or commander.
&nbsp;     * @param size      the crew size.
&nbsp;     * @param gunnery   the crew&#39;s Gunnery skill.
&nbsp;     * @param piloting  the crew&#39;s Piloting or Driving skill.
&nbsp;     * @param gender    the gender of the crew or commander
&nbsp;     * @param extraData any extra data passed to be stored with this Crew.
&nbsp;     */
&nbsp;    public Crew(CrewType crewType, String name, int size, int gunnery, int piloting, Gender gender,
&nbsp;                Map&lt;Integer, Map&lt;String, String&gt;&gt; extraData) {
<b class="fc">&nbsp;        this(crewType, name, size, gunnery, gunnery, gunnery, piloting, gender, extraData);</b>
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @param crewType  the type of crew.
&nbsp;     * @param name      the name of the crew or commander.
&nbsp;     * @param size      the crew size.
&nbsp;     * @param gunneryL  the crew&#39;s &quot;laser&quot; Gunnery skill.
&nbsp;     * @param gunneryM  the crew&#39;s &quot;missile&quot; Gunnery skill.
&nbsp;     * @param gunneryB  the crew&#39;s &quot;ballistic&quot; Gunnery skill.
&nbsp;     * @param piloting  the crew&#39;s Piloting or Driving skill.
&nbsp;     * @param gender    the gender of the crew or commander
&nbsp;     * @param extraData any extra data passed to be stored with this Crew.
&nbsp;     */
&nbsp;    public Crew(CrewType crewType, String name, int size, int gunneryL, int gunneryM, int gunneryB,
<b class="fc">&nbsp;                int piloting, Gender gender, Map&lt;Integer, Map&lt;String, String&gt;&gt; extraData) {</b>
<b class="fc">&nbsp;        this.crewType = crewType;</b>
<b class="fc">&nbsp;        this.size = Math.max(size, crewType.getCrewSlots());</b>
<b class="fc">&nbsp;        this.currentSize = size;</b>
&nbsp;
<b class="fc">&nbsp;        this.extraData = extraData;</b>
&nbsp;
<b class="fc">&nbsp;        int slots = crewType.getCrewSlots();</b>
<b class="fc">&nbsp;        this.name = new String[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.name, name);</b>
<b class="fc">&nbsp;        this.nickname = new String[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.nickname, &quot;&quot;);</b>
<b class="fc">&nbsp;        this.gender = new Gender[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.gender, Gender.RANDOMIZE);</b>
<b class="fc">&nbsp;        this.gender[0] = gender;</b>
&nbsp;
<b class="fc">&nbsp;        int avGunnery = (int) Math.round((gunneryL + gunneryM + gunneryB) / 3.0);</b>
<b class="fc">&nbsp;        this.gunnery = new int[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.gunnery, avGunnery);</b>
<b class="fc">&nbsp;        this.gunneryL = new int[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.gunneryL, gunneryL);</b>
<b class="fc">&nbsp;        this.gunneryB = new int[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.gunneryB, gunneryB);</b>
<b class="fc">&nbsp;        this.gunneryM = new int[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.gunneryM, gunneryM);</b>
<b class="fc">&nbsp;        this.artillery = new int[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.artillery, avGunnery);</b>
<b class="fc">&nbsp;        this.piloting = new int[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(this.piloting, piloting);</b>
&nbsp;
<b class="fc">&nbsp;        initBonus = 0;</b>
<b class="fc">&nbsp;        commandBonus = 0;</b>
<b class="fc">&nbsp;        hits = new int[slots];</b>
<b class="fc">&nbsp;        unconscious = new boolean[slots];</b>
<b class="fc">&nbsp;        dead = new boolean[slots];</b>
<b class="fc">&nbsp;        missing = new boolean[slots];</b>
<b class="fc">&nbsp;        koThisRound = new boolean[slots];</b>
<b class="fc">&nbsp;        fatigue = 0;</b>
<b class="fc">&nbsp;        toughness = new int[slots];</b>
<b class="fc">&nbsp;        portraitCategory = new String[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(portraitCategory, AbstractIcon.ROOT_CATEGORY);</b>
<b class="fc">&nbsp;        portraitFileName = new String[slots];</b>
<b class="fc">&nbsp;        Arrays.fill(portraitFileName, AbstractIcon.DEFAULT_ICON_FILENAME);</b>
&nbsp;
<b class="fc">&nbsp;        options.initialize();</b>
&nbsp;
<b class="fc">&nbsp;        pilotPos = crewType.getPilotPos();</b>
<b class="fc">&nbsp;        gunnerPos = crewType.getGunnerPos();</b>
&nbsp;
&nbsp;        //For 2-slot crews, this will designate the other crew member as backup. For superheavy tripods,
&nbsp;        //this will designate the pilot and gunner as backups for each other.
<b class="fc">&nbsp;        if (getSlotCount() &gt; 1) {</b>
<b class="nc">&nbsp;            backupPilot = 1 - pilotPos;</b>
<b class="nc">&nbsp;            backupGunner = 1 - gunnerPos;</b>
&nbsp;        }
<b class="fc">&nbsp;        actedThisTurn = new boolean[slots];</b>
<b class="fc">&nbsp;        resetActedFlag();</b>
&nbsp;
&nbsp;        //set a random UUID for external ID, this will help us sort enemy salvage and prisoners in MHQ
&nbsp;        //and should have no effect on MM (but need to make sure it doesn&#39;t screw up MekWars)
<b class="fc">&nbsp;        externalId = new String[slots];</b>
<b class="fc">&nbsp;        for (int i = 0; i &lt; slots; i++) {</b>
<b class="fc">&nbsp;            externalId[i] = UUID.randomUUID().toString();</b>
&nbsp;        }
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    public String getName() {
<b class="nc">&nbsp;        return name[0];</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getName(int pos) {
<b class="nc">&nbsp;        return name[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getNickname() {
<b class="nc">&nbsp;        return nickname[0];</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getNickname(int pos) {
<b class="nc">&nbsp;        return nickname[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public Gender getGender() {
<b class="nc">&nbsp;        return gender[0];</b>
&nbsp;    }
&nbsp;
&nbsp;    public Gender getGender(int pos) {
&nbsp;        // The randomize return value is used in MekHQ to create new personnel following a battle,
&nbsp;        // and should not be changed without ensuring it doesn&#39;t break on that side
<b class="nc">&nbsp;        if (pos &lt; gender.length) {</b>
<b class="nc">&nbsp;            return gender[pos];</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return Gender.RANDOMIZE;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @param pos The slot index for multi-crewed cockpits
&nbsp;     * @return For multi-slot crews, the crew member&#39;s name followed by the role. For-slot crews, the
&nbsp;     * crew name only.
&nbsp;     */
&nbsp;    public String getNameAndRole(int pos) {
<b class="nc">&nbsp;        if (getSlotCount() &lt; 2) {</b>
<b class="nc">&nbsp;            return getName(pos);</b>
&nbsp;        }
<b class="nc">&nbsp;        return getName(pos) + &quot; (&quot; + crewType.getRoleName(pos) + &quot;)&quot;;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * The size of this crew.
&nbsp;     *
&nbsp;     * @return the number of crew members.
&nbsp;     */
&nbsp;    public int getSize() {
<b class="fc">&nbsp;        return size;</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * The currentsize of this crew.
&nbsp;     *
&nbsp;     * @return the current number of crew members.
&nbsp;     */
&nbsp;    public int getCurrentSize() {
<b class="nc">&nbsp;        return currentSize;</b>
&nbsp;    }
&nbsp;
&nbsp;    public CrewType getCrewType() {
<b class="nc">&nbsp;        return crewType;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @return The number of crew members that are tracked individually
&nbsp;     */
&nbsp;    public int getSlotCount() {
<b class="fc">&nbsp;        return crewType.getCrewSlots();</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunnery() {
<b class="nc">&nbsp;        return gunnery[gunnerPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunnery(int pos) {
<b class="nc">&nbsp;        return gunnery[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunneryL() {
<b class="nc">&nbsp;        return gunneryL[gunnerPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunneryL(int pos) {
<b class="nc">&nbsp;        return gunneryL[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunneryM() {
<b class="nc">&nbsp;        return gunneryM[gunnerPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunneryM(int pos) {
<b class="nc">&nbsp;        return gunneryM[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunneryB() {
<b class="nc">&nbsp;        return gunneryB[gunnerPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getGunneryB(int pos) {
<b class="nc">&nbsp;        return gunneryB[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getArtillery() {
<b class="nc">&nbsp;        return artillery[gunnerPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getArtillery(int pos) {
<b class="nc">&nbsp;        return artillery[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getPiloting() {
<b class="nc">&nbsp;        return piloting[pilotPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getPiloting(int pos) {
<b class="nc">&nbsp;        return piloting[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * LAMs use a different skill in AirMech mode depending on whether they are grounded or airborne.
&nbsp;     */
&nbsp;    public int getPiloting(EntityMovementType moveType) {
<b class="nc">&nbsp;        return piloting[pilotPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @return a String showing the overall skills in the format gunnery/piloting
&nbsp;     */
&nbsp;    public String getSkillsAsString(boolean rpgSkills) {
<b class="nc">&nbsp;        return getSkillsAsString(true, rpgSkills);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @param showPiloting if false, only the gunnery skill is shown (used for protomechs; may be ignored
&nbsp;     *                     for other unit types)
&nbsp;     * @return a String showing the overall skills in the format gunnery/piloting
&nbsp;     */
&nbsp;    public String getSkillsAsString(boolean showPiloting, boolean rpgSkills) {
<b class="nc">&nbsp;        if (showPiloting) {</b>
<b class="nc">&nbsp;            return CrewSkillSummaryUtil.getPilotSkillSummary(</b>
<b class="nc">&nbsp;                    getGunnery(),</b>
<b class="nc">&nbsp;                    getGunneryL(),</b>
<b class="nc">&nbsp;                    getGunneryM(),</b>
<b class="nc">&nbsp;                    getGunneryB(),</b>
<b class="nc">&nbsp;                    getPiloting(),</b>
&nbsp;                    rpgSkills);
&nbsp;        } else {
<b class="nc">&nbsp;            return CrewSkillSummaryUtil.getGunnerySkillSummary(</b>
<b class="nc">&nbsp;                    getGunnery(),</b>
<b class="nc">&nbsp;                    getGunneryL(),</b>
<b class="nc">&nbsp;                    getGunneryM(),</b>
<b class="nc">&nbsp;                    getGunneryB(),</b>
&nbsp;                    rpgSkills);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @return a String showing the skills for a particular slot in the format gunnery/piloting
&nbsp;     */
&nbsp;    public String getSkillsAsString(int pos, boolean rpgSkills) {
<b class="nc">&nbsp;        return getSkillsAsString(pos, true, rpgSkills);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @param showPiloting if false, only the gunnery skill is shown (used for protomechs; may be ignored
&nbsp;     *                     for other unit types)
&nbsp;     * @return a String showing the skills for a particular slot in the format gunnery/piloting
&nbsp;     */
&nbsp;    public String getSkillsAsString(int pos, boolean showPiloting, boolean rpgSkills) {
<b class="nc">&nbsp;        if (showPiloting) {</b>
<b class="nc">&nbsp;            return CrewSkillSummaryUtil.getPilotSkillSummary(</b>
<b class="nc">&nbsp;                    getGunnery(pos),</b>
<b class="nc">&nbsp;                    getGunneryL(pos),</b>
<b class="nc">&nbsp;                    getGunneryM(pos),</b>
<b class="nc">&nbsp;                    getGunneryB(pos),</b>
<b class="nc">&nbsp;                    getPiloting(pos),</b>
&nbsp;                    rpgSkills);
&nbsp;        } else {
<b class="nc">&nbsp;            return CrewSkillSummaryUtil.getGunnerySkillSummary(</b>
<b class="nc">&nbsp;                    getGunnery(pos),</b>
<b class="nc">&nbsp;                    getGunneryL(pos),</b>
<b class="nc">&nbsp;                    getGunneryM(pos),</b>
<b class="nc">&nbsp;                    getGunneryB(pos),</b>
&nbsp;                    rpgSkills);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Used to determine whether the death threshold has been passed. As the crew is not dead until
&nbsp;     * each crew member slot is dead, we return the lowest value.
&nbsp;     *
&nbsp;     * @return The damage level of the least damaged crew member.
&nbsp;     */
&nbsp;    public int getHits() {
<b class="nc">&nbsp;        return Arrays.stream(hits).min().orElse(0);</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Uses the table on TO p206 to calculate the number of crew hits based on percentage
&nbsp;     * of total casualties. Used for ejection, boarding actions and such
&nbsp;     * @return 
&nbsp;     */
&nbsp;    public int calculateHits() {
<b class="nc">&nbsp;        if (currentSize == 0) {</b>
&nbsp;            //100% casualties
<b class="nc">&nbsp;            return 6;</b>
&nbsp;        }
<b class="nc">&nbsp;        double percentage = 1 - ((double) currentSize / (double) size);</b>
<b class="nc">&nbsp;        int hits = 0;</b>
<b class="nc">&nbsp;        if (percentage &gt; 0.05 &amp;&amp; percentage &lt;= 0.20) {</b>
<b class="nc">&nbsp;            hits = 1;</b>
<b class="nc">&nbsp;        } else if (percentage &gt; 0.20 &amp;&amp; percentage &lt;= 0.35) {</b>
<b class="nc">&nbsp;            hits = 2;</b>
<b class="nc">&nbsp;        } else if (percentage &gt; 0.35 &amp;&amp; percentage &lt;= 0.50) {</b>
<b class="nc">&nbsp;            hits = 3;</b>
<b class="nc">&nbsp;        } else if (percentage &gt; 0.50 &amp;&amp; percentage &lt;= 0.65) {</b>
<b class="nc">&nbsp;            hits = 4;</b>
<b class="nc">&nbsp;        } else if (percentage &gt; 0.65 &amp;&amp; percentage &lt;= 0.80) {</b>
<b class="nc">&nbsp;            hits = 5;</b>
<b class="nc">&nbsp;        } else if (percentage &gt; 0.80) {</b>
<b class="nc">&nbsp;            hits = 6;</b>
&nbsp;        }
<b class="nc">&nbsp;        return hits;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getHits(int pos) {
<b class="nc">&nbsp;        return hits[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getInitBonus() {
<b class="nc">&nbsp;        return initBonus;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getCommandBonus() {
<b class="nc">&nbsp;        return commandBonus;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setName(String name, int pos) {
<b class="nc">&nbsp;        this.name[pos] = name;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setNickname(String nickname, int pos) {
<b class="nc">&nbsp;        this.nickname[pos] = nickname;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setGender(Gender gender, int pos) {
<b class="nc">&nbsp;        this.gender[pos] = gender;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Accessor method to set the crew size.
&nbsp;     *
&nbsp;     * @param newSize The new size of this crew.
&nbsp;     */
&nbsp;    public void setSize(int newSize) {
<b class="fc">&nbsp;        size = newSize;</b>
<b class="fc">&nbsp;    }</b>
&nbsp;    
&nbsp;    /**
&nbsp;     * Accessor method to set the current crew size.
&nbsp;     *
&nbsp;     * @param newSize The new size of this crew.
&nbsp;     */
&nbsp;    public void setCurrentSize(int newSize) {
<b class="fc">&nbsp;        currentSize = newSize;</b>
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setGunnery(int gunnery, int pos) {
<b class="nc">&nbsp;        this.gunnery[pos] = gunnery;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setGunneryL(int gunnery, int pos) {
<b class="nc">&nbsp;        gunneryL[pos] = gunnery;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setGunneryM(int gunnery, int pos) {
<b class="nc">&nbsp;        gunneryM[pos] = gunnery;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setGunneryB(int gunnery, int pos) {
<b class="nc">&nbsp;        gunneryB[pos] = gunnery;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setArtillery(int artillery, int pos) {
<b class="nc">&nbsp;        this.artillery[pos] = artillery;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setPiloting(int piloting, int pos) {
<b class="nc">&nbsp;        this.piloting[pos] = piloting;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setHits(int hits, int pos) {
&nbsp;        // Ejected pilots stop taking hits.
<b class="nc">&nbsp;        if (!ejected &amp;&amp; !missing[pos]) {</b>
<b class="nc">&nbsp;            this.hits[pos] = hits;</b>
<b class="nc">&nbsp;            if (hits &gt;= DEATH) {</b>
<b class="nc">&nbsp;                setDead(true, pos);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setInitBonus(int bonus) {
<b class="nc">&nbsp;        initBonus = bonus;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setCommandBonus(int bonus) {
<b class="nc">&nbsp;        commandBonus = bonus;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The crew is considered unconscious as a whole if none are active and at least one is not dead.
&nbsp;     *
&nbsp;     * @return Whether at least one crew member is alive but none are conscious.
&nbsp;     */
&nbsp;    public boolean isUnconscious() {
<b class="nc">&nbsp;        return !isDead() &amp;&amp; !isActive();</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isUnconscious(int pos) {
<b class="nc">&nbsp;        return unconscious[pos] &amp;&amp; !dead[pos] &amp;&amp; hits[pos] &lt; DEATH;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setUnconscious(boolean unconscious) {
<b class="nc">&nbsp;        for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;            setUnconscious(unconscious, i);</b>
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setUnconscious(boolean unconscious, int pos) {
<b class="nc">&nbsp;        this.unconscious[pos] = unconscious;</b>
<b class="nc">&nbsp;        if (getSlotCount() &gt; 1) {</b>
<b class="nc">&nbsp;            activeStatusChanged();</b>
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The crew is considered dead as a whole if all members are dead.
&nbsp;     *
&nbsp;     * @return Whether all members of the crew are dead.
&nbsp;     */
&nbsp;    public boolean isDead() {
<b class="nc">&nbsp;        for (int i = 0; i &lt; this.getSlotCount(); i++) {</b>
<b class="nc">&nbsp;            if (!dead[i]) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isDead(int pos) {
<b class="nc">&nbsp;        return dead[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setDead(boolean dead) {
<b class="nc">&nbsp;        if (!ejected) {</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;                setDead(dead, i);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setDead(boolean dead, int pos) {
&nbsp;        // Ejected pilots stop taking hits.
<b class="nc">&nbsp;        if (!ejected &amp;&amp; !missing[pos]) {</b>
<b class="nc">&nbsp;            this.dead[pos] = dead;</b>
<b class="nc">&nbsp;            if (dead) {</b>
<b class="nc">&nbsp;                hits[pos] = 6;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (getSlotCount() &gt; 1) {</b>
<b class="nc">&nbsp;                activeStatusChanged();</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @return Whether the unit was fielded without a crew member in the slot.
&nbsp;     */
&nbsp;    public boolean isMissing(int pos) {
<b class="nc">&nbsp;        return missing[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Allows a unit with a multi-crew cockpit to fielded with less than a full crew. Does not apply
&nbsp;     * to collective crew (vehicles, infantry, large craft).
&nbsp;     */
&nbsp;    public void setMissing(boolean missing, int pos) {
<b class="nc">&nbsp;        this.missing[pos] = missing;</b>
<b class="nc">&nbsp;        activeStatusChanged();</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Doomed status only applies to the crew as a whole.
&nbsp;     *
&nbsp;     * @return Whether the crew is scheduled to die at the end of the phase.
&nbsp;     */
&nbsp;    public boolean isDoomed() {
<b class="nc">&nbsp;        return doomed;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Doomed status only applies to the crew as a whole.
&nbsp;     *
&nbsp;     * @param doomed Whether the crew is scheduled to die at the end of the phase.
&nbsp;     */
&nbsp;    public void setDoomed(boolean doomed) {
&nbsp;        // Ejected pilots stop taking hits.
<b class="nc">&nbsp;        if (!ejected) {</b>
<b class="nc">&nbsp;            this.doomed = doomed;</b>
<b class="nc">&nbsp;            if (doomed) {</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;                    hits[i] = 6;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The crew as a whole is considered active if any member is active.
&nbsp;     *
&nbsp;     * @return Whether the crew has at least one active member.
&nbsp;     */
&nbsp;    public boolean isActive() {
<b class="nc">&nbsp;        for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;            if (isActive(i)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isActive(int pos) {
<b class="nc">&nbsp;        return !unconscious[pos] &amp;&amp; !dead[pos] &amp;&amp; !missing[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * The crew as a whole is considered ko this round if all active members are ko this round.
&nbsp;     *
&nbsp;     * @return true if all active members of the crew as knocked out this round
&nbsp;     */
&nbsp;    public boolean isKoThisRound() {
<b class="nc">&nbsp;        for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;            if (isActive(i) &amp;&amp; !koThisRound[i]) {</b>
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isKoThisRound(int pos) {
<b class="nc">&nbsp;        return koThisRound[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Set ko value for all slots.
&nbsp;     *
&nbsp;     * @param koThisRound Whether the crew will go unconscious during this round.
&nbsp;     */
&nbsp;    public void setKoThisRound(boolean koThisRound) {
<b class="fc">&nbsp;        Arrays.fill(this.koThisRound, koThisRound);</b>
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setKoThisRound(boolean koThisRound, int pos) {
<b class="nc">&nbsp;        this.koThisRound[pos] = koThisRound;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setOptions(PilotOptions options) {
<b class="nc">&nbsp;        this.options = options;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public PilotOptions getOptions() {
<b class="nc">&nbsp;        return options;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void clearOptions(String grpKey) {
<b class="nc">&nbsp;        for (Enumeration&lt;IOptionGroup&gt; i = options.getGroups(); i.hasMoreElements(); ) {</b>
<b class="nc">&nbsp;            IOptionGroup group = i.nextElement();</b>
&nbsp;
<b class="nc">&nbsp;            if (!group.getKey().equalsIgnoreCase(grpKey)) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            for (Enumeration&lt;IOption&gt; j = group.getOptions(); j.hasMoreElements(); ) {</b>
<b class="nc">&nbsp;                IOption option = j.nextElement();</b>
&nbsp;
<b class="nc">&nbsp;                option.clearValue();</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public int countOptions() {
<b class="nc">&nbsp;        return options.count();</b>
&nbsp;    }
&nbsp;
&nbsp;    public int countOptions(String grpKey) {
<b class="nc">&nbsp;        return options.count(grpKey);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns the options of the given category that this pilot has
&nbsp;     */
&nbsp;    public Enumeration&lt;IOption&gt; getOptions(String grpKey) {
<b class="nc">&nbsp;        for (Enumeration&lt;IOptionGroup&gt; i = options.getGroups(); i.hasMoreElements(); ) {</b>
<b class="nc">&nbsp;            IOptionGroup group = i.nextElement();</b>
&nbsp;
<b class="nc">&nbsp;            if (group.getKey().equalsIgnoreCase(grpKey)) {</b>
<b class="nc">&nbsp;                return group.getOptions();</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // no pilot advantages -- return an empty Enumeration
<b class="nc">&nbsp;        return new Vector&lt;IOption&gt;().elements();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns a string of all the option &quot;codes&quot; for this pilot, for a given
&nbsp;     * group, using sep as the separator
&nbsp;     */
&nbsp;    public String getOptionList(String sep, String grpKey) {
<b class="nc">&nbsp;        return options.getOptionListString(sep, grpKey);</b>
&nbsp;    }
&nbsp;
&nbsp;    // Helper function to reverse getAdvantageList() above
&nbsp;    public static String parseAdvantageName(String s) {
<b class="nc">&nbsp;        s = s.trim();</b>
<b class="nc">&nbsp;        int index = s.indexOf(&quot; &quot;);</b>
<b class="nc">&nbsp;        if (index == -1) {</b>
<b class="nc">&nbsp;            index = s.length();</b>
&nbsp;        }
<b class="nc">&nbsp;        return s.substring(0, index);</b>
&nbsp;    }
&nbsp;
&nbsp;    // Helper function to reverse getAdvantageList() above
&nbsp;    public static Object parseAdvantageValue(String s) {
<b class="nc">&nbsp;        s = s.trim();</b>
<b class="nc">&nbsp;        int index = s.indexOf(&quot; &quot;);</b>
<b class="nc">&nbsp;        if (index == -1) {</b>
<b class="nc">&nbsp;            return Boolean.TRUE;</b>
&nbsp;        }
<b class="nc">&nbsp;        String t = s.substring(index + 1);</b>
&nbsp;        Object result;
&nbsp;        try {
<b class="nc">&nbsp;            result = Integer.valueOf(t);</b>
<b class="nc">&nbsp;        } catch (NumberFormatException e) {</b>
<b class="nc">&nbsp;            result = t;</b>
<b class="nc">&nbsp;        } // try-catch</b>
<b class="nc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Overall crew description, using the name of the first crew member in the case of multi-crew cockpits.
&nbsp;     */
&nbsp;    public String getDesc() {
<b class="nc">&nbsp;        return getDesc(0);</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getDesc(int pos) {
<b class="nc">&nbsp;        if (isMissing(pos)) {</b>
<b class="nc">&nbsp;            return &quot;[missing]&quot;;</b>
&nbsp;        }
<b class="nc">&nbsp;        String s = name[pos];</b>
<b class="nc">&nbsp;        if (hits[pos] &gt; 0) {</b>
<b class="nc">&nbsp;            s += &quot; (&quot; + hits[pos] + &quot; hit(s)&quot;;</b>
<b class="nc">&nbsp;            if (isUnconscious(pos)) {</b>
<b class="nc">&nbsp;                s += &quot; [ko]&quot;;</b>
<b class="nc">&nbsp;            } else if (isDead(pos)) {</b>
<b class="nc">&nbsp;                s += &quot; [dead]&quot;;</b>
&nbsp;            }
<b class="nc">&nbsp;            s += &quot;)&quot;;</b>
<b class="nc">&nbsp;        } else if (isUnconscious(pos)) {</b>
<b class="nc">&nbsp;            s += &quot; [ko]&quot;;</b>
<b class="nc">&nbsp;        } else if (isDead(pos)) {</b>
<b class="nc">&nbsp;            s += &quot; [dead]&quot;;</b>
&nbsp;        }
<b class="nc">&nbsp;        return s;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Crew summary report used for victory phase.
&nbsp;     *
&nbsp;     * @param gunneryOnly Do not show the piloting skill
&nbsp;     */
&nbsp;    public Vector&lt;Report&gt; getDescVector(boolean gunneryOnly) {
<b class="nc">&nbsp;        Vector&lt;Report&gt; vDesc = new Vector&lt;&gt;();</b>
&nbsp;        Report r;
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;            if (missing[i]) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            r = new Report();</b>
<b class="nc">&nbsp;            r.type = Report.PUBLIC;</b>
<b class="nc">&nbsp;            r.add(name[i]);</b>
<b class="nc">&nbsp;            if (getSlotCount() &gt; 1) {</b>
<b class="nc">&nbsp;                r.add(&quot; (&quot; + crewType.getRoleName(i) + &quot;)&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (gunneryOnly) {</b>
<b class="nc">&nbsp;                r.messageId = 7050;</b>
<b class="nc">&nbsp;                r.add(getGunnery(i));</b>
&nbsp;            } else {
<b class="nc">&nbsp;                r.messageId = 7045;</b>
<b class="nc">&nbsp;                r.add(getGunnery(i));</b>
<b class="nc">&nbsp;                r.add(getPiloting(i));</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if ((hits[i] &gt; 0) || isUnconscious(i) || isDead(i)) {</b>
<b class="nc">&nbsp;                Report r2 = new Report();</b>
<b class="nc">&nbsp;                r2.type = Report.PUBLIC;</b>
<b class="nc">&nbsp;                if (hits[i] &gt; 0) {</b>
<b class="nc">&nbsp;                    r2.messageId = 7055;</b>
<b class="nc">&nbsp;                    r2.add(hits[i]);</b>
<b class="nc">&nbsp;                    if (isUnconscious(i)) {</b>
<b class="nc">&nbsp;                        r2.messageId = 7060;</b>
<b class="nc">&nbsp;                        r2.choose(true);</b>
<b class="nc">&nbsp;                    } else if (isDead(i)) {</b>
<b class="nc">&nbsp;                        r2.messageId = 7060;</b>
<b class="nc">&nbsp;                        r2.choose(false);</b>
&nbsp;                    }
<b class="nc">&nbsp;                } else if (isUnconscious(i)) {</b>
<b class="nc">&nbsp;                    r2.messageId = 7065;</b>
<b class="nc">&nbsp;                    r2.choose(true);</b>
<b class="nc">&nbsp;                } else if (isDead(i)) {</b>
<b class="nc">&nbsp;                    r2.messageId = 7065;</b>
<b class="nc">&nbsp;                    r2.choose(false);</b>
&nbsp;                }
<b class="nc">&nbsp;                r.newlines = 0;</b>
<b class="nc">&nbsp;                vDesc.addElement(r);</b>
<b class="nc">&nbsp;                vDesc.addElement(r2);</b>
<b class="nc">&nbsp;            } else {</b>
<b class="nc">&nbsp;                vDesc.addElement(r);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return vDesc;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns whether this pilot has non-standard piloting or gunnery values
&nbsp;     */
&nbsp;    public boolean isCustom() {
<b class="nc">&nbsp;        return (getGunnery() != 4) || (getPiloting() != 5);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns the BV multiplier for this pilot&#39;s gunnery/piloting
&nbsp;     *
&nbsp;     * @param game the game to use to determine the modifier
&nbsp;     */
&nbsp;    public double getBVSkillMultiplier(IGame game) {
<b class="nc">&nbsp;        return getBVSkillMultiplier(true, game);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns the BV multiplier for this pilot&#39;s gunnery/piloting
&nbsp;     *
&nbsp;     * @param usePiloting whether or not to use the default value non-anti-mech
&nbsp;     *                    infantry/BA should not use the anti-mech skill
&nbsp;     * @param game the game to use to determine the modifier
&nbsp;     */
&nbsp;    public double getBVSkillMultiplier(boolean usePiloting, IGame game) {
<b class="nc">&nbsp;        int pilotVal = getPiloting();</b>
<b class="nc">&nbsp;        if (!usePiloting) {</b>
<b class="nc">&nbsp;            pilotVal = 5;</b>
&nbsp;        }
<b class="nc">&nbsp;        return getBVImplantMultiplier() * getBVSkillMultiplier(getGunnery(), pilotVal, game);</b>
&nbsp;    }
&nbsp;
&nbsp;    public double getBVImplantMultiplier() {
&nbsp;
&nbsp;        // get highest level
<b class="nc">&nbsp;        int level = 1;</b>
<b class="nc">&nbsp;        if (options.booleanOption(OptionsConstants.MD_PAIN_SHUNT)) {</b>
<b class="nc">&nbsp;            level = 2;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (options.booleanOption(OptionsConstants.MD_VDNI)) {</b>
<b class="nc">&nbsp;            level = 3;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (options.booleanOption(OptionsConstants.MD_BVDNI)) {</b>
<b class="nc">&nbsp;            level = 5;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return (level / 4.0) + 0.75;</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns the BV multiplier for a pilots gunnery/piloting. This function is
&nbsp;     * static to evaluate the BV of a unit, even when they have not yet been
&nbsp;     * assigned a pilot.
&nbsp;     *
&nbsp;     * @param gunnery  the gunnery skill of the pilot
&nbsp;     * @param piloting the piloting skill of the pilot
&nbsp;     * @return a multiplier to the BV of whatever unit the pilot is piloting.
&nbsp;     */
&nbsp;    public static double getBVSkillMultiplier(int gunnery, int piloting) {
<b class="nc">&nbsp;        return getBVSkillMultiplier(gunnery, piloting, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static double getBVSkillMultiplier(int gunnery, int piloting, IGame game) {
<b class="fc">&nbsp;        if ((game != null) &amp;&amp; game.getOptions().booleanOption(OptionsConstants.ADVANCED_ALTERNATE_PILOT_BV_MOD)) {</b>
<b class="fc">&nbsp;            return alternateBvMod[Math.max(Math.min(8, gunnery), 0)][Math.max(Math.min(8, piloting), 0)];</b>
&nbsp;        }
<b class="fc">&nbsp;        return bvMod[Math.max(Math.min(8, gunnery), 0)][Math.max(Math.min(8, piloting), 0)];</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean hasEdgeRemaining() {
<b class="nc">&nbsp;        return (getOptions().intOption(OptionsConstants.EDGE) &gt; 0);</b>
&nbsp;    }
&nbsp;
&nbsp;    public void decreaseEdge() {
<b class="nc">&nbsp;        IOption edgeOption = getOptions().getOption(OptionsConstants.EDGE);</b>
<b class="nc">&nbsp;        edgeOption.setValue((Integer) edgeOption.getValue() - 1);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Determine if this pilot has abandoned her vehicle.
&nbsp;     *
&nbsp;     * @return &lt;code&gt;true&lt;/code&gt; if the pilot has abandoned her vehicle,
&nbsp;     * &lt;code&gt;false&lt;/code&gt; if the pilot is still in the vehicle.
&nbsp;     */
&nbsp;    public boolean isEjected() {
<b class="nc">&nbsp;        return ejected;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Specify if this pilot has abandoned her vehicle.
&nbsp;     *
&nbsp;     * @param abandoned the &lt;code&gt;boolean&lt;/code&gt; value to set.
&nbsp;     */
&nbsp;    public void setEjected(boolean abandoned) {
<b class="nc">&nbsp;        ejected = abandoned;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * for sensor ops, so these might be easily expanded later for rpg
&nbsp;     */
&nbsp;    public int getSensorOps() {
<b class="nc">&nbsp;        if (getPiloting() &gt; -1) {</b>
<b class="nc">&nbsp;            return getPiloting();</b>
&nbsp;        }
<b class="nc">&nbsp;        return getGunnery();</b>
&nbsp;    }
&nbsp;
&nbsp;    private int getPilotingFatigueTurn() {
<b class="nc">&nbsp;        int turn = 20;</b>
<b class="nc">&nbsp;        if (getPiloting() &gt; 5) {</b>
<b class="nc">&nbsp;            turn = 10;</b>
<b class="nc">&nbsp;        } else if (getPiloting() &gt; 3) {</b>
<b class="nc">&nbsp;            turn = 14;</b>
<b class="nc">&nbsp;        } else if (getPiloting() &gt; 1) {</b>
<b class="nc">&nbsp;            turn = 17;</b>
&nbsp;        }
&nbsp;
&nbsp;        // get fatigue point modifiers
<b class="nc">&nbsp;        int mod = (int) Math.min(Math.max(0, Math.ceil(fatigue / 4.0) - 1), 4);</b>
<b class="nc">&nbsp;        turn = turn - mod;</b>
&nbsp;
<b class="nc">&nbsp;        return turn;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isPilotingFatigued() {
<b class="nc">&nbsp;        return fatigueCount &gt;= getPilotingFatigueTurn();</b>
&nbsp;    }
&nbsp;
&nbsp;    private int getGunneryFatigueTurn() {
<b class="nc">&nbsp;        int turn = 20;</b>
<b class="nc">&nbsp;        if (getPiloting() &gt; 5) {</b>
<b class="nc">&nbsp;            turn = 14;</b>
<b class="nc">&nbsp;        } else if (getPiloting() &gt; 3) {</b>
<b class="nc">&nbsp;            turn = 17;</b>
&nbsp;        }
&nbsp;
&nbsp;        // get fatigue point modifiers
<b class="nc">&nbsp;        int mod = (int) Math.min(Math.max(0, Math.ceil(fatigue / 4.0) - 1), 4);</b>
<b class="nc">&nbsp;        turn = turn - mod;</b>
&nbsp;
<b class="nc">&nbsp;        return turn;</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public boolean isGunneryFatigued() {
<b class="nc">&nbsp;        if (getPiloting() &lt; 2) {</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
<b class="nc">&nbsp;        return fatigueCount &gt;= getGunneryFatigueTurn();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @return A description of the status of a single crew member
&nbsp;     */
&nbsp;    public String getStatusDesc(int pos) {
<b class="nc">&nbsp;        if (isMissing(pos)) {</b>
<b class="nc">&nbsp;            return &quot;Missing&quot;;</b>
&nbsp;        }
<b class="nc">&nbsp;        String s = &quot;&quot;;</b>
<b class="nc">&nbsp;        if (getHits(pos) &gt; 0) {</b>
<b class="nc">&nbsp;            s += hits[pos] + &quot; hits&quot;;</b>
<b class="nc">&nbsp;            if (isUnconscious(pos)) {</b>
<b class="nc">&nbsp;                s += &quot; (KO)&quot;;</b>
<b class="nc">&nbsp;            } else if (isDead(pos)) {</b>
<b class="nc">&nbsp;                s += &quot; (dead)&quot;;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return s;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setExternalIdAsString(String i, int pos) {
<b class="nc">&nbsp;        externalId[pos] = i;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public String getExternalIdAsString(int pos) {
<b class="nc">&nbsp;        if (pos &lt; externalId.length) {</b>
<b class="nc">&nbsp;            return externalId[pos];</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return &quot;-1&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Use the first assigned slot as a general id for the crew.
&nbsp;     *
&nbsp;     * @return The id of the first slot that is not set to &quot;-1&quot;
&nbsp;     */
&nbsp;    public String getExternalIdAsString() {
<b class="nc">&nbsp;        for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;            if (!externalId[i].equals(&quot;-1&quot;)) {</b>
<b class="nc">&nbsp;                return externalId[i];</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return &quot;-1&quot;;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getExternalId(int pos) {
<b class="nc">&nbsp;        return Integer.parseInt(externalId[pos]);</b>
&nbsp;    }
&nbsp;
&nbsp;    public AbstractIcon getPortrait(int pos) {
<b class="nc">&nbsp;        return new Portrait(getPortraitCategory(pos), getPortraitFileName(pos));</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setPortraitCategory(String name, int pos) {
<b class="nc">&nbsp;        portraitCategory[pos] = name;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public String getPortraitCategory(int pos) {
<b class="nc">&nbsp;        return portraitCategory[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setPortraitFileName(String name, int pos) {
<b class="nc">&nbsp;        portraitFileName[pos] = name;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public String getPortraitFileName(int pos) {
<b class="nc">&nbsp;        if (portraitFileName.length &gt; pos) {</b>
<b class="nc">&nbsp;            return portraitFileName[pos];</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return AbstractIcon.DEFAULT_ICON_FILENAME;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public int getToughness(int pos) {
<b class="nc">&nbsp;        return toughness[pos];</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setToughness(int t, int pos) {
<b class="nc">&nbsp;        toughness[pos] = t;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public int getFatigue() {
<b class="nc">&nbsp;        return fatigue;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setFatigue(int i) {
<b class="nc">&nbsp;        fatigue = i;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void incrementFatigueCount() {
<b class="nc">&nbsp;        fatigueCount++;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Sets crew state fields back to defaults. Used by MekHQ to clear game state.
&nbsp;     */
&nbsp;    public void resetGameState() {
<b class="nc">&nbsp;        fatigueCount = 0;</b>
<b class="nc">&nbsp;        doomed = false;</b>
<b class="nc">&nbsp;        ejected = false;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; crewType.getCrewSlots(); i++) {</b>
<b class="nc">&nbsp;            unconscious[i] = false;</b>
<b class="nc">&nbsp;            dead[i] = false;</b>
<b class="nc">&nbsp;            missing[i] = false;</b>
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public int rollGunnerySkill() {
<b class="nc">&nbsp;        if (getOptions().booleanOption(OptionsConstants.PILOT_APTITUDE_GUNNERY)) {</b>
<b class="nc">&nbsp;            return Compute.d6(3, 2);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return Compute.d6(2);</b>
&nbsp;    }
&nbsp;
&nbsp;    public int rollPilotingSkill() {
<b class="nc">&nbsp;        if (getOptions().booleanOption(OptionsConstants.PILOT_APTITUDE_PILOTING)) {</b>
<b class="nc">&nbsp;            return Compute.d6(3, 2);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        return Compute.d6(2);</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getCurrentPilotIndex() {
<b class="fc">&nbsp;        return pilotPos;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getCurrentGunnerIndex() {
<b class="fc">&nbsp;        return gunnerPos;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getBackupPilotPos() {
<b class="nc">&nbsp;        return backupPilot;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setBackupPilotPos(int pos) {
<b class="nc">&nbsp;        backupPilot = pos;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public int getBackupGunnerPos() {
<b class="nc">&nbsp;        return backupGunner;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setBackupGunnerPos(int pos) {
<b class="nc">&nbsp;        backupGunner = pos;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Set the pilot slot. If a multicrew cockpit uses the same crew member as both pilot and gunner
&nbsp;     * (i.e. cockpit command console), sets the gunner as well.
&nbsp;     *
&nbsp;     * @param pos The slot index to set as pilot.
&nbsp;     */
&nbsp;    public void setCurrentPilot(int pos) {
<b class="nc">&nbsp;        pilotPos = pos;</b>
<b class="nc">&nbsp;        if (crewType.getPilotPos() == crewType.getGunnerPos()) {</b>
<b class="nc">&nbsp;            gunnerPos = pos;</b>
&nbsp;        }
<b class="nc">&nbsp;        actedThisTurn[pos] = true;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Called when the active status of a crew slot changes in a unit with a multi-crew cockpit.
&nbsp;     * If a pilot or gunner is incapacitated, someone else must take over the duties.
&nbsp;     * A pilot or gunner that wakes up will resume normal duties.
&nbsp;     */
&nbsp;    private void activeStatusChanged() {
&nbsp;        //Cockpit command console can be swapped deliberately by the player and should not be changed
&nbsp;        //automatically unless the current pilot becomes inactive.
<b class="nc">&nbsp;        if (crewType.equals(CrewType.COMMAND_CONSOLE)</b>
<b class="nc">&nbsp;                &amp;&amp; isActive(getCurrentPilotIndex())) {</b>
<b class="nc">&nbsp;            return;</b>
&nbsp;        }
&nbsp;        //Start by checking whether the default pilot is available. If not, check the designated backup.
&nbsp;        //If still not available, select the first active slot. If none are active, it does not matter
&nbsp;        //which slot is designated and the value is not changed.
<b class="nc">&nbsp;        if (isActive(crewType.getPilotPos())) {</b>
<b class="nc">&nbsp;            pilotPos = crewType.getPilotPos();</b>
<b class="nc">&nbsp;        } else if (isActive(backupPilot)) {</b>
<b class="nc">&nbsp;            pilotPos = backupPilot;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;                if (isActive(i)) {</b>
<b class="nc">&nbsp;                    pilotPos = i;</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (isActive(crewType.getGunnerPos())) {</b>
<b class="nc">&nbsp;            gunnerPos = crewType.getGunnerPos();</b>
<b class="nc">&nbsp;        } else if (isActive(backupGunner)) {</b>
<b class="nc">&nbsp;            gunnerPos = backupGunner;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;                if (isActive(i)) {</b>
<b class="nc">&nbsp;                    gunnerPos = i;</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * When assigning skills randomly, we want to make sure the skills are assigned to the most
&nbsp;     * appropriate position in crews where the pilot and gunner are separate.
&nbsp;     * We&#39;re going to do it the simpler way and reassign the piloting and gunnery
&nbsp;     * skills individually, resulting in a more specialized crew.
&nbsp;     */
&nbsp;    public void sortRandomSkills() {
<b class="nc">&nbsp;        if (crewType.getCrewSlots() &lt; 2 || crewType.getPilotPos() == crewType.getGunnerPos()) {</b>
<b class="nc">&nbsp;            return;</b>
&nbsp;        }
<b class="nc">&nbsp;        int lowest = MAX_SKILL;</b>
<b class="nc">&nbsp;        int pos = -1;</b>
<b class="nc">&nbsp;        if (!missing[crewType.getPilotPos()]) {</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;                if (piloting[i] &lt; lowest) {</b>
<b class="nc">&nbsp;                    lowest = piloting[i];</b>
<b class="nc">&nbsp;                    pos = i;</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (pos &gt;= 0) {</b>
<b class="nc">&nbsp;                piloting[pos] = piloting[crewType.getPilotPos()];</b>
<b class="nc">&nbsp;                piloting[crewType.getPilotPos()] = lowest;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        lowest = MAX_SKILL;</b>
<b class="nc">&nbsp;        pos = -1;</b>
<b class="nc">&nbsp;        if (!missing[crewType.getGunnerPos()]) {</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; getSlotCount(); i++) {</b>
<b class="nc">&nbsp;                if (gunnery[i] &lt; lowest) {</b>
<b class="nc">&nbsp;                    lowest = gunnery[i];</b>
<b class="nc">&nbsp;                    pos = i;</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (pos &gt;= 0) {</b>
<b class="nc">&nbsp;                gunnery[pos] = gunnery[crewType.getGunnerPos()];</b>
<b class="nc">&nbsp;                gunnery[crewType.getGunnerPos()] = lowest;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Tripods and QuadVees get special benefits if the dedicated pilot is active.
&nbsp;     *
&nbsp;     * @return Whether a Mek has a separate pilot who is active.
&nbsp;     */
&nbsp;    public boolean hasDedicatedPilot() {
<b class="nc">&nbsp;        return isActive(crewType.getPilotPos())</b>
<b class="nc">&nbsp;                &amp;&amp; crewType.getGunnerPos() != crewType.getPilotPos();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Tripods and QuadVees get special benefits if the dedicated gunner is active.
&nbsp;     *
&nbsp;     * @return Whether a Mek has a separate gunner who is active.
&nbsp;     */
&nbsp;    public boolean hasDedicatedGunner() {
<b class="nc">&nbsp;        return isActive(crewType.getGunnerPos())</b>
<b class="nc">&nbsp;                &amp;&amp; crewType.getGunnerPos() != crewType.getPilotPos();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Super heavy tripods gain benefits from having a technical officer.
&nbsp;     *
&nbsp;     * @return Whether the tech officer is alive and conscious.
&nbsp;     */
&nbsp;    public boolean hasActiveTechOfficer() {
<b class="nc">&nbsp;        return crewType.getTechPos() &gt; 0 &amp;&amp; isActive(crewType.getTechPos());</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Cockpit command console provides commander init bonus if both crew members are active
&nbsp;     * (also requires advanced fire control and heavy/assault unit, which is not checked here).
&nbsp;     * Though the positions are named &quot;pilot&quot; and &quot;commander&quot; they can switch positions in the end
&nbsp;     * phase of any turn so we need to check whichever is not currently acting as pilot.
&nbsp;     *
&nbsp;     * @return Whether the unit has a commander that is not also acting as pilot currently or in the previous turn.
&nbsp;     */
&nbsp;    public boolean hasActiveCommandConsole() {
<b class="nc">&nbsp;        int commandPos = 1 - getCurrentPilotIndex();</b>
<b class="nc">&nbsp;        return crewType.equals(CrewType.COMMAND_CONSOLE) &amp;&amp; isActive(commandPos) &amp;&amp; !actedThisTurn[commandPos];</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Called after the initiative bonus for the round has been calculated.
&nbsp;     */
&nbsp;    public void resetActedFlag() {
<b class="fc">&nbsp;        Arrays.fill(actedThisTurn, false);</b>
<b class="fc">&nbsp;        actedThisTurn[getCurrentPilotIndex()] = true;</b>
<b class="fc">&nbsp;        actedThisTurn[getCurrentGunnerIndex()] = true;</b>
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @return Whether the crew members in a command console-equipped unit are scheduled to swap roles at
&nbsp;     * the end of the turn.
&nbsp;     */
&nbsp;    public boolean getSwapConsoleRoles() {
<b class="nc">&nbsp;        return swapConsoleRoles;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Schedules or clears a scheduled swap of roles in a command console-equipped unit.
&nbsp;     *
&nbsp;     * @param swap true for crew slots in a command console to swap roles at the end of the turn,
&nbsp;     *             otherwise false
&nbsp;     */
&nbsp;    public void setSwapConsoleRoles(boolean swap) {
<b class="nc">&nbsp;        swapConsoleRoles = swap;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Checks whether a role swap is scheduled for a command-console equipped unit and (if the new pilot
&nbsp;     * is active) performs the swap. The swap flag is cleared regardless of whether a swap took place.
&nbsp;     *
&nbsp;     * @return True if a swap was performed, otherwise false.
&nbsp;     */
&nbsp;    public boolean doConsoleRoleSwap() {
<b class="nc">&nbsp;        if (swapConsoleRoles &amp;&amp; crewType.equals(CrewType.COMMAND_CONSOLE)) {</b>
<b class="nc">&nbsp;            int newPilotIndex = 1 - getCurrentPilotIndex();</b>
<b class="nc">&nbsp;            if (isActive(newPilotIndex)) {</b>
<b class="nc">&nbsp;                setCurrentPilot(newPilotIndex);</b>
<b class="nc">&nbsp;                swapConsoleRoles = false;</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        swapConsoleRoles = false;</b>
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    //region extraData
&nbsp;    public void setExtraData(Map&lt;Integer, Map&lt;String, String&gt;&gt; extraData) {
<b class="nc">&nbsp;        this.extraData = extraData;</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void setExtraDataForCrewMember(int crewIndex, Map&lt;String, String&gt; dataMap) {
<b class="nc">&nbsp;        if (this.extraData == null) {</b>
<b class="nc">&nbsp;            this.extraData = new HashMap&lt;&gt;();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        this.extraData.put(crewIndex, dataMap);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public Map&lt;Integer, Map&lt;String, String&gt;&gt; getExtraData() {
<b class="nc">&nbsp;        return extraData;</b>
&nbsp;    }
&nbsp;
&nbsp;    public Map&lt;String, String&gt; getExtraDataForCrewMember(int crewIndex) {
<b class="nc">&nbsp;        if (this.extraData == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return extraData.get(crewIndex);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public String getExtraDataValue(int crewIndex, String key) {
<b class="nc">&nbsp;        if (this.extraData == null) {</b>
<b class="nc">&nbsp;            return null;</b>
<b class="nc">&nbsp;        } else if (this.extraData.get(crewIndex) == null) {</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return extraData.get(crewIndex).get(key);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public String writeExtraDataToXMLLine(int pos) {
<b class="nc">&nbsp;        Map&lt;String, String&gt; dataRow = getExtraDataForCrewMember(pos);</b>
&nbsp;
<b class="nc">&nbsp;        if (dataRow != null) {</b>
<b class="nc">&nbsp;            StringBuilder output = new StringBuilder();</b>
&nbsp;
<b class="nc">&nbsp;            output.append(&quot;\&quot; extraData=\&quot;&quot;);</b>
&nbsp;
<b class="nc">&nbsp;            boolean first = true;</b>
<b class="nc">&nbsp;            for (Map.Entry&lt;String, String&gt; row : dataRow.entrySet()) {</b>
<b class="nc">&nbsp;                if (!first) {</b>
<b class="nc">&nbsp;                    output.append(&quot;|&quot;);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    first = false;</b>
&nbsp;                }
<b class="nc">&nbsp;                output.append(row.getKey()).append(&quot;=&quot;).append(row.getValue());</b>
<b class="nc">&nbsp;            }</b>
&nbsp;
<b class="nc">&nbsp;            return output.toString();</b>
&nbsp;        } else {
<b class="nc">&nbsp;            return null;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    //endregion extraData
&nbsp;
&nbsp;    //region MekWars
&nbsp;    /*
&nbsp;     * Legacy methods used by MekWars
&nbsp;     */
&nbsp;    /**
&nbsp;     * @deprecated by multi-crew cockpits. Replaced by {@link #setHits(int, int)}
&nbsp;     */
&nbsp;    @Deprecated
&nbsp;    public void setHits(int hits) {
<b class="nc">&nbsp;        setHits(hits, 0);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Sets the piloting skill of the crew&#39;s default pilot.
&nbsp;     */
&nbsp;    public void setPiloting(int piloting) {
<b class="nc">&nbsp;        setPiloting(piloting, crewType.getPilotPos());</b>
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Sets the gunnery skill of the crew&#39;s default gunner.
&nbsp;     */
&nbsp;    public void setGunnery(int gunnery) {
<b class="nc">&nbsp;        setGunnery(gunnery, crewType.getGunnerPos());</b>
<b class="nc">&nbsp;    }</b>
&nbsp;    //endregion MekWars
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
