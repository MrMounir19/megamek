


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > MenuScroller</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing.util</a>
</div>

<h1>Coverage Summary for Class: MenuScroller (megamek.client.ui.swing.util)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">MenuScroller</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/31)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/85)
  </span>
</td>
</tr>
  <tr>
    <td class="name">MenuScroller$1</td>
  </tr>
  <tr>
    <td class="name">MenuScroller$MenuIcon</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/16)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MenuScroller$MenuScrollItem</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/10)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MenuScroller$MenuScrollListener</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/16)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MenuScroller$MenuScrollTimer</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MenuScroller$MenuScrollTimer$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/48)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/132)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/**
&nbsp; * @(#)MenuScroller.java	1.4.0 14/09/10
&nbsp; */
&nbsp;
&nbsp;package megamek.client.ui.swing.util;
&nbsp;
&nbsp;import java.awt.Component;
&nbsp;import java.awt.Dimension;
&nbsp;import java.awt.Graphics;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;
&nbsp;import javax.swing.Icon;
&nbsp;import javax.swing.JComponent;
&nbsp;import javax.swing.JMenu;
&nbsp;import javax.swing.JMenuItem;
&nbsp;import javax.swing.JPopupMenu;
&nbsp;import javax.swing.JSeparator;
&nbsp;import javax.swing.MenuSelectionManager;
&nbsp;import javax.swing.Timer;
&nbsp;import javax.swing.UIManager;
&nbsp;import javax.swing.event.ChangeEvent;
&nbsp;import javax.swing.event.ChangeListener;
&nbsp;import javax.swing.event.PopupMenuEvent;
&nbsp;import javax.swing.event.PopupMenuListener;
&nbsp;
&nbsp;/**
&nbsp; * A class that provides scrolling capabilities to a long menu dropdown or
&nbsp; * popup menu.  A number of items can optionally be frozen at the top and/or
&nbsp; * bottom of the menu.
&nbsp; * &lt;P&gt;
&nbsp; * &lt;B&gt;Implementation note:&lt;/B&gt;  The default number of items to display
&nbsp; * at a time is 15, and the default scrolling interval is 125 milliseconds.
&nbsp; * &lt;P&gt;
&nbsp; * @author Darryl
&nbsp; * 
&nbsp; * See http://tips4java.wordpress.com/2009/02/01/menu-scroller/
&nbsp; * 
&nbsp; */
<b class="nc">&nbsp;public class MenuScroller {</b>
&nbsp;
&nbsp;  //private JMenu menu;
&nbsp;  private JPopupMenu menu;
&nbsp;  private Component[] menuItems;
&nbsp;  private MenuScrollItem upItem;
&nbsp;  private MenuScrollItem downItem;
<b class="nc">&nbsp;  private final MenuScrollListener menuListener = new MenuScrollListener();</b>
&nbsp;  private int scrollCount;
&nbsp;  private int interval;
&nbsp;  private int topFixedCount;
&nbsp;  private int bottomFixedCount;
<b class="nc">&nbsp;  private int firstIndex = 0;</b>
<b class="nc">&nbsp;  private int keepVisibleIndex = -1;</b>
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a menu to be scrolled with the default number of items to
&nbsp;   * display at a time and the default scrolling interval.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   * @return the MenuScroller
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JMenu menu) {
<b class="nc">&nbsp;    return new MenuScroller(menu);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a popup menu to be scrolled with the default number of items to
&nbsp;   * display at a time and the default scrolling interval.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   * @return the MenuScroller
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JPopupMenu menu) {
<b class="nc">&nbsp;    return new MenuScroller(menu);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a menu to be scrolled with the default number of items to
&nbsp;   * display at a time and the specified scrolling interval.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   * @param scrollCount the number of items to display at a time
&nbsp;   * @return the MenuScroller
&nbsp;   * @throws IllegalArgumentException if scrollCount is 0 or negative
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JMenu menu, int scrollCount) {
<b class="nc">&nbsp;    return new MenuScroller(menu, scrollCount);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a popup menu to be scrolled with the default number of items to
&nbsp;   * display at a time and the specified scrolling interval.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   * @param scrollCount the number of items to display at a time
&nbsp;   * @return the MenuScroller
&nbsp;   * @throws IllegalArgumentException if scrollCount is 0 or negative
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JPopupMenu menu, int scrollCount) {
<b class="nc">&nbsp;    return new MenuScroller(menu, scrollCount);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a menu to be scrolled, with the specified number of items to
&nbsp;   * display at a time and the specified scrolling interval.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   * @param scrollCount the number of items to be displayed at a time
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @return the MenuScroller
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or negative
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JMenu menu, int scrollCount, int interval) {
<b class="nc">&nbsp;    return new MenuScroller(menu, scrollCount, interval);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a popup menu to be scrolled, with the specified number of items to
&nbsp;   * display at a time and the specified scrolling interval.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   * @param scrollCount the number of items to be displayed at a time
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @return the MenuScroller
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or negative
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JPopupMenu menu, int scrollCount, int interval) {
<b class="nc">&nbsp;    return new MenuScroller(menu, scrollCount, interval);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a menu to be scrolled, with the specified number of items
&nbsp;   * to display in the scrolling region, the specified scrolling interval,
&nbsp;   * and the specified numbers of items fixed at the top and bottom of the
&nbsp;   * menu.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   * @param scrollCount the number of items to display in the scrolling portion
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @param topFixedCount the number of items to fix at the top.  May be 0.
&nbsp;   * @param bottomFixedCount the number of items to fix at the bottom. May be 0
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or
&nbsp;   * negative or if topFixedCount or bottomFixedCount is negative
&nbsp;   * @return the MenuScroller
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JMenu menu, int scrollCount, int interval,
&nbsp;          int topFixedCount, int bottomFixedCount) {
<b class="nc">&nbsp;    return new MenuScroller(menu, scrollCount, interval,</b>
&nbsp;            topFixedCount, bottomFixedCount);
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Registers a popup menu to be scrolled, with the specified number of items
&nbsp;   * to display in the scrolling region, the specified scrolling interval,
&nbsp;   * and the specified numbers of items fixed at the top and bottom of the
&nbsp;   * popup menu.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   * @param scrollCount the number of items to display in the scrolling portion
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @param topFixedCount the number of items to fix at the top.  May be 0
&nbsp;   * @param bottomFixedCount the number of items to fix at the bottom.  May be 0
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or
&nbsp;   * negative or if topFixedCount or bottomFixedCount is negative
&nbsp;   * @return the MenuScroller
&nbsp;   */
&nbsp;  public static MenuScroller setScrollerFor(JPopupMenu menu, int scrollCount, int interval,
&nbsp;          int topFixedCount, int bottomFixedCount) {
<b class="nc">&nbsp;    return new MenuScroller(menu, scrollCount, interval,</b>
&nbsp;            topFixedCount, bottomFixedCount);
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a menu with the
&nbsp;   * default number of items to display at a time, and default scrolling
&nbsp;   * interval.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   */
&nbsp;  public MenuScroller(JMenu menu) {
<b class="nc">&nbsp;    this(menu, 15);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a popup menu with the
&nbsp;   * default number of items to display at a time, and default scrolling
&nbsp;   * interval.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   */
&nbsp;  public MenuScroller(JPopupMenu menu) {
<b class="nc">&nbsp;    this(menu, 15);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a menu with the
&nbsp;   * specified number of items to display at a time, and default scrolling
&nbsp;   * interval.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   * @param scrollCount the number of items to display at a time
&nbsp;   * @throws IllegalArgumentException if scrollCount is 0 or negative
&nbsp;   */
&nbsp;  public MenuScroller(JMenu menu, int scrollCount) {
<b class="nc">&nbsp;    this(menu, scrollCount, 150);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a popup menu with the
&nbsp;   * specified number of items to display at a time, and default scrolling
&nbsp;   * interval.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   * @param scrollCount the number of items to display at a time
&nbsp;   * @throws IllegalArgumentException if scrollCount is 0 or negative
&nbsp;   */
&nbsp;  public MenuScroller(JPopupMenu menu, int scrollCount) {
<b class="nc">&nbsp;    this(menu, scrollCount, 150);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a menu with the
&nbsp;   * specified number of items to display at a time, and specified scrolling
&nbsp;   * interval.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   * @param scrollCount the number of items to display at a time
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or negative
&nbsp;   */
&nbsp;  public MenuScroller(JMenu menu, int scrollCount, int interval) {
<b class="nc">&nbsp;    this(menu, scrollCount, interval, 0, 0);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a popup menu with the
&nbsp;   * specified number of items to display at a time, and specified scrolling
&nbsp;   * interval.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   * @param scrollCount the number of items to display at a time
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or negative
&nbsp;   */
&nbsp;  public MenuScroller(JPopupMenu menu, int scrollCount, int interval) {
<b class="nc">&nbsp;    this(menu, scrollCount, interval, 0, 0);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a menu with the
&nbsp;   * specified number of items to display in the scrolling region, the
&nbsp;   * specified scrolling interval, and the specified numbers of items fixed at
&nbsp;   * the top and bottom of the menu.
&nbsp;   * 
&nbsp;   * @param menu the menu
&nbsp;   * @param scrollCount the number of items to display in the scrolling portion
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @param topFixedCount the number of items to fix at the top.  May be 0
&nbsp;   * @param bottomFixedCount the number of items to fix at the bottom.  May be 0
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or
&nbsp;   * negative or if topFixedCount or bottomFixedCount is negative
&nbsp;   */
&nbsp;  public MenuScroller(JMenu menu, int scrollCount, int interval,
&nbsp;          int topFixedCount, int bottomFixedCount) {
<b class="nc">&nbsp;    this(menu.getPopupMenu(), scrollCount, interval, topFixedCount, bottomFixedCount);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Constructs a &lt;code&gt;MenuScroller&lt;/code&gt; that scrolls a popup menu with the
&nbsp;   * specified number of items to display in the scrolling region, the
&nbsp;   * specified scrolling interval, and the specified numbers of items fixed at
&nbsp;   * the top and bottom of the popup menu.
&nbsp;   * 
&nbsp;   * @param menu the popup menu
&nbsp;   * @param scrollCount the number of items to display in the scrolling portion
&nbsp;   * @param interval the scroll interval, in milliseconds
&nbsp;   * @param topFixedCount the number of items to fix at the top.  May be 0
&nbsp;   * @param bottomFixedCount the number of items to fix at the bottom.  May be 0
&nbsp;   * @throws IllegalArgumentException if scrollCount or interval is 0 or
&nbsp;   * negative or if topFixedCount or bottomFixedCount is negative
&nbsp;   */
&nbsp;  public MenuScroller(JPopupMenu menu, int scrollCount, int interval,
<b class="nc">&nbsp;          int topFixedCount, int bottomFixedCount) {</b>
<b class="nc">&nbsp;    if (scrollCount &lt;= 0 || interval &lt;= 0) {</b>
<b class="nc">&nbsp;      throw new IllegalArgumentException(&quot;scrollCount and interval must be greater than 0&quot;);</b>
&nbsp;    }
<b class="nc">&nbsp;    if (topFixedCount &lt; 0 || bottomFixedCount &lt; 0) {</b>
<b class="nc">&nbsp;      throw new IllegalArgumentException(&quot;topFixedCount and bottomFixedCount cannot be negative&quot;);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    upItem = new MenuScrollItem(MenuIcon.UP, -1);</b>
<b class="nc">&nbsp;    downItem = new MenuScrollItem(MenuIcon.DOWN, +1);</b>
<b class="nc">&nbsp;    setScrollCount(scrollCount);</b>
<b class="nc">&nbsp;    setInterval(interval);</b>
<b class="nc">&nbsp;    setTopFixedCount(topFixedCount);</b>
<b class="nc">&nbsp;    setBottomFixedCount(bottomFixedCount);</b>
&nbsp;
<b class="nc">&nbsp;    this.menu = menu;</b>
<b class="nc">&nbsp;    menu.addPopupMenuListener(menuListener);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Returns the scroll interval in milliseconds
&nbsp;   * 
&nbsp;   * @return the scroll interval in milliseconds
&nbsp;   */
&nbsp;  public int getInterval() {
<b class="nc">&nbsp;    return interval;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Sets the scroll interval in milliseconds
&nbsp;   * 
&nbsp;   * @param interval the scroll interval in milliseconds
&nbsp;   * @throws IllegalArgumentException if interval is 0 or negative
&nbsp;   */
&nbsp;  public void setInterval(int interval) {
<b class="nc">&nbsp;    if (interval &lt;= 0) {</b>
<b class="nc">&nbsp;      throw new IllegalArgumentException(&quot;interval must be greater than 0&quot;);</b>
&nbsp;    }
<b class="nc">&nbsp;    upItem.setInterval(interval);</b>
<b class="nc">&nbsp;    downItem.setInterval(interval);</b>
<b class="nc">&nbsp;    this.interval = interval;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Returns the number of items in the scrolling portion of the menu.
&nbsp;   *
&nbsp;   * @return the number of items to display at a time
&nbsp;   */
&nbsp;  public int getscrollCount() {
<b class="nc">&nbsp;    return scrollCount;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Sets the number of items in the scrolling portion of the menu.
&nbsp;   * 
&nbsp;   * @param scrollCount the number of items to display at a time
&nbsp;   * @throws IllegalArgumentException if scrollCount is 0 or negative
&nbsp;   */
&nbsp;  public void setScrollCount(int scrollCount) {
<b class="nc">&nbsp;    if (scrollCount &lt;= 0) {</b>
<b class="nc">&nbsp;      throw new IllegalArgumentException(&quot;scrollCount must be greater than 0&quot;);</b>
&nbsp;    }
<b class="nc">&nbsp;    this.scrollCount = scrollCount;</b>
<b class="nc">&nbsp;    MenuSelectionManager.defaultManager().clearSelectedPath();</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Returns the number of items fixed at the top of the menu or popup menu.
&nbsp;   * 
&nbsp;   * @return the number of items
&nbsp;   */
&nbsp;  public int getTopFixedCount() {
<b class="nc">&nbsp;    return topFixedCount;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Sets the number of items to fix at the top of the menu or popup menu.
&nbsp;   * 
&nbsp;   * @param topFixedCount the number of items
&nbsp;   */
&nbsp;  public void setTopFixedCount(int topFixedCount) {
<b class="nc">&nbsp;    if (firstIndex &lt;= topFixedCount) {</b>
<b class="nc">&nbsp;      firstIndex = topFixedCount;</b>
&nbsp;    } else {
<b class="nc">&nbsp;      firstIndex += (topFixedCount - this.topFixedCount);</b>
&nbsp;    }
<b class="nc">&nbsp;    this.topFixedCount = topFixedCount;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Returns the number of items fixed at the bottom of the menu or popup menu.
&nbsp;   * 
&nbsp;   * @return the number of items
&nbsp;   */
&nbsp;  public int getBottomFixedCount() {
<b class="nc">&nbsp;    return bottomFixedCount;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Sets the number of items to fix at the bottom of the menu or popup menu.
&nbsp;   * 
&nbsp;   * @param bottomFixedCount the number of items
&nbsp;   */
&nbsp;  public void setBottomFixedCount(int bottomFixedCount) {
<b class="nc">&nbsp;    this.bottomFixedCount = bottomFixedCount;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Scrolls the specified item into view each time the menu is opened.  Call this method with
&nbsp;   * &lt;code&gt;null&lt;/code&gt; to restore the default behavior, which is to show the menu as it last
&nbsp;   * appeared.
&nbsp;   *
&nbsp;   * @param item the item to keep visible
&nbsp;   * @see #keepVisible(int)
&nbsp;   */
&nbsp;  public void keepVisible(JMenuItem item) {
<b class="nc">&nbsp;    if (item == null) {</b>
<b class="nc">&nbsp;      keepVisibleIndex = -1;</b>
&nbsp;    } else {
<b class="nc">&nbsp;      int index = menu.getComponentIndex(item);</b>
<b class="nc">&nbsp;      keepVisibleIndex = index;</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Scrolls the item at the specified index into view each time the menu is opened.  Call this
&nbsp;   * method with &lt;code&gt;-1&lt;/code&gt; to restore the default behavior, which is to show the menu as
&nbsp;   * it last appeared.
&nbsp;   *
&nbsp;   * @param index the index of the item to keep visible
&nbsp;   * @see #keepVisible(javax.swing.JMenuItem)
&nbsp;   */
&nbsp;  public void keepVisible(int index) {
<b class="nc">&nbsp;    keepVisibleIndex = index;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Removes this MenuScroller from the associated menu and restores the
&nbsp;   * default behavior of the menu.
&nbsp;   */
&nbsp;  public void dispose() {
<b class="nc">&nbsp;    if (menu != null) {</b>
<b class="nc">&nbsp;      menu.removePopupMenuListener(menuListener);</b>
<b class="nc">&nbsp;      menu = null;</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Ensures that the &lt;code&gt;dispose&lt;/code&gt; method of this MenuScroller is
&nbsp;   * called when there are no more refrences to it.
&nbsp;   * 
&nbsp;   * @exception  Throwable if an error occurs.
&nbsp;   * @see MenuScroller#dispose()
&nbsp;   */
&nbsp;  @Override
&nbsp;  public void finalize() throws Throwable {
<b class="nc">&nbsp;    dispose();</b>
&nbsp;  }
&nbsp;
&nbsp;  private void refreshMenu() {
<b class="nc">&nbsp;    if (menuItems != null &amp;&amp; menuItems.length &gt; 0) {</b>
<b class="nc">&nbsp;      firstIndex = Math.max(topFixedCount, firstIndex);</b>
<b class="nc">&nbsp;      firstIndex = Math.min(menuItems.length - bottomFixedCount - scrollCount, firstIndex);</b>
&nbsp;
<b class="nc">&nbsp;      upItem.setEnabled(firstIndex &gt; topFixedCount);</b>
<b class="nc">&nbsp;      downItem.setEnabled(firstIndex + scrollCount &lt; menuItems.length - bottomFixedCount);</b>
&nbsp;
<b class="nc">&nbsp;      menu.removeAll();</b>
<b class="nc">&nbsp;      for (int i = 0; i &lt; topFixedCount; i++) {</b>
<b class="nc">&nbsp;        menu.add(menuItems[i]);</b>
&nbsp;      }
<b class="nc">&nbsp;      if (topFixedCount &gt; 0) {</b>
<b class="nc">&nbsp;        menu.add(new JSeparator());</b>
&nbsp;      }
&nbsp;
<b class="nc">&nbsp;      menu.add(upItem);</b>
<b class="nc">&nbsp;      for (int i = firstIndex; i &lt; scrollCount + firstIndex; i++) {</b>
<b class="nc">&nbsp;        menu.add(menuItems[i]);</b>
&nbsp;      }
<b class="nc">&nbsp;      menu.add(downItem);</b>
&nbsp;
<b class="nc">&nbsp;      if (bottomFixedCount &gt; 0) {</b>
<b class="nc">&nbsp;        menu.add(new JSeparator());</b>
&nbsp;      }
<b class="nc">&nbsp;      for (int i = menuItems.length - bottomFixedCount; i &lt; menuItems.length; i++) {</b>
<b class="nc">&nbsp;        menu.add(menuItems[i]);</b>
&nbsp;      }
&nbsp;
<b class="nc">&nbsp;      JComponent parent = (JComponent) upItem.getParent();</b>
<b class="nc">&nbsp;      parent.revalidate();</b>
<b class="nc">&nbsp;      parent.repaint();</b>
&nbsp;    }
&nbsp;  }
&nbsp;
<b class="nc">&nbsp;  private class MenuScrollListener implements PopupMenuListener {</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void popupMenuWillBecomeVisible(PopupMenuEvent e) {
<b class="nc">&nbsp;      setMenuItems();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void popupMenuWillBecomeInvisible(PopupMenuEvent e) {
<b class="nc">&nbsp;      restoreMenuItems();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void popupMenuCanceled(PopupMenuEvent e) {
<b class="nc">&nbsp;      restoreMenuItems();</b>
&nbsp;    }
&nbsp;
&nbsp;    private void setMenuItems() {
<b class="nc">&nbsp;      menuItems = menu.getComponents();</b>
<b class="nc">&nbsp;      if (keepVisibleIndex &gt;= topFixedCount</b>
<b class="nc">&nbsp;              &amp;&amp; keepVisibleIndex &lt;= menuItems.length - bottomFixedCount</b>
<b class="nc">&nbsp;              &amp;&amp; (keepVisibleIndex &gt; firstIndex + scrollCount</b>
<b class="nc">&nbsp;              || keepVisibleIndex &lt; firstIndex)) {</b>
<b class="nc">&nbsp;        firstIndex = Math.min(firstIndex, keepVisibleIndex);</b>
<b class="nc">&nbsp;        firstIndex = Math.max(firstIndex, keepVisibleIndex - scrollCount + 1);</b>
&nbsp;      }
<b class="nc">&nbsp;      if (menuItems.length &gt; topFixedCount + scrollCount + bottomFixedCount) {</b>
<b class="nc">&nbsp;        refreshMenu();</b>
&nbsp;      }
&nbsp;    }
&nbsp;
&nbsp;    private void restoreMenuItems() {
<b class="nc">&nbsp;      menu.removeAll();</b>
<b class="nc">&nbsp;      for (Component component : menuItems) {</b>
<b class="nc">&nbsp;        menu.add(component);</b>
&nbsp;      }
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  private class MenuScrollTimer extends Timer {
&nbsp;
&nbsp;    /**
&nbsp;	 * 
&nbsp;	 */
&nbsp;	private static final long serialVersionUID = -4822787859347179973L;
&nbsp;
<b class="nc">&nbsp;	public MenuScrollTimer(final int increment, int interval) {</b>
<b class="nc">&nbsp;      super(interval, new ActionListener() {</b>
&nbsp;
&nbsp;        @Override
&nbsp;        public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;          firstIndex += increment;</b>
<b class="nc">&nbsp;          refreshMenu();</b>
&nbsp;        }
&nbsp;      });
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  private class MenuScrollItem extends JMenuItem
&nbsp;          implements ChangeListener {
&nbsp;
&nbsp;    /**
&nbsp;	 * 
&nbsp;	 */
&nbsp;	private static final long serialVersionUID = -3219754555835929469L;
&nbsp;	private MenuScrollTimer timer;
&nbsp;
<b class="nc">&nbsp;    public MenuScrollItem(MenuIcon icon, int increment) {</b>
<b class="nc">&nbsp;      setIcon(icon);</b>
<b class="nc">&nbsp;      setDisabledIcon(icon);</b>
<b class="nc">&nbsp;      timer = new MenuScrollTimer(increment, interval);</b>
<b class="nc">&nbsp;      addChangeListener(this);</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setInterval(int interval) {
<b class="nc">&nbsp;      timer.setDelay(interval);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void stateChanged(ChangeEvent e) {
<b class="nc">&nbsp;      if (isArmed() &amp;&amp; !timer.isRunning()) {</b>
<b class="nc">&nbsp;        timer.start();</b>
&nbsp;      }
<b class="nc">&nbsp;      if (!isArmed() &amp;&amp; timer.isRunning()) {</b>
<b class="nc">&nbsp;        timer.stop();</b>
&nbsp;      }
&nbsp;    }
&nbsp;  }
&nbsp;
<b class="nc">&nbsp;  private static enum MenuIcon implements Icon {</b>
&nbsp;
<b class="nc">&nbsp;    UP(9, 1, 9),</b>
<b class="nc">&nbsp;    DOWN(1, 9, 1);</b>
<b class="nc">&nbsp;    final int[] xPoints = {1, 5, 9};</b>
&nbsp;    final int[] yPoints;
&nbsp;
<b class="nc">&nbsp;    MenuIcon(int... yPoints) {</b>
<b class="nc">&nbsp;      this.yPoints = yPoints;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void paintIcon(Component c, Graphics g, int x, int y) {
<b class="nc">&nbsp;      Dimension size = c.getSize();</b>
<b class="nc">&nbsp;      Graphics g2 = g.create(size.width / 2 - 5, size.height / 2 - 5, 10, 10);</b>
<b class="nc">&nbsp;      g2.setColor(UIManager.getColor(&quot;MenuItem.disabledForeground&quot;));</b>
<b class="nc">&nbsp;      g2.drawPolygon(xPoints, yPoints, 3);</b>
<b class="nc">&nbsp;      if (c.isEnabled()) {</b>
<b class="nc">&nbsp;        g2.setColor(UIManager.getColor(&quot;MenuItem.foreground&quot;));</b>
<b class="nc">&nbsp;        g2.fillPolygon(xPoints, yPoints, 3);</b>
&nbsp;      }
<b class="nc">&nbsp;      g2.dispose();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getIconWidth() {
<b class="nc">&nbsp;      return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public int getIconHeight() {
<b class="nc">&nbsp;      return 10;</b>
&nbsp;    }
&nbsp;  }
&nbsp;  
&nbsp;  /**
&nbsp;   * Take any given memu object and turn on scrollbars if it contains more than 20 items.
&nbsp;   * Then, cycle through all submenus recursively.
&nbsp;   * 
&nbsp;   * @param menu
&nbsp;   */
&nbsp;  public static void createScrollBarsOnMenus(JMenu menu) {
<b class="nc">&nbsp;      if (menu.getMenuComponentCount() &gt; 20) {</b>
<b class="nc">&nbsp;          MenuScroller.setScrollerFor(menu, 20);</b>
&nbsp;      }
<b class="nc">&nbsp;      for (int i = 0; i &lt; menu.getMenuComponentCount(); i++) {</b>
<b class="nc">&nbsp;          if (menu.getMenuComponent(i) instanceof JMenu) {</b>
<b class="nc">&nbsp;              MenuScroller.createScrollBarsOnMenus(((JMenu)menu.getMenuComponent(i)));</b>
&nbsp;          }
&nbsp;      }
&nbsp;  }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
