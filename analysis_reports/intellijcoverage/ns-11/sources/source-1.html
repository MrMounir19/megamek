


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > SkinEditorMainGUI</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing.skinEditor</a>
</div>

<h1>Coverage Summary for Class: SkinEditorMainGUI (megamek.client.ui.swing.skinEditor)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SkinEditorMainGUI</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/42)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/405)
  </span>
</td>
</tr>
  <tr>
    <td class="name">SkinEditorMainGUI$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SkinEditorMainGUI$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/45)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/410)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2000,2001,2002,2003,2004,2006 Ben Mazur (bmazur@sev.org)
&nbsp; * Copyright © 2015 Nicholas Walczak (walczak@cs.umn.edu)
&nbsp; *
&nbsp; * This program is free software; you can redistribute it and/or modify it
&nbsp; * under the terms of the GNU General Public License as published by the Free
&nbsp; * Software Foundation; either version 2 of the License, or (at your option)
&nbsp; * any later version.
&nbsp; *
&nbsp; * This program is distributed in the hope that it will be useful, but
&nbsp; * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; * for more details.
&nbsp; */
&nbsp;package megamek.client.ui.swing.skinEditor;
&nbsp;
&nbsp;import java.awt.BorderLayout;
&nbsp;import java.awt.CardLayout;
&nbsp;import java.awt.Component;
&nbsp;import java.awt.Dimension;
&nbsp;import java.awt.Frame;
&nbsp;import java.awt.GraphicsConfiguration;
&nbsp;import java.awt.GraphicsDevice;
&nbsp;import java.awt.GraphicsEnvironment;
&nbsp;import java.awt.Image;
&nbsp;import java.awt.Rectangle;
&nbsp;import java.awt.SystemColor;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.awt.event.ComponentEvent;
&nbsp;import java.awt.event.ComponentListener;
&nbsp;import java.awt.event.WindowAdapter;
&nbsp;import java.awt.event.WindowEvent;
&nbsp;import java.awt.event.WindowListener;
&nbsp;import java.io.IOException;
&nbsp;import java.util.*;
&nbsp;
&nbsp;import javax.swing.ImageIcon;
&nbsp;import javax.swing.JComponent;
&nbsp;import javax.swing.JDialog;
&nbsp;import javax.swing.JFrame;
&nbsp;import javax.swing.JLabel;
&nbsp;import javax.swing.JOptionPane;
&nbsp;import javax.swing.JPanel;
&nbsp;import javax.swing.JScrollPane;
&nbsp;import javax.swing.JTextPane;
&nbsp;import javax.swing.ScrollPaneConstants;
&nbsp;
&nbsp;import megamek.client.TimerSingleton;
&nbsp;import megamek.client.event.BoardViewEvent;
&nbsp;import megamek.client.event.BoardViewListener;
&nbsp;import megamek.client.ui.IBoardView;
&nbsp;import megamek.client.ui.Messages;
&nbsp;import megamek.client.ui.swing.ChatLounge;
&nbsp;import megamek.client.ui.swing.ChoiceDialog;
&nbsp;import megamek.client.ui.swing.CommonMenuBar;
&nbsp;import megamek.client.ui.swing.ConfirmDialog;
&nbsp;import megamek.client.ui.swing.DeployMinefieldDisplay;
&nbsp;import megamek.client.ui.swing.DeploymentDisplay;
&nbsp;import megamek.client.ui.swing.FiringDisplay;
&nbsp;import megamek.client.ui.swing.GUIPreferences;
&nbsp;import megamek.client.ui.swing.MovementDisplay;
&nbsp;import megamek.client.ui.swing.PhysicalDisplay;
&nbsp;import megamek.client.ui.swing.ReportDisplay;
&nbsp;import megamek.client.ui.swing.SelectArtyAutoHitHexDisplay;
&nbsp;import megamek.client.ui.swing.StatusBarPhaseDisplay;
&nbsp;import megamek.client.ui.swing.TargetingPhaseDisplay;
&nbsp;import megamek.client.ui.swing.UnitLoadingDialog;
&nbsp;import megamek.client.ui.swing.boardview.BoardView1;
&nbsp;import megamek.client.ui.swing.unitDisplay.UnitDisplay;
&nbsp;import megamek.common.Configuration;
&nbsp;import megamek.common.Coords;
&nbsp;import megamek.common.Entity;
&nbsp;import megamek.common.Game;
&nbsp;import megamek.common.IGame;
&nbsp;import megamek.common.IPlayer;
&nbsp;import megamek.common.MechFileParser;
&nbsp;import megamek.common.MechSummary;
&nbsp;import megamek.common.MechSummaryCache;
&nbsp;import megamek.common.icons.Camouflage;
&nbsp;import megamek.common.loaders.EntityLoadingException;
&nbsp;import megamek.common.util.Distractable;
&nbsp;import megamek.common.util.fileUtils.MegaMekFile;
&nbsp;
<b class="nc">&nbsp;public class SkinEditorMainGUI extends JPanel implements WindowListener, BoardViewListener,</b>
&nbsp;        ActionListener, ComponentListener {
&nbsp;    private static final long serialVersionUID = 5625499617779156289L;
&nbsp;
&nbsp;    private static final String FILENAME_ICON_16X16 = &quot;megamek-icon-16x16.png&quot;;
&nbsp;    private static final String FILENAME_ICON_32X32 = &quot;megamek-icon-32x32.png&quot;;
&nbsp;    private static final String FILENAME_ICON_48X48 = &quot;megamek-icon-48x48.png&quot;;
&nbsp;    private static final String FILENAME_ICON_256X256 = &quot;megamek-icon-256x256.png&quot;;
&nbsp;
&nbsp;    // a frame, to show stuff in
&nbsp;    private JFrame frame;
&nbsp;
&nbsp;    // A menu bar to contain all actions.
&nbsp;    protected CommonMenuBar menuBar;
&nbsp;
&nbsp;    private BoardView1 bv;
&nbsp;    private Component bvc;
&nbsp;    private JDialog skinSpecEditorD;
&nbsp;    private SkinSpecEditor skinSpecEditor;
&nbsp;
&nbsp;    public JDialog mechW;
&nbsp;    public UnitDisplay unitDisplay;
&nbsp;
&nbsp;    protected JComponent curPanel;
&nbsp;    private ChatLounge chatlounge;
&nbsp;
&nbsp;    /**
&nbsp;     * Test entity to display in UnitDisplay.
&nbsp;     */
&nbsp;    private Entity testEntity;
&nbsp;
&nbsp;    /**
&nbsp;     * Map each phase to the name of the card for the main display area.
&nbsp;     */
<b class="nc">&nbsp;    private HashMap&lt;String, String&gt; mainNames = new HashMap&lt;&gt;();</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The &lt;code&gt;JPanel&lt;/code&gt; containing the main display area.
&nbsp;     */
<b class="nc">&nbsp;    private JPanel panMain = new JPanel();</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The &lt;code&gt;CardLayout&lt;/code&gt; of the main display area.
&nbsp;     */
<b class="nc">&nbsp;    private CardLayout cardsMain = new CardLayout();</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Map each phase to the name of the card for the secondary area.
&nbsp;     */
<b class="nc">&nbsp;    private HashMap&lt;String, String&gt; secondaryNames = new HashMap&lt;&gt;();</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The &lt;code&gt;JPanel&lt;/code&gt; containing the secondary display area.
&nbsp;     */
<b class="nc">&nbsp;    private JPanel panSecondary = new JPanel();</b>
&nbsp;
&nbsp;    private StatusBarPhaseDisplay currPhaseDisplay;
&nbsp;
&nbsp;    /**
&nbsp;     * The &lt;code&gt;CardLayout&lt;/code&gt; of the secondary display area.
&nbsp;     */
<b class="nc">&nbsp;    private CardLayout cardsSecondary = new CardLayout();</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Map phase component names to phase component objects.
&nbsp;     */
<b class="nc">&nbsp;    HashMap&lt;String, JComponent&gt; phaseComponents = new HashMap&lt;&gt;();</b>
&nbsp;
&nbsp;    public SkinEditorMainGUI() {
<b class="nc">&nbsp;        super(new BorderLayout());</b>
<b class="nc">&nbsp;        this.addComponentListener(this);</b>
&nbsp;
<b class="nc">&nbsp;        panMain.setLayout(cardsMain);</b>
<b class="nc">&nbsp;        panSecondary.setLayout(cardsSecondary);</b>
<b class="nc">&nbsp;        JPanel panDisplay = new JPanel(new BorderLayout());</b>
<b class="nc">&nbsp;        panDisplay.add(panMain, BorderLayout.CENTER);</b>
<b class="nc">&nbsp;        panDisplay.add(panSecondary, BorderLayout.SOUTH);</b>
<b class="nc">&nbsp;        add(panDisplay, BorderLayout.CENTER);</b>
&nbsp;
<b class="nc">&nbsp;        UnitLoadingDialog unitLoadingDialog = new UnitLoadingDialog(frame);</b>
<b class="nc">&nbsp;        if (!MechSummaryCache.getInstance().isInitialized()) {</b>
<b class="nc">&nbsp;            unitLoadingDialog.setVisible(true);</b>
&nbsp;        }
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            MechSummary ms = MechSummaryCache.getInstance().getMech(</b>
&nbsp;                    &quot;Archer ARC-2W&quot;);
<b class="nc">&nbsp;            testEntity = new MechFileParser(ms.getSourceFile(),</b>
<b class="nc">&nbsp;                    ms.getEntryName()).getEntity();</b>
<b class="nc">&nbsp;        } catch (EntityLoadingException e) {</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    public IBoardView getBoardView() {
<b class="nc">&nbsp;        return bv;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Initializes a number of things about this frame.
&nbsp;     */
&nbsp;    private void initializeFrame() {
<b class="nc">&nbsp;        frame = new JFrame(Messages.getString(&quot;ClientGUI.title&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        frame.setJMenuBar(menuBar);</b>
<b class="nc">&nbsp;        Rectangle virtualBounds = getVirtualBounds();</b>
&nbsp;        int x, y, w, h;
<b class="nc">&nbsp;        if (GUIPreferences.getInstance().getWindowSizeHeight() != 0) {</b>
<b class="nc">&nbsp;            x = GUIPreferences.getInstance().getWindowPosX();</b>
<b class="nc">&nbsp;            y = GUIPreferences.getInstance().getWindowPosY();</b>
<b class="nc">&nbsp;            w = GUIPreferences.getInstance().getWindowSizeWidth();</b>
<b class="nc">&nbsp;            h = GUIPreferences.getInstance().getWindowSizeHeight();</b>
<b class="nc">&nbsp;            if ((x &lt; virtualBounds.getMinX())</b>
<b class="nc">&nbsp;                    || ((x + w) &gt; virtualBounds.getMaxX())) {</b>
<b class="nc">&nbsp;                x = 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((y &lt; virtualBounds.getMinY())</b>
<b class="nc">&nbsp;                    || ((y + h) &gt; virtualBounds.getMaxY())) {</b>
<b class="nc">&nbsp;                y = 0;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (w &gt; virtualBounds.getWidth()) {</b>
<b class="nc">&nbsp;                w = (int) virtualBounds.getWidth();</b>
&nbsp;            }
<b class="nc">&nbsp;            if (h &gt; virtualBounds.getHeight()) {</b>
<b class="nc">&nbsp;                h = (int) virtualBounds.getHeight();</b>
&nbsp;            }
<b class="nc">&nbsp;            frame.setLocation(x, y);</b>
<b class="nc">&nbsp;            frame.setSize(w, h);</b>
&nbsp;        } else {
<b class="nc">&nbsp;            frame.setSize(800, 600);</b>
&nbsp;        }
<b class="nc">&nbsp;        frame.setMinimumSize(new Dimension(640, 480));</b>
<b class="nc">&nbsp;        frame.setBackground(SystemColor.menu);</b>
<b class="nc">&nbsp;        frame.setForeground(SystemColor.menuText);</b>
<b class="nc">&nbsp;        List&lt;Image&gt; iconList = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_16X16)</b>
<b class="nc">&nbsp;                        .toString()));</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_32X32)</b>
<b class="nc">&nbsp;                        .toString()));</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_48X48)</b>
<b class="nc">&nbsp;                        .toString()));</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_256X256)</b>
<b class="nc">&nbsp;                        .toString()));</b>
<b class="nc">&nbsp;        frame.setIconImages(iconList);</b>
&nbsp;
<b class="nc">&nbsp;        mechW = new JDialog(frame, Messages.getString(&quot;ClientGUI.MechDisplay&quot;), false);</b>
<b class="nc">&nbsp;        x = GUIPreferences.getInstance().getDisplayPosX();</b>
<b class="nc">&nbsp;        y = GUIPreferences.getInstance().getDisplayPosY();</b>
<b class="nc">&nbsp;        h = GUIPreferences.getInstance().getDisplaySizeHeight();</b>
<b class="nc">&nbsp;        w = GUIPreferences.getInstance().getDisplaySizeWidth();</b>
<b class="nc">&nbsp;        if ((x + w) &gt; virtualBounds.getWidth()) {</b>
<b class="nc">&nbsp;            x = 0;</b>
<b class="nc">&nbsp;            w = Math.min(w, (int)virtualBounds.getWidth());</b>
&nbsp;        }
<b class="nc">&nbsp;        if ((y + h) &gt; virtualBounds.getHeight()) {</b>
<b class="nc">&nbsp;            y = 0;</b>
<b class="nc">&nbsp;            h = Math.min(h, (int)virtualBounds.getHeight());</b>
&nbsp;        }
<b class="nc">&nbsp;        mechW.setLocation(x, y);</b>
<b class="nc">&nbsp;        mechW.setSize(w, h);</b>
<b class="nc">&nbsp;        mechW.setResizable(true);</b>
<b class="nc">&nbsp;        unitDisplay = new UnitDisplay(null);</b>
<b class="nc">&nbsp;        mechW.add(unitDisplay);</b>
<b class="nc">&nbsp;        mechW.setVisible(true);</b>
<b class="nc">&nbsp;        unitDisplay.displayEntity(testEntity);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Lays out the frame by setting this Client object to take up the full
&nbsp;     * frame display area.
&nbsp;     */
&nbsp;    private void layoutFrame() {
<b class="nc">&nbsp;        frame.setTitle(Messages.getString(&quot;MegaMek.SkinEditor.label&quot;) //$NON-NLS-1$</b>
<b class="nc">&nbsp;                + Messages.getString(&quot;ClientGUI.clientTitleSuffix&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        frame.getContentPane().setLayout(new BorderLayout());</b>
<b class="nc">&nbsp;        frame.getContentPane().add(this, BorderLayout.CENTER);</b>
<b class="nc">&nbsp;        frame.validate();</b>
&nbsp;    }
&nbsp;
&nbsp;    public void updateBorder() {
<b class="nc">&nbsp;        phaseComponents.clear();</b>
<b class="nc">&nbsp;        panMain.removeAll();</b>
<b class="nc">&nbsp;        panSecondary.removeAll();</b>
<b class="nc">&nbsp;        mainNames.clear();</b>
<b class="nc">&nbsp;        secondaryNames.clear();</b>
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            bv = new BoardView1(new Game(), null, null);</b>
<b class="nc">&nbsp;            bv.setPreferredSize(getSize());</b>
<b class="nc">&nbsp;            bvc = bv.getComponent();</b>
<b class="nc">&nbsp;            bvc.setName(&quot;BoardView&quot;);</b>
<b class="nc">&nbsp;        } catch (IOException e) {</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;            doAlertDialog(Messages.getString(&quot;ClientGUI.FatalError.title&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;ClientGUI.FatalError.message&quot;) + e); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            die();</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        switchPanel(IGame.Phase.PHASE_MOVEMENT);</b>
<b class="nc">&nbsp;        frame.validate();</b>
&nbsp;
&nbsp;        // This is a horrible hack
&nbsp;        // Essentially, UnitDisplay (I think specifically ArmorPanel), relies
&nbsp;        // upon addNotify being called, so I need to way to set the
&nbsp;        // isDisplayable state to true.  However, if I create a new JDialog, or
&nbsp;        // called JDialog.setVisible(true), focus will get stolen from the
&nbsp;        // Skin Spec Editor, which causes undesirable behavior, particularly
&nbsp;        // with the path JTextFields
<b class="nc">&nbsp;        Dimension sz = mechW.getSize();</b>
<b class="nc">&nbsp;        mechW.remove(unitDisplay);</b>
&nbsp;        // UnitDisplay has no way to update the skin without being recreated
<b class="nc">&nbsp;        unitDisplay = new UnitDisplay(null);</b>
<b class="nc">&nbsp;        mechW.add(unitDisplay);</b>
<b class="nc">&nbsp;        if (mechW.isVisible()) {</b>
&nbsp;            // This will cause the isDisplayable state to be true, in effect
&nbsp;            // ensuring addNotify has been called.
<b class="nc">&nbsp;            mechW.pack();</b>
&nbsp;        } else {
<b class="nc">&nbsp;            mechW.setVisible(true);</b>
&nbsp;        }
&nbsp;        // Packing is going to change the dimensions, so we&#39;ll restore old sz
<b class="nc">&nbsp;        mechW.setSize(sz);</b>
<b class="nc">&nbsp;        unitDisplay.displayEntity(testEntity);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Have the client register itself as a listener wherever it&#39;s needed.
&nbsp;     * &lt;p/&gt;
&nbsp;     * According to
&nbsp;     * http://www-106.ibm.com/developerworks/java/library/j-jtp0618.html it is a
&nbsp;     * major bad no-no to perform these registrations before the constructor
&nbsp;     * finishes, so this function has to be called after the &lt;code&gt;Client&lt;/code&gt;
&nbsp;     * is created.
&nbsp;     */
&nbsp;    public void initialize() {
<b class="nc">&nbsp;        phaseComponents.clear();</b>
<b class="nc">&nbsp;        panMain.removeAll();</b>
<b class="nc">&nbsp;        panSecondary.removeAll();</b>
<b class="nc">&nbsp;        mainNames.clear();</b>
<b class="nc">&nbsp;        secondaryNames.clear();</b>
<b class="nc">&nbsp;        menuBar = new CommonMenuBar(null);</b>
<b class="nc">&nbsp;        initializeFrame();</b>
&nbsp;        try {
&nbsp;            // Create the board viewer.
<b class="nc">&nbsp;            bv = new BoardView1(new Game(), null, null);</b>
<b class="nc">&nbsp;            bv.setPreferredSize(getSize());</b>
<b class="nc">&nbsp;            bvc = bv.getComponent();</b>
<b class="nc">&nbsp;            bvc.setName(&quot;BoardView&quot;);</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;            doAlertDialog(Messages.getString(&quot;ClientGUI.FatalError.title&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;ClientGUI.FatalError.message&quot;) + e); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            die();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        layoutFrame();</b>
<b class="nc">&nbsp;        menuBar.addActionListener(this);</b>
<b class="nc">&nbsp;        frame.addWindowListener(new WindowAdapter() {</b>
&nbsp;            @Override
&nbsp;            public void windowClosing(WindowEvent e) {
<b class="nc">&nbsp;                frame.setVisible(false);</b>
<b class="nc">&nbsp;                saveSettings();</b>
<b class="nc">&nbsp;                die();</b>
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        GraphicsDevice gd = GraphicsEnvironment.getLocalGraphicsEnvironment()</b>
<b class="nc">&nbsp;                .getDefaultScreenDevice();</b>
&nbsp;        int x;
&nbsp;        int y;
&nbsp;        int h;
&nbsp;        int w;
<b class="nc">&nbsp;        skinSpecEditorD = new JDialog(frame,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.SkinEditorDialog.Title&quot;), false); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        x = GUIPreferences.getInstance().getDisplayPosX();</b>
<b class="nc">&nbsp;        y = GUIPreferences.getInstance().getDisplayPosY();</b>
<b class="nc">&nbsp;        h = 480;</b>
<b class="nc">&nbsp;        w = 640;</b>
<b class="nc">&nbsp;        if ((x + w) &gt; gd.getDisplayMode().getWidth()) {</b>
<b class="nc">&nbsp;            x = 0;</b>
<b class="nc">&nbsp;            w = Math.min(w, gd.getDisplayMode().getWidth());</b>
&nbsp;        }
<b class="nc">&nbsp;        if ((y + h) &gt; gd.getDisplayMode().getHeight()) {</b>
<b class="nc">&nbsp;            y = 0;</b>
<b class="nc">&nbsp;            h = Math.min(h, gd.getDisplayMode().getHeight());</b>
&nbsp;        }
<b class="nc">&nbsp;        skinSpecEditorD.setLocation(x, y);</b>
<b class="nc">&nbsp;        skinSpecEditorD.setSize(w, h);</b>
<b class="nc">&nbsp;        skinSpecEditorD.setResizable(true);</b>
<b class="nc">&nbsp;        skinSpecEditorD.addWindowListener(this);</b>
<b class="nc">&nbsp;        skinSpecEditor = new SkinSpecEditor(this);</b>
<b class="nc">&nbsp;        skinSpecEditorD.add(skinSpecEditor);</b>
<b class="nc">&nbsp;        skinSpecEditorD.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;        x = GUIPreferences.getInstance().getDisplayPosX();</b>
<b class="nc">&nbsp;        y = GUIPreferences.getInstance().getDisplayPosY();</b>
<b class="nc">&nbsp;        h = GUIPreferences.getInstance().getDisplaySizeHeight();</b>
<b class="nc">&nbsp;        w = GUIPreferences.getInstance().getDisplaySizeWidth();</b>
<b class="nc">&nbsp;        if ((x + w) &gt; gd.getDisplayMode().getWidth()) {</b>
<b class="nc">&nbsp;            x = 0;</b>
<b class="nc">&nbsp;            w = Math.min(w, gd.getDisplayMode().getWidth());</b>
&nbsp;        }
<b class="nc">&nbsp;        if ((y + h) &gt; gd.getDisplayMode().getHeight()) {</b>
<b class="nc">&nbsp;            y = 0;</b>
<b class="nc">&nbsp;            h = Math.min(h, gd.getDisplayMode().getHeight());</b>
&nbsp;        }
<b class="nc">&nbsp;        frame.pack();</b>
<b class="nc">&nbsp;        frame.setVisible(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Get the menu bar for this client.
&nbsp;     *
&nbsp;     * @return the &lt;code&gt;CommonMenuBar&lt;/code&gt; of this client.
&nbsp;     */
&nbsp;    public CommonMenuBar getMenuBar() {
<b class="nc">&nbsp;        return menuBar;</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Implement the &lt;code&gt;ActionListener&lt;/code&gt; interface.
&nbsp;     */
&nbsp;    public void actionPerformed(ActionEvent event) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Saves the current settings to the cfg file.
&nbsp;     */
&nbsp;    void saveSettings() {
&nbsp;        // save frame location
<b class="nc">&nbsp;        GUIPreferences.getInstance().setWindowPosX(frame.getLocation().x);</b>
<b class="nc">&nbsp;        GUIPreferences.getInstance().setWindowPosY(frame.getLocation().y);</b>
<b class="nc">&nbsp;        GUIPreferences.getInstance().setWindowSizeWidth(frame.getSize().width);</b>
<b class="nc">&nbsp;        GUIPreferences.getInstance().setWindowSizeHeight(frame.getSize().height);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Shuts down threads and sockets
&nbsp;     */
&nbsp;    void die() {
&nbsp;        // Tell all the displays to remove themselves as listeners.
<b class="nc">&nbsp;        boolean reportHandled = false;</b>
<b class="nc">&nbsp;        if (bv != null) {</b>
&nbsp;            //cleanup our timers first
<b class="nc">&nbsp;            bv.die();</b>
&nbsp;        }
<b class="nc">&nbsp;        Iterator&lt;String&gt; names = phaseComponents.keySet().iterator();</b>
<b class="nc">&nbsp;        while (names.hasNext()) {</b>
<b class="nc">&nbsp;            JComponent component = phaseComponents.get(names.next());</b>
<b class="nc">&nbsp;            if (component instanceof ReportDisplay) {</b>
<b class="nc">&nbsp;                if (reportHandled) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                reportHandled = true;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (component instanceof Distractable) {</b>
<b class="nc">&nbsp;                ((Distractable) component).removeAllListeners();</b>
&nbsp;            }
<b class="nc">&nbsp;        } // Handle the next component</b>
<b class="nc">&nbsp;        frame.removeAll();</b>
<b class="nc">&nbsp;        frame.setVisible(false);</b>
&nbsp;        try {
<b class="nc">&nbsp;            frame.dispose();</b>
<b class="nc">&nbsp;        } catch (Throwable error) {</b>
<b class="nc">&nbsp;            error.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // This is required because the ChatLounge adds the listener to the
&nbsp;        // MechSummaryCache that must be removed explicitly.
<b class="nc">&nbsp;        if (chatlounge != null) {</b>
<b class="nc">&nbsp;            chatlounge.die();</b>
&nbsp;        }
<b class="nc">&nbsp;        TimerSingleton.getInstance().killTimer();</b>
&nbsp;
<b class="nc">&nbsp;        if (menuBar != null) {</b>
<b class="nc">&nbsp;            menuBar.die();</b>
<b class="nc">&nbsp;            menuBar = null;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public void switchPanel(IGame.Phase phase) {
&nbsp;        // Clear the old panel&#39;s listeners.
<b class="nc">&nbsp;        if (curPanel instanceof BoardViewListener) {</b>
<b class="nc">&nbsp;            bv.removeBoardViewListener((BoardViewListener) curPanel);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (curPanel instanceof ActionListener) {</b>
<b class="nc">&nbsp;            menuBar.removeActionListener((ActionListener) curPanel);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (curPanel instanceof Distractable) {</b>
<b class="nc">&nbsp;            ((Distractable) curPanel).setIgnoringEvents(true);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Get the new panel.
<b class="nc">&nbsp;        String name = String.valueOf(phase);</b>
<b class="nc">&nbsp;        curPanel = phaseComponents.get(name);</b>
<b class="nc">&nbsp;        if (curPanel == null) {</b>
<b class="nc">&nbsp;            curPanel = initializePanel(phase);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Handle phase-specific items.
<b class="nc">&nbsp;        switch (phase) {</b>
&nbsp;            case PHASE_LOUNGE:
&nbsp;                // reset old report tabs and images, if any
<b class="nc">&nbsp;                ReportDisplay rD = (ReportDisplay) phaseComponents.get(String</b>
<b class="nc">&nbsp;                        .valueOf(IGame.Phase.PHASE_INITIATIVE_REPORT));</b>
<b class="nc">&nbsp;                if (rD != null) {</b>
<b class="nc">&nbsp;                    rD.resetTabs();</b>
&nbsp;                }
&nbsp;                //ChatLounge cl = (ChatLounge) phaseComponents.get(
&nbsp;                //        String.valueOf(IGame.Phase.PHASE_LOUNGE));
&nbsp;                //cb.setDoneButton(cl.butDone);
&nbsp;                //cl.add(cb.getComponent(), BorderLayout.SOUTH);
<b class="nc">&nbsp;                getBoardView().getTilesetManager().reset();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_DEPLOY_MINEFIELDS:
&nbsp;            case PHASE_DEPLOYMENT:
&nbsp;            case PHASE_TARGETING:
&nbsp;            case PHASE_MOVEMENT:
&nbsp;            case PHASE_OFFBOARD:
&nbsp;            case PHASE_FIRING:
&nbsp;            case PHASE_PHYSICAL:
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_INITIATIVE_REPORT:
&nbsp;            case PHASE_TARGETING_REPORT:
&nbsp;            case PHASE_MOVEMENT_REPORT:
&nbsp;            case PHASE_OFFBOARD_REPORT:
&nbsp;            case PHASE_FIRING_REPORT:
&nbsp;            case PHASE_PHYSICAL_REPORT:
&nbsp;            case PHASE_END_REPORT:
&nbsp;            case PHASE_VICTORY:
<b class="nc">&nbsp;                rD = (ReportDisplay) phaseComponents.get(String</b>
<b class="nc">&nbsp;                        .valueOf(IGame.Phase.PHASE_INITIATIVE_REPORT));</b>
&nbsp;                //cb.setDoneButton(rD.butDone);
&nbsp;                //rD.add(cb.getComponent(), GBC.eol().fill(
&nbsp;                //        GridBagConstraints.HORIZONTAL));
<b class="nc">&nbsp;                break;</b>
&nbsp;            default:
&nbsp;                break;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        cardsMain.show(panMain, mainNames.get(name));</b>
<b class="nc">&nbsp;        String secondaryToShow = secondaryNames.get(name);</b>
&nbsp;        // only show the secondary component if there is one to show
<b class="nc">&nbsp;        if (secondaryToShow != null) {</b>
<b class="nc">&nbsp;            panSecondary.setVisible(true);</b>
<b class="nc">&nbsp;            cardsSecondary.show(panSecondary, secondaryNames.get(name));</b>
&nbsp;        } else {
&nbsp;            // otherwise, hide the panel
<b class="nc">&nbsp;            panSecondary.setVisible(false);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Set the new panel&#39;s listeners
<b class="nc">&nbsp;        if (curPanel instanceof BoardViewListener) {</b>
<b class="nc">&nbsp;            bv.addBoardViewListener((BoardViewListener) curPanel);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (curPanel instanceof ActionListener) {</b>
<b class="nc">&nbsp;            menuBar.addActionListener((ActionListener) curPanel);</b>
&nbsp;        }
<b class="nc">&nbsp;        if (curPanel instanceof Distractable) {</b>
<b class="nc">&nbsp;            ((Distractable) curPanel).setIgnoringEvents(false);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Make the new panel the focus, if the Client option says so
<b class="nc">&nbsp;        if (GUIPreferences.getInstance().getFocus() ) {</b>
<b class="nc">&nbsp;            curPanel.requestFocus();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public void updateButtonPanel(IGame.Phase phase) {
<b class="nc">&nbsp;        if ((currPhaseDisplay != null)) {</b>
<b class="nc">&nbsp;            currPhaseDisplay.setupButtonPanel();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private JComponent initializePanel(IGame.Phase phase) {
&nbsp;        // Create the components for this phase.
<b class="nc">&nbsp;        String name = String.valueOf(phase);</b>
&nbsp;        JComponent component;
<b class="nc">&nbsp;        String secondary = null;</b>
&nbsp;        String main;
<b class="nc">&nbsp;        switch (phase) {</b>
&nbsp;            case PHASE_LOUNGE:
<b class="nc">&nbsp;                component = new ChatLounge(null);</b>
<b class="nc">&nbsp;                chatlounge = (ChatLounge) component;</b>
<b class="nc">&nbsp;                main = &quot;ChatLounge&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(main);</b>
<b class="nc">&nbsp;                panMain.add(component, main);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_STARTING_SCENARIO:
<b class="nc">&nbsp;                component = new JLabel(</b>
<b class="nc">&nbsp;                        Messages.getString(&quot;ClientGUI.StartingScenario&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;                main = &quot;JLabel-StartingScenario&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(main);</b>
<b class="nc">&nbsp;                panMain.add(component, main);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_EXCHANGE:
<b class="nc">&nbsp;                component = new JLabel(</b>
<b class="nc">&nbsp;                        Messages.getString(&quot;ClientGUI.TransmittingData&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;                main = &quot;JLabel-Exchange&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(main);</b>
<b class="nc">&nbsp;                panMain.add(component, main);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_SET_ARTYAUTOHITHEXES:
<b class="nc">&nbsp;                component = new SelectArtyAutoHitHexDisplay(null);</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;SelectArtyAutoHitHexDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_DEPLOY_MINEFIELDS:
<b class="nc">&nbsp;                component = new DeployMinefieldDisplay(null);</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;DeployMinefieldDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_DEPLOYMENT:
<b class="nc">&nbsp;                component = new DeploymentDisplay(null);</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;DeploymentDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_TARGETING:
<b class="nc">&nbsp;                component = new TargetingPhaseDisplay(null, false);</b>
<b class="nc">&nbsp;                ((TargetingPhaseDisplay) component).initializeListeners();</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;TargetingPhaseDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_MOVEMENT:
<b class="nc">&nbsp;                component = new MovementDisplay(null);</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;MovementDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_OFFBOARD:
<b class="nc">&nbsp;                component = new TargetingPhaseDisplay(null, true);</b>
<b class="nc">&nbsp;                ((TargetingPhaseDisplay) component).initializeListeners();</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;OffboardDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_FIRING:
<b class="nc">&nbsp;                component = new FiringDisplay(null);</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;FiringDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_PHYSICAL:
<b class="nc">&nbsp;                component = new PhysicalDisplay(null);</b>
<b class="nc">&nbsp;                main = &quot;BoardView&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = &quot;PhysicalDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(secondary);</b>
<b class="nc">&nbsp;                if (!mainNames.containsValue(main)) {</b>
<b class="nc">&nbsp;                    panMain.add(bvc, main);</b>
&nbsp;                }
<b class="nc">&nbsp;                currPhaseDisplay = (StatusBarPhaseDisplay)(component);</b>
<b class="nc">&nbsp;                panSecondary.add(component, secondary);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_INITIATIVE_REPORT:
<b class="nc">&nbsp;                component = new ReportDisplay(null);</b>
<b class="nc">&nbsp;                main = &quot;ReportDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                component.setName(main);</b>
<b class="nc">&nbsp;                panMain.add(main, component);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case PHASE_TARGETING_REPORT:
&nbsp;            case PHASE_MOVEMENT_REPORT:
&nbsp;            case PHASE_OFFBOARD_REPORT:
&nbsp;            case PHASE_FIRING_REPORT:
&nbsp;            case PHASE_PHYSICAL_REPORT:
&nbsp;            case PHASE_END_REPORT:
&nbsp;            case PHASE_VICTORY:
&nbsp;                // Try to reuse the ReportDisplay for other phases...
<b class="nc">&nbsp;                component = phaseComponents.get(String</b>
<b class="nc">&nbsp;                        .valueOf(IGame.Phase.PHASE_INITIATIVE_REPORT));</b>
<b class="nc">&nbsp;                if (component == null) {</b>
&nbsp;                    // no ReportDisplay to reuse -- get a new one
<b class="nc">&nbsp;                    component = initializePanel(</b>
&nbsp;                            IGame.Phase.PHASE_INITIATIVE_REPORT);
&nbsp;                }
<b class="nc">&nbsp;                main = &quot;ReportDisplay&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            default:
<b class="nc">&nbsp;                component = new JLabel(</b>
<b class="nc">&nbsp;                        Messages.getString(&quot;ClientGUI.waitingOnTheServer&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;                main = &quot;JLabel-Default&quot;; //$NON-NLS-1$</b>
<b class="nc">&nbsp;                secondary = main;</b>
<b class="nc">&nbsp;                component.setName(main);</b>
<b class="nc">&nbsp;                panMain.add(main, component);</b>
&nbsp;        }
<b class="nc">&nbsp;        phaseComponents.put(name, component);</b>
<b class="nc">&nbsp;        mainNames.put(name, main);</b>
<b class="nc">&nbsp;        if (secondary != null) {</b>
<b class="nc">&nbsp;            secondaryNames.put(name, secondary);</b>
&nbsp;        }
<b class="nc">&nbsp;        return component;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Sets the visibility of the entity display window
&nbsp;     */
&nbsp;    public void setDisplayVisible(boolean visible) {
<b class="nc">&nbsp;        skinSpecEditorD.setVisible(visible);</b>
<b class="nc">&nbsp;        if (visible) {</b>
<b class="nc">&nbsp;            frame.requestFocus();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Pops up a dialog box giving the player a series of choices that are not
&nbsp;     * mutually exclusive.
&nbsp;     *
&nbsp;     * @param title
&nbsp;     *            the &lt;code&gt;String&lt;/code&gt; title of the dialog box.
&nbsp;     * @param question
&nbsp;     *            the &lt;code&gt;String&lt;/code&gt; question that has a &quot;Yes&quot; or &quot;No&quot;
&nbsp;     *            answer. The question will be split across multiple line on the
&nbsp;     *            &#39;\n&#39; characters.
&nbsp;     * @param choices
&nbsp;     *            the array of &lt;code&gt;String&lt;/code&gt; choices that the player can
&nbsp;     *            select from.
&nbsp;     * @return The array of the &lt;code&gt;int&lt;/code&gt; indexes of the from the input
&nbsp;     *         array that match the selected choices. If no choices were
&nbsp;     *         available, if the player did not select a choice, or if the
&nbsp;     *         player canceled the choice, a &lt;code&gt;null&lt;/code&gt; value is
&nbsp;     *         returned.
&nbsp;     */
&nbsp;    public int[] doChoiceDialog(String title, String question, String[] choices) {
<b class="nc">&nbsp;        ChoiceDialog choice = new ChoiceDialog(frame, title, question, choices);</b>
<b class="nc">&nbsp;        choice.setVisible(true);</b>
<b class="nc">&nbsp;        return choice.getChoices();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Pops up a dialog box showing an alert
&nbsp;     */
&nbsp;    public void doAlertDialog(String title, String message) {
<b class="nc">&nbsp;        JTextPane textArea = new JTextPane();</b>
<b class="nc">&nbsp;        ReportDisplay.setupStylesheet(textArea);</b>
&nbsp;
<b class="nc">&nbsp;        textArea.setEditable(false);</b>
<b class="nc">&nbsp;        JScrollPane scrollPane = new JScrollPane(textArea,</b>
&nbsp;                ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED,
&nbsp;                ScrollPaneConstants.HORIZONTAL_SCROLLBAR_AS_NEEDED);
<b class="nc">&nbsp;        textArea.setText(&quot;&lt;pre&gt;&quot; + message + &quot;&lt;/pre&gt;&quot;);</b>
<b class="nc">&nbsp;        scrollPane.setPreferredSize(new Dimension(</b>
<b class="nc">&nbsp;                (int) (getSize().getWidth() / 1.5), (int) (getSize()</b>
<b class="nc">&nbsp;                        .getHeight() / 1.5)));</b>
<b class="nc">&nbsp;        JOptionPane.showMessageDialog(frame, scrollPane, title,</b>
&nbsp;                JOptionPane.ERROR_MESSAGE);
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Pops up a dialog box asking a yes/no question
&nbsp;     *
&nbsp;     * @param title
&nbsp;     *            the &lt;code&gt;String&lt;/code&gt; title of the dialog box.
&nbsp;     * @param question
&nbsp;     *            the &lt;code&gt;String&lt;/code&gt; question that has a &quot;Yes&quot; or &quot;No&quot;
&nbsp;     *            answer. The question will be split across multiple line on the
&nbsp;     *            &#39;\n&#39; characters.
&nbsp;     * @return &lt;code&gt;true&lt;/code&gt; if yes
&nbsp;     */
&nbsp;    public boolean doYesNoDialog(String title, String question) {
<b class="nc">&nbsp;        ConfirmDialog confirm = new ConfirmDialog(frame, title, question);</b>
<b class="nc">&nbsp;        confirm.setVisible(true);</b>
<b class="nc">&nbsp;        return confirm.getAnswer();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Pops up a dialog box asking a yes/no question
&nbsp;     * &lt;p/&gt;
&nbsp;     * The player will be given a chance to not show the dialog again.
&nbsp;     *
&nbsp;     * @param title
&nbsp;     *            the &lt;code&gt;String&lt;/code&gt; title of the dialog box.
&nbsp;     * @param question
&nbsp;     *            the &lt;code&gt;String&lt;/code&gt; question that has a &quot;Yes&quot; or &quot;No&quot;
&nbsp;     *            answer. The question will be split across multiple line on the
&nbsp;     *            &#39;\n&#39; characters.
&nbsp;     * @return the &lt;code&gt;ConfirmDialog&lt;/code&gt; containing the player&#39;s responses.
&nbsp;     *         The dialog will already have been shown to the player, and is
&nbsp;     *         only being returned so the calling function can see the answer to
&nbsp;     *         the question and the state of the &quot;Show again?&quot; question.
&nbsp;     */
&nbsp;    public ConfirmDialog doYesNoBotherDialog(String title, String question) {
<b class="nc">&nbsp;        ConfirmDialog confirm = new ConfirmDialog(frame, title, question, true);</b>
<b class="nc">&nbsp;        confirm.setVisible(true);</b>
<b class="nc">&nbsp;        return confirm;</b>
&nbsp;    }
&nbsp;
&nbsp;    //
&nbsp;    // WindowListener
&nbsp;    //
&nbsp;    @Override
&nbsp;    public void windowActivated(WindowEvent windowEvent) {
&nbsp;        // TODO: this is a kludge to fix a window iconify issue
&nbsp;        // For some reason when I click on the window button, the main UI
&nbsp;        // window doesn&#39;t deiconify.  This fix doesn&#39;t allow me to iconify the
&nbsp;        // window by clicking the window button, but it&#39;s better than the
&nbsp;        // alternative
<b class="nc">&nbsp;        frame.setState(Frame.NORMAL);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void windowClosed(WindowEvent windowEvent) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void windowClosing(WindowEvent windowEvent) {
<b class="nc">&nbsp;        if (windowEvent.getWindow().equals(skinSpecEditorD)) {</b>
<b class="nc">&nbsp;            setDisplayVisible(false);</b>
<b class="nc">&nbsp;            die();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void windowDeactivated(WindowEvent windowEvent) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void windowDeiconified(WindowEvent windowEvent) {
&nbsp;        // TODO: this is a kludge to fix a window iconify issue
&nbsp;        // For some reason when I click on the window button, the main UI
&nbsp;        // window doesn&#39;t deiconify.  This fix doesn&#39;t allow me to iconify the
&nbsp;        // window by clicking the window button, but it&#39;s better than the
&nbsp;        // alternative
<b class="nc">&nbsp;        frame.setState(Frame.NORMAL);</b>
&nbsp;    }
&nbsp;
&nbsp;    public void windowIconified(WindowEvent windowEvent) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void windowOpened(WindowEvent windowEvent) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * @return the frame this client is displayed in
&nbsp;     */
&nbsp;    public JFrame getFrame() {
<b class="nc">&nbsp;        return frame;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void loadPreviewImage(JLabel bp, Entity entity, IPlayer player) {
<b class="nc">&nbsp;        final Camouflage camouflage = entity.getCamouflageOrElse(player.getCamouflage());</b>
<b class="nc">&nbsp;        bp.setIcon(new ImageIcon(bv.getTilesetManager().loadPreviewImage(entity, camouflage, bp)));</b>
&nbsp;    }
&nbsp;
&nbsp;   
&nbsp;    @Override
&nbsp;    public void hexMoused(BoardViewEvent b) {
<b class="nc">&nbsp;        if (b.getType() == BoardViewEvent.BOARD_HEX_POPUP) {</b>
&nbsp;            
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void hexCursor(BoardViewEvent b) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void boardHexHighlighted(BoardViewEvent b) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void hexSelected(BoardViewEvent b) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void firstLOSHex(BoardViewEvent b) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void secondLOSHex(BoardViewEvent b, Coords c) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void finishedMovingUnits(BoardViewEvent b) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void unitSelected(BoardViewEvent b) {
&nbsp;        // ignored
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void componentHidden(ComponentEvent arg0) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void componentMoved(ComponentEvent arg0) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void componentResized(ComponentEvent arg0) {
<b class="nc">&nbsp;        bv.setPreferredSize(getSize());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void componentShown(ComponentEvent arg0) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Returns the panel for the current phase. The ClientGUI is split into the
&nbsp;     * main panel (view) at the top, which takes up the majority of the view and
&nbsp;     * the the &quot;current panel&quot; which has different controls based on the phase.
&nbsp;     * 
&nbsp;     * @return
&nbsp;     */
&nbsp;    public JComponent getCurrentPanel() {
<b class="nc">&nbsp;        return curPanel;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns the &#39;virtual bounds&#39; of the screen.  That is, the union of the
&nbsp;     * displayable space on all available screen devices.
&nbsp;     *
&nbsp;     * @return
&nbsp;     */
&nbsp;    private Rectangle getVirtualBounds() {
<b class="nc">&nbsp;        Rectangle virtualBounds = new Rectangle();</b>
<b class="nc">&nbsp;        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();</b>
<b class="nc">&nbsp;        GraphicsDevice[] gs = ge.getScreenDevices();</b>
<b class="nc">&nbsp;        for (GraphicsDevice gd : gs) {</b>
<b class="nc">&nbsp;            GraphicsConfiguration[] gc = gd.getConfigurations();</b>
<b class="nc">&nbsp;            for (GraphicsConfiguration element : gc) {</b>
<b class="nc">&nbsp;                virtualBounds = virtualBounds.union(element.getBounds());</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return virtualBounds;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
