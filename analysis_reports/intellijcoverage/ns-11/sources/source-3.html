


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > SkinSpecPanel</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing.skinEditor</a>
</div>

<h1>Coverage Summary for Class: SkinSpecPanel (megamek.client.ui.swing.skinEditor)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SkinSpecPanel</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/191)
  </span>
</td>
</tr>
  <tr>
    <td class="name">SkinSpecPanel$BackgroundElement</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/23)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">SkinSpecPanel$BorderElement</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/152)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/25)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/366)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2000,2001,2002,2003,2004,2006 Ben Mazur (bmazur@sev.org)
&nbsp; * Copyright © 2015 Nicholas Walczak (walczak@cs.umn.edu)
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;
&nbsp;package megamek.client.ui.swing.skinEditor;
&nbsp;
&nbsp;import java.awt.Color;
&nbsp;import java.awt.Dimension;
&nbsp;import java.awt.GridBagConstraints;
&nbsp;import java.awt.GridBagLayout;
&nbsp;import java.awt.Insets;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Collections;
&nbsp;import java.util.List;
&nbsp;
&nbsp;import javax.swing.BorderFactory;
&nbsp;import javax.swing.JButton;
&nbsp;import javax.swing.JCheckBox;
&nbsp;import javax.swing.JColorChooser;
&nbsp;import javax.swing.JFileChooser;
&nbsp;import javax.swing.JLabel;
&nbsp;import javax.swing.JPanel;
&nbsp;import javax.swing.JTextField;
&nbsp;import javax.swing.border.TitledBorder;
&nbsp;import javax.swing.event.DocumentEvent;
&nbsp;import javax.swing.event.DocumentListener;
&nbsp;import javax.swing.event.ListSelectionEvent;
&nbsp;import javax.swing.event.ListSelectionListener;
&nbsp;
&nbsp;import megamek.client.ui.Messages;
&nbsp;import megamek.client.ui.swing.widget.SkinSpecification;
&nbsp;import megamek.common.Configuration;
&nbsp;
&nbsp;/**
&nbsp; * Panel with elements for viewing and adjusting a specific SkinSpecification.
&nbsp; * 
&nbsp; * @author arlith
&nbsp; */
&nbsp;public class SkinSpecPanel extends JPanel implements ListSelectionListener,
&nbsp;        ActionListener {
&nbsp;
<b class="nc">&nbsp;    JFileChooser fileChooser = new JFileChooser(Configuration.widgetsDir());</b>
&nbsp;
&nbsp;    /**
&nbsp;     * A UI widget for displaying information related to a border widget (image
&nbsp;     * path and whether the image is tiled or not). Also supports a flag to
&nbsp;     * determine if the image should be allowed to tile (ie, corners should
&nbsp;     * never be tiled)
&nbsp;     * 
&nbsp;     * @author arlith
&nbsp;     *
&nbsp;     */
<b class="nc">&nbsp;    private class BorderElement extends JPanel implements ActionListener,</b>
&nbsp;            DocumentListener {
&nbsp;
&nbsp;        /**
&nbsp;         * 
&nbsp;         */
&nbsp;        private static final long serialVersionUID = -2004313765932049794L;
&nbsp;
&nbsp;        /**
&nbsp;         * Specifies the width of text fields
&nbsp;         */
&nbsp;        private static final int TEXTFIELD_COLS = 20;
&nbsp;
<b class="nc">&nbsp;        List&lt;JButton&gt; pathLbl = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        List&lt;JTextField&gt; path = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        List&lt;JCheckBox&gt; tiled = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        List&lt;JButton&gt; removeButtons = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        JButton addButton = new JButton(Messages.getString(&quot;SkinEditor.Add&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;        boolean displayTiled = false;</b>
&nbsp;
&nbsp;        SkinSpecPanel skinPanel;
&nbsp;
&nbsp;        /**
&nbsp;         * Constructor for BorderElements that only have one image (like
&nbsp;         * corners). The option to tile the image is not present, nor are the
&nbsp;         * add and remove buttons.
&nbsp;         *
&nbsp;         * @param elementName
&nbsp;         * @param imgPath
&nbsp;         */
&nbsp;        BorderElement(SkinSpecPanel skinPanel, String elementName,
<b class="nc">&nbsp;                String imgPath) {</b>
<b class="nc">&nbsp;            super(new GridBagLayout());</b>
<b class="nc">&nbsp;            this.skinPanel = skinPanel;</b>
<b class="nc">&nbsp;            setBorder(BorderFactory.createTitledBorder(</b>
<b class="nc">&nbsp;                    BorderFactory.createEmptyBorder(), elementName,</b>
&nbsp;                    TitledBorder.LEFT, TitledBorder.TOP));
&nbsp;
<b class="nc">&nbsp;            displayTiled = false;</b>
&nbsp;
<b class="nc">&nbsp;            JButton newPathLbl = new JButton(</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;SkinEditor.Path&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            newPathLbl.setMargin(new Insets(1, 1, 1, 1));</b>
<b class="nc">&nbsp;            newPathLbl.setToolTipText(Messages.getString(</b>
&nbsp;                    &quot;SkinEditor.PathToolTip&quot;, //$NON-NLS-1$
<b class="nc">&nbsp;                    new Object[] { Configuration.widgetsDir().getPath() }));</b>
<b class="nc">&nbsp;            newPathLbl.addActionListener(this);</b>
<b class="nc">&nbsp;            pathLbl.add(newPathLbl);</b>
<b class="nc">&nbsp;            JTextField newPath = new JTextField(imgPath, TEXTFIELD_COLS);</b>
<b class="nc">&nbsp;            newPath.getDocument().addDocumentListener(this);</b>
<b class="nc">&nbsp;            path.add(newPath);</b>
<b class="nc">&nbsp;            JCheckBox newTiled = new JCheckBox(</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;SkinEditor.Tiled&quot;), //$NON-NLS-1$</b>
&nbsp;                    false);
<b class="nc">&nbsp;            newTiled.addActionListener(this);</b>
<b class="nc">&nbsp;            tiled.add(newTiled);</b>
<b class="nc">&nbsp;            removeButtons.add(new JButton());</b>
&nbsp;
<b class="nc">&nbsp;            layoutPanel();</b>
&nbsp;        }
&nbsp;
&nbsp;        /**
&nbsp;         * Constructor for BorderElements that can have multiple images, like
&nbsp;         * edges. An add button is used to allow more images to be added and
&nbsp;         * each image path added has the option to be tiled or not. There is
&nbsp;         * also a remove button added for each entry to allow them to be
&nbsp;         * removed. Remove buttons are enabled if there are more than one image,
&nbsp;         * otherwise if only one image is specified then the remove button is
&nbsp;         * disabled.
&nbsp;         *
&nbsp;         * @param elementName
&nbsp;         * @param imgPath
&nbsp;         * @param isTiled
&nbsp;         */
&nbsp;        BorderElement(SkinSpecPanel skinPanel, String elementName,
&nbsp;                List&lt;String&gt; imgPath, List&lt;Boolean&gt; isTiled) {
<b class="nc">&nbsp;            this(skinPanel, elementName, imgPath, isTiled, imgPath.size() &gt; 1);</b>
&nbsp;        }
&nbsp;
&nbsp;        /**
&nbsp;         * Constructor for BorderElements that can have multiple images, like
&nbsp;         * edges. An add button is used to allow more images to be added and
&nbsp;         * each image path added has the option to be tiled or not. There is
&nbsp;         * also a remove button added for each entry to allow them to be
&nbsp;         * removed.
&nbsp;         *
&nbsp;         * @param elementName
&nbsp;         * @param imgPath
&nbsp;         * @param isTiled
&nbsp;         * @param removeEnabled
&nbsp;         *            Determines if remove buttons are enabled
&nbsp;         */
&nbsp;        BorderElement(SkinSpecPanel skinPanel, String elementName,
&nbsp;                List&lt;String&gt; imgPath, List&lt;Boolean&gt; isTiled,
<b class="nc">&nbsp;                boolean removeEnabled) {</b>
<b class="nc">&nbsp;            super(new GridBagLayout());</b>
<b class="nc">&nbsp;            this.skinPanel = skinPanel;</b>
<b class="nc">&nbsp;            setBorder(BorderFactory.createTitledBorder(</b>
<b class="nc">&nbsp;                    BorderFactory.createEmptyBorder(), elementName,</b>
&nbsp;                    TitledBorder.LEFT, TitledBorder.TOP));
&nbsp;
<b class="nc">&nbsp;            displayTiled = true;</b>
<b class="nc">&nbsp;            assert (imgPath.size() == isTiled.size());</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; imgPath.size(); i++) {</b>
<b class="nc">&nbsp;                addPathRow(imgPath.get(i), isTiled.get(i), removeEnabled);</b>
&nbsp;            }
<b class="nc">&nbsp;            addButton.setToolTipText(Messages</b>
<b class="nc">&nbsp;                    .getString(&quot;SkinEditor.AddButtonToolTip&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            addButton.setMargin(new Insets(1, 1, 1, 1));</b>
<b class="nc">&nbsp;            addButton.setMaximumSize(new Dimension(40, 14));</b>
<b class="nc">&nbsp;            addButton.setPreferredSize(new Dimension(40, 14));</b>
<b class="nc">&nbsp;            addButton.addActionListener(this);</b>
<b class="nc">&nbsp;            layoutPanel();</b>
&nbsp;        }
&nbsp;
&nbsp;        /**
&nbsp;         * Used for BorderElements that have multiple entries, this method adds
&nbsp;         * a row of PathButton, Path text field, tiled checkbox and remove
&nbsp;         * button
&nbsp;         */
&nbsp;        protected void addPathRow(String imgPath, boolean isTiled,
&nbsp;                boolean removeEnabled) {
<b class="nc">&nbsp;            JButton newPathLbl = new JButton(</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;SkinEditor.Path&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            newPathLbl.setMargin(new Insets(1, 1, 1, 1));</b>
<b class="nc">&nbsp;            newPathLbl.setToolTipText(Messages.getString(</b>
&nbsp;                    &quot;SkinEditor.PathToolTip&quot;, //$NON-NLS-1$
<b class="nc">&nbsp;                    new Object[] { Configuration.widgetsDir().getPath() }));</b>
<b class="nc">&nbsp;            newPathLbl.addActionListener(this);</b>
<b class="nc">&nbsp;            pathLbl.add(newPathLbl); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            JTextField newPath = new JTextField(imgPath, TEXTFIELD_COLS);</b>
<b class="nc">&nbsp;            newPath.getDocument().addDocumentListener(this);</b>
<b class="nc">&nbsp;            path.add(newPath);</b>
<b class="nc">&nbsp;            JCheckBox newTiled = new JCheckBox(</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;SkinEditor.Tiled&quot;), //$NON-NLS-1$</b>
&nbsp;                    isTiled);
<b class="nc">&nbsp;            newTiled.setToolTipText(Messages</b>
<b class="nc">&nbsp;                    .getString(&quot;SkinEditor.TiledToolTip&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            newTiled.addActionListener(this);</b>
<b class="nc">&nbsp;            tiled.add(newTiled);</b>
<b class="nc">&nbsp;            JButton newRemoveButton = new JButton(</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;SkinEditor.RemoveButton&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            newRemoveButton.setToolTipText(Messages</b>
<b class="nc">&nbsp;                    .getString(&quot;SkinEditor.RemoveButtonToolTip&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            newRemoveButton.setMargin(new Insets(0, 0, 1, 0));</b>
<b class="nc">&nbsp;            newRemoveButton.setPreferredSize(new Dimension(14, 14));</b>
<b class="nc">&nbsp;            newRemoveButton.setMaximumSize(new Dimension(14, 14));</b>
<b class="nc">&nbsp;            newRemoveButton.setEnabled(removeEnabled);</b>
<b class="nc">&nbsp;            newRemoveButton.addActionListener(this);</b>
<b class="nc">&nbsp;            removeButtons.add(newRemoveButton);</b>
&nbsp;        }
&nbsp;
&nbsp;        void layoutPanel() {
<b class="nc">&nbsp;            removeAll();</b>
<b class="nc">&nbsp;            GridBagConstraints gbc = new GridBagConstraints();</b>
<b class="nc">&nbsp;            gbc.insets = new Insets(1, 1, 1, 1);</b>
<b class="nc">&nbsp;            gbc.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;            gbc.gridx = gbc.gridy = 0;</b>
<b class="nc">&nbsp;            if (displayTiled) {</b>
<b class="nc">&nbsp;                add(addButton, gbc);</b>
<b class="nc">&nbsp;                gbc.gridy++;</b>
&nbsp;            }
<b class="nc">&nbsp;            for (int i = 0; i &lt; path.size(); i++) {</b>
<b class="nc">&nbsp;                gbc.gridx = 0;</b>
<b class="nc">&nbsp;                gbc.gridwidth = 1;</b>
<b class="nc">&nbsp;                gbc.weightx = 0;</b>
<b class="nc">&nbsp;                gbc.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;                add(pathLbl.get(i), gbc);</b>
&nbsp;
<b class="nc">&nbsp;                gbc.gridx++;</b>
<b class="nc">&nbsp;                gbc.weightx = 1;</b>
<b class="nc">&nbsp;                gbc.fill = GridBagConstraints.HORIZONTAL;</b>
<b class="nc">&nbsp;                if (!displayTiled) {</b>
<b class="nc">&nbsp;                    gbc.gridwidth = 2;</b>
&nbsp;                }
<b class="nc">&nbsp;                add(path.get(i), gbc);</b>
&nbsp;
<b class="nc">&nbsp;                if (displayTiled) {</b>
<b class="nc">&nbsp;                    gbc.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;                    gbc.gridwidth = 1;</b>
<b class="nc">&nbsp;                    gbc.weightx = 0;</b>
<b class="nc">&nbsp;                    gbc.gridx++;</b>
<b class="nc">&nbsp;                    add(tiled.get(i), gbc);</b>
<b class="nc">&nbsp;                    gbc.gridx++;</b>
<b class="nc">&nbsp;                    add(removeButtons.get(i), gbc);</b>
&nbsp;                }
<b class="nc">&nbsp;                gbc.gridy++;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void setEnabled(boolean en) {
<b class="nc">&nbsp;            super.setEnabled(en);</b>
<b class="nc">&nbsp;            addButton.setEnabled(en);</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; path.size(); i++) {</b>
<b class="nc">&nbsp;                pathLbl.get(i).setEnabled(en);</b>
<b class="nc">&nbsp;                path.get(i).setEnabled(en);</b>
<b class="nc">&nbsp;                tiled.get(i).setEnabled(en);</b>
<b class="nc">&nbsp;                removeButtons.get(i).setEnabled((path.size() &gt; 1) &amp;&amp; en);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;            if (e.getSource().equals(addButton)) {</b>
<b class="nc">&nbsp;                addPathRow(&quot;&quot;, false, true);</b>
<b class="nc">&nbsp;                for (JButton removeButton : removeButtons) {</b>
<b class="nc">&nbsp;                    removeButton.setEnabled(path.size() &gt; 1);</b>
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;                layoutPanel();</b>
<b class="nc">&nbsp;                skinPanel.notifySkinChanges(true);</b>
<b class="nc">&nbsp;                skinPanel.signalValidate();</b>
&nbsp;            } else {
&nbsp;                // Did we press a remove button?
<b class="nc">&nbsp;                for (int i = 0; i &lt; removeButtons.size(); i++) {</b>
&nbsp;                    // Find the button pressed, and remove the entry
<b class="nc">&nbsp;                    if (e.getSource().equals(removeButtons.get(i))) {</b>
&nbsp;                        // Remove Listeners
<b class="nc">&nbsp;                        pathLbl.get(i).removeActionListener(this);</b>
<b class="nc">&nbsp;                        path.get(i).getDocument().removeDocumentListener(this);</b>
<b class="nc">&nbsp;                        tiled.get(i).removeActionListener(this);</b>
<b class="nc">&nbsp;                        removeButtons.get(i).removeActionListener(this);</b>
&nbsp;
&nbsp;                        // Remove UI elements
<b class="nc">&nbsp;                        pathLbl.remove(i);</b>
<b class="nc">&nbsp;                        path.remove(i);</b>
<b class="nc">&nbsp;                        tiled.remove(i);</b>
<b class="nc">&nbsp;                        removeButtons.remove(i);</b>
<b class="nc">&nbsp;                        for (JButton removeButton : removeButtons) {</b>
<b class="nc">&nbsp;                            removeButton.setEnabled(path.size() &gt; 1);</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                        layoutPanel();</b>
<b class="nc">&nbsp;                        skinPanel.notifySkinChanges(true);</b>
<b class="nc">&nbsp;                        skinPanel.signalValidate();</b>
&nbsp;                        // We&#39;re done
&nbsp;                        return;
&nbsp;                    }
&nbsp;                }
&nbsp;                // Did we press a pathLbl button?
<b class="nc">&nbsp;                for (int i = 0; i &lt; pathLbl.size(); i++) {</b>
<b class="nc">&nbsp;                    if (e.getSource().equals(pathLbl.get(i))) {</b>
<b class="nc">&nbsp;                        chooseFile(i);</b>
<b class="nc">&nbsp;                        skinPanel.notifySkinChanges(false);</b>
<b class="nc">&nbsp;                        skinPanel.signalValidate();</b>
&nbsp;                        return;
&nbsp;                    }
&nbsp;                }
&nbsp;                // Did we press a tile button?
<b class="nc">&nbsp;                for (int i = 0; i &lt; tiled.size(); i++) {</b>
<b class="nc">&nbsp;                    if (e.getSource().equals(tiled.get(i))) {</b>
<b class="nc">&nbsp;                        skinPanel.notifySkinChanges(false);</b>
&nbsp;                        return;
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        /**
&nbsp;         * Handles the pressing of a pathLbl button: display the file chooser
&nbsp;         * and update the path if a file is selected
&nbsp;         *
&nbsp;         * @param pathIdx
&nbsp;         */
&nbsp;        private void chooseFile(int pathIdx) {
<b class="nc">&nbsp;            int returnVal = fileChooser.showOpenDialog(this);</b>
&nbsp;            // Did the user choose valid input?
<b class="nc">&nbsp;            if ((returnVal != JFileChooser.APPROVE_OPTION)</b>
<b class="nc">&nbsp;                    || (fileChooser.getSelectedFile() == null)) {</b>
&nbsp;                return;
&nbsp;            }
&nbsp;            // Get relative path
<b class="nc">&nbsp;            String relativePath = Configuration.widgetsDir().toURI()</b>
<b class="nc">&nbsp;                    .relativize(fileChooser.getSelectedFile().toURI())</b>
<b class="nc">&nbsp;                    .getPath();</b>
&nbsp;            // Set text
<b class="nc">&nbsp;            path.get(pathIdx).getDocument().removeDocumentListener(this);</b>
<b class="nc">&nbsp;            path.get(pathIdx).setText(relativePath);</b>
<b class="nc">&nbsp;            path.get(pathIdx).getDocument().addDocumentListener(this);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void changedUpdate(DocumentEvent arg0) {
<b class="nc">&nbsp;            skinPanel.notifySkinChanges(false);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void insertUpdate(DocumentEvent arg0) {
<b class="nc">&nbsp;            skinPanel.notifySkinChanges(false);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void removeUpdate(DocumentEvent arg0) {
<b class="nc">&nbsp;            skinPanel.notifySkinChanges(false);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Essentially the same thing as the BorderElement, but used for backgrounds
&nbsp;     * where each background image shares the same shouldTile state.
&nbsp;     * 
&nbsp;     * @author arlith
&nbsp;     *
&nbsp;     */
&nbsp;    private class BackgroundElement extends BorderElement {
&nbsp;
&nbsp;        /**
&nbsp;         * 
&nbsp;         */
&nbsp;        private static final long serialVersionUID = 3448867645483831732L;
&nbsp;
&nbsp;        BackgroundElement(SkinSpecPanel skinPanel, List&lt;String&gt; imgPath,
<b class="nc">&nbsp;                List&lt;Boolean&gt; isTiled) {</b>
<b class="nc">&nbsp;            super(skinPanel, Messages.getString(&quot;SkinEditor.Background&quot;), //$NON-NLS-1$</b>
&nbsp;                    imgPath, isTiled, true);
&nbsp;        }
&nbsp;
&nbsp;        public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;            boolean tiledChecked = false;</b>
<b class="nc">&nbsp;            boolean newValue = false;</b>
<b class="nc">&nbsp;            if (e.getSource().equals(addButton)) {</b>
<b class="nc">&nbsp;                addPathRow(&quot;&quot;, false, true);</b>
<b class="nc">&nbsp;                for (JButton removeButton : removeButtons) {</b>
<b class="nc">&nbsp;                    removeButton.setEnabled(true);</b>
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;                layoutPanel();</b>
<b class="nc">&nbsp;                skinPanel.notifySkinChanges(true);</b>
<b class="nc">&nbsp;                skinPanel.signalValidate();</b>
&nbsp;                return;
&nbsp;            }
<b class="nc">&nbsp;            for (JCheckBox tileChk : tiled) {</b>
<b class="nc">&nbsp;                if (e.getSource().equals(tileChk)) {</b>
<b class="nc">&nbsp;                    tiledChecked = true;</b>
<b class="nc">&nbsp;                    newValue = tileChk.isSelected();</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            if (tiledChecked) {</b>
<b class="nc">&nbsp;                for (JCheckBox tileChk : tiled) {</b>
<b class="nc">&nbsp;                    tileChk.setSelected(newValue);</b>
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;                skinPanel.notifySkinChanges(false);</b>
&nbsp;                return;
&nbsp;            }
<b class="nc">&nbsp;            super.actionPerformed(e);</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * 
&nbsp;     */
&nbsp;    private static final long serialVersionUID = -37452332974426228L;
&nbsp;
&nbsp;    BorderElement tlCorner, trCorner, blCorner, brCorner;
&nbsp;
&nbsp;    BorderElement topEdge, bottomEdge, leftEdge, rightEdge;
&nbsp;
&nbsp;    BackgroundElement background;
&nbsp;
<b class="nc">&nbsp;    JCheckBox showScrollBars = new JCheckBox(</b>
<b class="nc">&nbsp;            Messages.getString(&quot;SkinEditor.ShowScrollBars&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;    ArrayList&lt;JButton&gt; colorButtons = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;    JButton addColor = new JButton(</b>
<b class="nc">&nbsp;            Messages.getString(&quot;SkinEditor.AddColor.Text&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;    JButton removeColor = new JButton(</b>
<b class="nc">&nbsp;            Messages.getString(&quot;SkinEditor.RemoveColor.Text&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;    JLabel colorLbl = new JLabel(Messages.getString(&quot;SkinEditor.Color&quot;)); //$NON-NLS-1$</b>
&nbsp;
&nbsp;    SkinSpecEditor skinEditor;
&nbsp;
&nbsp;    /**
&nbsp;     * 
&nbsp;     */
&nbsp;    public SkinSpecPanel(SkinSpecEditor skinEditor) {
<b class="nc">&nbsp;        super(new GridBagLayout());</b>
<b class="nc">&nbsp;        this.skinEditor = skinEditor;</b>
<b class="nc">&nbsp;        addColor.setToolTipText(Messages</b>
<b class="nc">&nbsp;                .getString(&quot;SkinEditor.AddColor.ToolTip&quot;));</b>
<b class="nc">&nbsp;        removeColor.setToolTipText(Messages</b>
<b class="nc">&nbsp;                .getString(&quot;SkinEditor.RemoveColor.ToolTip&quot;));</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Add this SkinSpecEditor as a listener to all components.
&nbsp;     */
&nbsp;    private void addListeners() {
<b class="nc">&nbsp;        for (JButton colorButton : colorButtons) {</b>
<b class="nc">&nbsp;            colorButton.addActionListener(this);</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        addColor.addActionListener(this);</b>
<b class="nc">&nbsp;        removeColor.addActionListener(this);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Remove thsi SkinSpecEditor as a listener from all components.
&nbsp;     */
&nbsp;    private void removeListeners() {
<b class="nc">&nbsp;        for (JButton colorButton : colorButtons) {</b>
<b class="nc">&nbsp;            colorButton.removeActionListener(this);</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        addColor.removeActionListener(this);</b>
<b class="nc">&nbsp;        removeColor.removeActionListener(this);</b>
&nbsp;    }
&nbsp;
&nbsp;    private void resetColorButtons(SkinSpecification skinSpec) {
&nbsp;        // Listeners must already be removed before calling this!
<b class="nc">&nbsp;        colorButtons.clear();</b>
<b class="nc">&nbsp;        for (Color c : skinSpec.fontColors) {</b>
<b class="nc">&nbsp;            JButton colorButton = new JButton();</b>
<b class="nc">&nbsp;            colorButton.setMaximumSize(new Dimension(14, 14));</b>
<b class="nc">&nbsp;            colorButton.setPreferredSize(new Dimension(14, 14));</b>
<b class="nc">&nbsp;            colorButton.setForeground(c);</b>
<b class="nc">&nbsp;            colorButton.setBackground(c);</b>
<b class="nc">&nbsp;            colorButtons.add(colorButton);</b>
<b class="nc">&nbsp;        }</b>
&nbsp;        // Don&#39;t add listeners, to prevent double add
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Update the given SkinSpecification based on the state of the UI elements.
&nbsp;     *
&nbsp;     * @param skinSpec
&nbsp;     * @return
&nbsp;     */
&nbsp;    public void updateSkinSpec(SkinSpecification skinSpec, boolean enableBorders) {
&nbsp;
<b class="nc">&nbsp;        skinSpec.noBorder = !enableBorders;</b>
<b class="nc">&nbsp;        skinSpec.tl_corner = tlCorner.path.get(0).getText();</b>
<b class="nc">&nbsp;        skinSpec.tr_corner = trCorner.path.get(0).getText();</b>
<b class="nc">&nbsp;        skinSpec.bl_corner = blCorner.path.get(0).getText();</b>
<b class="nc">&nbsp;        skinSpec.br_corner = brCorner.path.get(0).getText();</b>
&nbsp;
&nbsp;        // Top Edge
<b class="nc">&nbsp;        skinSpec.topEdge.clear();</b>
<b class="nc">&nbsp;        skinSpec.topShouldTile.clear();</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; topEdge.path.size(); i++) {</b>
<b class="nc">&nbsp;            skinSpec.topEdge.add(topEdge.path.get(i).getText());</b>
<b class="nc">&nbsp;            skinSpec.topShouldTile.add(topEdge.tiled.get(i).isSelected());</b>
&nbsp;        }
&nbsp;        // Bottom Edge
<b class="nc">&nbsp;        skinSpec.bottomEdge.clear();</b>
<b class="nc">&nbsp;        skinSpec.bottomShouldTile.clear();</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; bottomEdge.path.size(); i++) {</b>
<b class="nc">&nbsp;            skinSpec.bottomEdge.add(bottomEdge.path.get(i).getText());</b>
<b class="nc">&nbsp;            skinSpec.bottomShouldTile.add(bottomEdge.tiled.get(i).isSelected());</b>
&nbsp;        }
&nbsp;        // Left Edge
<b class="nc">&nbsp;        skinSpec.leftEdge.clear();</b>
<b class="nc">&nbsp;        skinSpec.leftShouldTile.clear();</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; leftEdge.path.size(); i++) {</b>
<b class="nc">&nbsp;            skinSpec.leftEdge.add(leftEdge.path.get(i).getText());</b>
<b class="nc">&nbsp;            skinSpec.leftShouldTile.add(leftEdge.tiled.get(i).isSelected());</b>
&nbsp;        }
&nbsp;        // Right Edge
<b class="nc">&nbsp;        skinSpec.rightEdge.clear();</b>
<b class="nc">&nbsp;        skinSpec.rightShouldTile.clear();</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; rightEdge.path.size(); i++) {</b>
<b class="nc">&nbsp;            skinSpec.rightEdge.add(rightEdge.path.get(i).getText());</b>
<b class="nc">&nbsp;            skinSpec.rightShouldTile.add(rightEdge.tiled.get(i).isSelected());</b>
&nbsp;        }
&nbsp;
&nbsp;        // Background
<b class="nc">&nbsp;        skinSpec.backgrounds.clear();</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; background.path.size(); i++) {</b>
<b class="nc">&nbsp;            skinSpec.backgrounds.add(background.path.get(i).getText());</b>
&nbsp;        }
<b class="nc">&nbsp;        skinSpec.tileBackground = false;</b>
<b class="nc">&nbsp;        if (background.tiled.size() &gt; 0) {</b>
<b class="nc">&nbsp;            skinSpec.tileBackground = background.tiled.get(0).isSelected();</b>
&nbsp;        }
&nbsp;
&nbsp;        // Font Color
<b class="nc">&nbsp;        skinSpec.fontColors.clear();</b>
<b class="nc">&nbsp;        for (JButton colorButton : colorButtons) {</b>
<b class="nc">&nbsp;            skinSpec.fontColors.add(colorButton.getBackground());</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // Show Scroll Bars
<b class="nc">&nbsp;        skinSpec.showScrollBars = showScrollBars.isSelected();</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Update the editing panel with the currently selected SkinSpecification.
&nbsp;     */
&nbsp;    public void setupSkinEditPanel(SkinSpecification skinSpec) {
<b class="nc">&nbsp;        removeListeners();</b>
<b class="nc">&nbsp;        removeAll();</b>
&nbsp;
<b class="nc">&nbsp;        boolean enableBorders = !skinSpec.noBorder;</b>
&nbsp;
<b class="nc">&nbsp;        GridBagConstraints gbc = new GridBagConstraints();</b>
&nbsp;
<b class="nc">&nbsp;        gbc.gridx = gbc.gridy = 0;</b>
<b class="nc">&nbsp;        gbc.weightx = 1.0;</b>
<b class="nc">&nbsp;        gbc.fill = GridBagConstraints.HORIZONTAL;</b>
<b class="nc">&nbsp;        gbc.insets = new Insets(0, 0, 4, 0);</b>
&nbsp;
<b class="nc">&nbsp;        JPanel borderPanel = new JPanel(new GridBagLayout());</b>
&nbsp;        // borderPanel.setLayout(new BoxLayout(borderPanel, BoxLayout.Y_AXIS));
<b class="nc">&nbsp;        borderPanel.setBorder(BorderFactory.createTitledBorder(</b>
<b class="nc">&nbsp;                BorderFactory.createLineBorder(Color.BLACK),</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.Borders&quot;), TitledBorder.TOP, //$NON-NLS-1$</b>
&nbsp;                TitledBorder.DEFAULT_POSITION));
<b class="nc">&nbsp;        borderPanel.setEnabled(enableBorders);</b>
&nbsp;
&nbsp;        // Top Left Corner
<b class="nc">&nbsp;        tlCorner = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.TLC&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.tl_corner);
<b class="nc">&nbsp;        tlCorner.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(tlCorner, gbc);</b>
<b class="nc">&nbsp;        gbc.gridx++;</b>
&nbsp;        // Top Right Corner
<b class="nc">&nbsp;        trCorner = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.TRC&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.tr_corner);
<b class="nc">&nbsp;        trCorner.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(trCorner, gbc);</b>
<b class="nc">&nbsp;        gbc.gridx = 0;</b>
<b class="nc">&nbsp;        gbc.gridy++;</b>
&nbsp;        // Bottom Left Corner
<b class="nc">&nbsp;        blCorner = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.BLC&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.bl_corner);
<b class="nc">&nbsp;        blCorner.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(blCorner, gbc);</b>
<b class="nc">&nbsp;        gbc.gridx++;</b>
&nbsp;        // Bottom Right Corner
<b class="nc">&nbsp;        brCorner = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.BRC&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.br_corner);
<b class="nc">&nbsp;        brCorner.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(brCorner, gbc);</b>
<b class="nc">&nbsp;        gbc.gridy++;</b>
<b class="nc">&nbsp;        gbc.gridx = 0;</b>
&nbsp;
&nbsp;        // Top Edge
<b class="nc">&nbsp;        topEdge = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.TopEdge&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.topEdge, skinSpec.topShouldTile);
<b class="nc">&nbsp;        topEdge.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(topEdge, gbc);</b>
<b class="nc">&nbsp;        gbc.gridx++;</b>
&nbsp;
&nbsp;        // Bottom Edge
<b class="nc">&nbsp;        bottomEdge = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.BottomEdge&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.bottomEdge, skinSpec.bottomShouldTile);
<b class="nc">&nbsp;        bottomEdge.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(bottomEdge, gbc);</b>
<b class="nc">&nbsp;        gbc.gridx = 0;</b>
<b class="nc">&nbsp;        gbc.gridy++;</b>
&nbsp;
&nbsp;        // Left Edge
<b class="nc">&nbsp;        leftEdge = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.LeftEdge&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.leftEdge, skinSpec.leftShouldTile);
<b class="nc">&nbsp;        leftEdge.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(leftEdge, gbc);</b>
<b class="nc">&nbsp;        gbc.gridx++;</b>
&nbsp;
&nbsp;        // Right Edge
<b class="nc">&nbsp;        rightEdge = new BorderElement(this,</b>
<b class="nc">&nbsp;                Messages.getString(&quot;SkinEditor.RightEdge&quot;), //$NON-NLS-1$</b>
&nbsp;                skinSpec.rightEdge, skinSpec.rightShouldTile);
<b class="nc">&nbsp;        rightEdge.setEnabled(enableBorders);</b>
<b class="nc">&nbsp;        borderPanel.add(rightEdge, gbc);</b>
<b class="nc">&nbsp;        gbc.gridy++;</b>
<b class="nc">&nbsp;        gbc.gridx = 0;</b>
&nbsp;
<b class="nc">&nbsp;        gbc.gridx = gbc.gridy = 0;</b>
<b class="nc">&nbsp;        add(borderPanel, gbc);</b>
&nbsp;
<b class="nc">&nbsp;        background = new BackgroundElement(this, skinSpec.backgrounds,</b>
<b class="nc">&nbsp;                Collections.nCopies(skinSpec.backgrounds.size(),</b>
<b class="nc">&nbsp;                        skinSpec.tileBackground));</b>
&nbsp;
<b class="nc">&nbsp;        gbc.gridy++;</b>
&nbsp;
<b class="nc">&nbsp;        add(background, gbc);</b>
&nbsp;
<b class="nc">&nbsp;        JPanel misc = new JPanel(new GridBagLayout());</b>
<b class="nc">&nbsp;        gbc.gridy++;</b>
<b class="nc">&nbsp;        add(misc, gbc);</b>
&nbsp;
<b class="nc">&nbsp;        gbc.gridx = gbc.gridy = 0;</b>
<b class="nc">&nbsp;        gbc.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;        misc.add(showScrollBars);</b>
&nbsp;
<b class="nc">&nbsp;        resetColorButtons(skinSpec);</b>
<b class="nc">&nbsp;        JPanel glue = new JPanel();</b>
<b class="nc">&nbsp;        glue.add(colorLbl);</b>
<b class="nc">&nbsp;        for (JButton colorButton : colorButtons) {</b>
<b class="nc">&nbsp;            glue.add(colorButton);</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        glue.add(addColor);</b>
<b class="nc">&nbsp;        glue.add(removeColor);</b>
<b class="nc">&nbsp;        gbc.gridy++;</b>
<b class="nc">&nbsp;        misc.add(glue, gbc);</b>
&nbsp;
<b class="nc">&nbsp;        revalidate();</b>
<b class="nc">&nbsp;        addListeners();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void valueChanged(ListSelectionEvent e) {
<b class="nc">&nbsp;        if (e.getValueIsAdjusting()) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;        removeListeners();</b>
<b class="nc">&nbsp;        boolean notify = false;</b>
<b class="nc">&nbsp;        if (e.getSource() instanceof JButton) {</b>
<b class="nc">&nbsp;            if (addColor.equals(e.getSource())) {</b>
<b class="nc">&nbsp;                if (colorButtons.size() &lt; SkinSpecification.MAX_NUM_COLORS) {</b>
<b class="nc">&nbsp;                    JButton colorButton = new JButton();</b>
<b class="nc">&nbsp;                    colorButton.setMaximumSize(new Dimension(14, 14));</b>
<b class="nc">&nbsp;                    colorButton.setPreferredSize(new Dimension(14, 14));</b>
<b class="nc">&nbsp;                    colorButton.setForeground(Color.BLACK);</b>
<b class="nc">&nbsp;                    colorButton.setBackground(Color.BLACK);</b>
<b class="nc">&nbsp;                    colorButtons.add(colorButton);</b>
<b class="nc">&nbsp;                    notify = true;</b>
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;            } else if (removeColor.equals(e.getSource())) {</b>
<b class="nc">&nbsp;                if (colorButtons.size() &gt; 1) {</b>
<b class="nc">&nbsp;                    colorButtons.remove(colorButtons.size() - 1);</b>
<b class="nc">&nbsp;                    notify = true;</b>
&nbsp;                }
<b class="nc">&nbsp;            } else if (colorButtons.contains(e.getSource())) {</b>
<b class="nc">&nbsp;                JButton colorButton = (JButton) e.getSource();</b>
<b class="nc">&nbsp;                Color newColor = JColorChooser.showDialog(this,</b>
<b class="nc">&nbsp;                        Messages.getString(&quot;SkinEditor.ColorChoice&quot;), //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        colorButton.getBackground());</b>
<b class="nc">&nbsp;                if (newColor != null) {</b>
<b class="nc">&nbsp;                    colorButton.setBackground(newColor);</b>
<b class="nc">&nbsp;                    notify = true;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        if (notify) {</b>
<b class="nc">&nbsp;            notifySkinChanges(true);</b>
&nbsp;        } else { // If we notify, listeners are added, don&#39;t double-add
<b class="nc">&nbsp;            addListeners();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Override the base setEnabled to also set the state of all members.
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void setEnabled(boolean enabled) {
&nbsp;        // Corners
<b class="nc">&nbsp;        tlCorner.setEnabled(enabled);</b>
<b class="nc">&nbsp;        trCorner.setEnabled(enabled);</b>
<b class="nc">&nbsp;        blCorner.setEnabled(enabled);</b>
<b class="nc">&nbsp;        brCorner.setEnabled(enabled);</b>
&nbsp;
&nbsp;        // Edges
<b class="nc">&nbsp;        topEdge.setEnabled(enabled);</b>
<b class="nc">&nbsp;        bottomEdge.setEnabled(enabled);</b>
<b class="nc">&nbsp;        leftEdge.setEnabled(enabled);</b>
<b class="nc">&nbsp;        rightEdge.setEnabled(enabled);</b>
&nbsp;    }
&nbsp;
&nbsp;    public void signalValidate() {
<b class="nc">&nbsp;        skinEditor.validate();</b>
&nbsp;    }
&nbsp;
&nbsp;    public void notifySkinChanges(boolean setupSkinEditPanel) {
<b class="nc">&nbsp;        skinEditor.notifySkinChanges(setupSkinEditPanel);</b>
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
