


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > MissionRole</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ratgenerator</a>
</div>

<h1>Coverage Summary for Class: MissionRole (megamek.client.ratgenerator)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">MissionRole</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/369)
  </span>
</td>
</tr>
  <tr>
    <td class="name">MissionRole$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/370)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2005 Ben Mazur (bmazur@sev.org)
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;package megamek.client.ratgenerator;
&nbsp;
&nbsp;import java.util.Collection;
&nbsp;import java.util.HashSet;
&nbsp;
&nbsp;import megamek.common.UnitType;
&nbsp;
&nbsp;/**
&nbsp; * Used to adjust availability to conform to a particular mission role.
&nbsp; * 
&nbsp; * @author Neoancient
&nbsp; *
&nbsp; */
<b class="nc">&nbsp;public enum MissionRole {</b>
&nbsp;    /*General combat roles */
<b class="nc">&nbsp;    RECON, RAIDER, INCENDIARY, EW_SUPPORT, ARTILLERY, MISSILE_ARTILLERY, APC, TRAINING, COMMAND,</b>
&nbsp;    /* Non-combat roles */
<b class="nc">&nbsp;    CARGO, SUPPORT, CIVILIAN,</b>
&nbsp;    /* Ground forces */
<b class="nc">&nbsp;    FIRE_SUPPORT, SR_FIRE_SUPPORT, URBAN, SPOTTER, ANTI_AIRCRAFT, ANTI_INFANTRY, INF_SUPPORT, CAVALRY,</b>
&nbsp;    /* Specialized ground support roles */
<b class="nc">&nbsp;    SPECOPS, ENGINEER, MINESWEEPER, MINELAYER,</b>
&nbsp;    /* ASF roles */
<b class="nc">&nbsp;    BOMBER, ESCORT, INTERCEPTOR, GROUND_SUPPORT, //unused: STRIKE,</b>
&nbsp;    /* DropShip roles */
<b class="nc">&nbsp;    ASSAULT, MECH_CARRIER, ASF_CARRIER, VEE_CARRIER, INFANTRY_CARRIER, BA_CARRIER, TROOP_CARRIER,</b>
<b class="nc">&nbsp;    TUG, POCKET_WARSHIP, PROTOMECH_CARRIER,</b>
&nbsp;    /* WarShip roles */
<b class="nc">&nbsp;    CORVETTE, DESTROYER, FRIGATE, CRUISER, BATTLESHIP,</b>
&nbsp;    /* Mechanized Battle armor */
<b class="nc">&nbsp;    OMNI, MECHANIZED_BA, MAG_CLAMP,</b>
&nbsp;    /* Infantry roles */
<b class="nc">&nbsp;    MARINE, MOUNTAINEER, XCT, PARATROOPER, ANTI_MEK, FIELD_GUN,</b>
&nbsp;    /* allows artillery but does not filter out all other roles */
<b class="nc">&nbsp;    MIXED_ARTILLERY; </b>
&nbsp;    
&nbsp;    public boolean fitsUnitType(int unitType) {
<b class="nc">&nbsp;        switch (this) {</b>
&nbsp;        case RECON:
&nbsp;        case SUPPORT:
<b class="nc">&nbsp;            return true;</b>
&nbsp;        
&nbsp;        case CIVILIAN:
<b class="nc">&nbsp;            return unitType &gt;= UnitType.SMALL_CRAFT &amp;&amp; unitType != UnitType.WARSHIP;</b>
&nbsp;            
&nbsp;        case COMMAND:
<b class="nc">&nbsp;            return unitType &lt;= UnitType.GUN_EMPLACEMENT;</b>
&nbsp;            
&nbsp;        case SPECOPS:
<b class="nc">&nbsp;            return unitType &lt; UnitType.JUMPSHIP;</b>
&nbsp;            
&nbsp;        case URBAN:
&nbsp;        case ANTI_INFANTRY:
&nbsp;        case INF_SUPPORT:
<b class="nc">&nbsp;            return unitType &lt;= UnitType.TANK;</b>
&nbsp;            
&nbsp;        case FIRE_SUPPORT:
&nbsp;        case CAVALRY:
&nbsp;        case RAIDER:
&nbsp;        case APC:
<b class="nc">&nbsp;            return unitType &lt;= UnitType.TANK || unitType == UnitType.VTOL;</b>
&nbsp;            
&nbsp;        case ARTILLERY:
&nbsp;        case MISSILE_ARTILLERY:
<b class="nc">&nbsp;            return unitType &lt; UnitType.CONV_FIGHTER || unitType == UnitType.SMALL_CRAFT || unitType == UnitType.DROPSHIP;</b>
&nbsp;            
&nbsp;        case INCENDIARY:
&nbsp;        case ANTI_AIRCRAFT:
<b class="nc">&nbsp;            return unitType &lt;= UnitType.PROTOMEK; // all ground units</b>
&nbsp;            
&nbsp;        case ENGINEER:
&nbsp;        case MINESWEEPER:
&nbsp;        case MINELAYER:
<b class="nc">&nbsp;            return unitType &lt; UnitType.TANK || unitType == UnitType.INFANTRY;</b>
&nbsp;
&nbsp;        case CARGO:
<b class="nc">&nbsp;            return unitType &lt; UnitType.BATTLE_ARMOR || unitType &gt; UnitType.PROTOMEK;</b>
&nbsp;            
&nbsp;        case EW_SUPPORT:
<b class="nc">&nbsp;            return unitType &lt;= UnitType.TANK || unitType == UnitType.AERO;</b>
&nbsp;
&nbsp;        case TRAINING:
<b class="nc">&nbsp;            return unitType &lt; UnitType.SMALL_CRAFT;</b>
&nbsp;        
&nbsp;        case SPOTTER:
<b class="nc">&nbsp;            return unitType &lt;= UnitType.AERO;</b>
&nbsp;            
&nbsp;        case BOMBER:
&nbsp;        case ESCORT:
&nbsp;        case INTERCEPTOR:
&nbsp;        case GROUND_SUPPORT:
&nbsp;        //case STRIKE:
<b class="nc">&nbsp;            return unitType == UnitType.AERO || unitType == UnitType.CONV_FIGHTER;</b>
&nbsp;            
&nbsp;        case ASSAULT:
&nbsp;        case VEE_CARRIER:
&nbsp;        case INFANTRY_CARRIER:
&nbsp;        case BA_CARRIER:
&nbsp;        case MECH_CARRIER:
&nbsp;        case TUG:
&nbsp;        case POCKET_WARSHIP:
&nbsp;        case PROTOMECH_CARRIER:
<b class="nc">&nbsp;            return unitType == UnitType.DROPSHIP;</b>
&nbsp;            
&nbsp;        case TROOP_CARRIER:
&nbsp;        case ASF_CARRIER:
<b class="nc">&nbsp;            return unitType == UnitType.DROPSHIP || unitType == UnitType.WARSHIP;</b>
&nbsp;            
&nbsp;        case CORVETTE:
&nbsp;        case DESTROYER:
&nbsp;        case FRIGATE:
&nbsp;        case CRUISER:
&nbsp;        case BATTLESHIP:
<b class="nc">&nbsp;            return unitType == UnitType.WARSHIP;</b>
&nbsp;            
&nbsp;        case OMNI:
<b class="nc">&nbsp;            return (unitType == UnitType.MEK)</b>
&nbsp;                    || (unitType == UnitType.AERO)
&nbsp;                    || (unitType == UnitType.TANK);
&nbsp;            // This should apply to fixed-wing support also, but that cannot be distinguished from conventional fighters here.
&nbsp;            
&nbsp;        case MECHANIZED_BA:
&nbsp;        case MAG_CLAMP:
<b class="nc">&nbsp;            return unitType == UnitType.BATTLE_ARMOR;</b>
&nbsp;            
&nbsp;        case MARINE:
&nbsp;        case XCT:
<b class="nc">&nbsp;            return unitType == UnitType.INFANTRY || unitType == UnitType.BATTLE_ARMOR;</b>
&nbsp;            
&nbsp;        case MOUNTAINEER:
&nbsp;        case PARATROOPER:
&nbsp;        case ANTI_MEK:
&nbsp;        case FIELD_GUN:
<b class="nc">&nbsp;            return unitType == UnitType.INFANTRY;</b>
&nbsp;            
&nbsp;        case MIXED_ARTILLERY:
&nbsp;            /* TODO: allow inclusion of artillery without binary either/or */ 
&nbsp;        default:
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    public static Double adjustAvailabilityByRole(double avRating, Collection&lt;MissionRole&gt; desiredRoles,
&nbsp;            ModelRecord mRec, int year, int strictness) {
<b class="nc">&nbsp;        boolean roleApplied = false;</b>
<b class="nc">&nbsp;        if (desiredRoles == null) {</b>
<b class="nc">&nbsp;            desiredRoles = new HashSet&lt;MissionRole&gt;();</b>
&nbsp;        }
<b class="nc">&nbsp;        double[] avAdj = new double[5];</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; avAdj.length; i++) {</b>
<b class="nc">&nbsp;            avAdj[i] = (i + 1) * strictness / 3.0;</b>
&nbsp;        }
<b class="nc">&nbsp;        if (desiredRoles.size() &gt; 0) {</b>
<b class="nc">&nbsp;            roleApplied = true;</b>
<b class="nc">&nbsp;            for (MissionRole role : desiredRoles) {</b>
<b class="nc">&nbsp;                switch (role) {</b>
&nbsp;                case ARTILLERY:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(ARTILLERY)</b>
<b class="nc">&nbsp;                            &amp;&amp; !mRec.getRoles().contains(MISSILE_ARTILLERY)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case MISSILE_ARTILLERY:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(MISSILE_ARTILLERY)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case ENGINEER:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(ENGINEER)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case RECON:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(RECON)){</b>
<b class="nc">&nbsp;                            avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(EW_SUPPORT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(SPOTTER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (isSpecialized(desiredRoles, mRec)) {</b>
<b class="nc">&nbsp;                            return null;</b>
<b class="nc">&nbsp;                        } else if (mRec.getUnitType() != UnitType.INFANTRY</b>
<b class="nc">&nbsp;                                &amp;&amp; mRec.getUnitType() != UnitType.BATTLE_ARMOR</b>
<b class="nc">&nbsp;                                    &amp;&amp; mRec.getSpeed() &lt; 4 + avAdj[2] - mRec.getWeightClass()) {</b>
<b class="nc">&nbsp;                            return null;</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            avRating += mRec.getSpeed() - (4 + avAdj[2] - mRec.getWeightClass());</b>
<b class="nc">&nbsp;                            if (mRec.getRoles().contains(URBAN) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(INF_SUPPORT) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(ANTI_INFANTRY) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(APC) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(MOUNTAINEER) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(PARATROOPER) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(MARINE) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(XCT)) {</b>
<b class="nc">&nbsp;                                avRating -= avAdj[3];</b>
<b class="nc">&nbsp;                            } else if (mRec.getRoles().contains(SPECOPS)) {</b>
<b class="nc">&nbsp;                                avRating -= avAdj[4];</b>
&nbsp;                            } else {
<b class="nc">&nbsp;                                avRating -= avAdj[0];</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case COMMAND:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(COMMAND)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
&nbsp;                    }
<b class="nc">&nbsp;                    if ((ModelRecord.NETWORK_COMPANY_COMMAND &amp; mRec.getNetworkMask()) != 0) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
<b class="nc">&nbsp;                    } else if ((ModelRecord.NETWORK_C3_MASTER &amp; mRec.getNetworkMask()) != 0) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case FIELD_GUN:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(FIELD_GUN)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case FIRE_SUPPORT:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(FIRE_SUPPORT)</b>
<b class="nc">&nbsp;                            || mRec.getLongRange() &gt; 0.75) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getLongRange() &gt; 0.5) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
<b class="nc">&nbsp;                    } else if (mRec.getLongRange() &gt; 0.2) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(SR_FIRE_SUPPORT)</b>
<b class="nc">&nbsp;                            || mRec.getRoles().contains(ANTI_AIRCRAFT)</b>
<b class="nc">&nbsp;                            || mRec.getRoles().contains(MISSILE_ARTILLERY)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case INF_SUPPORT:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(INF_SUPPORT)) {</b>
<b class="nc">&nbsp;                        avRating += strictness;</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(APC)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(ANTI_INFANTRY)</b>
<b class="nc">&nbsp;                            || mRec.getRoles().contains(URBAN)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (isSpecialized(desiredRoles, mRec)) {</b>
<b class="nc">&nbsp;                            return null;</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            if (mRec.getRoles().contains(MOUNTAINEER) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(PARATROOPER)) {</b>
<b class="nc">&nbsp;                                avRating -= avAdj[2];</b>
<b class="nc">&nbsp;                            } else if (mRec.getRoles().contains(INCENDIARY) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(MARINE) ||</b>
<b class="nc">&nbsp;                                    mRec.getRoles().contains(XCT)) {</b>
<b class="nc">&nbsp;                                avRating -= avAdj[3];</b>
<b class="nc">&nbsp;                            } else if (mRec.getRoles().contains(SPECOPS)) {</b>
<b class="nc">&nbsp;                                avRating -= avAdj[4];</b>
&nbsp;                            } else {
<b class="nc">&nbsp;                                avRating -= avAdj[1];</b>
&nbsp;                            }
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case OMNI:
<b class="nc">&nbsp;                    if (isSpecialized(desiredRoles, mRec) || !mRec.isOmni()) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case MECHANIZED_BA:
<b class="nc">&nbsp;                    if (mRec.getUnitType() == UnitType.BATTLE_ARMOR</b>
<b class="nc">&nbsp;                            &amp;&amp; !mRec.canDoMechanizedBA()) {</b>
<b class="nc">&nbsp;                        return null;                        </b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case MAG_CLAMP:
<b class="nc">&nbsp;                    if (mRec.getUnitType() == UnitType.BATTLE_ARMOR</b>
<b class="nc">&nbsp;                            &amp;&amp; !mRec.hasMagClamp()) {</b>
<b class="nc">&nbsp;                        return null;                        </b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case URBAN:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(URBAN)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(ANTI_INFANTRY)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(INF_SUPPORT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (isSpecialized(desiredRoles, mRec)) {</b>
<b class="nc">&nbsp;                            return null;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        if (mRec.getRoles().contains(FIRE_SUPPORT) ||</b>
<b class="nc">&nbsp;                                mRec.getRoles().contains(SR_FIRE_SUPPORT) ||</b>
<b class="nc">&nbsp;                                mRec.getRoles().contains(ANTI_AIRCRAFT)) {</b>
<b class="nc">&nbsp;                            avRating -= avAdj[0];</b>
&nbsp;                        }
<b class="nc">&nbsp;                        if (mRec.getRoles().contains(MARINE) ||</b>
<b class="nc">&nbsp;                                mRec.getRoles().contains(XCT)) {</b>
<b class="nc">&nbsp;                            avRating -= avAdj[2];</b>
&nbsp;                        }
<b class="nc">&nbsp;                        if (mRec.getRoles().contains(MOUNTAINEER) ||</b>
<b class="nc">&nbsp;                                mRec.getRoles().contains(PARATROOPER) ||</b>
<b class="nc">&nbsp;                                mRec.getRoles().contains(SPECOPS)) {</b>
<b class="nc">&nbsp;                            avRating -= avAdj[3];</b>
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                    if (avRating &gt; 0 &amp;&amp; mRec.getUnitType() == UnitType.TANK) {</b>
<b class="nc">&nbsp;                        if (mRec.getMechSummary().getUnitSubType().equals(&quot;Wheeled&quot;)) {</b>
<b class="nc">&nbsp;                            avRating += avAdj[2];</b>
<b class="nc">&nbsp;                        } else if (mRec.getMechSummary().getUnitSubType().equals(&quot;Tracked&quot;)) {</b>
<b class="nc">&nbsp;                            avRating -= avAdj[2];</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                    break;
&nbsp;                    
&nbsp;                case RAIDER:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(RAIDER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (isSpecialized(desiredRoles, mRec)) {</b>
<b class="nc">&nbsp;                            return null;</b>
<b class="nc">&nbsp;                        } else if (mRec.getAmmoRequirement() &lt; 0.2) {</b>
<b class="nc">&nbsp;                            avRating += avAdj[0];</b>
<b class="nc">&nbsp;                        } else if (mRec.getAmmoRequirement() &lt; 0.5) {</b>
<b class="nc">&nbsp;                            avRating += avAdj[1];</b>
&nbsp;                        }
<b class="nc">&nbsp;                        if (mRec.getUnitType() != UnitType.INFANTRY</b>
<b class="nc">&nbsp;                                &amp;&amp; mRec.getUnitType() != UnitType.BATTLE_ARMOR</b>
<b class="nc">&nbsp;                                    &amp;&amp; mRec.getSpeed() &lt; 3 + avAdj[2] - mRec.getWeightClass()) {</b>
<b class="nc">&nbsp;                            avRating -= 2 + avAdj[2] - mRec.getWeightClass() - mRec.getSpeed();</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case INCENDIARY:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(INCENDIARY)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (isSpecialized(desiredRoles, mRec)) {</b>
<b class="nc">&nbsp;                            avRating = 0;</b>
<b class="nc">&nbsp;                        } else if (mRec.hasIncendiaryWeapon()) {</b>
<b class="nc">&nbsp;                            avRating += avAdj[2];</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            avRating -= avAdj[2];</b>
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case ANTI_AIRCRAFT:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(ANTI_AIRCRAFT) ||</b>
<b class="nc">&nbsp;                            mRec.getFlak() &gt; 0.75) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getFlak() &gt; 0.5) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
<b class="nc">&nbsp;                    } else if (mRec.getFlak() &gt; 0.2) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        if (isSpecialized(desiredRoles, mRec)) {</b>
<b class="nc">&nbsp;                            return null;</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            avRating -= avAdj[1];</b>
&nbsp;                        }
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case ANTI_INFANTRY:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(ANTI_INFANTRY)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else     if (isSpecialized(desiredRoles, mRec)) {</b>
<b class="nc">&nbsp;                        return null;</b>
<b class="nc">&nbsp;                    } else if (!mRec.hasAPWeapons()) {</b>
<b class="nc">&nbsp;                        avRating -= avAdj[2];</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                    
&nbsp;                case GROUND_SUPPORT:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(GROUND_SUPPORT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        avRating -= avAdj[2];</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case INTERCEPTOR:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(INTERCEPTOR)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        avRating -= avAdj[2];</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case BOMBER:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(BOMBER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        avRating -= avAdj[2];</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case ESCORT:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(ESCORT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        avRating -= avAdj[2];</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case CAVALRY:
<b class="nc">&nbsp;                    if (mRec.getUnitType() == UnitType.INFANTRY</b>
<b class="nc">&nbsp;                            || mRec.getUnitType() == UnitType.BATTLE_ARMOR) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2] * (mRec.getSpeed() - 3);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        avRating += avAdj[2] * (mRec.getSpeed() - (7 - mRec.getWeightClass()));                    </b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                //Large craft roles
&nbsp;                case CIVILIAN:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(CIVILIAN)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case CARGO:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(CARGO)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(CIVILIAN)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        avRating -= avAdj[2];</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case SUPPORT:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(SUPPORT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(TUG)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[1];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(CARGO)</b>
<b class="nc">&nbsp;                                || mRec.getRoles().contains(CIVILIAN)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        avRating -= avAdj[2];</b>
&nbsp;                    }
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case TUG:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(TUG)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case POCKET_WARSHIP:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(POCKET_WARSHIP)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(ASSAULT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case ASSAULT:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(ASSAULT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(POCKET_WARSHIP)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case MECH_CARRIER:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(MECH_CARRIER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(TROOP_CARRIER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case ASF_CARRIER:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(ASF_CARRIER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(ASSAULT)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case BA_CARRIER:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(BA_CARRIER)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case INFANTRY_CARRIER:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(INFANTRY_CARRIER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(TROOP_CARRIER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case VEE_CARRIER:
<b class="nc">&nbsp;                    if (mRec.getRoles().contains(VEE_CARRIER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[2];</b>
<b class="nc">&nbsp;                    } else if (mRec.getRoles().contains(TROOP_CARRIER)) {</b>
<b class="nc">&nbsp;                        avRating += avAdj[0];</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case PROTOMECH_CARRIER:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(PROTOMECH_CARRIER)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case TROOP_CARRIER:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(TROOP_CARRIER)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case CORVETTE:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(CORVETTE)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case DESTROYER:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(DESTROYER)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case FRIGATE:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(FRIGATE)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case CRUISER:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(CRUISER)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case BATTLESHIP:
<b class="nc">&nbsp;                    if (!mRec.getRoles().contains(BATTLESHIP)) {</b>
<b class="nc">&nbsp;                        return null;</b>
&nbsp;                    }
&nbsp;                    break;
&nbsp;                default:
<b class="nc">&nbsp;                    roleApplied = false;</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;        /* Reduce rating of units with certain specialized functions if the roles does not
&nbsp;         * require them.
&nbsp;         */
<b class="nc">&nbsp;        if (!roleApplied) {</b>
<b class="nc">&nbsp;            if ((mRec.getRoles().contains(SUPPORT) &amp;&amp; !desiredRoles.contains(SUPPORT)) ||</b>
<b class="nc">&nbsp;                    (mRec.getRoles().contains(CARGO) &amp;&amp; !(desiredRoles.contains(CARGO) || desiredRoles.size() &gt; 1 || mRec.getUnitType() == UnitType.WARSHIP)) ||</b>
<b class="nc">&nbsp;                    (mRec.getRoles().contains(TUG) &amp;&amp; !desiredRoles.contains(TUG)) ||</b>
<b class="nc">&nbsp;                    (mRec.getRoles().contains(CIVILIAN) &amp;&amp; !desiredRoles.contains(CIVILIAN)) ||</b>
<b class="nc">&nbsp;                    (mRec.getRoles().contains(TRAINING) &amp;&amp; !desiredRoles.contains(TRAINING)) ||</b>
<b class="nc">&nbsp;                    (mRec.getRoles().contains(FIELD_GUN) &amp;&amp; !desiredRoles.contains(FIELD_GUN)) ||</b>
<b class="nc">&nbsp;                    (mRec.getRoles().contains(ARTILLERY) &amp;&amp; !desiredRoles.contains(MIXED_ARTILLERY))) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (mRec.getRoles().contains(MISSILE_ARTILLERY) &amp;&amp;</b>
<b class="nc">&nbsp;                    !desiredRoles.contains(ARTILLERY)</b>
<b class="nc">&nbsp;                    &amp;&amp; !desiredRoles.contains(MISSILE_ARTILLERY)</b>
<b class="nc">&nbsp;                    &amp;&amp; !desiredRoles.contains(FIRE_SUPPORT)</b>
<b class="nc">&nbsp;                    &amp;&amp; !desiredRoles.contains(MIXED_ARTILLERY)) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            if (mRec.getRoles().contains(RECON) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(EW_SUPPORT)) {</b>
<b class="nc">&nbsp;                avRating -= avAdj[0];</b>
&nbsp;            }
<b class="nc">&nbsp;            if (mRec.getRoles().contains(URBAN) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(INF_SUPPORT) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(ANTI_INFANTRY) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(APC) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(MOUNTAINEER) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(PARATROOPER)) {</b>
<b class="nc">&nbsp;                avRating -= avAdj[1];</b>
&nbsp;            }
<b class="nc">&nbsp;            if (mRec.getRoles().contains(INCENDIARY) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(MARINE) ||</b>
<b class="nc">&nbsp;                    mRec.getRoles().contains(XCT)) {</b>
<b class="nc">&nbsp;                avRating -= avAdj[2];</b>
&nbsp;            }
<b class="nc">&nbsp;            if (mRec.getRoles().contains(SPECOPS)) {</b>
<b class="nc">&nbsp;                avRating -= avAdj[3];</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return avRating;</b>
&nbsp;    }
&nbsp;
&nbsp;    private static boolean isSpecialized(Collection&lt;MissionRole&gt; desiredRoles,
&nbsp;            ModelRecord mRec) {
<b class="nc">&nbsp;        return (mRec.getRoles().contains(SUPPORT) &amp;&amp; !desiredRoles.contains(SUPPORT)) ||</b>
<b class="nc">&nbsp;                (mRec.getRoles().contains(CARGO) &amp;&amp; !desiredRoles.contains(CARGO)) ||</b>
<b class="nc">&nbsp;                (mRec.getRoles().contains(TUG) &amp;&amp; !desiredRoles.contains(TUG)) ||</b>
<b class="nc">&nbsp;                (mRec.getRoles().contains(CIVILIAN) &amp;&amp; !desiredRoles.contains(CIVILIAN)) ||</b>
<b class="nc">&nbsp;                (mRec.getRoles().contains(TRAINING) &amp;&amp; !desiredRoles.contains(TRAINING)) ||</b>
<b class="nc">&nbsp;                (mRec.getRoles().contains(ARTILLERY) &amp;&amp; !desiredRoles.contains(ARTILLERY)</b>
<b class="nc">&nbsp;                        &amp;&amp; !desiredRoles.contains(MIXED_ARTILLERY));</b>
&nbsp;    }
&nbsp;    
&nbsp;    public static MissionRole parseRole(String role) {
<b class="nc">&nbsp;        switch (role.toLowerCase().replace(&quot;_&quot;, &quot; &quot;)) {</b>
&nbsp;        case &quot;recon&quot;:
<b class="nc">&nbsp;            return RECON;</b>
&nbsp;        case &quot;fire support&quot;:
<b class="nc">&nbsp;            return FIRE_SUPPORT;</b>
&nbsp;        case &quot;command&quot;:
<b class="nc">&nbsp;            return COMMAND;</b>
&nbsp;        case &quot;sr fire support&quot;:
<b class="nc">&nbsp;            return SR_FIRE_SUPPORT;</b>
&nbsp;        case &quot;spotter&quot;:
<b class="nc">&nbsp;            return SPOTTER;</b>
&nbsp;        case &quot;urban&quot;:
<b class="nc">&nbsp;            return URBAN;</b>
&nbsp;        case &quot;infantry support&quot;:
&nbsp;        case &quot;inf support&quot;:
<b class="nc">&nbsp;            return INF_SUPPORT;</b>
&nbsp;        case &quot;cavalry&quot;:
<b class="nc">&nbsp;            return CAVALRY;</b>
&nbsp;        case &quot;raider&quot;:
<b class="nc">&nbsp;            return RAIDER;</b>
&nbsp;        case &quot;incendiary&quot;:
&nbsp;        case &quot;incindiary&quot;:
<b class="nc">&nbsp;            return INCENDIARY;</b>
&nbsp;        case &quot;ew support&quot;:
<b class="nc">&nbsp;            return EW_SUPPORT;</b>
&nbsp;        case &quot;artillery&quot;:
<b class="nc">&nbsp;            return ARTILLERY;</b>
&nbsp;        case &quot;missile artillery&quot;:
<b class="nc">&nbsp;            return MISSILE_ARTILLERY;</b>
&nbsp;        case &quot;anti-aircraft&quot;:
&nbsp;        case &quot;anti aircraft&quot;:
<b class="nc">&nbsp;            return ANTI_AIRCRAFT;</b>
&nbsp;        case &quot;anti-infantry&quot;:
&nbsp;        case &quot;anti infantry&quot;:
<b class="nc">&nbsp;            return ANTI_INFANTRY;</b>
&nbsp;        case &quot;apc&quot;:
<b class="nc">&nbsp;            return APC;</b>
&nbsp;        case &quot;spec ops&quot;:
&nbsp;        case &quot;specops&quot;:
<b class="nc">&nbsp;            return SPECOPS;</b>
&nbsp;        case &quot;cargo&quot;:
<b class="nc">&nbsp;            return CARGO;</b>
&nbsp;        case &quot;support&quot;:
<b class="nc">&nbsp;            return SUPPORT;</b>
&nbsp;        case &quot;bomber&quot;:
<b class="nc">&nbsp;            return BOMBER;</b>
&nbsp;        case &quot;escort&quot;:
<b class="nc">&nbsp;            return ESCORT;</b>
&nbsp;        case &quot;interceptor&quot;:
<b class="nc">&nbsp;            return INTERCEPTOR;</b>
&nbsp;        case &quot;ground support&quot;:
<b class="nc">&nbsp;            return GROUND_SUPPORT;</b>
&nbsp;        //case &quot;strike&quot;:
&nbsp;            //return STRIKE;
&nbsp;        case &quot;training&quot;:
<b class="nc">&nbsp;            return TRAINING;</b>
&nbsp;        case &quot;assault&quot;:
<b class="nc">&nbsp;            return ASSAULT;</b>
&nbsp;        case &quot;mech carrier&quot;:
<b class="nc">&nbsp;            return MECH_CARRIER;</b>
&nbsp;        case &quot;asf carrier&quot;:
<b class="nc">&nbsp;            return ASF_CARRIER;</b>
&nbsp;        case &quot;vee carrier&quot;:
<b class="nc">&nbsp;            return VEE_CARRIER;</b>
&nbsp;        case &quot;infantry carrier&quot;:
<b class="nc">&nbsp;            return INFANTRY_CARRIER;</b>
&nbsp;        case &quot;ba carrier&quot;:
<b class="nc">&nbsp;            return BA_CARRIER;</b>
&nbsp;        case &quot;protomech carrier&quot;:
<b class="nc">&nbsp;            return PROTOMECH_CARRIER;</b>
&nbsp;        case &quot;tug&quot;:
<b class="nc">&nbsp;            return TUG;</b>
&nbsp;        case &quot;troop carrier&quot;:
<b class="nc">&nbsp;            return TROOP_CARRIER;</b>
&nbsp;        case &quot;pocket ws&quot;:
&nbsp;        case &quot;pocket warship&quot;:
<b class="nc">&nbsp;            return POCKET_WARSHIP;</b>
&nbsp;        case &quot;corvette&quot;:
<b class="nc">&nbsp;            return CORVETTE;</b>
&nbsp;        case &quot;destroyer&quot;:
<b class="nc">&nbsp;            return DESTROYER;</b>
&nbsp;        case &quot;frigate&quot;:
<b class="nc">&nbsp;            return FRIGATE;</b>
&nbsp;        case &quot;cruiser&quot;:
<b class="nc">&nbsp;            return CRUISER;</b>
&nbsp;        case &quot;battleship&quot;:
<b class="nc">&nbsp;            return BATTLESHIP;</b>
&nbsp;        case &quot;engineer&quot;:
<b class="nc">&nbsp;            return ENGINEER;</b>
&nbsp;        case &quot;marine&quot;:
<b class="nc">&nbsp;            return MARINE;</b>
&nbsp;        case &quot;mountaineer&quot;:
<b class="nc">&nbsp;            return MOUNTAINEER;</b>
&nbsp;        case &quot;xct&quot;:
<b class="nc">&nbsp;            return XCT;</b>
&nbsp;        case &quot;paratrooper&quot;:
<b class="nc">&nbsp;            return PARATROOPER;</b>
&nbsp;        case &quot;anti-mek&quot;:
&nbsp;        case &quot;anti mek&quot;:
<b class="nc">&nbsp;            return ANTI_MEK;</b>
&nbsp;        case &quot;omni&quot;:
<b class="nc">&nbsp;            return OMNI;</b>
&nbsp;        case &quot;mechanized ba&quot;:
<b class="nc">&nbsp;            return MECHANIZED_BA;</b>
&nbsp;        case &quot;mag clamp&quot;:
<b class="nc">&nbsp;            return MAG_CLAMP;</b>
&nbsp;        case &quot;field gun&quot;:
<b class="nc">&nbsp;            return FIELD_GUN;</b>
&nbsp;        case &quot;civilian&quot;:
<b class="nc">&nbsp;            return CIVILIAN;</b>
&nbsp;        case &quot;minesweeper&quot;:
<b class="nc">&nbsp;            return MINESWEEPER;</b>
&nbsp;        case &quot;minelayer&quot;:
<b class="nc">&nbsp;            return MINELAYER;</b>
&nbsp;        }
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public String toString() {
<b class="nc">&nbsp;        return name().toLowerCase();</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
