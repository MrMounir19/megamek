


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > AdvancedSearchDialog</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing</a>
</div>

<h1>Coverage Summary for Class: AdvancedSearchDialog (megamek.client.ui.swing)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">AdvancedSearchDialog</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/607)
  </span>
</td>
</tr>
  <tr>
    <td class="name">AdvancedSearchDialog$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/13)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/14)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$EquipmentFT</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$EquipmentTableModel</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/38)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$FilterTokens</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$OperationFT</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$ParensFT</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AdvancedSearchDialog$WeaponsTableModel</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/46)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/55)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/738)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2002, 2003 Ben Mazur (bmazur@sev.org)
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;
&nbsp;/**
&nbsp; * Advanced search functions for the mech selector dialog
&nbsp; *
&nbsp; * @author  Jay Lawson
&nbsp; */
&nbsp;package megamek.client.ui.swing;
&nbsp;
&nbsp;import java.awt.BorderLayout;
&nbsp;import java.awt.Dimension;
&nbsp;import java.awt.Font;
&nbsp;import java.awt.Frame;
&nbsp;import java.awt.GridBagConstraints;
&nbsp;import java.awt.GridBagLayout;
&nbsp;import java.awt.Insets;
&nbsp;import java.awt.Label;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.awt.event.ItemEvent;
&nbsp;import java.awt.event.ItemListener;
&nbsp;import java.awt.event.KeyEvent;
&nbsp;import java.awt.event.KeyListener;
&nbsp;import java.awt.event.WindowAdapter;
&nbsp;import java.awt.event.WindowEvent;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Enumeration;
&nbsp;import java.util.Vector;
&nbsp;
&nbsp;import javax.swing.DefaultCellEditor;
&nbsp;import javax.swing.DefaultComboBoxModel;
&nbsp;import javax.swing.DefaultRowSorter;
&nbsp;import javax.swing.JButton;
&nbsp;import javax.swing.JCheckBox;
&nbsp;import javax.swing.JComboBox;
&nbsp;import javax.swing.JDialog;
&nbsp;import javax.swing.JLabel;
&nbsp;import javax.swing.JOptionPane;
&nbsp;import javax.swing.JPanel;
&nbsp;import javax.swing.JScrollPane;
&nbsp;import javax.swing.JTextArea;
&nbsp;import javax.swing.JTextField;
&nbsp;import javax.swing.ListSelectionModel;
&nbsp;import javax.swing.RowFilter;
&nbsp;import javax.swing.RowSorter.SortKey;
&nbsp;import javax.swing.SortOrder;
&nbsp;import javax.swing.SwingConstants;
&nbsp;import javax.swing.event.ListSelectionEvent;
&nbsp;import javax.swing.event.ListSelectionListener;
&nbsp;import javax.swing.table.AbstractTableModel;
&nbsp;import javax.swing.table.TableColumn;
&nbsp;import javax.swing.table.TableRowSorter;
&nbsp;
&nbsp;import megamek.client.ui.Messages;
&nbsp;import megamek.client.ui.swing.table.MegamekTable;
&nbsp;import megamek.common.EquipmentType;
&nbsp;import megamek.common.Mech;
&nbsp;import megamek.common.MechSearchFilter;
&nbsp;import megamek.common.MiscType;
&nbsp;import megamek.common.TechConstants;
&nbsp;import megamek.common.UnitType;
&nbsp;import megamek.common.WeaponType;
&nbsp;
&nbsp;/**
&nbsp; *  JDialog that allows the user to create a unit filter.
&nbsp; *
&nbsp; * @author Arlith
&nbsp; *
&nbsp; */
<b class="nc">&nbsp;public class AdvancedSearchDialog extends JDialog implements ActionListener,</b>
&nbsp;        ItemListener, KeyListener, ListSelectionListener {
&nbsp;
&nbsp;    /**
&nbsp;     *
&nbsp;     */
&nbsp;    private static final long serialVersionUID = 1L;
&nbsp;    /**
&nbsp;     *
&nbsp;     */
<b class="nc">&nbsp;    private boolean isCanceled = true;</b>
<b class="nc">&nbsp;    public MechSearchFilter mechFilter = null;</b>
&nbsp;    private Vector&lt;FilterTokens&gt; filterToks;
<b class="nc">&nbsp;    private JButton btnOkay   =</b>
<b class="nc">&nbsp;        new JButton(Messages.getString(&quot;Okay&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JButton btnCancel = new</b>
<b class="nc">&nbsp;    JButton(Messages.getString(&quot;Cancel&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;    private JButton btnLeftParen =  new JButton(&quot;(&quot;); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JButton btnRightParen =  new JButton(&quot;)&quot;); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JButton btnAdd =</b>
<b class="nc">&nbsp;            new JButton(Messages.getString(&quot;MechSelectorDialog.Search.add&quot;));//$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JButton btnAnd =</b>
<b class="nc">&nbsp;        new JButton(Messages.getString(&quot;MechSelectorDialog.Search.and&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JButton btnOr =</b>
<b class="nc">&nbsp;        new JButton(Messages.getString(&quot;MechSelectorDialog.Search.or&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JButton btnClear =</b>
<b class="nc">&nbsp;        new JButton(Messages.getString(&quot;MechSelectorDialog.Reset&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JButton btnBack =</b>
&nbsp;        new JButton(&quot;Back&quot;); //$NON-NLS-1$
&nbsp;
<b class="nc">&nbsp;    private JLabel  lblEqExpTxt =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.FilterExpression&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JTextArea  txtEqExp =</b>
&nbsp;        new JTextArea(&quot;&quot;); //$NON-NLS-1$
<b class="nc">&nbsp;    private JScrollPane expScroller = new JScrollPane(txtEqExp,</b>
&nbsp;            JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,
&nbsp;            JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
&nbsp;
<b class="nc">&nbsp;    private JLabel lblWalk =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.Walk&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cWalk = new JComboBox&lt;String&gt;();</b>
<b class="nc">&nbsp;    private JTextField tWalk = new JTextField(2);</b>
&nbsp;
<b class="nc">&nbsp;    private JLabel lblJump =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.Jump&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cJump = new JComboBox&lt;String&gt;();</b>
<b class="nc">&nbsp;    private JTextField tJump = new JTextField(2);</b>
&nbsp;
<b class="nc">&nbsp;    private JLabel lblArmor =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.Armor&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cArmor = new JComboBox&lt;String&gt;();</b>
&nbsp;
<b class="nc">&nbsp;    private JLabel lblTableFilters = new JLabel(</b>
<b class="nc">&nbsp;            Messages.getString(&quot;MechSelectorDialog.Search.TableFilters&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JLabel lblUnitType = new JLabel(</b>
<b class="nc">&nbsp;            Messages.getString(&quot;MechSelectorDialog.Search.UnitType&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JLabel lblTechClass = new JLabel(</b>
<b class="nc">&nbsp;            Messages.getString(&quot;MechSelectorDialog.Search.TechClass&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JLabel lblTechLevel = new JLabel(</b>
<b class="nc">&nbsp;            Messages.getString(&quot;MechSelectorDialog.Search.TechLevel&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cboUnitType = new JComboBox&lt;String&gt;();</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cboTechClass = new JComboBox&lt;String&gt;();</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cboTechLevel = new JComboBox&lt;String&gt;();</b>
&nbsp;
<b class="nc">&nbsp;    private JLabel lblWeapons =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.Weapons&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JScrollPane scrTableWeapons = new JScrollPane();</b>
&nbsp;    private MegamekTable tblWeapons;
&nbsp;    private WeaponsTableModel weaponsModel;
&nbsp;    private TableRowSorter&lt;WeaponsTableModel&gt; weaponsSorter;
&nbsp;
<b class="nc">&nbsp;    private JLabel lblEquipment =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.Equipment&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JScrollPane scrTableEquipment = new JScrollPane();</b>
&nbsp;    private MegamekTable tblEquipment;
&nbsp;    private EquipmentTableModel equipmentModel;
&nbsp;    private TableRowSorter&lt;EquipmentTableModel&gt; equipmentSorter;
&nbsp;
<b class="nc">&nbsp;    private JLabel lblYear =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.Year&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JTextField tStartYear = new JTextField(4);</b>
<b class="nc">&nbsp;    private JTextField tEndYear = new JTextField(4);</b>
&nbsp;
<b class="nc">&nbsp;    private JCheckBox cbxEnableCockpitSearch =</b>
<b class="nc">&nbsp;        new JCheckBox(Messages.getString(&quot;MechSelectorDialog.Search.Enable&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JLabel lblCockpitType =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.CockpitType&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cboCockpitType = new JComboBox&lt;String&gt;();</b>
&nbsp;
<b class="nc">&nbsp;    private JCheckBox cbxEnableInternalsSearch =</b>
<b class="nc">&nbsp;        new JCheckBox(Messages.getString(&quot;MechSelectorDialog.Search.Enable&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JLabel lblInternalsType =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.InternalsType&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cboInternalsType = new JComboBox&lt;String&gt;();</b>
&nbsp;
<b class="nc">&nbsp;    private JCheckBox cbxEnableArmorSearch =</b>
<b class="nc">&nbsp;        new JCheckBox(Messages.getString(&quot;MechSelectorDialog.Search.Enable&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JLabel lblArmorType =</b>
<b class="nc">&nbsp;        new JLabel(Messages.getString(&quot;MechSelectorDialog.Search.ArmorType&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cboArmorType = new JComboBox&lt;String&gt;();</b>
&nbsp;
<b class="nc">&nbsp;    private JComboBox&lt;String&gt; cboQty   = new JComboBox&lt;String&gt;();</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Stores the games current year.
&nbsp;     */
&nbsp;    private int gameYear;
&nbsp;
&nbsp;    /**
&nbsp;     * Constructs a new AdvancedSearchDialog.
&nbsp;     *
&nbsp;     * @param frame  Parent frame
&nbsp;     */
&nbsp;    public AdvancedSearchDialog(Frame frame,int yr) {
<b class="nc">&nbsp;        super(frame, Messages.getString(&quot;AdvancedSearchDialog.title&quot;), true); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;        gameYear = yr;</b>
&nbsp;
<b class="nc">&nbsp;        filterToks = new Vector&lt;FilterTokens&gt;(30);</b>
&nbsp;
&nbsp;        //Initialize Items
<b class="nc">&nbsp;        btnOkay.addActionListener(this);</b>
<b class="nc">&nbsp;        btnCancel.addActionListener(this);</b>
<b class="nc">&nbsp;        btnAnd.addActionListener(this);</b>
<b class="nc">&nbsp;        btnAdd.addActionListener(this);</b>
<b class="nc">&nbsp;        btnLeftParen.addActionListener(this);</b>
<b class="nc">&nbsp;        btnRightParen.addActionListener(this);</b>
<b class="nc">&nbsp;        btnOr.addActionListener(this);</b>
<b class="nc">&nbsp;        btnClear.addActionListener(this);</b>
<b class="nc">&nbsp;        btnBack.addActionListener(this);</b>
&nbsp;
<b class="nc">&nbsp;        btnBack.setEnabled(false);</b>
<b class="nc">&nbsp;        btnAdd.setEnabled(false);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        cWalk.addItem(Messages.getString(&quot;MechSelectorDialog.Search.AtLeast&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cWalk.addItem(Messages.getString(&quot;MechSelectorDialog.Search.EqualTo&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cWalk.addItem(Messages.getString(&quot;MechSelectorDialog.Search.NoMoreThan&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;        cJump.addItem(Messages.getString(&quot;MechSelectorDialog.Search.AtLeast&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cJump.addItem(Messages.getString(&quot;MechSelectorDialog.Search.EqualTo&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cJump.addItem(Messages.getString(&quot;MechSelectorDialog.Search.NoMoreThan&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;        cArmor.addItem(Messages.getString(&quot;MechSelectorDialog.Search.Any&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cArmor.addItem(Messages.getString(&quot;MechSelectorDialog.Search.Armor25&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cArmor.addItem(Messages.getString(&quot;MechSelectorDialog.Search.Armor50&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cArmor.addItem(Messages.getString(&quot;MechSelectorDialog.Search.Armor75&quot;)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        cArmor.addItem(Messages.getString(&quot;MechSelectorDialog.Search.Armor90&quot;)); //$NON-NLS-1$</b>
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; EquipmentType.armorNames.length; i++) {</b>
<b class="nc">&nbsp;            cboArmorType.addItem(EquipmentType.armorNames[i]);</b>
&nbsp;        }
<b class="nc">&nbsp;        cboArmorType.setEnabled(false);</b>
<b class="nc">&nbsp;        lblArmorType.setEnabled(false);</b>
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; EquipmentType.structureNames.length; i++) {</b>
<b class="nc">&nbsp;            cboInternalsType.addItem(EquipmentType.structureNames[i]);</b>
&nbsp;        }
<b class="nc">&nbsp;        cboInternalsType.setEnabled(false);</b>
<b class="nc">&nbsp;        lblInternalsType.setEnabled(false);</b>
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; Mech.COCKPIT_STRING.length; i++) {</b>
<b class="nc">&nbsp;            cboCockpitType.addItem(Mech.COCKPIT_STRING[i]);</b>
&nbsp;        }
<b class="nc">&nbsp;        cboCockpitType.setEnabled(false);</b>
<b class="nc">&nbsp;        lblCockpitType.setEnabled(false);</b>
&nbsp;
<b class="nc">&nbsp;        cbxEnableCockpitSearch.setHorizontalTextPosition(SwingConstants.LEFT);</b>
<b class="nc">&nbsp;        cbxEnableCockpitSearch.addItemListener(this);</b>
<b class="nc">&nbsp;        cbxEnableInternalsSearch.setHorizontalTextPosition(SwingConstants.LEFT);</b>
<b class="nc">&nbsp;        cbxEnableInternalsSearch.addItemListener(this);</b>
<b class="nc">&nbsp;        cbxEnableArmorSearch.setHorizontalTextPosition(SwingConstants.LEFT);</b>
<b class="nc">&nbsp;        cbxEnableArmorSearch.addItemListener(this);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        for (int i = 1; i &lt;= 20; i++) {</b>
<b class="nc">&nbsp;            cboQty.addItem(Integer.toString(i));</b>
&nbsp;        }
<b class="nc">&nbsp;        cboQty.setSelectedIndex(0);</b>
&nbsp;
&nbsp;        //Setup table filter combo boxes
<b class="nc">&nbsp;        DefaultComboBoxModel&lt;String&gt; unitTypeModel = new DefaultComboBoxModel&lt;String&gt;();</b>
<b class="nc">&nbsp;        unitTypeModel.addElement(Messages.getString(&quot;MechSelectorDialog.All&quot;));</b>
<b class="nc">&nbsp;        unitTypeModel.addElement(UnitType.getTypeDisplayableName(UnitType.MEK));</b>
<b class="nc">&nbsp;        unitTypeModel.addElement(UnitType.getTypeDisplayableName(UnitType.TANK));</b>
<b class="nc">&nbsp;        unitTypeModel.addElement(UnitType.getTypeDisplayableName(UnitType.BATTLE_ARMOR));</b>
<b class="nc">&nbsp;        unitTypeModel.addElement(UnitType.getTypeDisplayableName(UnitType.INFANTRY));</b>
<b class="nc">&nbsp;        unitTypeModel.addElement(UnitType.getTypeDisplayableName(UnitType.PROTOMEK));</b>
<b class="nc">&nbsp;        unitTypeModel.addElement(UnitType.getTypeDisplayableName(UnitType.AERO));</b>
<b class="nc">&nbsp;        unitTypeModel.setSelectedItem(Messages.getString(&quot;MechSelectorDialog.All&quot;));</b>
&nbsp;
<b class="nc">&nbsp;        cboUnitType.setModel(unitTypeModel);</b>
<b class="nc">&nbsp;        cboUnitType.addActionListener(this);</b>
&nbsp;
<b class="nc">&nbsp;        DefaultComboBoxModel&lt;String&gt; techLevelModel = new DefaultComboBoxModel&lt;String&gt;();</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; TechConstants.SIZE; i++) {</b>
<b class="nc">&nbsp;            techLevelModel.addElement(TechConstants.getLevelDisplayableName(i));</b>
&nbsp;        }
<b class="nc">&nbsp;        techLevelModel.setSelectedItem(TechConstants.getLevelDisplayableName(TechConstants.SIZE-1));</b>
<b class="nc">&nbsp;        cboTechLevel.setModel(techLevelModel);</b>
<b class="nc">&nbsp;        cboTechLevel.addActionListener(this);</b>
&nbsp;
<b class="nc">&nbsp;        DefaultComboBoxModel&lt;String&gt; techClassModel = new DefaultComboBoxModel&lt;String&gt;();</b>
<b class="nc">&nbsp;        techClassModel.addElement(&quot;All&quot;);</b>
<b class="nc">&nbsp;        techClassModel.addElement(&quot;Inner Sphere&quot;);</b>
<b class="nc">&nbsp;        techClassModel.addElement(&quot;Clan&quot;);</b>
<b class="nc">&nbsp;        techClassModel.addElement(&quot;IS/Clan&quot;);</b>
<b class="nc">&nbsp;        techClassModel.addElement(&quot;(Unknown Technology Base)&quot;);</b>
<b class="nc">&nbsp;        techClassModel.setSelectedItem(&quot;All&quot;);</b>
<b class="nc">&nbsp;        cboTechClass.setModel(techClassModel);</b>
<b class="nc">&nbsp;        cboTechClass.addActionListener(this);</b>
&nbsp;
&nbsp;
&nbsp;        //Setup Weapons Table
<b class="nc">&nbsp;        scrTableWeapons.setMinimumSize(new Dimension(850, 150));</b>
<b class="nc">&nbsp;        scrTableWeapons.setPreferredSize(new Dimension(850, 150));</b>
<b class="nc">&nbsp;        weaponsModel = new WeaponsTableModel();</b>
<b class="nc">&nbsp;        tblWeapons = new MegamekTable(weaponsModel,WeaponsTableModel.COL_NAME);</b>
<b class="nc">&nbsp;        TableColumn wpsCol = tblWeapons.getColumnModel().getColumn(</b>
&nbsp;                WeaponsTableModel.COL_QTY);
<b class="nc">&nbsp;        wpsCol.setCellEditor(new DefaultCellEditor(cboQty));</b>
<b class="nc">&nbsp;        tblWeapons.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</b>
<b class="nc">&nbsp;        weaponsSorter = new TableRowSorter&lt;WeaponsTableModel&gt;(weaponsModel);</b>
<b class="nc">&nbsp;        tblWeapons.setRowSorter(weaponsSorter);</b>
<b class="nc">&nbsp;        tblWeapons.addKeyListener(this);</b>
<b class="nc">&nbsp;        TableColumn column = null;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; WeaponsTableModel.N_COL; i++) {</b>
<b class="nc">&nbsp;            column = tblWeapons.getColumnModel().getColumn(i);</b>
<b class="nc">&nbsp;            if((i == WeaponsTableModel.COL_QTY)) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(40);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if( i == WeaponsTableModel.COL_IS_CLAN) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(75);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if( i == WeaponsTableModel.COL_NAME) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(310);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if( i == WeaponsTableModel.COL_LEVEL) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(100);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if((i == WeaponsTableModel.COL_DMG)   ||</b>
&nbsp;                    (i == WeaponsTableModel.COL_HEAT)  ||
&nbsp;                    (i == WeaponsTableModel.COL_SHORT) ||
&nbsp;                    (i == WeaponsTableModel.COL_MED)   ||
&nbsp;                    (i == WeaponsTableModel.COL_LONG)) {
<b class="nc">&nbsp;                column.setPreferredWidth(50);</b>
&nbsp;            }
&nbsp;            else {
<b class="nc">&nbsp;                column.setPreferredWidth(25);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        tblWeapons.setFont(new Font(&quot;Monospaced&quot;, Font.PLAIN, 12)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        tblWeapons.getSelectionModel().addListSelectionListener(this);</b>
<b class="nc">&nbsp;        scrTableWeapons.setViewportView(tblWeapons);</b>
&nbsp;
&nbsp;        //Setup Equipment Table
<b class="nc">&nbsp;        scrTableEquipment.setMinimumSize(new java.awt.Dimension(850, 150));</b>
<b class="nc">&nbsp;        scrTableEquipment.setPreferredSize(new java.awt.Dimension(850, 150));</b>
<b class="nc">&nbsp;        equipmentModel = new EquipmentTableModel();</b>
<b class="nc">&nbsp;        tblEquipment = new MegamekTable(equipmentModel,</b>
&nbsp;                EquipmentTableModel.COL_NAME);
<b class="nc">&nbsp;        TableColumn eqCol = tblEquipment.getColumnModel().getColumn(</b>
&nbsp;                EquipmentTableModel.COL_QTY);
<b class="nc">&nbsp;        eqCol.setCellEditor(new DefaultCellEditor(cboQty));</b>
<b class="nc">&nbsp;        tblEquipment.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</b>
<b class="nc">&nbsp;        equipmentSorter =</b>
&nbsp;                new TableRowSorter&lt;EquipmentTableModel&gt;(equipmentModel);
<b class="nc">&nbsp;        tblEquipment.setRowSorter(equipmentSorter);</b>
<b class="nc">&nbsp;        tblEquipment.addKeyListener(this);</b>
<b class="nc">&nbsp;        column = null;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; EquipmentTableModel.N_COL; i++) {</b>
<b class="nc">&nbsp;            column = tblEquipment.getColumnModel().getColumn(i);</b>
<b class="nc">&nbsp;            if(i == EquipmentTableModel.COL_NAME) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(400);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if(i == EquipmentTableModel.COL_COST) {</b>
<b class="nc">&nbsp;                    column.setPreferredWidth(175);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if(i == EquipmentTableModel.COL_LEVEL) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(100);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if((i == EquipmentTableModel.COL_QTY)) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(40);</b>
&nbsp;            }
<b class="nc">&nbsp;            else if( i == EquipmentTableModel.COL_IS_CLAN) {</b>
<b class="nc">&nbsp;                column.setPreferredWidth(75);</b>
&nbsp;            }
&nbsp;            else {
<b class="nc">&nbsp;                column.setPreferredWidth(25);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        tblEquipment.setFont(new Font(&quot;Monospaced&quot;, Font.PLAIN, 12)); //$NON-NLS-1$</b>
<b class="nc">&nbsp;        tblEquipment.getSelectionModel().addListSelectionListener(this);</b>
<b class="nc">&nbsp;        scrTableEquipment.setViewportView(tblEquipment);</b>
&nbsp;
&nbsp;        //Populate Tables
<b class="nc">&nbsp;        populateWeaponsAndEquipmentChoices();</b>
&nbsp;
&nbsp;        //initialize with the weapons sorted alphabetically by name
<b class="nc">&nbsp;        ArrayList&lt;SortKey&gt; sortlist = new ArrayList&lt;SortKey&gt;();</b>
<b class="nc">&nbsp;        sortlist.add(new SortKey(WeaponsTableModel.COL_NAME,SortOrder.ASCENDING));</b>
<b class="nc">&nbsp;        tblWeapons.getRowSorter().setSortKeys(sortlist);</b>
<b class="nc">&nbsp;        ((DefaultRowSorter&lt;?, ?&gt;)tblWeapons.getRowSorter()).sort();</b>
<b class="nc">&nbsp;        tblWeapons.invalidate(); // force re-layout of window</b>
&nbsp;
&nbsp;        //initialize with the equipment sorted alphabetically by chassis
<b class="nc">&nbsp;        sortlist = new ArrayList&lt;SortKey&gt;();</b>
<b class="nc">&nbsp;        sortlist.add(new SortKey(EquipmentTableModel.COL_NAME,SortOrder.ASCENDING));</b>
<b class="nc">&nbsp;        tblEquipment.getRowSorter().setSortKeys(sortlist);</b>
<b class="nc">&nbsp;        ((DefaultRowSorter&lt;?, ?&gt;)tblEquipment.getRowSorter()).sort();</b>
<b class="nc">&nbsp;        tblEquipment.invalidate(); // force re-layout of window</b>
&nbsp;
<b class="nc">&nbsp;        tWalk.setText(&quot;&quot;);</b>
<b class="nc">&nbsp;        tJump.setText(&quot;&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        txtEqExp.setEditable(false);</b>
<b class="nc">&nbsp;        txtEqExp.setLineWrap(true);</b>
<b class="nc">&nbsp;        txtEqExp.setWrapStyleWord(true);</b>
<b class="nc">&nbsp;        Dimension size = new Dimension(325,50);</b>
<b class="nc">&nbsp;        txtEqExp.setPreferredSize(size);</b>
<b class="nc">&nbsp;        expScroller.setPreferredSize(size);</b>
<b class="nc">&nbsp;        expScroller.setMaximumSize(size);</b>
&nbsp;
&nbsp;        // Layout
<b class="nc">&nbsp;        GridBagConstraints c = new GridBagConstraints();</b>
<b class="nc">&nbsp;        setLayout(new GridBagLayout());</b>
&nbsp;
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
&nbsp;
<b class="nc">&nbsp;        c.insets = new Insets(0,10,0,0);</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy = 0;</b>
<b class="nc">&nbsp;        this.add(lblWalk,c);</b>
<b class="nc">&nbsp;        c.gridx = 1; c.gridy = 0;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.EAST;</b>
<b class="nc">&nbsp;        JPanel panWalk = new JPanel();</b>
<b class="nc">&nbsp;        panWalk.add(cWalk);</b>
<b class="nc">&nbsp;        panWalk.add(tWalk);</b>
<b class="nc">&nbsp;        this.add(panWalk,c);</b>
<b class="nc">&nbsp;        c.gridx = 3; c.gridy = 0;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,40,0,0);</b>
<b class="nc">&nbsp;        c.weighty = 1;</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        JPanel cockpitPanel = new JPanel();</b>
<b class="nc">&nbsp;        cockpitPanel.add(cbxEnableCockpitSearch,BorderLayout.WEST);</b>
<b class="nc">&nbsp;        cockpitPanel.add(lblCockpitType,BorderLayout.WEST);</b>
<b class="nc">&nbsp;        cockpitPanel.add(cboCockpitType,BorderLayout.EAST);</b>
<b class="nc">&nbsp;        this.add(cockpitPanel,c);</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.weighty = 0;</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        c.gridx = 0; c.gridy = 1;</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,10,0,0);</b>
<b class="nc">&nbsp;        this.add(lblJump,c);</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.gridx = 1; c.gridy = 1;</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.EAST;</b>
<b class="nc">&nbsp;        JPanel panJump = new JPanel();</b>
<b class="nc">&nbsp;        panJump.add(cJump);</b>
<b class="nc">&nbsp;        panJump.add(tJump);</b>
<b class="nc">&nbsp;        this.add(panJump,c);</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        c.gridx = 3; c.gridy = 1;</b>
<b class="nc">&nbsp;        c.weighty = 1;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,40,0,0);</b>
<b class="nc">&nbsp;        JPanel internalsPanel = new JPanel();</b>
<b class="nc">&nbsp;        internalsPanel.add(cbxEnableInternalsSearch);</b>
<b class="nc">&nbsp;        internalsPanel.add(lblInternalsType);</b>
<b class="nc">&nbsp;        internalsPanel.add(cboInternalsType,BorderLayout.EAST);</b>
<b class="nc">&nbsp;        this.add(internalsPanel,c);</b>
<b class="nc">&nbsp;        c.weighty = 0;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
&nbsp;
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,10,0,0);</b>
<b class="nc">&nbsp;        this.add(lblArmor,c);</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.gridx = 1;</b>
<b class="nc">&nbsp;        this.add(cArmor,c);</b>
<b class="nc">&nbsp;        c.gridx = 3;</b>
<b class="nc">&nbsp;        c.weighty = 1;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,40,0,0);</b>
<b class="nc">&nbsp;        JPanel armorPanel = new JPanel();</b>
<b class="nc">&nbsp;        armorPanel.add(cbxEnableArmorSearch);</b>
<b class="nc">&nbsp;        armorPanel.add(lblArmorType);</b>
<b class="nc">&nbsp;        armorPanel.add(cboArmorType,BorderLayout.EAST);</b>
<b class="nc">&nbsp;        this.add(armorPanel,c);</b>
<b class="nc">&nbsp;        c.weighty = 0;</b>
&nbsp;
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.CENTER;</b>
&nbsp;
<b class="nc">&nbsp;        c.insets = new Insets(16,0,0,0);</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        this.add(lblTableFilters,c);</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        c.gridwidth = 4;</b>
<b class="nc">&nbsp;        JPanel cboPanel = new JPanel();</b>
<b class="nc">&nbsp;        cboPanel.add(lblUnitType);</b>
<b class="nc">&nbsp;        cboPanel.add(cboUnitType);</b>
<b class="nc">&nbsp;        cboPanel.add(lblTechClass);</b>
<b class="nc">&nbsp;        cboPanel.add(cboTechClass);</b>
<b class="nc">&nbsp;        cboPanel.add(lblTechLevel,c);</b>
<b class="nc">&nbsp;        cboPanel.add(cboTechLevel,c);</b>
<b class="nc">&nbsp;        this.add(cboPanel,c);</b>
<b class="nc">&nbsp;        c.gridwidth = 1;</b>
&nbsp;
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        this.add(lblWeapons,c);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.gridwidth = 4;</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        this.add(scrTableWeapons,c);</b>
<b class="nc">&nbsp;        c.gridwidth = 1;</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        c.gridwidth = 1;</b>
<b class="nc">&nbsp;        c.insets = new Insets(16,0,0,0);</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        this.add(lblEquipment,c);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
<b class="nc">&nbsp;        c.gridwidth = 4;</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        this.add(scrTableEquipment,c);</b>
<b class="nc">&nbsp;        c.gridwidth = 1;</b>
&nbsp;
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        c.gridwidth = 4;</b>
<b class="nc">&nbsp;        JPanel btnPanel = new JPanel();</b>
<b class="nc">&nbsp;        btnPanel.add(btnAdd,c);</b>
<b class="nc">&nbsp;        btnPanel.add(btnLeftParen,c);</b>
<b class="nc">&nbsp;        btnPanel.add(btnRightParen,c);</b>
<b class="nc">&nbsp;        btnPanel.add(btnAnd,c);</b>
<b class="nc">&nbsp;        btnPanel.add(btnOr,c);</b>
<b class="nc">&nbsp;        btnPanel.add(btnBack,c);</b>
<b class="nc">&nbsp;        btnPanel.add(btnClear,c);</b>
<b class="nc">&nbsp;        this.add(btnPanel,c);</b>
<b class="nc">&nbsp;        c.gridwidth = 1;</b>
&nbsp;
&nbsp;        // Filter Expression
&nbsp;        //c.insets = new Insets(50,0,0,0);
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        this.add(lblEqExpTxt,c);</b>
<b class="nc">&nbsp;        c.fill = GridBagConstraints.BOTH;</b>
<b class="nc">&nbsp;        c.gridwidth = 4;</b>
<b class="nc">&nbsp;        c.gridx = 1;</b>
<b class="nc">&nbsp;        this.add(expScroller,c);</b>
<b class="nc">&nbsp;        c.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,0,0,0);</b>
&nbsp;
<b class="nc">&nbsp;        c.gridwidth  = 1;</b>
<b class="nc">&nbsp;        c.gridx = 0; c.gridy++;</b>
<b class="nc">&nbsp;        this.add(lblYear,c);</b>
<b class="nc">&nbsp;        c.gridx = 1;</b>
<b class="nc">&nbsp;        JPanel designYearPanel = new JPanel();</b>
<b class="nc">&nbsp;        designYearPanel.add(tStartYear);</b>
<b class="nc">&nbsp;        designYearPanel.add(new Label(&quot;-&quot;));</b>
<b class="nc">&nbsp;        designYearPanel.add(tEndYear);</b>
<b class="nc">&nbsp;        add(designYearPanel,c);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        c.gridwidth = 1;</b>
<b class="nc">&nbsp;        c.gridx = 2; c.gridy++;</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.EAST;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,20,10,0);</b>
<b class="nc">&nbsp;        this.add(btnOkay,c);</b>
<b class="nc">&nbsp;        c.gridx = 3;</b>
<b class="nc">&nbsp;        c.insets = new Insets(0,20,10,0);</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        this.add(btnCancel,c);</b>
&nbsp;
<b class="nc">&nbsp;        addWindowListener(new WindowAdapter() {</b>
&nbsp;            @Override
&nbsp;            public void windowClosing(WindowEvent e) {
<b class="nc">&nbsp;                setVisible(false);</b>
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        pack();</b>
<b class="nc">&nbsp;        int x = Math.max(0,</b>
<b class="nc">&nbsp;                (frame.getLocation().x + (frame.getSize().width / 2)) -</b>
<b class="nc">&nbsp;                (getSize().width / 2));</b>
<b class="nc">&nbsp;        int y = Math.max(0,</b>
<b class="nc">&nbsp;                (frame.getLocation().y + (frame.getSize().height / 2)) -</b>
<b class="nc">&nbsp;                (getSize().height / 2));</b>
<b class="nc">&nbsp;        setLocation(x, y);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Listener for check box state changes
&nbsp;     *
&nbsp;     */
&nbsp;    public void itemStateChanged(ItemEvent e) {
<b class="nc">&nbsp;        if (e.getSource().equals(cbxEnableCockpitSearch)){</b>
<b class="nc">&nbsp;            cboCockpitType.setEnabled(!cboCockpitType.isEnabled());</b>
<b class="nc">&nbsp;            lblCockpitType.setEnabled(!lblCockpitType.isEnabled());</b>
<b class="nc">&nbsp;        } else if (e.getSource().equals(cbxEnableInternalsSearch)){</b>
<b class="nc">&nbsp;            cboInternalsType.setEnabled(!cboInternalsType.isEnabled());</b>
<b class="nc">&nbsp;            lblInternalsType.setEnabled(!lblInternalsType.isEnabled());</b>
<b class="nc">&nbsp;        } else if (e.getSource().equals(cbxEnableArmorSearch)){</b>
<b class="nc">&nbsp;            cboArmorType.setEnabled(!cboArmorType.isEnabled());</b>
<b class="nc">&nbsp;            lblArmorType.setEnabled(!lblArmorType.isEnabled());</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Selection Listener for Weapons and Equipment tables.  Checks to see if
&nbsp;     * a row is selected and if it is, enables the corresponding the add button.
&nbsp;     */
&nbsp;    @Override
&nbsp;    public void valueChanged(ListSelectionEvent evt) {
&nbsp;        boolean lastTokIsOperation;
<b class="nc">&nbsp;        int tokSize = filterToks.size();</b>
<b class="nc">&nbsp;        lastTokIsOperation = ((tokSize == 0) ||</b>
<b class="nc">&nbsp;                (filterToks.elementAt(tokSize-1) instanceof OperationFT));</b>
<b class="nc">&nbsp;        if (evt.getSource().equals(tblWeapons.getSelectionModel())){</b>
<b class="nc">&nbsp;            if ((tblWeapons.getSelectedRow() &gt;= 0) &amp;&amp; lastTokIsOperation){</b>
<b class="nc">&nbsp;                tblEquipment.clearSelection();</b>
<b class="nc">&nbsp;                btnAdd.setEnabled(true);</b>
<b class="nc">&nbsp;            } else if (tblWeapons.getSelectedRow() &gt;= 0) {</b>
<b class="nc">&nbsp;                tblEquipment.clearSelection();</b>
&nbsp;            }
<b class="nc">&nbsp;        }else if (evt.getSource().equals(tblEquipment.getSelectionModel())){</b>
<b class="nc">&nbsp;            if ((tblEquipment.getSelectedRow() &gt;= 0) &amp;&amp; lastTokIsOperation){</b>
<b class="nc">&nbsp;                tblWeapons.clearSelection();</b>
<b class="nc">&nbsp;                btnAdd.setEnabled(true);</b>
<b class="nc">&nbsp;            } else if (tblEquipment.getSelectedRow() &gt;= 0) {</b>
<b class="nc">&nbsp;                tblWeapons.clearSelection();</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Convenience method for enabling the buttons related to weapon/equipment
&nbsp;     * selection for filtering (btnAddEquipment, btnAddWeapon, etc)
&nbsp;     */
&nbsp;    private void enableSelectionButtons(){
<b class="nc">&nbsp;        if ((tblWeapons.getSelectedRow() != -1) ||</b>
<b class="nc">&nbsp;                (tblEquipment.getSelectedRow() != -1)) {</b>
<b class="nc">&nbsp;            btnAdd.setEnabled(true);</b>
&nbsp;        }
<b class="nc">&nbsp;        btnLeftParen.setEnabled(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Convenience method for disabling the buttons related to weapon/equipment
&nbsp;     * selection for filtering (btnAddEquipment, btnAddWeapon, etc)
&nbsp;     */
&nbsp;    private void disableSelectionButtons(){
<b class="nc">&nbsp;        btnAdd.setEnabled(false);</b>
<b class="nc">&nbsp;        btnLeftParen.setEnabled(false);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Convenience method for enabling the buttons related to filter operations
&nbsp;     * for filtering (btnAnd, btnOr, etc)
&nbsp;     */
&nbsp;    private void enableOperationButtons(){
<b class="nc">&nbsp;        btnOr.setEnabled(true);</b>
<b class="nc">&nbsp;        btnAnd.setEnabled(true);</b>
<b class="nc">&nbsp;        btnRightParen.setEnabled(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Convenience method for disabling the buttons related to filter operations
&nbsp;     * for filtering (btnAnd, btnOr, etc)
&nbsp;     */
&nbsp;    private void disableOperationButtons(){
<b class="nc">&nbsp;        btnOr.setEnabled(false);</b>
<b class="nc">&nbsp;        btnAnd.setEnabled(false);</b>
<b class="nc">&nbsp;        btnRightParen.setEnabled(false);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     *  Listener for button presses.
&nbsp;     */
&nbsp;    public void actionPerformed(java.awt.event.ActionEvent ev) {
&nbsp;        //Okay Button Clicked
<b class="nc">&nbsp;        if (ev.getSource().equals(btnOkay)) {</b>
<b class="nc">&nbsp;            isCanceled = false;</b>
&nbsp;            try{
<b class="nc">&nbsp;                mechFilter.createFilterExpressionFromTokens(filterToks);</b>
<b class="nc">&nbsp;                setVisible(false);</b>
<b class="nc">&nbsp;            }catch (MechSearchFilter.FilterParsingException e){</b>
<b class="nc">&nbsp;                JOptionPane.showMessageDialog(this,</b>
&nbsp;                        &quot;Error parsing filter expression!\n\n&quot; + e.msg,
&nbsp;                        &quot;Filter Expression Parsing Error&quot;,
&nbsp;                        JOptionPane.ERROR_MESSAGE);
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;        //Cancel Button Clicked
<b class="nc">&nbsp;        else if (ev.getSource().equals(btnCancel)) {</b>
<b class="nc">&nbsp;            isCanceled = true;</b>
<b class="nc">&nbsp;            setVisible(false);</b>
<b class="nc">&nbsp;        }else if (ev.getSource().equals(cboUnitType)</b>
<b class="nc">&nbsp;                || ev.getSource().equals(cboTechLevel)</b>
<b class="nc">&nbsp;                || ev.getSource().equals(cboTechClass)) {</b>
<b class="nc">&nbsp;            filterTables();</b>
<b class="nc">&nbsp;        }else if (ev.getSource().equals(btnAdd)){</b>
<b class="nc">&nbsp;            int row = tblEquipment.getSelectedRow();</b>
<b class="nc">&nbsp;            if (row &gt;= 0){</b>
<b class="nc">&nbsp;                String internalName = (String)</b>
<b class="nc">&nbsp;                        tblEquipment.getModel().getValueAt(</b>
<b class="nc">&nbsp;                                tblEquipment.convertRowIndexToModel(row),</b>
&nbsp;                                EquipmentTableModel.COL_INTERNAL_NAME);
<b class="nc">&nbsp;                String fullName = (String)</b>
<b class="nc">&nbsp;                        tblEquipment.getValueAt(</b>
&nbsp;                                row, EquipmentTableModel.COL_NAME);
<b class="nc">&nbsp;                int qty = Integer.parseInt((String)</b>
<b class="nc">&nbsp;                    tblEquipment.getValueAt(row, EquipmentTableModel.COL_QTY));</b>
<b class="nc">&nbsp;                filterToks.add(new EquipmentFT(internalName,fullName,qty));</b>
<b class="nc">&nbsp;                txtEqExp.setText(filterExpressionString());</b>
<b class="nc">&nbsp;                btnBack.setEnabled(true);</b>
<b class="nc">&nbsp;                enableOperationButtons();</b>
<b class="nc">&nbsp;                disableSelectionButtons();</b>
&nbsp;            }
<b class="nc">&nbsp;            row = tblWeapons.getSelectedRow();</b>
<b class="nc">&nbsp;            if (row &gt;= 0){</b>
<b class="nc">&nbsp;                String internalName = (String)</b>
<b class="nc">&nbsp;                        tblWeapons.getModel().getValueAt(</b>
<b class="nc">&nbsp;                                tblWeapons.convertRowIndexToModel(row),</b>
&nbsp;                                WeaponsTableModel.COL_INTERNAL_NAME);
<b class="nc">&nbsp;                String fullName = (String)</b>
<b class="nc">&nbsp;                        tblWeapons.getValueAt(</b>
&nbsp;                                row, WeaponsTableModel.COL_NAME);
<b class="nc">&nbsp;                int qty = Integer.parseInt((String)</b>
<b class="nc">&nbsp;                    tblWeapons.getValueAt(row, WeaponsTableModel.COL_QTY));</b>
<b class="nc">&nbsp;                filterToks.add(new EquipmentFT(internalName,fullName,qty));</b>
<b class="nc">&nbsp;                txtEqExp.setText(filterExpressionString());</b>
<b class="nc">&nbsp;                btnBack.setEnabled(true);</b>
<b class="nc">&nbsp;                enableOperationButtons();</b>
<b class="nc">&nbsp;                disableSelectionButtons();</b>
&nbsp;            }
<b class="nc">&nbsp;        }else if (ev.getSource().equals(btnLeftParen)){</b>
<b class="nc">&nbsp;            filterToks.add(new ParensFT(&quot;(&quot;));</b>
<b class="nc">&nbsp;            txtEqExp.setText(filterExpressionString());</b>
<b class="nc">&nbsp;            btnBack.setEnabled(true);</b>
<b class="nc">&nbsp;            disableOperationButtons();</b>
<b class="nc">&nbsp;            enableSelectionButtons();</b>
<b class="nc">&nbsp;            btnLeftParen.setEnabled(false);</b>
<b class="nc">&nbsp;            btnRightParen.setEnabled(false);</b>
<b class="nc">&nbsp;        }else if (ev.getSource().equals(btnRightParen)){</b>
<b class="nc">&nbsp;            filterToks.add(new ParensFT(&quot;)&quot;));</b>
<b class="nc">&nbsp;            txtEqExp.setText(filterExpressionString());</b>
<b class="nc">&nbsp;            btnBack.setEnabled(true);</b>
<b class="nc">&nbsp;            enableOperationButtons();</b>
<b class="nc">&nbsp;            disableSelectionButtons();</b>
<b class="nc">&nbsp;            btnLeftParen.setEnabled(false);</b>
<b class="nc">&nbsp;            btnRightParen.setEnabled(false);</b>
<b class="nc">&nbsp;        }else if (ev.getSource().equals(btnAnd)){</b>
<b class="nc">&nbsp;            filterToks.add(new OperationFT(MechSearchFilter.BoolOp.AND));</b>
<b class="nc">&nbsp;            txtEqExp.setText(filterExpressionString());</b>
<b class="nc">&nbsp;            btnBack.setEnabled(true);</b>
<b class="nc">&nbsp;            disableOperationButtons();</b>
<b class="nc">&nbsp;            enableSelectionButtons();</b>
<b class="nc">&nbsp;        }else if (ev.getSource().equals(btnOr)){</b>
<b class="nc">&nbsp;            filterToks.add(new OperationFT(MechSearchFilter.BoolOp.OR));</b>
<b class="nc">&nbsp;            txtEqExp.setText(filterExpressionString());</b>
<b class="nc">&nbsp;            btnBack.setEnabled(true);</b>
<b class="nc">&nbsp;            disableOperationButtons();</b>
<b class="nc">&nbsp;            enableSelectionButtons();</b>
<b class="nc">&nbsp;        }else if (ev.getSource().equals(btnBack)){</b>
<b class="nc">&nbsp;            if (filterToks.size() &gt; 0){</b>
<b class="nc">&nbsp;                filterToks.remove(filterToks.size()-1);</b>
<b class="nc">&nbsp;                txtEqExp.setText(filterExpressionString());</b>
<b class="nc">&nbsp;                if (filterToks.size() == 0) {</b>
<b class="nc">&nbsp;                    btnBack.setEnabled(false);</b>
&nbsp;                }
<b class="nc">&nbsp;                if ((filterToks.size() == 0) ||</b>
<b class="nc">&nbsp;                        (filterToks.lastElement() instanceof OperationFT)){</b>
<b class="nc">&nbsp;                    disableOperationButtons();</b>
<b class="nc">&nbsp;                    enableSelectionButtons();</b>
&nbsp;                }else{
<b class="nc">&nbsp;                    enableOperationButtons();</b>
<b class="nc">&nbsp;                    disableSelectionButtons();</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;        } else if (ev.getSource().equals(btnClear)){</b>
<b class="nc">&nbsp;            filterToks.clear();</b>
<b class="nc">&nbsp;            txtEqExp.setText(&quot;&quot;);</b>
<b class="nc">&nbsp;            btnBack.setEnabled(false);</b>
<b class="nc">&nbsp;            disableOperationButtons();</b>
<b class="nc">&nbsp;            enableSelectionButtons();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private boolean matchTechLvl(int t1, int t2){
<b class="nc">&nbsp;        return ((t1 == TechConstants.T_ALL)</b>
&nbsp;                || (t1 == t2)
&nbsp;                || ((t1 == TechConstants.T_IS_TW_ALL)
&nbsp;                    &amp;&amp; ((t2 &lt;= TechConstants.T_IS_TW_NON_BOX)
&nbsp;                     || ((t2) == TechConstants.T_INTRO_BOXSET))))
&nbsp;                || ((t1 == TechConstants.T_TW_ALL)
&nbsp;                    &amp;&amp; ((t2 &lt;= TechConstants.T_IS_TW_NON_BOX)
&nbsp;                     || (t2 &lt;= TechConstants.T_INTRO_BOXSET)
&nbsp;                     || (t2 &lt;= TechConstants.T_CLAN_TW)))
&nbsp;                || ((t1 == TechConstants.T_ALL_IS)
&nbsp;                    &amp;&amp; ((t2 &lt;= TechConstants.T_IS_TW_NON_BOX)
&nbsp;                     || (t2 == TechConstants.T_INTRO_BOXSET)
&nbsp;                     || (t2 == TechConstants.T_IS_ADVANCED)
&nbsp;                     || (t2 == TechConstants.T_IS_EXPERIMENTAL)
&nbsp;                     || (t2 == TechConstants.T_IS_UNOFFICIAL)))
&nbsp;                || ((t1 == TechConstants.T_ALL_CLAN)
&nbsp;                    &amp;&amp; ((t2 == TechConstants.T_CLAN_TW)
&nbsp;                     || (t2 == TechConstants.T_CLAN_ADVANCED)
&nbsp;                     || (t2 == TechConstants.T_CLAN_EXPERIMENTAL)
&nbsp;                     || (t2 == TechConstants.T_CLAN_UNOFFICIAL)));
&nbsp;    }
&nbsp;
&nbsp;    private boolean matchTechClass(String t1, String t2){
<b class="nc">&nbsp;        if (t1.equals(&quot;All&quot;)){</b>
<b class="nc">&nbsp;            return true;</b>
<b class="nc">&nbsp;        } else if (t1.equals(&quot;IS/Clan&quot;)){</b>
<b class="nc">&nbsp;            if (t2.equals(&quot;Inner Sphere&quot;) || t2.equals(&quot;Clan&quot;) ||</b>
<b class="nc">&nbsp;                    t1.equals(t2)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
<b class="nc">&nbsp;        } else if (t1.equals(t2)) {</b>
<b class="nc">&nbsp;            return true;</b>
&nbsp;        }
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    private boolean matchUnitType(int unitTypeFilter, EquipmentType eq){
&nbsp;        // All is selected
<b class="nc">&nbsp;        if (unitTypeFilter &lt; 0){</b>
<b class="nc">&nbsp;            return true;</b>
&nbsp;        }
<b class="nc">&nbsp;        switch (unitTypeFilter) {</b>
&nbsp;        case 5: //UnitType.AERO: the aero index is out of order
<b class="nc">&nbsp;            if (eq.hasFlag(WeaponType.F_AERO_WEAPON)</b>
<b class="nc">&nbsp;                    || eq.hasFlag(MiscType.F_FIGHTER_EQUIPMENT)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        case UnitType.BATTLE_ARMOR:
<b class="nc">&nbsp;            if (eq.hasFlag(WeaponType.F_BA_WEAPON)</b>
<b class="nc">&nbsp;                    || eq.hasFlag(MiscType.F_BA_EQUIPMENT)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        case UnitType.INFANTRY:
<b class="nc">&nbsp;            if (eq.hasFlag(WeaponType.F_INFANTRY)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        case UnitType.MEK:
<b class="nc">&nbsp;            if (eq.hasFlag(WeaponType.F_MECH_WEAPON)</b>
<b class="nc">&nbsp;                    || eq.hasFlag(MiscType.F_MECH_EQUIPMENT)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        case UnitType.TANK:
<b class="nc">&nbsp;            if (eq.hasFlag(WeaponType.F_TANK_WEAPON)</b>
<b class="nc">&nbsp;                    || eq.hasFlag(MiscType.F_TANK_EQUIPMENT)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        case UnitType.PROTOMEK:
<b class="nc">&nbsp;            if (eq.hasFlag(WeaponType.F_PROTO_WEAPON)</b>
<b class="nc">&nbsp;                    || eq.hasFlag(MiscType.F_PROTOMECH_EQUIPMENT)) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;            break;
&nbsp;        default:
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    void filterTables() {
<b class="nc">&nbsp;        RowFilter&lt;WeaponsTableModel, Integer&gt; weaponFilter = null;</b>
<b class="nc">&nbsp;        RowFilter&lt;EquipmentTableModel, Integer&gt; equipmentFilter = null;</b>
<b class="nc">&nbsp;        final int techLevel = cboTechLevel.getSelectedIndex();</b>
<b class="nc">&nbsp;        final String techClass = (String)cboTechClass.getSelectedItem();</b>
<b class="nc">&nbsp;        final int unitType = cboUnitType.getSelectedIndex() - 1;</b>
&nbsp;        //If current expression doesn&#39;t parse, don&#39;t update.
&nbsp;        try {
<b class="nc">&nbsp;            weaponFilter = new RowFilter&lt;WeaponsTableModel,Integer&gt;() {</b>
&nbsp;                @Override
&nbsp;                public boolean include(Entry&lt;? extends WeaponsTableModel, ? extends Integer&gt; entry) {
<b class="nc">&nbsp;                    WeaponsTableModel weapModel = entry.getModel();</b>
<b class="nc">&nbsp;                    WeaponType wp = weapModel.getWeaponTypeAt(entry.getIdentifier());</b>
<b class="nc">&nbsp;                    String currTechClass =</b>
<b class="nc">&nbsp;                           TechConstants.getTechName(wp.getTechLevel(gameYear));</b>
&nbsp;
<b class="nc">&nbsp;                    boolean techLvlMatch =</b>
<b class="nc">&nbsp;                            matchTechLvl(techLevel,wp.getTechLevel(gameYear));</b>
<b class="nc">&nbsp;                    boolean techClassMatch =</b>
<b class="nc">&nbsp;                            matchTechClass(techClass,currTechClass);</b>
<b class="nc">&nbsp;                    boolean unitTypeMatch = matchUnitType(unitType,wp);</b>
<b class="nc">&nbsp;                    if (techLvlMatch &amp;&amp; techClassMatch &amp;&amp; unitTypeMatch){</b>
<b class="nc">&nbsp;                        return true;</b>
&nbsp;                    }else{
<b class="nc">&nbsp;                        return false;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            };
<b class="nc">&nbsp;        } catch (java.util.regex.PatternSyntaxException e) {</b>
&nbsp;            return;
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        weaponsSorter.setRowFilter(weaponFilter);</b>
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            equipmentFilter = new RowFilter&lt;EquipmentTableModel, Integer&gt;() {</b>
&nbsp;                @Override
&nbsp;                public boolean include(Entry&lt;? extends EquipmentTableModel, ? extends Integer&gt; entry) {
<b class="nc">&nbsp;                    EquipmentTableModel eqModel = entry.getModel();</b>
<b class="nc">&nbsp;                    EquipmentType eq =</b>
<b class="nc">&nbsp;                            eqModel.getEquipmentTypeAt(entry.getIdentifier());</b>
<b class="nc">&nbsp;                    String currTechClass =</b>
<b class="nc">&nbsp;                           TechConstants.getTechName(eq.getTechLevel(gameYear));</b>
<b class="nc">&nbsp;                    boolean techLvlMatch =</b>
<b class="nc">&nbsp;                            matchTechLvl(techLevel,eq.getTechLevel(gameYear));</b>
<b class="nc">&nbsp;                    boolean techClassMatch =</b>
<b class="nc">&nbsp;                            matchTechClass(techClass,currTechClass);</b>
<b class="nc">&nbsp;                    boolean unitTypeMatch = matchUnitType(unitType,eq);</b>
<b class="nc">&nbsp;                    if (techLvlMatch &amp;&amp; techClassMatch &amp;&amp; unitTypeMatch){</b>
<b class="nc">&nbsp;                        return true;</b>
&nbsp;                    }else{
<b class="nc">&nbsp;                        return false;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            };
<b class="nc">&nbsp;        } catch (java.util.regex.PatternSyntaxException e) {</b>
&nbsp;            return;
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        equipmentSorter.setRowFilter(equipmentFilter);</b>
&nbsp;    }
&nbsp;
&nbsp;    private String filterExpressionString(){
&nbsp;        //Build the string representation of the new expression
<b class="nc">&nbsp;        StringBuilder filterExp = new StringBuilder();</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; filterToks.size(); i++){</b>
<b class="nc">&nbsp;            filterExp.append(&quot; &quot; + filterToks.elementAt(i).toString() + &quot; &quot;);</b>
&nbsp;        }
<b class="nc">&nbsp;        return filterExp.toString();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Show the dialog.  setVisible(true) blocks until setVisible(false).
&nbsp;     *
&nbsp;     * @return Return the filter that was created with this dialog.
&nbsp;     */
&nbsp;    public MechSearchFilter showDialog() {
&nbsp;        //We need to save a copy since the user can alter the filter state
&nbsp;        // and then click on the cancel button.  We want to make sure the
&nbsp;        // original filter state is saved.
<b class="nc">&nbsp;        MechSearchFilter currFilter = mechFilter;</b>
<b class="nc">&nbsp;        mechFilter = new MechSearchFilter(currFilter);</b>
<b class="nc">&nbsp;        txtEqExp.setText(mechFilter.getEquipmentExpression());</b>
<b class="nc">&nbsp;        if ((filterToks == null) || (filterToks.size() == 0)</b>
<b class="nc">&nbsp;                || (filterToks.lastElement() instanceof OperationFT)) {</b>
<b class="nc">&nbsp;            disableOperationButtons();</b>
<b class="nc">&nbsp;            enableSelectionButtons();</b>
&nbsp;        }else{
<b class="nc">&nbsp;            enableOperationButtons();</b>
<b class="nc">&nbsp;            disableSelectionButtons();</b>
&nbsp;        }
<b class="nc">&nbsp;        setVisible(true);</b>
<b class="nc">&nbsp;        if (isCanceled){</b>
<b class="nc">&nbsp;            mechFilter = currFilter;</b>
&nbsp;        }else{
<b class="nc">&nbsp;            updateMechSearchFilter();</b>
&nbsp;        }
<b class="nc">&nbsp;        return mechFilter;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     *  Clear the filter.
&nbsp;     */
&nbsp;    public void clearValues() {
<b class="nc">&nbsp;        cWalk.setSelectedIndex(0);</b>
<b class="nc">&nbsp;        tWalk.setText(&quot;&quot;);</b>
<b class="nc">&nbsp;        cJump.setSelectedIndex(0);</b>
<b class="nc">&nbsp;        tJump.setText(&quot;&quot;);</b>
<b class="nc">&nbsp;        cArmor.setSelectedIndex(0);</b>
<b class="nc">&nbsp;        tblWeapons.clearSelection();</b>
<b class="nc">&nbsp;        tblEquipment.clearSelection();</b>
<b class="nc">&nbsp;        txtEqExp.setText(&quot;&quot;);</b>
<b class="nc">&nbsp;        cbxEnableArmorSearch.setSelected(false);</b>
<b class="nc">&nbsp;        cbxEnableCockpitSearch.setSelected(false);</b>
<b class="nc">&nbsp;        cbxEnableInternalsSearch.setSelected(false);</b>
<b class="nc">&nbsp;        cboArmorType.setSelectedIndex(0);</b>
<b class="nc">&nbsp;        cboCockpitType.setSelectedIndex(0);</b>
<b class="nc">&nbsp;        cboInternalsType.setSelectedIndex(0);</b>
<b class="nc">&nbsp;        mechFilter = null;</b>
<b class="nc">&nbsp;        filterToks.clear();</b>
<b class="nc">&nbsp;        btnBack.setEnabled(false);</b>
<b class="nc">&nbsp;        disableOperationButtons();</b>
<b class="nc">&nbsp;        enableSelectionButtons();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Creates collections for all of the possible &lt;code&gt;WeaponType&lt;/code&gt;s and
&nbsp;     * &lt;code&gt;EquipmentType&lt;/code&gt;s.  These are used to populate the weapons
&nbsp;     * and equipment tables.
&nbsp;     */
&nbsp;    private void populateWeaponsAndEquipmentChoices() {
<b class="nc">&nbsp;        Vector&lt;WeaponType&gt; weapons = new Vector&lt;WeaponType&gt;();</b>
<b class="nc">&nbsp;        Vector&lt;EquipmentType&gt; equipment = new Vector&lt;EquipmentType&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        for (Enumeration&lt;EquipmentType&gt; e = EquipmentType.getAllTypes();</b>
<b class="nc">&nbsp;                 e.hasMoreElements();) {</b>
<b class="nc">&nbsp;            EquipmentType et = e.nextElement();</b>
<b class="nc">&nbsp;            if ((et instanceof WeaponType)) {</b>
<b class="nc">&nbsp;                weapons.add((WeaponType)et);</b>
&nbsp;                //Check for C3+Tag and C3 Master Booster
<b class="nc">&nbsp;                if (et.hasFlag(WeaponType.F_C3M) ||</b>
<b class="nc">&nbsp;                        et.hasFlag(WeaponType.F_C3MBS)) {</b>
<b class="nc">&nbsp;                    equipment.add(et);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if ((et instanceof MiscType)) {</b>
<b class="nc">&nbsp;                equipment.add(et);</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        weaponsModel.setData(weapons);</b>
<b class="nc">&nbsp;        equipmentModel.setData(equipment);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    public MechSearchFilter getMechSearchFilter()
&nbsp;    {
<b class="nc">&nbsp;        return mechFilter;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Update the search fields that aren&#39;t automatically updated.
&nbsp;     */
&nbsp;    protected void updateMechSearchFilter() {
<b class="nc">&nbsp;        mechFilter.isDisabled = false;</b>
<b class="nc">&nbsp;        mechFilter.sWalk = tWalk.getText();</b>
<b class="nc">&nbsp;        mechFilter.iWalk = cWalk.getSelectedIndex();</b>
&nbsp;
<b class="nc">&nbsp;        mechFilter.sJump = tJump.getText();</b>
<b class="nc">&nbsp;        mechFilter.iJump = cJump.getSelectedIndex();</b>
&nbsp;
<b class="nc">&nbsp;        mechFilter.iArmor = cArmor.getSelectedIndex();</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;        mechFilter.sStartYear = tStartYear.getText();</b>
<b class="nc">&nbsp;        mechFilter.sEndYear = tEndYear.getText();</b>
&nbsp;
<b class="nc">&nbsp;        mechFilter.checkArmorType = cbxEnableArmorSearch.isSelected();</b>
<b class="nc">&nbsp;        if (cbxEnableArmorSearch.isSelected()){</b>
<b class="nc">&nbsp;            mechFilter.armorType = cboArmorType.getSelectedIndex();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        mechFilter.checkInternalsType = cbxEnableInternalsSearch.isSelected();</b>
<b class="nc">&nbsp;        if (cbxEnableInternalsSearch.isSelected()){</b>
<b class="nc">&nbsp;            mechFilter.internalsType = cboInternalsType.getSelectedIndex();</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        mechFilter.checkCockpitType = cbxEnableCockpitSearch.isSelected();</b>
<b class="nc">&nbsp;        if (cbxEnableCockpitSearch.isSelected()){</b>
<b class="nc">&nbsp;            mechFilter.cockpitType = cboCockpitType.getSelectedIndex();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * A table model for displaying weapons
&nbsp;     */
<b class="nc">&nbsp;    public class WeaponsTableModel extends AbstractTableModel {</b>
&nbsp;
&nbsp;        /**
&nbsp;         *
&nbsp;         */
&nbsp;        private static final long serialVersionUID = 1L;
&nbsp;
&nbsp;        private static final int COL_QTY = 0;
&nbsp;        private static final int COL_NAME = 1;
&nbsp;        private static final int COL_DMG = 2;
&nbsp;        private static final int COL_HEAT = 3;
&nbsp;        private static final int COL_SHORT = 4;
&nbsp;        private static final int COL_MED = 5;
&nbsp;        private static final int COL_LONG = 6;
&nbsp;        private static final int COL_IS_CLAN = 7;
&nbsp;        private static final int COL_LEVEL = 8;
&nbsp;        private static final int N_COL = 9;
&nbsp;        private static final int COL_INTERNAL_NAME = 9;
&nbsp;
&nbsp;
&nbsp;        private int[] qty;
&nbsp;
<b class="nc">&nbsp;        private Vector&lt;WeaponType&gt; weapons = new Vector&lt;WeaponType&gt;();</b>
&nbsp;
&nbsp;        public int getRowCount() {
<b class="nc">&nbsp;            return weapons.size();</b>
&nbsp;        }
&nbsp;
&nbsp;        public int getColumnCount() {
<b class="nc">&nbsp;            return N_COL;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public String getColumnName(int column) {
<b class="nc">&nbsp;            switch (column) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                return &quot;Qty&quot;;</b>
&nbsp;            case COL_NAME:
<b class="nc">&nbsp;                return &quot;Weapon Name&quot;;</b>
&nbsp;            case COL_IS_CLAN:
<b class="nc">&nbsp;                return &quot;IS/Clan&quot;;</b>
&nbsp;            case COL_DMG:
<b class="nc">&nbsp;                return &quot;DMG&quot;;</b>
&nbsp;            case COL_HEAT:
<b class="nc">&nbsp;                return &quot;Heat&quot;;</b>
&nbsp;            case COL_SHORT:
<b class="nc">&nbsp;                return &quot;Short&quot;;</b>
&nbsp;            case COL_MED:
<b class="nc">&nbsp;                return &quot;Med&quot;;</b>
&nbsp;            case COL_LONG:
<b class="nc">&nbsp;                return &quot;Long&quot;;</b>
&nbsp;            case COL_LEVEL:
<b class="nc">&nbsp;                return &quot;Lvl&quot;;</b>
&nbsp;            default:
<b class="nc">&nbsp;                return &quot;?&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public Class&lt;?&gt; getColumnClass(int c) {
<b class="nc">&nbsp;            return getValueAt(0, c).getClass();</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean isCellEditable(int row, int col) {
<b class="nc">&nbsp;            switch (col) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                return true;</b>
&nbsp;            default:
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        // fill table with values
&nbsp;        public void setData(Vector&lt;WeaponType&gt; wps) {
<b class="nc">&nbsp;            weapons = wps;</b>
<b class="nc">&nbsp;            qty = new int[wps.size()];</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; qty.length; i++) {</b>
<b class="nc">&nbsp;                qty[i] = 1;</b>
&nbsp;            }
<b class="nc">&nbsp;            fireTableDataChanged();</b>
&nbsp;        }
&nbsp;
&nbsp;        public WeaponType getWeaponTypeAt(int row){
<b class="nc">&nbsp;            return weapons.elementAt(row);</b>
&nbsp;        }
&nbsp;
&nbsp;        public Object getValueAt(int row, int col) {
<b class="nc">&nbsp;            if (row &gt;= weapons.size()) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            WeaponType wp = weapons.elementAt(row);</b>
<b class="nc">&nbsp;            switch (col) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                return qty[row] + &quot;&quot;;</b>
&nbsp;            case COL_NAME:
<b class="nc">&nbsp;                return wp.getName();</b>
&nbsp;            case COL_IS_CLAN:
<b class="nc">&nbsp;                return TechConstants.getTechName(wp.getTechLevel(gameYear));</b>
&nbsp;            case COL_DMG:
<b class="nc">&nbsp;                return wp.getDamage();</b>
&nbsp;            case COL_HEAT:
<b class="nc">&nbsp;                return wp.getHeat();</b>
&nbsp;            case COL_SHORT:
<b class="nc">&nbsp;                return wp.getShortRange();</b>
&nbsp;            case COL_MED:
<b class="nc">&nbsp;                return wp.getMediumRange();</b>
&nbsp;            case COL_LONG:
<b class="nc">&nbsp;                return wp.getLongRange();</b>
&nbsp;            case COL_LEVEL:
<b class="nc">&nbsp;                    return TechConstants.getSimpleLevelName(TechConstants</b>
<b class="nc">&nbsp;                            .convertFromNormalToSimple(wp</b>
<b class="nc">&nbsp;                                    .getTechLevel(gameYear)));</b>
&nbsp;            case COL_INTERNAL_NAME:
<b class="nc">&nbsp;                return wp.getInternalName();</b>
&nbsp;            default:
<b class="nc">&nbsp;                return &quot;?&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void setValueAt(Object value, int row, int col) {
<b class="nc">&nbsp;            switch (col) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                qty[row] = Integer.parseInt((String) value);</b>
<b class="nc">&nbsp;                fireTableCellUpdated(row, col);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            default:
&nbsp;                break;
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * A table model for displaying equipment
&nbsp;     */
<b class="nc">&nbsp;    public class EquipmentTableModel extends AbstractTableModel {</b>
&nbsp;
&nbsp;        /**
&nbsp;         *
&nbsp;         */
&nbsp;        private static final long serialVersionUID = 1L;
&nbsp;
&nbsp;        private static final int COL_QTY = 0;
&nbsp;        private static final int COL_NAME = 1;
&nbsp;        private static final int COL_COST = 2;
&nbsp;        private static final int COL_IS_CLAN = 3;
&nbsp;        private static final int COL_LEVEL = 4;
&nbsp;        private static final int N_COL = 5;
&nbsp;        private static final int COL_INTERNAL_NAME = 5;
&nbsp;
&nbsp;        private int[] qty;
<b class="nc">&nbsp;        private Vector&lt;EquipmentType&gt; equipment = new Vector&lt;EquipmentType&gt;();</b>
&nbsp;
&nbsp;        public int getRowCount() {
<b class="nc">&nbsp;            return equipment.size();</b>
&nbsp;        }
&nbsp;
&nbsp;        public int getColumnCount() {
<b class="nc">&nbsp;            return N_COL;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public String getColumnName(int column) {
<b class="nc">&nbsp;            switch (column) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                return &quot;Qty&quot;;</b>
&nbsp;            case COL_NAME:
<b class="nc">&nbsp;                return &quot;Name&quot;;</b>
&nbsp;            case COL_IS_CLAN:
<b class="nc">&nbsp;                return &quot;IS/Clan&quot;;</b>
&nbsp;            case COL_COST:
<b class="nc">&nbsp;                return &quot;Cost&quot;;</b>
&nbsp;            case COL_LEVEL:
<b class="nc">&nbsp;                return &quot;Lvl&quot;;</b>
&nbsp;            default:
<b class="nc">&nbsp;                return &quot;?&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public Class&lt;?&gt; getColumnClass(int c) {
<b class="nc">&nbsp;            return getValueAt(0, c).getClass();</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public boolean isCellEditable(int row, int col) {
<b class="nc">&nbsp;            switch (col) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                return true;</b>
&nbsp;            default:
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        // fill table with values
&nbsp;        public void setData(Vector&lt;EquipmentType&gt; eq) {
<b class="nc">&nbsp;            equipment = eq;</b>
<b class="nc">&nbsp;            qty = new int[eq.size()];</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; qty.length; i++) {</b>
<b class="nc">&nbsp;                qty[i] = 1;</b>
&nbsp;            }
<b class="nc">&nbsp;            fireTableDataChanged();</b>
&nbsp;        }
&nbsp;
&nbsp;        public EquipmentType getEquipmentTypeAt(int row){
<b class="nc">&nbsp;            return equipment.elementAt(row);</b>
&nbsp;        }
&nbsp;
&nbsp;        public Object getValueAt(int row, int col) {
<b class="nc">&nbsp;            if (row &gt;= equipment.size()) {</b>
<b class="nc">&nbsp;                return null;</b>
&nbsp;            }
<b class="nc">&nbsp;            EquipmentType eq = equipment.elementAt(row);</b>
<b class="nc">&nbsp;            switch (col) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                return qty[row] + &quot;&quot;;</b>
&nbsp;            case COL_NAME:
<b class="nc">&nbsp;                return eq.getName();</b>
&nbsp;            case COL_IS_CLAN:
<b class="nc">&nbsp;                return TechConstants.getTechName(eq.getTechLevel(gameYear));</b>
&nbsp;            case COL_COST:
<b class="nc">&nbsp;                return eq.getRawCost();</b>
&nbsp;            case COL_LEVEL:
<b class="nc">&nbsp;                    return TechConstants.getSimpleLevelName(TechConstants</b>
<b class="nc">&nbsp;                            .convertFromNormalToSimple(eq</b>
<b class="nc">&nbsp;                                    .getTechLevel(gameYear)));</b>
&nbsp;            case COL_INTERNAL_NAME:
<b class="nc">&nbsp;                return eq.getInternalName();</b>
&nbsp;            default:
<b class="nc">&nbsp;                return &quot;?&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void setValueAt(Object value, int row, int col) {
<b class="nc">&nbsp;            switch (col) {</b>
&nbsp;            case COL_QTY:
<b class="nc">&nbsp;                qty[row] = Integer.parseInt((String) value);</b>
<b class="nc">&nbsp;                fireTableCellUpdated(row, col);</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            default:
&nbsp;                break;
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void keyPressed(KeyEvent evt) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void keyReleased(KeyEvent evt) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void keyTyped(KeyEvent evt) {
<b class="nc">&nbsp;        char keyChar = evt.getKeyChar();</b>
&nbsp;        //Ensure we&#39;ve got a number or letter pressed
<b class="nc">&nbsp;        if (!(((keyChar &gt;= &#39;0&#39;) &amp;&amp; (keyChar &lt;= &#39;9&#39;)) ||</b>
&nbsp;             ((keyChar &gt;= &#39;a&#39;) &amp;&amp; (keyChar &lt;=&#39;z&#39;)) || (keyChar == &#39; &#39;))){
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if  (evt.getComponent().equals(tblWeapons)){</b>
<b class="nc">&nbsp;            tblWeapons.keyTyped(evt);</b>
<b class="nc">&nbsp;        }else if (evt.getComponent().equals(tblEquipment)){</b>
<b class="nc">&nbsp;            tblEquipment.keyTyped(evt);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Base class for different tokens that can be in a filter expression.
&nbsp;     *
&nbsp;     * @author Arlith
&nbsp;     *
&nbsp;     */
<b class="nc">&nbsp;    public class FilterTokens{</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * FilterTokens subclass that represents parenthesis.
&nbsp;     * @author Arlith
&nbsp;     *
&nbsp;     */
&nbsp;    public class ParensFT extends FilterTokens{
&nbsp;        public String parens;
&nbsp;
<b class="nc">&nbsp;        public ParensFT(String p){</b>
<b class="nc">&nbsp;            parens = p;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public String toString(){
<b class="nc">&nbsp;            return parens;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * FilterTokens subclass that represents equipment.
&nbsp;     * @author Arlith
&nbsp;     *
&nbsp;     */
&nbsp;    public class EquipmentFT extends FilterTokens{
&nbsp;        public String internalName;
&nbsp;        public String fullName;
&nbsp;        public int qty;
&nbsp;
<b class="nc">&nbsp;        public EquipmentFT(String in, String fn, int q){</b>
<b class="nc">&nbsp;            internalName = in;</b>
<b class="nc">&nbsp;            fullName = fn;</b>
<b class="nc">&nbsp;            qty = q;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public String toString(){
<b class="nc">&nbsp;            if (qty == 1) {</b>
<b class="nc">&nbsp;                return qty + &quot; &quot; + fullName;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                return qty + &quot; &quot; + fullName + &quot;s&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * FilterTokens subclass that represents a boolean operation.
&nbsp;     * @author Arlith
&nbsp;     *
&nbsp;     */
&nbsp;    public class OperationFT extends FilterTokens{
&nbsp;        public MechSearchFilter.BoolOp op;
&nbsp;
<b class="nc">&nbsp;        public OperationFT(MechSearchFilter.BoolOp o){</b>
<b class="nc">&nbsp;            op = o;</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public String toString(){
<b class="nc">&nbsp;            if (op == MechSearchFilter.BoolOp.AND) {</b>
<b class="nc">&nbsp;                return &quot;And&quot;;</b>
<b class="nc">&nbsp;            } else if (op == MechSearchFilter.BoolOp.OR) {</b>
<b class="nc">&nbsp;                return &quot;Or&quot;;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                return &quot;&quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;}
&nbsp;
&nbsp;
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
