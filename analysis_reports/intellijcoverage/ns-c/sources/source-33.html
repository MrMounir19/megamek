


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > MegaMekGUI</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing</a>
</div>

<h1>Coverage Summary for Class: MegaMekGUI (megamek.client.ui.swing)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">MegaMekGUI</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/512)
  </span>
</td>
</tr>
  <tr>
    <td class="name">MegaMekGUI$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MegaMekGUI$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/11)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MegaMekGUI$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MegaMekGUI$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">MegaMekGUI$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/38)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/542)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek -
&nbsp; * Copyright (C) 2000,2001,2002,2003,2004,2005 Ben Mazur (bmazur@sev.org)
&nbsp; * Copyright © 2013 Edward Cullen (eddy@obsessedcomputers.co.uk)
&nbsp; * Copyright (c) 2020 - The MegaMek Team. All Rights Reserved.
&nbsp; *
&nbsp; * This program is free software; you can redistribute it and/or modify it
&nbsp; * under the terms of the GNU General Public License as published by the Free
&nbsp; * Software Foundation; either version 2 of the License, or (at your option)
&nbsp; * any later version.
&nbsp; *
&nbsp; * This program is distributed in the hope that it will be useful, but
&nbsp; * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; * for more details.
&nbsp; */
&nbsp;package megamek.client.ui.swing;
&nbsp;
&nbsp;import static megamek.common.Compute.d6;
&nbsp;
&nbsp;import java.awt.Cursor;
&nbsp;import java.awt.Dimension;
&nbsp;import java.awt.DisplayMode;
&nbsp;import java.awt.Font;
&nbsp;import java.awt.FontFormatException;
&nbsp;import java.awt.FontMetrics;
&nbsp;import java.awt.Frame;
&nbsp;import java.awt.Graphics;
&nbsp;import java.awt.GraphicsEnvironment;
&nbsp;import java.awt.GridBagConstraints;
&nbsp;import java.awt.GridBagLayout;
&nbsp;import java.awt.Image;
&nbsp;import java.awt.Insets;
&nbsp;import java.awt.KeyboardFocusManager;
&nbsp;import java.awt.MediaTracker;
&nbsp;import java.awt.SystemColor;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.awt.event.WindowAdapter;
&nbsp;import java.awt.event.WindowEvent;
&nbsp;import java.awt.image.BufferedImage;
&nbsp;import java.awt.Window;
&nbsp;import java.io.File;
&nbsp;import java.io.FileInputStream;
&nbsp;import java.io.IOException;
&nbsp;import java.io.InputStream;
&nbsp;import java.net.MalformedURLException;
&nbsp;import java.net.URL;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Enumeration;
&nbsp;import java.util.List;
&nbsp;import java.util.Locale;
&nbsp;import java.util.Vector;
&nbsp;import java.util.zip.GZIPInputStream;
&nbsp;
&nbsp;import javax.swing.ImageIcon;
&nbsp;import javax.swing.JComponent;
&nbsp;import javax.swing.JFileChooser;
&nbsp;import javax.swing.JFrame;
&nbsp;import javax.swing.JLabel;
&nbsp;import javax.swing.JOptionPane;
&nbsp;import javax.swing.JPanel;
&nbsp;import javax.swing.SwingUtilities;
&nbsp;import javax.swing.ToolTipManager;
&nbsp;import javax.swing.UIManager;
&nbsp;import javax.swing.filechooser.FileFilter;
&nbsp;
&nbsp;import com.thoughtworks.xstream.XStream;
&nbsp;
&nbsp;import megamek.MegaMek;
&nbsp;import megamek.client.Client;
&nbsp;import megamek.client.bot.BotClient;
&nbsp;import megamek.client.bot.TestBot;
&nbsp;import megamek.client.bot.princess.Princess;
&nbsp;import megamek.client.bot.ui.swing.BotGUI;
&nbsp;import megamek.client.ui.IMegaMekGUI;
&nbsp;import megamek.client.ui.Messages;
&nbsp;import megamek.client.ui.swing.gameConnectionDialogs.ConnectDialog;
&nbsp;import megamek.client.ui.swing.gameConnectionDialogs.HostDialog;
&nbsp;import megamek.client.ui.swing.skinEditor.SkinEditorMainGUI;
&nbsp;import megamek.client.ui.swing.util.MegaMekController;
&nbsp;import megamek.client.ui.swing.widget.MegamekButton;
&nbsp;import megamek.client.ui.swing.widget.SkinSpecification;
&nbsp;import megamek.client.ui.swing.widget.SkinXMLHandler;
&nbsp;import megamek.common.Compute;
&nbsp;import megamek.common.Configuration;
&nbsp;import megamek.common.IGame;
&nbsp;import megamek.common.IPlayer;
&nbsp;import megamek.common.KeyBindParser;
&nbsp;import megamek.common.MechFileParser;
&nbsp;import megamek.common.MechSummaryCache;
&nbsp;import megamek.common.Player;
&nbsp;import megamek.common.QuirksHandler;
&nbsp;import megamek.common.WeaponOrderHandler;
&nbsp;import megamek.common.logging.LogLevel;
&nbsp;import megamek.common.options.GameOptions;
&nbsp;import megamek.common.options.IBasicOption;
&nbsp;import megamek.common.options.IOption;
&nbsp;import megamek.common.preference.IPreferenceChangeListener;
&nbsp;import megamek.common.preference.PreferenceChangeEvent;
&nbsp;import megamek.common.preference.PreferenceManager;
&nbsp;import megamek.common.util.ImageUtil;
&nbsp;import megamek.common.util.SerializationHelper;
&nbsp;import megamek.common.util.fileUtils.MegaMekFile;
&nbsp;import megamek.server.ScenarioLoader;
&nbsp;import megamek.server.Server;
&nbsp;
<b class="nc">&nbsp;public class MegaMekGUI  implements IPreferenceChangeListener, IMegaMekGUI {</b>
&nbsp;    private static final String FILENAME_MEGAMEK_SPLASH = &quot;../misc/megamek-splash.jpg&quot;;
&nbsp;    private static final String FILENAME_ICON_16X16 = &quot;megamek-icon-16x16.png&quot;;
&nbsp;    private static final String FILENAME_ICON_32X32 = &quot;megamek-icon-32x32.png&quot;;
&nbsp;    private static final String FILENAME_ICON_48X48 = &quot;megamek-icon-48x48.png&quot;;
&nbsp;    private static final String FILENAME_ICON_256X256 = &quot;megamek-icon-256x256.png&quot;;
&nbsp;
&nbsp;    private static final String FILENAME_BT_CLASSIC_FONT = &quot;btclassic/BTLogo_old.ttf&quot;;
&nbsp;
&nbsp;    private JFrame frame;
&nbsp;    private Client client;
&nbsp;    private Server server;
&nbsp;    private CommonAboutDialog about;
&nbsp;    private CommonHelpDialog help;
&nbsp;    private GameOptionsDialog optionsDialog;
&nbsp;    private CommonSettingsDialog settingsDialog;
&nbsp;
&nbsp;    private MegaMekController controller;
&nbsp;
<b class="nc">&nbsp;    BufferedImage backgroundIcon = null;</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void start(String[] args) {
<b class="nc">&nbsp;        createGUI();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Construct a MegaMek, and display the main menu in the specified frame.
&nbsp;     */
&nbsp;    private void createGUI() {
&nbsp;        try {
<b class="nc">&nbsp;            GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();</b>
<b class="nc">&nbsp;            File btFontFile = new MegaMekFile(Configuration.fontsDir(), FILENAME_BT_CLASSIC_FONT).getFile();</b>
<b class="nc">&nbsp;            Font btFont = Font.createFont(Font.TRUETYPE_FONT, btFontFile);</b>
<b class="nc">&nbsp;            System.out.println(&quot;Loaded Font: &quot; + btFont.getName());</b>
<b class="nc">&nbsp;            ge.registerFont(btFont);</b>
<b class="nc">&nbsp;        } catch (IOException | FontFormatException e) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Error Registering BT Classic Font! Error: &quot; + e.getMessage());</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        createController();</b>
&nbsp;
<b class="nc">&nbsp;        GUIPreferences.getInstance().addPreferenceChangeListener(this);</b>
&nbsp;
&nbsp;        // Set a couple of things to make the Swing GUI look more &quot;Mac-like&quot; on
&nbsp;        // Macs
&nbsp;        // Taken from:
&nbsp;        // http://www.devdaily.com/apple/mac/java-mac-native-look/Introduction.shtml
<b class="nc">&nbsp;        System.setProperty(&quot;apple.laf.useScreenMenuBar&quot;, &quot;true&quot;);</b>
<b class="nc">&nbsp;        System.setProperty(&quot;com.apple.mrj.application.apple.menu.about.name&quot;, &quot;MegaMek&quot;);</b>
&nbsp;
&nbsp;        // Add additional themes
<b class="nc">&nbsp;        UIManager.installLookAndFeel(&quot;Flat Light&quot;, &quot;com.formdev.flatlaf.FlatLightLaf&quot;);</b>
<b class="nc">&nbsp;        UIManager.installLookAndFeel(&quot;Flat IntelliJ&quot;, &quot;com.formdev.flatlaf.FlatIntelliJLaf&quot;);</b>
<b class="nc">&nbsp;        UIManager.installLookAndFeel(&quot;Flat Dark&quot;, &quot;com.formdev.flatlaf.FlatDarkLaf&quot;);</b>
<b class="nc">&nbsp;        UIManager.installLookAndFeel(&quot;Flat Darcula&quot;, &quot;com.formdev.flatlaf.FlatDarculaLaf&quot;);</b>
&nbsp;
&nbsp;        // this should also help to make MegaMek look more system-specific
&nbsp;        try {
<b class="nc">&nbsp;            UIManager.setLookAndFeel(GUIPreferences.getInstance().getUITheme());</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            System.err.println(&quot;Error setting look and feel!&quot;);</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        ToolTipManager.sharedInstance().setInitialDelay(</b>
<b class="nc">&nbsp;                GUIPreferences.getInstance().getTooltipDelay());</b>
<b class="nc">&nbsp;        if (GUIPreferences.getInstance().getTooltipDismissDelay() &gt;= 0) {</b>
<b class="nc">&nbsp;            ToolTipManager.sharedInstance().setDismissDelay(</b>
<b class="nc">&nbsp;                    GUIPreferences.getInstance().getTooltipDismissDelay());</b>
&nbsp;        }
<b class="nc">&nbsp;        frame = new JFrame(&quot;MegaMek&quot;);</b>
<b class="nc">&nbsp;        frame.addWindowListener(new WindowAdapter() {</b>
&nbsp;            @Override
&nbsp;            public void windowClosing(WindowEvent e) {
<b class="nc">&nbsp;                quit();</b>
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        frame.setContentPane(new JPanel() {</b>
&nbsp;            private static final long serialVersionUID = 5174313603291016012L;
&nbsp;
&nbsp;            @Override
&nbsp;            protected void paintComponent(Graphics g) {
<b class="nc">&nbsp;                if (backgroundIcon == null) {</b>
<b class="nc">&nbsp;                    super.paintComponent(g);</b>
&nbsp;                    return;
&nbsp;                }
<b class="nc">&nbsp;                int w = getWidth();</b>
<b class="nc">&nbsp;                int h = getHeight();</b>
<b class="nc">&nbsp;                int iW = backgroundIcon.getWidth();</b>
<b class="nc">&nbsp;                int iH = backgroundIcon.getHeight();</b>
&nbsp;                // If the image isn&#39;t loaded, prevent an infinite loop
<b class="nc">&nbsp;                if ((iW &lt; 1) || (iH &lt; 1)) {</b>
&nbsp;                    return;
&nbsp;                }
<b class="nc">&nbsp;                for (int x = 0; x &lt; w; x += iW) {</b>
<b class="nc">&nbsp;                    for (int y = 0; y &lt; h; y += iH) {</b>
<b class="nc">&nbsp;                        g.drawImage(backgroundIcon, x, y,null);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        List&lt;Image&gt; iconList = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_16X16).toString()));</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_32X32).toString()));</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_48X48).toString()));</b>
<b class="nc">&nbsp;        iconList.add(frame.getToolkit().getImage(</b>
<b class="nc">&nbsp;                new MegaMekFile(Configuration.miscImagesDir(), FILENAME_ICON_256X256).toString()));</b>
<b class="nc">&nbsp;        frame.setIconImages(iconList);</b>
<b class="nc">&nbsp;        CommonMenuBar menuBar = new CommonMenuBar();</b>
<b class="nc">&nbsp;        menuBar.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        frame.setJMenuBar(menuBar);</b>
<b class="nc">&nbsp;        showMainMenu();</b>
&nbsp;
&nbsp;        // set visible on middle of screen
<b class="nc">&nbsp;        frame.setLocationRelativeTo(null);</b>
&nbsp;        // init the cache
<b class="nc">&nbsp;        MechSummaryCache.getInstance();</b>
&nbsp;
&nbsp;        // Show the window.
<b class="nc">&nbsp;        frame.setVisible(true);</b>
&nbsp;
&nbsp;        // tell the user about the readme...
<b class="nc">&nbsp;        if (GUIPreferences.getInstance().getNagForReadme()) {</b>
<b class="nc">&nbsp;            ConfirmDialog confirm = new ConfirmDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.welcome.title&quot;) + MegaMek.VERSION,</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.welcome.message&quot;), true);</b>
<b class="nc">&nbsp;            confirm.setVisible(true);</b>
<b class="nc">&nbsp;            if (!confirm.getShowAgain()) {</b>
<b class="nc">&nbsp;                GUIPreferences.getInstance().setNagForReadme(false);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (confirm.getAnswer()) {</b>
<b class="nc">&nbsp;                showHelp();</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public void createController() {
<b class="nc">&nbsp;        controller = new MegaMekController();</b>
<b class="nc">&nbsp;        KeyboardFocusManager kbfm = KeyboardFocusManager.getCurrentKeyboardFocusManager();</b>
<b class="nc">&nbsp;        kbfm.addKeyEventDispatcher(controller);</b>
&nbsp;
<b class="nc">&nbsp;        KeyBindParser.parseKeyBindings(controller);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Display the main menu.
&nbsp;     */
&nbsp;    private void showMainMenu() {
<b class="nc">&nbsp;        SkinSpecification skinSpec = SkinXMLHandler.getSkin(SkinSpecification.UIComponents.MainMenuBorder.getComp(),</b>
&nbsp;                true);
<b class="nc">&nbsp;        frame.getContentPane().removeAll();</b>
<b class="nc">&nbsp;        frame.setBackground(SystemColor.menu);</b>
<b class="nc">&nbsp;        frame.setForeground(SystemColor.menuText);</b>
<b class="nc">&nbsp;        frame.setResizable(false);</b>
&nbsp;
&nbsp;        MegamekButton hostB;
&nbsp;        MegamekButton connectB;
&nbsp;        MegamekButton botB;
&nbsp;        MegamekButton editB;
&nbsp;        MegamekButton skinEditB;
&nbsp;        MegamekButton scenB;
&nbsp;        MegamekButton loadB;
&nbsp;        MegamekButton quitB;
<b class="nc">&nbsp;        JLabel labVersion = new JLabel(Messages.getString(&quot;MegaMek.Version&quot;) + MegaMek.VERSION,</b>
&nbsp;                JLabel.CENTER);
<b class="nc">&nbsp;        labVersion.setPreferredSize(new Dimension(250,15));</b>
<b class="nc">&nbsp;        if (skinSpec.fontColors.size() &gt; 0) {</b>
<b class="nc">&nbsp;            labVersion.setForeground(skinSpec.fontColors.get(0));</b>
&nbsp;        }
<b class="nc">&nbsp;        hostB = new MegamekButton(Messages.getString(&quot;MegaMek.hostNewGame.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        hostB.setActionCommand(ClientGUI.FILE_GAME_NEW);</b>
<b class="nc">&nbsp;        hostB.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        scenB = new MegamekButton(Messages.getString(&quot;MegaMek.hostScenario.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        scenB.setActionCommand(ClientGUI.FILE_GAME_SCENARIO);</b>
<b class="nc">&nbsp;        scenB.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        loadB = new MegamekButton(Messages.getString(&quot;MegaMek.hostSavedGame.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        loadB.setActionCommand(ClientGUI.FILE_GAME_OPEN);</b>
<b class="nc">&nbsp;        loadB.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        connectB = new MegamekButton(Messages.getString(&quot;MegaMek.Connect.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        connectB.setActionCommand(ClientGUI.FILE_GAME_CONNECT);</b>
<b class="nc">&nbsp;        connectB.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        botB = new MegamekButton(Messages.getString(&quot;MegaMek.ConnectAsBot.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        botB.setActionCommand(ClientGUI.FILE_GAME_CONNECT_BOT);</b>
<b class="nc">&nbsp;        botB.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        editB = new MegamekButton(Messages.getString(&quot;MegaMek.MapEditor.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        editB.setActionCommand(ClientGUI.FILE_BOARD_NEW);</b>
<b class="nc">&nbsp;        editB.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        skinEditB = new MegamekButton(Messages.getString(&quot;MegaMek.SkinEditor.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        skinEditB.setActionCommand(ClientGUI.MAIN_SKIN_NEW);</b>
<b class="nc">&nbsp;        skinEditB.addActionListener(actionListener);</b>
<b class="nc">&nbsp;        quitB = new MegamekButton(Messages.getString(&quot;MegaMek.Quit.label&quot;),</b>
<b class="nc">&nbsp;                SkinSpecification.UIComponents.MainMenuButton.getComp(), true);</b>
<b class="nc">&nbsp;        quitB.setActionCommand(ClientGUI.MAIN_QUIT);</b>
<b class="nc">&nbsp;        quitB.addActionListener(actionListener);</b>
&nbsp;
&nbsp;        // Use the current monitor so we don&#39;t &quot;overflow&quot; computers whose primary
&nbsp;        // displays aren&#39;t as large as their secondary displays.
<b class="nc">&nbsp;        DisplayMode currentMonitor = frame.getGraphicsConfiguration().getDevice().getDisplayMode();</b>
&nbsp;
&nbsp;        String splashFilename;
<b class="nc">&nbsp;        if (skinSpec.hasBackgrounds()) {</b>
<b class="nc">&nbsp;            splashFilename = determineSplashScreen(skinSpec.backgrounds, </b>
<b class="nc">&nbsp;                    currentMonitor.getWidth(), currentMonitor.getHeight());</b>
<b class="nc">&nbsp;            if (skinSpec.backgrounds.size() &gt; 1) {</b>
<b class="nc">&nbsp;                File file = new MegaMekFile(Configuration.widgetsDir(),</b>
<b class="nc">&nbsp;                        skinSpec.backgrounds.get(1)).getFile();</b>
<b class="nc">&nbsp;                if (!file.exists()) {</b>
<b class="nc">&nbsp;                    MegaMek.getLogger().error(&quot;MainMenu Error: background icon doesn&#39;t exist: &quot;</b>
<b class="nc">&nbsp;                            + file.getAbsolutePath());</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    backgroundIcon = (BufferedImage) ImageUtil.loadImageFromFile(file.toString());</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        } else {
<b class="nc">&nbsp;            splashFilename = FILENAME_MEGAMEK_SPLASH;</b>
<b class="nc">&nbsp;            backgroundIcon = null;</b>
&nbsp;        }
<b class="nc">&nbsp;        File splashFile = new File(Configuration.widgetsDir(), splashFilename);</b>
&nbsp;        // Ensure we have a splash image, even if we have to fall back to default.
<b class="nc">&nbsp;        if (!splashFile.exists()) {</b>
<b class="nc">&nbsp;            splashFilename = FILENAME_MEGAMEK_SPLASH;</b>
&nbsp;        }
&nbsp;        // initialize splash image
<b class="nc">&nbsp;        Image imgSplash = frame.getToolkit()</b>
<b class="nc">&nbsp;                .getImage(new MegaMekFile(Configuration.widgetsDir(), splashFilename).toString());</b>
&nbsp;
&nbsp;        // wait for splash image to load completely
<b class="nc">&nbsp;        MediaTracker tracker = new MediaTracker(frame);</b>
<b class="nc">&nbsp;        tracker.addImage(imgSplash, 0);</b>
&nbsp;        try {
<b class="nc">&nbsp;            tracker.waitForID(0);</b>
<b class="nc">&nbsp;        } catch (InterruptedException e) {</b>
&nbsp;            // really should never come here
<b class="nc">&nbsp;        }</b>
&nbsp;        // make splash image panel
<b class="nc">&nbsp;        ImageIcon icon = new ImageIcon(imgSplash);</b>
<b class="nc">&nbsp;        JLabel panTitle = new JLabel(icon);</b>
&nbsp;
<b class="nc">&nbsp;        FontMetrics metrics = hostB.getFontMetrics(loadB.getFont());</b>
<b class="nc">&nbsp;        int width = metrics.stringWidth(hostB.getText());</b>
<b class="nc">&nbsp;        int height = metrics.getHeight();</b>
<b class="nc">&nbsp;        Dimension textDim =  new Dimension(width+50, height+10);</b>
&nbsp;
&nbsp;        // Strive for no more than ~90% of the screen and use golden ratio to make
&nbsp;        // the button width &quot;look&quot; reasonable.
<b class="nc">&nbsp;        int imageWidth = imgSplash.getWidth(frame);</b>
<b class="nc">&nbsp;        int maximumWidth = (int) (0.9 * currentMonitor.getWidth()) - imageWidth;</b>
<b class="nc">&nbsp;        Dimension minButtonDim = new Dimension((int) (maximumWidth / 1.618), 25);</b>
<b class="nc">&nbsp;        if (textDim.getWidth() &gt; minButtonDim.getWidth()) {</b>
<b class="nc">&nbsp;            minButtonDim = textDim;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        hostB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        connectB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        botB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        editB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        skinEditB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        scenB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        loadB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        quitB.setPreferredSize(minButtonDim);</b>
<b class="nc">&nbsp;        hostB.setPreferredSize(minButtonDim);</b>
&nbsp;
<b class="nc">&nbsp;        connectB.setMinimumSize(minButtonDim);</b>
<b class="nc">&nbsp;        botB.setMinimumSize(minButtonDim);</b>
<b class="nc">&nbsp;        editB.setMinimumSize(minButtonDim);</b>
<b class="nc">&nbsp;        skinEditB.setMinimumSize(minButtonDim);</b>
<b class="nc">&nbsp;        scenB.setMinimumSize(minButtonDim);</b>
<b class="nc">&nbsp;        loadB.setMinimumSize(minButtonDim);</b>
<b class="nc">&nbsp;        quitB.setMinimumSize(minButtonDim);</b>
&nbsp;
&nbsp;        // layout
<b class="nc">&nbsp;        GridBagLayout gridbag = new GridBagLayout();</b>
<b class="nc">&nbsp;        GridBagConstraints c = new GridBagConstraints();</b>
<b class="nc">&nbsp;        frame.getContentPane().setLayout(gridbag);</b>
&nbsp;        // Left Column
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        c.insets = new Insets(10, 5, 10, 10);</b>
<b class="nc">&nbsp;        c.ipadx = 10; c.ipady = 5;</b>
<b class="nc">&nbsp;        c.gridx = 0;  c.gridy = 0;</b>
<b class="nc">&nbsp;        c.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;        c.weightx = 0.0; c.weighty = 0.0;</b>
<b class="nc">&nbsp;        c.gridwidth = 1;</b>
<b class="nc">&nbsp;        c.gridheight = 9;</b>
<b class="nc">&nbsp;        addBag(panTitle, gridbag, c);</b>
&nbsp;        // Right Column
<b class="nc">&nbsp;        c.insets = new Insets(4, 4, 1, 12);</b>
<b class="nc">&nbsp;        c.fill = GridBagConstraints.BOTH;</b>
<b class="nc">&nbsp;        c.weightx = 1.0; c.weighty = 1.0;</b>
<b class="nc">&nbsp;        c.ipadx = 0; c.ipady = 0;</b>
<b class="nc">&nbsp;        c.gridheight = 1;</b>
<b class="nc">&nbsp;        c.gridx = 1; c.gridy = 0;</b>
<b class="nc">&nbsp;        addBag(labVersion, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        addBag(hostB, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        addBag(loadB, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        addBag(scenB, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        addBag(connectB, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        addBag(botB, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        addBag(editB, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        addBag(skinEditB, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy++;</b>
<b class="nc">&nbsp;        c.insets = new Insets(4, 4, 15, 12);</b>
<b class="nc">&nbsp;        addBag(quitB, gridbag, c);</b>
<b class="nc">&nbsp;        frame.validate();</b>
<b class="nc">&nbsp;        frame.pack();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Display the game options dialog.
&nbsp;     */
&nbsp;    void showGameOptions() {
<b class="nc">&nbsp;        GameOptions options = new GameOptions();</b>
<b class="nc">&nbsp;        options.initialize();</b>
<b class="nc">&nbsp;        options.loadOptions();</b>
<b class="nc">&nbsp;        if (optionsDialog == null) {</b>
<b class="nc">&nbsp;            optionsDialog = new GameOptionsDialog(frame, options, true);</b>
&nbsp;        }
<b class="nc">&nbsp;        optionsDialog.update(options);</b>
<b class="nc">&nbsp;        optionsDialog.setVisible(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Display the board editor.
&nbsp;     */
&nbsp;    void showEditor() {
<b class="nc">&nbsp;        BoardEditor editor = new BoardEditor(controller);</b>
<b class="nc">&nbsp;        controller.boardEditor = editor;</b>
<b class="nc">&nbsp;        launch(editor.getFrame());</b>
<b class="nc">&nbsp;        editor.boardNew(GUIPreferences.getInstance().getBoardEdRndStart());</b>
&nbsp;    }
&nbsp;    
&nbsp;    void showSkinEditor() {
<b class="nc">&nbsp;        int response = JOptionPane.showConfirmDialog(frame, </b>
&nbsp;                &quot;The skin editor is currently &quot;
&nbsp;                + &quot;in beta and is a work in progress.  There are likely to &quot;
&nbsp;                + &quot;be issues. \nContinue?&quot;, &quot;Continue?&quot;,
&nbsp;                JOptionPane.OK_CANCEL_OPTION);
<b class="nc">&nbsp;        if (response == JOptionPane.CANCEL_OPTION) {</b>
&nbsp;            return;
&nbsp;        }
<b class="nc">&nbsp;        SkinEditorMainGUI skinEditor = new SkinEditorMainGUI();</b>
<b class="nc">&nbsp;        skinEditor.initialize();</b>
<b class="nc">&nbsp;        skinEditor.switchPanel(IGame.Phase.PHASE_MOVEMENT);</b>
<b class="nc">&nbsp;        launch(skinEditor.getFrame());        </b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Display the board editor and open an &quot;open&quot; dialog.
&nbsp;     */
&nbsp;    void showEditorOpen() {
<b class="nc">&nbsp;        BoardEditor editor = new BoardEditor(controller);</b>
<b class="nc">&nbsp;        controller.boardEditor = editor;</b>
<b class="nc">&nbsp;        launch(editor.getFrame());</b>
<b class="nc">&nbsp;        editor.boardLoad();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Start instances of both the client and the server.
&nbsp;     */
&nbsp;    void host() {
<b class="nc">&nbsp;        HostDialog hd = new HostDialog(frame);</b>
<b class="nc">&nbsp;        hd.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;        if (!hd.dataValidation(&quot;MegaMek.HostGameAlert.title&quot;)) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;        // kick off a RNG check
<b class="nc">&nbsp;        d6();</b>
&nbsp;
&nbsp;        // start server
&nbsp;        try {
<b class="nc">&nbsp;            server = new Server(hd.getServerPass(), hd.getPort(), hd.isRegister(),</b>
<b class="nc">&nbsp;                    hd.isRegister() ? hd.getMetaserver() : &quot;&quot;);</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            MegaMek.getLogger().error(&quot;Could not create server socket on port &quot; + hd.getPort(), e);</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getFormattedString(&quot;MegaMek.StartServerError&quot;, hd.getPort(), e.getMessage()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.HostGameAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
&nbsp;            return;
<b class="nc">&nbsp;        }</b>
&nbsp;        // initialize client
<b class="nc">&nbsp;        client = new Client(hd.getPlayerName(), &quot;localhost&quot;, hd.getPort());</b>
<b class="nc">&nbsp;        ClientGUI gui = new ClientGUI(client, controller);</b>
<b class="nc">&nbsp;        controller.clientgui = gui;</b>
<b class="nc">&nbsp;        frame.setCursor(new Cursor(Cursor.WAIT_CURSOR));</b>
<b class="nc">&nbsp;        gui.initialize();</b>
<b class="nc">&nbsp;        frame.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));</b>
<b class="nc">&nbsp;        if (!client.connect()) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getFormattedString(&quot;MegaMek.ServerConnectionError&quot;, &quot;localhost&quot;, hd.getPort()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.HostGameAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
<b class="nc">&nbsp;            frame.setVisible(false);</b>
<b class="nc">&nbsp;            client.die();</b>
&nbsp;        }
<b class="nc">&nbsp;        launch(gui.getFrame());</b>
&nbsp;
<b class="nc">&nbsp;        optionsDialog = null;</b>
&nbsp;    }
&nbsp;
&nbsp;    void loadGame() {
<b class="nc">&nbsp;        JFileChooser fc = new JFileChooser(&quot;savegames&quot;);</b>
<b class="nc">&nbsp;        fc.setLocation(frame.getLocation().x + 150, frame.getLocation().y + 100);</b>
<b class="nc">&nbsp;        fc.setDialogTitle(Messages.getString(&quot;MegaMek.SaveGameDialog.title&quot;));</b>
<b class="nc">&nbsp;        fc.setFileFilter(new FileFilter() {</b>
&nbsp;            @Override
&nbsp;            public boolean accept(File dir) {
<b class="nc">&nbsp;                return ((dir.getName().endsWith(&quot;.sav&quot;) || dir.getName().endsWith(&quot;.sav.gz&quot;) || dir.isDirectory()));</b>
&nbsp;            }
&nbsp;
&nbsp;            @Override
&nbsp;            public String getDescription() {
<b class="nc">&nbsp;                return &quot;Savegames&quot;;</b>
&nbsp;            }
&nbsp;        });
<b class="nc">&nbsp;        int returnVal = fc.showOpenDialog(frame);</b>
<b class="nc">&nbsp;        if ((returnVal != JFileChooser.APPROVE_OPTION) || (fc.getSelectedFile() == null)) {</b>
&nbsp;            // I want a file, y&#39;know!
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        IGame newGame = null;</b>
<b class="nc">&nbsp;        try (InputStream is = new FileInputStream(fc.getSelectedFile()); InputStream gzi = new GZIPInputStream(is)) {</b>
<b class="nc">&nbsp;            XStream xstream = SerializationHelper.getXStream();</b>
<b class="nc">&nbsp;            newGame = (IGame) xstream.fromXML(gzi);</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            MegaMek.getLogger().error(&quot;Unable to load file: &quot; + fc.getSelectedFile(), e);</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame, Messages.getString(&quot;MegaMek.LoadGameAlert.message&quot;),</b>
<b class="nc">&nbsp;            Messages.getString(&quot;MegaMek.LoadGameAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
&nbsp;            return;
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        Vector&lt;String&gt; playerNames = null;</b>
<b class="nc">&nbsp;        if (newGame != null) {</b>
<b class="nc">&nbsp;            playerNames = new Vector&lt;&gt;();</b>
<b class="nc">&nbsp;            for (IPlayer player : newGame.getPlayersVector()) {</b>
<b class="nc">&nbsp;                playerNames.add(player.getName());</b>
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        HostDialog hd = new HostDialog(frame, playerNames);</b>
<b class="nc">&nbsp;        hd.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;        if (!hd.dataValidation(&quot;MegaMek.LoadGameAlert.title&quot;)) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;        // kick off a RNG check
<b class="nc">&nbsp;        d6();</b>
&nbsp;        // start server
&nbsp;        try {
<b class="nc">&nbsp;            server = new Server(hd.getServerPass(), hd.getPort(), hd.isRegister(), hd.isRegister() ? hd.getMetaserver() : &quot;&quot;);</b>
<b class="nc">&nbsp;        } catch (IOException ex) {</b>
<b class="nc">&nbsp;            MegaMek.getLogger().error(&quot;Could not create server socket on port &quot; + hd.getPort(), ex);</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getFormattedString(&quot;MegaMek.StartServerError&quot;, hd.getPort(), ex.getMessage()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.LoadGameAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
&nbsp;            return;
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        if (!server.loadGame(fc.getSelectedFile())) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame, Messages.getString(&quot;MegaMek.LoadGameAlert.message&quot;),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.LoadGameAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
<b class="nc">&nbsp;            server.die();</b>
<b class="nc">&nbsp;            server = null;</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        client = new Client(hd.getPlayerName(), &quot;localhost&quot;, hd.getPort());</b>
<b class="nc">&nbsp;        ClientGUI gui = new ClientGUI(client, controller);</b>
<b class="nc">&nbsp;        controller.clientgui = gui;</b>
<b class="nc">&nbsp;        frame.setCursor(new Cursor(Cursor.WAIT_CURSOR));</b>
<b class="nc">&nbsp;        gui.initialize();</b>
<b class="nc">&nbsp;        frame.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));</b>
<b class="nc">&nbsp;        if (!client.connect()) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getFormattedString(&quot;MegaMek.ServerConnectionError&quot;, &quot;localhost&quot;, hd.getPort()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.LoadGameAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
<b class="nc">&nbsp;            frame.setVisible(false);</b>
<b class="nc">&nbsp;            client.die();</b>
&nbsp;        }
<b class="nc">&nbsp;        optionsDialog = null;</b>
&nbsp;
&nbsp;        // free some memory that&#39;s only needed in lounge
&nbsp;        // This normally happens in the deployment phase in Client, but
&nbsp;        // if we are loading a game, this phase may not be reached
<b class="nc">&nbsp;        MechFileParser.dispose();</b>
&nbsp;        // We must do this last, as the name and unit generators can create
&nbsp;        // a new instance if they are running
<b class="nc">&nbsp;        MechSummaryCache.dispose();</b>
&nbsp;
<b class="nc">&nbsp;        launch(gui.getFrame());</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Host a game constructed from a scenario file
&nbsp;     */
&nbsp;    void scenario() {
<b class="nc">&nbsp;        JFileChooser fc = new JFileChooser(&quot;data&quot; + File.separatorChar + &quot;scenarios&quot;);</b>
<b class="nc">&nbsp;        fc.setLocation(frame.getLocation().x + 150, frame.getLocation().y + 100);</b>
<b class="nc">&nbsp;        fc.setDialogTitle(Messages.getString(&quot;MegaMek.SelectScenarioDialog.title&quot;));</b>
&nbsp;
<b class="nc">&nbsp;        FileFilter filter = new FileFilter() {</b>
&nbsp;
&nbsp;            @Override
&nbsp;            public boolean accept(File f) {
<b class="nc">&nbsp;                if (f.isDirectory()) {</b>
<b class="nc">&nbsp;                    return true;</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                String ext = null;</b>
<b class="nc">&nbsp;                String s = f.getName();</b>
<b class="nc">&nbsp;                int i = s.lastIndexOf(&#39;.&#39;);</b>
&nbsp;
<b class="nc">&nbsp;                if ((i &gt; 0) &amp;&amp; (i &lt; (s.length() - 1))) {</b>
<b class="nc">&nbsp;                    ext = s.substring(i + 1).toLowerCase();</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (ext != null) {</b>
<b class="nc">&nbsp;                    return ext.equalsIgnoreCase(&quot;mms&quot;);</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
&nbsp;
&nbsp;            @Override
&nbsp;            public String getDescription() {
<b class="nc">&nbsp;                return &quot;MegaMek Scenario Files&quot;;</b>
&nbsp;            }
&nbsp;
&nbsp;        };
<b class="nc">&nbsp;        fc.setFileFilter(filter);</b>
&nbsp;
<b class="nc">&nbsp;        int returnVal = fc.showOpenDialog(frame);</b>
<b class="nc">&nbsp;        if ((returnVal != JFileChooser.APPROVE_OPTION) || (fc.getSelectedFile() == null)) {</b>
&nbsp;            // I want a file, y&#39;know!
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        ScenarioLoader sl = new ScenarioLoader(fc.getSelectedFile());</b>
&nbsp;        IGame g;
&nbsp;        try {
<b class="nc">&nbsp;            g = sl.createGame();</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            MegaMek.getLogger().error(e);</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.HostScenarioAlert.message&quot;, e.getMessage()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.HostScenarioAlert.title&quot;),</b>
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;            return;
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // popup options dialog
<b class="nc">&nbsp;        GameOptionsDialog god = new GameOptionsDialog(frame, g.getOptions(), false);</b>
<b class="nc">&nbsp;        god.update(g.getOptions());</b>
<b class="nc">&nbsp;        god.setEditable(true);</b>
<b class="nc">&nbsp;        god.setVisible(true);</b>
<b class="nc">&nbsp;        for (IBasicOption opt : god.getOptions()) {</b>
<b class="nc">&nbsp;            IOption orig = g.getOptions().getOption(opt.getName());</b>
<b class="nc">&nbsp;            orig.setValue(opt.getValue());</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // popup planetary conditions dialog
<b class="nc">&nbsp;        PlanetaryConditionsDialog pcd = new PlanetaryConditionsDialog(frame, g.getPlanetaryConditions());</b>
<b class="nc">&nbsp;        pcd.update(g.getPlanetaryConditions());</b>
<b class="nc">&nbsp;        pcd.setVisible(true);</b>
<b class="nc">&nbsp;        g.setPlanetaryConditions(pcd.getConditions());</b>
&nbsp;
&nbsp;        // get player types and colors set
<b class="nc">&nbsp;        Player[] pa = new Player[g.getPlayersVector().size()];</b>
<b class="nc">&nbsp;        g.getPlayersVector().copyInto(pa);</b>
<b class="nc">&nbsp;        ScenarioDialog sd = new ScenarioDialog(frame, pa);</b>
<b class="nc">&nbsp;        sd.setVisible(true);</b>
<b class="nc">&nbsp;        if (!sd.bSet) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        HostDialog hd = new HostDialog(frame);</b>
<b class="nc">&nbsp;        boolean hasSlot = false;</b>
<b class="nc">&nbsp;        if (!(&quot;&quot;.equals(sd.localName))) {</b>
<b class="nc">&nbsp;            hasSlot = true;</b>
&nbsp;        }
<b class="nc">&nbsp;        hd.setPlayerName(sd.localName);</b>
<b class="nc">&nbsp;        hd.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;        if (!hd.dataValidation(&quot;MegaMek.HostScenarioAlert.title&quot;)) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        sd.localName = hd.getPlayerName();</b>
&nbsp;
&nbsp;        // kick off a RNG check
<b class="nc">&nbsp;        Compute.d6();</b>
&nbsp;
&nbsp;        // start server
&nbsp;        try {
<b class="nc">&nbsp;            server = new Server(hd.getServerPass(), hd.getPort());</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            MegaMek.getLogger().error(&quot;Could not create server socket on port &quot; + hd.getPort(), ex);</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getFormattedString(&quot;MegaMek.StartServerError&quot;, hd.getPort(), ex.getMessage()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.HostScenarioAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
&nbsp;            return;
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        server.setGame(g);</b>
&nbsp;
&nbsp;        // apply any scenario damage
<b class="nc">&nbsp;        sl.applyDamage(server);</b>
<b class="nc">&nbsp;        ClientGUI gui = null;</b>
<b class="nc">&nbsp;        if (!&quot;&quot;.equals(sd.localName)) {</b>
&nbsp;            // initialize game
<b class="nc">&nbsp;            client = new Client(hd.getPlayerName(), &quot;localhost&quot;, hd.getPort());</b>
<b class="nc">&nbsp;            gui = new ClientGUI(client, controller);</b>
<b class="nc">&nbsp;            controller.clientgui = gui;</b>
<b class="nc">&nbsp;            gui.initialize();</b>
<b class="nc">&nbsp;            if (!client.connect()) {</b>
<b class="nc">&nbsp;                JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                        Messages.getFormattedString(&quot;MegaMek.ServerConnectionError&quot;, &quot;localhost&quot;, hd.getPort()),</b>
<b class="nc">&nbsp;                        Messages.getString(&quot;MegaMek.HostScenarioAlert.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
<b class="nc">&nbsp;                frame.setVisible(false);</b>
<b class="nc">&nbsp;                client.die();</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        optionsDialog = null;</b>
&nbsp;
&nbsp;        // calculate initial BV
<b class="nc">&nbsp;        server.calculatePlayerBVs();</b>
&nbsp;
&nbsp;        // setup any bots
<b class="nc">&nbsp;        for (int x = 0; x &lt; pa.length; x++) {</b>
<b class="nc">&nbsp;            if (sd.playerTypes[x] == ScenarioDialog.T_BOT) {</b>
<b class="nc">&nbsp;                BotClient c = new TestBot(pa[x].getName(), &quot;localhost&quot;, hd.getPort());</b>
<b class="nc">&nbsp;                c.getGame().addGameListener(new BotGUI(c));</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        for (int x = 0; x &lt; pa.length; x++) {</b>
<b class="nc">&nbsp;            if (sd.playerTypes[x] == ScenarioDialog.T_OBOT) {</b>
<b class="nc">&nbsp;                BotClient c = new Princess(pa[x].getName(), &quot;localhost&quot;, hd.getPort(), LogLevel.ERROR);</b>
<b class="nc">&nbsp;                c.getGame().addGameListener(new BotGUI(c));</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        // If he didn&#39;t have a name when hasSlot was set, then the host should
&nbsp;        // be an observer.
<b class="nc">&nbsp;        if (!hasSlot) {</b>
<b class="nc">&nbsp;            Enumeration&lt;IPlayer&gt; pE = server.getGame().getPlayers();</b>
<b class="nc">&nbsp;            while (pE.hasMoreElements()) {</b>
<b class="nc">&nbsp;                IPlayer tmpP = pE.nextElement();</b>
<b class="nc">&nbsp;                if (tmpP.getName().equals(sd.localName)) {</b>
<b class="nc">&nbsp;                    tmpP.setObserver(true);</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        }
<b class="nc">&nbsp;        if (gui != null) {</b>
<b class="nc">&nbsp;            launch(gui.getFrame());</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Connect to to a game and then launch the chat lounge.
&nbsp;     */
&nbsp;    void connect() {
<b class="nc">&nbsp;        ConnectDialog cd = new ConnectDialog(frame);</b>
<b class="nc">&nbsp;        cd.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;        if (!cd.dataValidation(&quot;MegaMek.ConnectDialog.title&quot;)) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;        // initialize game
<b class="nc">&nbsp;        client = new Client(cd.getPlayerName(), cd.getServerAddress(), cd.getPort());</b>
<b class="nc">&nbsp;        ClientGUI gui = new ClientGUI(client, controller);</b>
<b class="nc">&nbsp;        controller.clientgui = gui;</b>
<b class="nc">&nbsp;        frame.setCursor(new Cursor(Cursor.WAIT_CURSOR));</b>
<b class="nc">&nbsp;        gui.initialize();</b>
<b class="nc">&nbsp;        frame.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));</b>
<b class="nc">&nbsp;        if (!client.connect()) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getFormattedString(&quot;MegaMek.ServerConnectionError&quot;, cd.getServerAddress(), cd.getPort()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.ConnectDialog.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
<b class="nc">&nbsp;            frame.setVisible(false);</b>
<b class="nc">&nbsp;            client.die();</b>
&nbsp;        }
<b class="nc">&nbsp;        launch(gui.getFrame());</b>
&nbsp;    }
&nbsp;
&nbsp;    void connectBot() {
<b class="nc">&nbsp;        ConnectDialog cd = new ConnectDialog(frame);</b>
<b class="nc">&nbsp;        cd.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;        if (!cd.dataValidation(&quot;MegaMek.ConnectDialog.title&quot;)) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;        // initialize game
<b class="nc">&nbsp;        BotConfigDialog bcd = new BotConfigDialog(frame);</b>
<b class="nc">&nbsp;        bcd.setVisible(true);</b>
<b class="nc">&nbsp;        if (bcd.dialogAborted) {</b>
&nbsp;            return; // user didn&#39;t click &#39;ok&#39;, add no bot
&nbsp;        }
<b class="nc">&nbsp;        client = bcd.getSelectedBot(cd.getServerAddress(), cd.getPort());</b>
<b class="nc">&nbsp;        client.getGame().addGameListener(new BotGUI((BotClient) client));</b>
<b class="nc">&nbsp;        ClientGUI gui = new ClientGUI(client, controller);</b>
<b class="nc">&nbsp;        controller.clientgui = gui;</b>
<b class="nc">&nbsp;        gui.initialize();</b>
<b class="nc">&nbsp;        if (!client.connect()) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(frame,</b>
<b class="nc">&nbsp;                    Messages.getFormattedString(&quot;MegaMek.ServerConnectionError&quot;, cd.getServerAddress(), cd.getPort()),</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;MegaMek.ConnectDialog.title&quot;), JOptionPane.ERROR_MESSAGE);</b>
<b class="nc">&nbsp;            frame.setVisible(false);</b>
<b class="nc">&nbsp;            client.die();</b>
&nbsp;        }
<b class="nc">&nbsp;        launch(gui.getFrame());</b>
&nbsp;    }
&nbsp;
&nbsp;    private void addBag(JComponent comp, GridBagLayout gridbag, GridBagConstraints c) {
<b class="nc">&nbsp;        gridbag.setConstraints(comp, c);</b>
<b class="nc">&nbsp;        frame.getContentPane().add(comp);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Called when the user selects the &quot;Help-&gt;About&quot; menu item.
&nbsp;     */
&nbsp;    void showAbout() {
&nbsp;        // Do we need to create the &quot;about&quot; dialog?
<b class="nc">&nbsp;        if (about == null) {</b>
<b class="nc">&nbsp;            about = new CommonAboutDialog(frame);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Show the about dialog.
<b class="nc">&nbsp;        about.setVisible(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Called when the user selects the &quot;Help-&gt;Contents&quot; menu item.
&nbsp;     */
&nbsp;    void showHelp() {
<b class="nc">&nbsp;        if (help == null) {</b>
<b class="nc">&nbsp;            help = showHelp(frame, Messages.getString(&quot;CommonMenuBar.helpFilePath&quot;));</b>
&nbsp;        }
&nbsp;        // Show the help dialog.
<b class="nc">&nbsp;        help.setVisible(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    private void showSkinningHowTo() {
&nbsp;        try {
&nbsp;            // Get the correct help file.
<b class="nc">&nbsp;            StringBuilder helpPath = new StringBuilder(&quot;file:///&quot;);</b>
<b class="nc">&nbsp;            helpPath.append(System.getProperty(&quot;user.dir&quot;));</b>
<b class="nc">&nbsp;            if (!helpPath.toString().endsWith(File.separator)) {</b>
<b class="nc">&nbsp;                helpPath.append(File.separator);</b>
&nbsp;            }
<b class="nc">&nbsp;            helpPath.append(Messages.getString(&quot;ClientGUI.skinningHelpPath&quot;));</b>
<b class="nc">&nbsp;            URL helpUrl = new URL(helpPath.toString());</b>
&nbsp;
&nbsp;            // Launch the help dialog.
<b class="nc">&nbsp;            HelpDialog helpDialog = new HelpDialog(</b>
<b class="nc">&nbsp;                    Messages.getString(&quot;ClientGUI.skinningHelpPath.title&quot;),</b>
&nbsp;                    helpUrl);
<b class="nc">&nbsp;            helpDialog.setVisible(true);</b>
<b class="nc">&nbsp;        } catch (MalformedURLException e) {</b>
<b class="nc">&nbsp;            MegaMek.getLogger().error(e);</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * display the filename in a CommonHelpDialog
&nbsp;     */
&nbsp;    private static CommonHelpDialog showHelp(JFrame frame, String filename) {
<b class="nc">&nbsp;        Locale l = Locale.getDefault();</b>
&nbsp;        File helpFile;
<b class="nc">&nbsp;        if (!filename.contains(&quot;.txt&quot;)) { //$NON-NLS-1$</b>
<b class="nc">&nbsp;            helpFile = new File(&quot;docs&quot; + File.separator + filename + &#39;-&#39; //$NON-NLS-1$  //$NON-NLS-2$</b>
<b class="nc">&nbsp;                    + l.getDisplayLanguage(Locale.ENGLISH) + &quot;.txt&quot;); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            if (!helpFile.exists()) {</b>
<b class="nc">&nbsp;                helpFile = new File(&quot;docs&quot; + File.separator + filename + &quot;.txt&quot;); //$NON-NLS-1$</b>
&nbsp;            }
&nbsp;        } else {
<b class="nc">&nbsp;            String localeFileName = filename.replace(&quot;.txt&quot;, //$NON-NLS-1$</b>
<b class="nc">&nbsp;                    &quot;-&quot; + l.getDisplayLanguage(Locale.ENGLISH) + &quot;.txt&quot;); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            helpFile = new File(localeFileName);</b>
<b class="nc">&nbsp;            if (!helpFile.exists()) {</b>
<b class="nc">&nbsp;                helpFile = new File(filename);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return new CommonHelpDialog(frame, helpFile);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Called when the user selects the &quot;View-&gt;Client Settings&quot; menu item.
&nbsp;     */
&nbsp;    void showSettings() {
&nbsp;        // Do we need to create the &quot;settings&quot; dialog?
<b class="nc">&nbsp;        if (settingsDialog == null) {</b>
<b class="nc">&nbsp;            settingsDialog = new CommonSettingsDialog(frame);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Show the settings dialog.
<b class="nc">&nbsp;        settingsDialog.setVisible(true);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Called when the quit buttons is pressed or the main menu is closed.
&nbsp;     */
&nbsp;    static void quit() {
<b class="nc">&nbsp;        PreferenceManager.getInstance().save();</b>
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            WeaponOrderHandler.saveWeaponOrderFile();</b>
<b class="nc">&nbsp;        } catch (IOException e) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Error saving custom weapon orders!&quot;);</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            QuirksHandler.saveCustomQuirksList();</b>
<b class="nc">&nbsp;        } catch (IOException e) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Error saving quirks override!&quot;);</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="nc">&nbsp;        System.exit(0);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Hides this window for later. Listens to the frame until it closes, then
&nbsp;     * calls unlaunch().
&nbsp;     */
&nbsp;    private void launch(JFrame launched) {
&nbsp;        // listen to new frame
<b class="nc">&nbsp;        launched.addWindowListener(new WindowAdapter() {</b>
&nbsp;            @Override
&nbsp;            public void windowClosed(WindowEvent e) {
<b class="nc">&nbsp;                unlaunch();</b>
&nbsp;            }
&nbsp;        });
&nbsp;        // hide menu frame
<b class="nc">&nbsp;        frame.setVisible(false);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Un-hides the main menu and tries to clean up the client or server.
&nbsp;     */
&nbsp;    void unlaunch() {
&nbsp;        // clean up server, if we have one
<b class="nc">&nbsp;        if (server != null) {</b>
<b class="nc">&nbsp;            server.die();</b>
<b class="nc">&nbsp;            server = null;</b>
&nbsp;        }
&nbsp;        // show menu frame
<b class="nc">&nbsp;        frame.setVisible(true);</b>
&nbsp;
&nbsp;        // just to free some memory
<b class="nc">&nbsp;        client = null;</b>
<b class="nc">&nbsp;        System.gc();</b>
<b class="nc">&nbsp;        System.runFinalization();</b>
&nbsp;    }
&nbsp;    
<b class="nc">&nbsp;    private ActionListener actionListener = ev -&gt; {</b>
<b class="nc">&nbsp;        switch (ev.getActionCommand()) {</b>
&nbsp;            case ClientGUI.FILE_BOARD_NEW:
<b class="nc">&nbsp;                showEditor();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.MAIN_SKIN_NEW:
<b class="nc">&nbsp;                showSkinEditor();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.FILE_BOARD_OPEN:
<b class="nc">&nbsp;                showEditorOpen();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.FILE_GAME_NEW:
<b class="nc">&nbsp;                host();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.FILE_GAME_SCENARIO:
<b class="nc">&nbsp;                scenario();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.FILE_GAME_CONNECT:
<b class="nc">&nbsp;                connect();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.FILE_GAME_CONNECT_BOT:
<b class="nc">&nbsp;                connectBot();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.FILE_GAME_OPEN:
<b class="nc">&nbsp;                loadGame();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.VIEW_GAME_OPTIONS:
<b class="nc">&nbsp;                showGameOptions();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.HELP_ABOUT:
<b class="nc">&nbsp;                showAbout();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.HELP_CONTENTS:
<b class="nc">&nbsp;                showHelp();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.HELP_SKINNING:
<b class="nc">&nbsp;                showSkinningHowTo();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.VIEW_CLIENT_SETTINGS:
<b class="nc">&nbsp;                showSettings();</b>
<b class="nc">&nbsp;                break;</b>
&nbsp;            case ClientGUI.MAIN_QUIT:
<b class="nc">&nbsp;                quit();</b>
&nbsp;                break;
&nbsp;        }
&nbsp;    };
&nbsp;
&nbsp;    @Override
&nbsp;    public void preferenceChange(PreferenceChangeEvent e) {
&nbsp;        // Update to reflect new skin
<b class="nc">&nbsp;        if (e.getName().equals(GUIPreferences.SKIN_FILE)) {</b>
<b class="nc">&nbsp;            showMainMenu();</b>
<b class="nc">&nbsp;            frame.repaint();</b>
<b class="nc">&nbsp;        } else if (e.getName().equals(GUIPreferences.UI_THEME)) {</b>
&nbsp;            try {
<b class="nc">&nbsp;                UIManager.setLookAndFeel((String)e.getNewValue());</b>
&nbsp;                // We went all Oprah and gave everybody frames...
&nbsp;                // so now we have to let everybody who got a frame
&nbsp;                // under their chair know that we updated our look
&nbsp;                // and feel.
<b class="nc">&nbsp;                for (Frame f : Frame.getFrames()) {</b>
<b class="nc">&nbsp;                    SwingUtilities.updateComponentTreeUI(f);</b>
&nbsp;                }
&nbsp;                // ...and also all of our windows and dialogs, etc.
<b class="nc">&nbsp;                for (Window w : Window.getWindows()) {</b>
<b class="nc">&nbsp;                    SwingUtilities.updateComponentTreeUI(w);</b>
&nbsp;                }
<b class="nc">&nbsp;            } catch (Exception ex) {</b>
<b class="nc">&nbsp;                MegaMek.getLogger().error(ex);</b>
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Method used to determine the appropriate splash screen to use. This method looks 
&nbsp;     * at both the height and the width of the main monitor.
&nbsp;     * 
&nbsp;     * @param splashScreens
&nbsp;     * 		List of available splash screens.
&nbsp;     * @param screenWidth
&nbsp;     * 		Width of the current monitor.
&nbsp;     * @param screenHeight
&nbsp;     * 		Height of the current monitor.
&nbsp;     * @return
&nbsp;     * 		String that represents the splash screen that should be displayed.
&nbsp;     */
&nbsp;    private String determineSplashScreen(final List&lt;String&gt; splashScreens, 
&nbsp;            final int screenWidth, final int screenHeight) {
&nbsp;        // Ensure that the list is of appropriate size to contain HD, FHD, and UHD splash
&nbsp;        // screens.
<b class="nc">&nbsp;        if (splashScreens.size() &gt; 3) {</b>
&nbsp;            // Default to the HD splash screen.
<b class="nc">&nbsp;            String splashFileName = splashScreens.get(3);</b>
&nbsp;            // If both height and width is greater than 1080p use the UHD splash screen.
<b class="nc">&nbsp;            if (screenWidth &gt; 1920 &amp;&amp; screenHeight &gt; 1080) {</b>
<b class="nc">&nbsp;                splashFileName = splashScreens.get(2);</b>
&nbsp;            }
&nbsp;            // If both height and width is greater than 720p then use the FHD splash screen.
<b class="nc">&nbsp;            else if (screenWidth &gt; 1280 &amp;&amp; screenHeight &gt; 720)</b>
&nbsp;            {
<b class="nc">&nbsp;                splashFileName = splashScreens.get(0);</b>
&nbsp;            }
<b class="nc">&nbsp;            return splashFileName;</b>
&nbsp;        }
&nbsp;        // List of splash screens is not complete so default to the first splash screen.
<b class="nc">&nbsp;        return splashScreens.get(0);</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
