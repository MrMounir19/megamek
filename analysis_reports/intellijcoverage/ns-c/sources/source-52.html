


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > StatusBarPhaseDisplay</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing</a>
</div>

<h1>Coverage Summary for Class: StatusBarPhaseDisplay (megamek.client.ui.swing)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">StatusBarPhaseDisplay</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/19)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/109)
  </span>
</td>
</tr>
  <tr>
    <td class="name">StatusBarPhaseDisplay$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">StatusBarPhaseDisplay$CommandComparator</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">StatusBarPhaseDisplay$PhaseCommand</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/23)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/119)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2000-2003 Ben Mazur (bmazur@sev.org)
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;
&nbsp;package megamek.client.ui.swing;
&nbsp;
&nbsp;import java.awt.Dimension;
&nbsp;import java.awt.GridBagConstraints;
&nbsp;import java.awt.GridBagLayout;
&nbsp;import java.awt.GridLayout;
&nbsp;import java.awt.Insets;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.awt.event.KeyEvent;
&nbsp;import java.awt.event.KeyListener;
&nbsp;import java.awt.event.MouseListener;
&nbsp;import java.awt.event.MouseEvent;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Comparator;
&nbsp;
&nbsp;import javax.swing.AbstractAction;
&nbsp;import javax.swing.Box;
&nbsp;import javax.swing.JComponent;
&nbsp;import javax.swing.JLabel;
&nbsp;import javax.swing.JPanel;
&nbsp;import javax.swing.KeyStroke;
&nbsp;import javax.swing.SwingConstants;
&nbsp;import javax.swing.ToolTipManager;
&nbsp;
&nbsp;import megamek.client.Client;
&nbsp;import megamek.client.ui.swing.widget.MegamekButton;
&nbsp;import megamek.client.ui.swing.widget.SkinSpecification;
&nbsp;import megamek.client.ui.swing.widget.SkinXMLHandler;
&nbsp;import megamek.common.logging.MMLogger;
&nbsp;import megamek.common.preference.IPreferenceChangeListener;
&nbsp;import megamek.common.preference.PreferenceChangeEvent;
&nbsp;
&nbsp;/**
&nbsp; * This is a parent class for the button display for each phase.  Every phase 
&nbsp; * has a panel of control buttons along with a done button.  Each button
&nbsp; * correspondes to a command that can be carried out in the current phase.  
&nbsp; * This class formats the button panel, the done button, and a status display 
&nbsp; * area. 
&nbsp; * 
&nbsp; * Control buttons are grouped and the groups can be cycled through.
&nbsp; *
&nbsp; */
&nbsp;public abstract class StatusBarPhaseDisplay extends AbstractPhaseDisplay
&nbsp;        implements ActionListener, MouseListener, KeyListener, IPreferenceChangeListener {
&nbsp;    
&nbsp;    //L4J Support
<b class="nc">&nbsp;    private MMLogger logger = null;</b>
&nbsp;
&nbsp;    private static final long serialVersionUID = 639696875125581395L;
&nbsp;    
&nbsp;    protected static final int TRANSPARENT = 0xFFFF00FF;
&nbsp;    
<b class="nc">&nbsp;    protected static final Dimension minButtonSize = new Dimension(32,32);</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void actionPerformed(ActionEvent e) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void mouseClicked(MouseEvent e) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void mousePressed(MouseEvent e) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void mouseReleased(MouseEvent e) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void mouseEntered(MouseEvent e) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void mouseExited(MouseEvent e) {
&nbsp;
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Interface that defines what a command for a phase is.
&nbsp;     * 
&nbsp;     * @author arlith
&nbsp;     *
&nbsp;     */
&nbsp;    public interface PhaseCommand {
&nbsp;        public String getCmd();
&nbsp;        public int getPriority();
&nbsp;        public void setPriority(int p);
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Comparator for comparing the priority of two commands, used to determine
&nbsp;     * button order.
&nbsp;     * 
&nbsp;     * @author arlith
&nbsp;     *
&nbsp;     */
<b class="nc">&nbsp;    public  static class CommandComparator implements Comparator&lt;PhaseCommand&gt;</b>
&nbsp;    {
&nbsp;        public int compare(PhaseCommand c1, PhaseCommand c2)
&nbsp;        {
<b class="nc">&nbsp;            return c1.getPriority() - c2.getPriority();            </b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    // displays
&nbsp;    private JLabel labStatus;
&nbsp;    protected JPanel panStatus;
&nbsp;    protected JPanel panButtons;  
&nbsp;    
&nbsp;    // Variables that determine the layout of the button panel
&nbsp;    // Keeps track of which group of buttons we are displaying
<b class="nc">&nbsp;    protected int currentButtonGroup = 0;</b>
&nbsp;    // How many different button groups there are, needs to be computed in a 
&nbsp;    //   child class
&nbsp;    protected int numButtonGroups;
&nbsp;    // How any buttons are in each group
<b class="nc">&nbsp;    protected int buttonsPerRow = GUIPreferences.getInstance().getInt(</b>
&nbsp;            GUIPreferences.ADVANCED_BUTTONS_PER_ROW);
<b class="nc">&nbsp;    protected int buttonsPerGroup = 2 * buttonsPerRow;</b>
&nbsp;    
&nbsp;
&nbsp;    protected StatusBarPhaseDisplay(ClientGUI cg) {
<b class="nc">&nbsp;        super(cg);</b>
<b class="nc">&nbsp;        getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(</b>
<b class="nc">&nbsp;            KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE,0), &quot;clearButton&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        getActionMap().put(&quot;clearButton&quot;, new AbstractAction() {</b>
&nbsp;            private static final long serialVersionUID = -7781405756822535409L;
&nbsp;
&nbsp;            public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;                if (isIgnoringEvents()) {</b>
&nbsp;                    return;
&nbsp;                }
<b class="nc">&nbsp;                if (clientgui.bv.getChatterBoxActive()){</b>
<b class="nc">&nbsp;                    clientgui.bv.setChatterBoxActive(false);</b>
<b class="nc">&nbsp;                    clientgui.cb2.clearMessage();</b>
&nbsp;                // Users can draw movement envelope during the movement phase 
&nbsp;                // even if it&#39;s not their turn, so we always want to be able
&nbsp;                // to clear.  MovementDisplay.clear() can handle this case
<b class="nc">&nbsp;                } else if (clientgui.getClient().isMyTurn() </b>
<b class="nc">&nbsp;                        || (e.getSource() instanceof MovementDisplay)) {</b>
<b class="nc">&nbsp;                    clear();</b>
&nbsp;                }
&nbsp;            }
&nbsp;        });
&nbsp;        
<b class="nc">&nbsp;        panButtons = new JPanel();      </b>
<b class="nc">&nbsp;        panButtons.setOpaque(false);        </b>
<b class="nc">&nbsp;        panButtons.setLayout(new GridBagLayout());</b>
&nbsp;        
<b class="nc">&nbsp;        GUIPreferences.getInstance().addPreferenceChangeListener(this);</b>
<b class="nc">&nbsp;        ToolTipManager.sharedInstance().registerComponent(this);</b>
&nbsp;    }
&nbsp;    
&nbsp;    
&nbsp;    /**
&nbsp;     * This method will return the list of buttons that should be displayed.
&nbsp;     * @return
&nbsp;     */
&nbsp;    protected abstract ArrayList&lt;MegamekButton&gt; getButtonList();
&nbsp;
&nbsp;    /**
&nbsp;     * Adds the buttons and status bar to the panel.    
&nbsp;     */
&nbsp;    protected void layoutScreen(){
<b class="nc">&nbsp;        GridBagLayout gridbag = new GridBagLayout();</b>
<b class="nc">&nbsp;        GridBagConstraints c = new GridBagConstraints();</b>
<b class="nc">&nbsp;        setLayout(gridbag);</b>
<b class="nc">&nbsp;        c.fill = GridBagConstraints.BOTH;</b>
<b class="nc">&nbsp;        c.insets = new Insets(1, 1, 1, 1);</b>
<b class="nc">&nbsp;        c.weightx = 1.0;</b>
<b class="nc">&nbsp;        c.weighty = 0.0;</b>
&nbsp;        
<b class="nc">&nbsp;        c.gridy = 0;</b>
<b class="nc">&nbsp;        addBag(panButtons, gridbag, c);</b>
<b class="nc">&nbsp;        c.gridy = 1;</b>
<b class="nc">&nbsp;        addBag(panStatus, gridbag, c);    </b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * Adds buttons to the button panel.  The buttons to be added are retrieved
&nbsp;     * with the &lt;code&gt;getButtonList()&lt;code&gt; method.  The number of buttons to
&nbsp;     * display is defined in &lt;code&gt;buttonsPerGroup&lt;/code&gt; and which group of
&nbsp;     * buttons will be displayed is set by &lt;code&gt;currentButtonGroup&lt;/code&gt;.
&nbsp;     */
&nbsp;    public void setupButtonPanel() {
<b class="nc">&nbsp;        panButtons.removeAll();</b>
<b class="nc">&nbsp;        panButtons.setLayout(new GridBagLayout());</b>
&nbsp;        
<b class="nc">&nbsp;        int numRows = buttonsPerGroup/buttonsPerRow;</b>
&nbsp;        
<b class="nc">&nbsp;        JPanel subPanel = new JPanel();</b>
<b class="nc">&nbsp;        subPanel.setOpaque(false);</b>
<b class="nc">&nbsp;        subPanel.setLayout(new GridLayout(numRows,buttonsPerRow));</b>
<b class="nc">&nbsp;        ArrayList&lt;MegamekButton&gt; buttonList = getButtonList();</b>
&nbsp;                
&nbsp;        // We may skip the current button group if all of its buttons are 
&nbsp;        //  disabled
<b class="nc">&nbsp;        boolean ok = false;</b>
<b class="nc">&nbsp;        while (!ok &amp;&amp; (currentButtonGroup != 0)) {</b>
<b class="nc">&nbsp;            for (int i = currentButtonGroup * buttonsPerGroup; </b>
&nbsp;            (i &lt; ((currentButtonGroup + 1) * buttonsPerGroup))
<b class="nc">&nbsp;                    &amp;&amp; (i &lt; buttonList.size()); i++) {</b>
<b class="nc">&nbsp;                if (buttonList.get(i) != null &amp;&amp; buttonList.get(i).isEnabled()){</b>
<b class="nc">&nbsp;                    ok = true;</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (!ok) {</b>
&nbsp;                // skip as nothing was enabled
<b class="nc">&nbsp;                currentButtonGroup++;</b>
<b class="nc">&nbsp;                if ((currentButtonGroup * buttonsPerGroup) &gt;= buttonList.size()) {</b>
<b class="nc">&nbsp;                    currentButtonGroup = 0;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        int i = 0;</b>
<b class="nc">&nbsp;        for (i = currentButtonGroup * buttonsPerGroup; </b>
&nbsp;                (i &lt; ((currentButtonGroup + 1) * buttonsPerGroup))
<b class="nc">&nbsp;                    &amp;&amp; (i &lt; buttonList.size()); i++) {</b>
<b class="nc">&nbsp;            if (buttonList.get(i) != null) {</b>
<b class="nc">&nbsp;                MegamekButton button = buttonList.get(i);</b>
<b class="nc">&nbsp;                button.setMinimumSize(minButtonSize);</b>
<b class="nc">&nbsp;                button.setPreferredSize(minButtonSize);</b>
<b class="nc">&nbsp;                subPanel.add(button);</b>
<b class="nc">&nbsp;                ToolTipManager.sharedInstance().registerComponent(button);</b>
<b class="nc">&nbsp;            } else {</b>
<b class="nc">&nbsp;                subPanel.add(Box.createHorizontalGlue());</b>
&nbsp;            }
&nbsp;        }         
<b class="nc">&nbsp;        while ( i &lt; ((currentButtonGroup + 1) * buttonsPerGroup)){</b>
<b class="nc">&nbsp;        subPanel.add(Box.createHorizontalGlue());</b>
<b class="nc">&nbsp;        i++;</b>
&nbsp;        }
&nbsp;           
<b class="nc">&nbsp;        GridBagConstraints c = new GridBagConstraints();</b>
<b class="nc">&nbsp;        c.fill = GridBagConstraints.BOTH;</b>
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.WEST;</b>
&nbsp;        
<b class="nc">&nbsp;        c.gridx = c.gridy = 0;</b>
<b class="nc">&nbsp;        c.weightx = 1;        </b>
<b class="nc">&nbsp;        panButtons.add(subPanel,c);</b>
&nbsp;        
<b class="nc">&nbsp;        c.anchor = GridBagConstraints.EAST;</b>
<b class="nc">&nbsp;        c.gridx = 1;</b>
<b class="nc">&nbsp;        c.weightx = 0;</b>
<b class="nc">&nbsp;        c.gridx = 1;</b>
<b class="nc">&nbsp;        panButtons.add(butDone,c);        </b>
<b class="nc">&nbsp;        butDone.setSize(DONE_BUTTON_WIDTH,butDone.getHeight());</b>
<b class="nc">&nbsp;        butDone.setPreferredSize(butDone.getSize());</b>
<b class="nc">&nbsp;        butDone.setMinimumSize(butDone.getSize());</b>
&nbsp;    
<b class="nc">&nbsp;        panButtons.validate();</b>
<b class="nc">&nbsp;        panButtons.repaint();   </b>
&nbsp;    }
&nbsp;    
&nbsp;    protected void addBag(JComponent comp, GridBagLayout gridbag,
&nbsp;            GridBagConstraints c) {
<b class="nc">&nbsp;        gridbag.setConstraints(comp, c);</b>
<b class="nc">&nbsp;        add(comp);</b>
<b class="nc">&nbsp;        comp.addKeyListener(this);</b>
&nbsp;    }
&nbsp;
&nbsp;    
&nbsp;    /**
&nbsp;     * clears the actions of this phase
&nbsp;     */
&nbsp;    public abstract void clear();
&nbsp;
&nbsp;    
&nbsp;    /**
&nbsp;     * Sets up the status bar with toggle buttons for the mek display and map.
&nbsp;     */
&nbsp;    protected void setupStatusBar(String defStatus) {
<b class="nc">&nbsp;        SkinSpecification pdSkinSpec = SkinXMLHandler</b>
<b class="nc">&nbsp;                .getSkin(SkinSpecification.UIComponents.PhaseDisplay.getComp());</b>
&nbsp;        
<b class="nc">&nbsp;        panStatus = new JPanel();</b>
<b class="nc">&nbsp;        panStatus.setOpaque(false);</b>
<b class="nc">&nbsp;        labStatus = new JLabel(defStatus, SwingConstants.CENTER);</b>
<b class="nc">&nbsp;        labStatus.setForeground(pdSkinSpec.fontColors.get(0));</b>
<b class="nc">&nbsp;        labStatus.setOpaque(false);</b>
&nbsp;
&nbsp;        // layout
<b class="nc">&nbsp;        GridBagLayout gridbag = new GridBagLayout();</b>
<b class="nc">&nbsp;        GridBagConstraints c = new GridBagConstraints();</b>
<b class="nc">&nbsp;        panStatus.setLayout(gridbag);</b>
&nbsp;
<b class="nc">&nbsp;        c.insets = new Insets(0, 1, 0, 1);</b>
<b class="nc">&nbsp;        c.fill = GridBagConstraints.HORIZONTAL;</b>
&nbsp;
<b class="nc">&nbsp;        c.gridwidth = GridBagConstraints.REMAINDER;</b>
<b class="nc">&nbsp;        c.weightx = 1.0;</b>
<b class="nc">&nbsp;        c.weighty = 0.0;</b>
<b class="nc">&nbsp;        gridbag.setConstraints(labStatus, c);</b>
<b class="nc">&nbsp;        panStatus.add(labStatus);</b>
&nbsp;    }
&nbsp;
&nbsp;    protected void setStatusBarText(String text) {
<b class="nc">&nbsp;        labStatus.setText(text);</b>
&nbsp;    }
&nbsp;    
&nbsp;    protected String getStatusBarText() {
<b class="nc">&nbsp;        return labStatus.getText();</b>
&nbsp;    }
&nbsp;
&nbsp;    protected boolean statusBarActionPerformed(ActionEvent ev, Client client) {
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;    
&nbsp;    @Override
&nbsp;    public void keyPressed(KeyEvent evt) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void keyReleased(KeyEvent evt) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public void keyTyped(KeyEvent evt) {
<b class="nc">&nbsp;    }</b>
&nbsp;
&nbsp;    public void preferenceChange(PreferenceChangeEvent e) {
<b class="nc">&nbsp;        if (e.getName().equals(GUIPreferences.ADVANCED_BUTTONS_PER_ROW)) {</b>
<b class="nc">&nbsp;            buttonsPerRow = GUIPreferences.getInstance().getInt(</b>
&nbsp;                    GUIPreferences.ADVANCED_BUTTONS_PER_ROW);
<b class="nc">&nbsp;            buttonsPerGroup = 2 * buttonsPerRow;</b>
<b class="nc">&nbsp;            setupButtonPanel();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
