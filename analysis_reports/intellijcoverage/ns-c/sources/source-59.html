


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > UnitEditorDialog</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing</a>
</div>

<h1>Coverage Summary for Class: UnitEditorDialog (megamek.client.ui.swing)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">UnitEditorDialog</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/15)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/976)
  </span>
</td>
</tr>
  <tr>
    <td class="name">UnitEditorDialog$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">UnitEditorDialog$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">UnitEditorDialog$CheckCritPanel</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/27)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">UnitEditorDialog$CheckCritPanel$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/25)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1010)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MechEditor.java - Copyright (C) 2013 Jay Lawson
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;
&nbsp;package megamek.client.ui.swing;
&nbsp;
&nbsp;import java.awt.BorderLayout;
&nbsp;import java.awt.GridBagConstraints;
&nbsp;import java.awt.GridBagLayout;
&nbsp;import java.awt.GridLayout;
&nbsp;import java.awt.Insets;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.HashMap;
&nbsp;import java.util.Map;
&nbsp;import java.util.TreeMap;
&nbsp;import java.util.Vector;
&nbsp;import java.util.function.BiConsumer;
&nbsp;
&nbsp;import javax.swing.BorderFactory;
&nbsp;import javax.swing.BoxLayout;
&nbsp;import javax.swing.JButton;
&nbsp;import javax.swing.JCheckBox;
&nbsp;import javax.swing.JDialog;
&nbsp;import javax.swing.JFrame;
&nbsp;import javax.swing.JLabel;
&nbsp;import javax.swing.JPanel;
&nbsp;import javax.swing.JScrollPane;
&nbsp;import javax.swing.JSpinner;
&nbsp;import javax.swing.SpinnerNumberModel;
&nbsp;
&nbsp;import megamek.client.ui.Messages;
&nbsp;
&nbsp;import megamek.common.ASFBay;
&nbsp;import megamek.common.Aero;
&nbsp;import megamek.common.BattleArmor;
&nbsp;import megamek.common.Bay;
&nbsp;import megamek.common.CriticalSlot;
&nbsp;import megamek.common.DockingCollar;
&nbsp;import megamek.common.Dropship;
&nbsp;import megamek.common.Entity;
&nbsp;import megamek.common.IArmorState;
&nbsp;import megamek.common.Infantry;
&nbsp;import megamek.common.Jumpship;
&nbsp;import megamek.common.LandAirMech;
&nbsp;import megamek.common.Mech;
&nbsp;import megamek.common.Mounted;
&nbsp;import megamek.common.Protomech;
&nbsp;import megamek.common.QuadMech;
&nbsp;import megamek.common.QuadVee;
&nbsp;import megamek.common.SmallCraft;
&nbsp;import megamek.common.SmallCraftBay;
&nbsp;import megamek.common.Tank;
&nbsp;import megamek.common.VTOL;
&nbsp;import megamek.common.options.OptionsConstants;
&nbsp;
&nbsp;/**
&nbsp; *
&nbsp; * @author Jay Lawson &lt;jaylawson39 at yahoo.com&gt; This dialog will allow the user
&nbsp; *         to edit the damage and status characteristics of a unit This designed
&nbsp; *         for use in both MegaMek and MHQ so don&#39;t go messing things up for MHQ
&nbsp; *         by changing a bunch of stuff
&nbsp; */
<b class="nc">&nbsp;public class UnitEditorDialog extends JDialog {</b>
&nbsp;
&nbsp;    /**
&nbsp;     *
&nbsp;     */
&nbsp;    private static final long serialVersionUID = 8144354264100884817L;
&nbsp;
&nbsp;    private Entity entity;
&nbsp;
&nbsp;    JPanel panArmor;
&nbsp;    JPanel panSystem;
&nbsp;    JPanel panEquip;
&nbsp;
&nbsp;    JSpinner[] spnInternal;
&nbsp;    JSpinner[] spnArmor;
&nbsp;    JSpinner[] spnRear;
&nbsp;
&nbsp;    HashMap&lt;Integer, CheckCritPanel&gt; equipCrits;
&nbsp;
&nbsp;    /* system crits */
&nbsp;    CheckCritPanel engineCrit;
&nbsp;    CheckCritPanel leftEngineCrit;
&nbsp;    CheckCritPanel rightEngineCrit;
&nbsp;    CheckCritPanel centerEngineCrit;
&nbsp;    CheckCritPanel gyroCrit;
&nbsp;    CheckCritPanel sensorCrit;
&nbsp;    CheckCritPanel lifeSupportCrit;
&nbsp;    CheckCritPanel cockpitCrit;
&nbsp;    Map&lt;Integer,CheckCritPanel&gt; lamAvionicsCrit;
&nbsp;    Map&lt;Integer,CheckCritPanel&gt; lamLandingGearCrit;
&nbsp;    CheckCritPanel[][] actuatorCrits;
&nbsp;    CheckCritPanel turretlockCrit;
&nbsp;    CheckCritPanel motiveCrit;
&nbsp;    CheckCritPanel[] stabilizerCrits;
&nbsp;    CheckCritPanel flightStabilizerCrit;
&nbsp;    CheckCritPanel avionicsCrit;
&nbsp;    CheckCritPanel fcsCrit;
&nbsp;    CheckCritPanel cicCrit;
&nbsp;    CheckCritPanel gearCrit;
&nbsp;    CheckCritPanel leftThrusterCrit;
&nbsp;    CheckCritPanel rightThrusterCrit;
&nbsp;    CheckCritPanel kfboomCrit;
&nbsp;    CheckCritPanel dockCollarCrit;
&nbsp;    CheckCritPanel gravDeckCrit;
&nbsp;    JSpinner[] bayDamage;
&nbsp;    CheckCritPanel[] bayDoorCrit;
&nbsp;    JSpinner collarDamage;
&nbsp;    JSpinner kfDamage;
&nbsp;    CheckCritPanel driveCoilCrit;
&nbsp;    CheckCritPanel chargingSystemCrit;
&nbsp;    CheckCritPanel fieldInitiatorCrit;
&nbsp;    CheckCritPanel driveControllerCrit;
&nbsp;    CheckCritPanel heliumTankCrit;
&nbsp;    CheckCritPanel lfBatteryCrit;
&nbsp;    JSpinner sailDamage;
&nbsp;    CheckCritPanel[] protoCrits;
&nbsp;
&nbsp;    public UnitEditorDialog(JFrame parent, Entity m) {
<b class="nc">&nbsp;        super(parent, true);</b>
<b class="nc">&nbsp;        entity = m;</b>
<b class="nc">&nbsp;        initComponents();</b>
<b class="nc">&nbsp;        setLocationRelativeTo(parent);</b>
&nbsp;    }
&nbsp;
&nbsp;    private void initComponents() {
&nbsp;        GridBagConstraints gridBagConstraints;
&nbsp;
<b class="nc">&nbsp;        getContentPane().setLayout(new BorderLayout());</b>
&nbsp;
<b class="nc">&nbsp;        setTitle(&quot;Edit damage for &quot; + entity.getDisplayName());</b>
&nbsp;
<b class="nc">&nbsp;        JPanel panMain = new JPanel(new GridBagLayout());</b>
<b class="nc">&nbsp;        JPanel panButtons = new JPanel(new GridLayout(1, 2));</b>
&nbsp;
&nbsp;        // TODO: protomeks
<b class="nc">&nbsp;        initArmorPanel();</b>
<b class="nc">&nbsp;        initSystemPanel();</b>
<b class="nc">&nbsp;        initEquipPanel();</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.fill = GridBagConstraints.BOTH;</b>
<b class="nc">&nbsp;        panMain.add(panArmor, gridBagConstraints);</b>
<b class="nc">&nbsp;        if (!((entity instanceof Infantry) &amp;&amp; !(entity instanceof BattleArmor))) {</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weighty = 1.0;</b>
<b class="nc">&nbsp;            panMain.add(new JScrollPane(panSystem), gridBagConstraints);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.anchor = GridBagConstraints.NORTHWEST;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridheight = 2;</b>
<b class="nc">&nbsp;            panMain.add(new JScrollPane(panEquip), gridBagConstraints);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        getContentPane().add(panMain, BorderLayout.CENTER);</b>
&nbsp;
<b class="nc">&nbsp;        JButton butOK = new JButton(Messages.getString(&quot;Okay&quot;));</b>
<b class="nc">&nbsp;        butOK.addActionListener(new java.awt.event.ActionListener() {</b>
&nbsp;            public void actionPerformed(java.awt.event.ActionEvent evt) {
<b class="nc">&nbsp;                btnOkayActionPerformed(evt);</b>
<b class="nc">&nbsp;                setVisible(false);</b>
&nbsp;            }
&nbsp;        });
<b class="nc">&nbsp;        JButton butCancel = new JButton(Messages.getString(&quot;Cancel&quot;));</b>
<b class="nc">&nbsp;        butCancel.addActionListener(new java.awt.event.ActionListener() {</b>
&nbsp;            public void actionPerformed(java.awt.event.ActionEvent evt) {
<b class="nc">&nbsp;                setVisible(false);</b>
&nbsp;            }
&nbsp;        });
&nbsp;
<b class="nc">&nbsp;        panButtons.add(butOK);</b>
<b class="nc">&nbsp;        panButtons.add(butCancel);</b>
&nbsp;
<b class="nc">&nbsp;        getContentPane().add(panButtons, BorderLayout.PAGE_END);</b>
&nbsp;
&nbsp;        // TODO: size right
&nbsp;
<b class="nc">&nbsp;        pack();</b>
&nbsp;    }
&nbsp;
&nbsp;    private void initArmorPanel() {
<b class="nc">&nbsp;        if (entity instanceof Aero) {</b>
<b class="nc">&nbsp;            initAeroArmorPanel();</b>
&nbsp;            return;
<b class="nc">&nbsp;        } else if ((entity instanceof Infantry)</b>
&nbsp;                &amp;&amp; !(entity instanceof BattleArmor)) {
<b class="nc">&nbsp;            initInfantryArmorPanel();</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;        GridBagConstraints gridBagConstraints;
&nbsp;
<b class="nc">&nbsp;        panArmor = new JPanel(new GridBagLayout());</b>
<b class="nc">&nbsp;        panArmor.setBorder(BorderFactory</b>
<b class="nc">&nbsp;                .createTitledBorder(Messages.getString(&quot;UnitEditorDialog.internalsAndArmor&quot;)));</b>
&nbsp;
<b class="nc">&nbsp;        spnArmor = new JSpinner[entity.locations()];</b>
<b class="nc">&nbsp;        spnInternal = new JSpinner[entity.locations()];</b>
<b class="nc">&nbsp;        spnRear = new JSpinner[entity.locations()];</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(1, 10, 1, 1);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.location&quot;) + &quot;&lt;/b&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.internal&quot;) + &quot;&lt;/b&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        gridBagConstraints.gridx = 2;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.frontArmor&quot;) + &quot;&lt;/b&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        gridBagConstraints.gridx = 3;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.rearArmor&quot;) + &quot;&lt;/b&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; entity.locations(); i++) {</b>
&nbsp;            // some units have hidden locations, skip these
<b class="nc">&nbsp;            if (entity.getOInternal(i) &lt;= 0) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            int internal = Math.max(entity.getInternal(i), 0);</b>
<b class="nc">&nbsp;            int armor = Math.max(entity.getArmor(i, false), 0);</b>
<b class="nc">&nbsp;            spnArmor[i] = new JSpinner(new SpinnerNumberModel(armor, 0,</b>
<b class="nc">&nbsp;                    entity.getOArmor(i), 1));</b>
<b class="nc">&nbsp;            spnInternal[i] = new JSpinner(new SpinnerNumberModel(internal, 0,</b>
<b class="nc">&nbsp;                    entity.getOInternal(i), 1));</b>
<b class="nc">&nbsp;            gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy = i + 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.insets = new Insets(1, 10, 1, 1);</b>
<b class="nc">&nbsp;            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;            panArmor.add(new JLabel(entity.getLocationName(i)),</b>
&nbsp;                    gridBagConstraints);
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            panArmor.add(spnInternal[i], gridBagConstraints);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 2;</b>
<b class="nc">&nbsp;            panArmor.add(spnArmor[i], gridBagConstraints);</b>
<b class="nc">&nbsp;            if (entity.hasRearArmor(i)) {</b>
<b class="nc">&nbsp;                int rear = Math.max(entity.getArmor(i, true), 0);</b>
<b class="nc">&nbsp;                spnRear[i] = new JSpinner(new SpinnerNumberModel(rear, 0,</b>
<b class="nc">&nbsp;                        entity.getOArmor(i, true), 1));</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 3;</b>
<b class="nc">&nbsp;                panArmor.add(spnRear[i], gridBagConstraints);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void initAeroArmorPanel() {
&nbsp;        GridBagConstraints gridBagConstraints;
&nbsp;
<b class="nc">&nbsp;        Aero aero = (Aero) entity;</b>
&nbsp;
<b class="nc">&nbsp;        panArmor = new JPanel(new GridBagLayout());</b>
<b class="nc">&nbsp;        panArmor.setBorder(BorderFactory.createTitledBorder(Messages.getString(&quot;UnitEditorDialog.siAndArmor&quot;)));</b>
&nbsp;
<b class="nc">&nbsp;        spnArmor = new JSpinner[entity.locations()];</b>
<b class="nc">&nbsp;        spnInternal = new JSpinner[entity.locations()];</b>
<b class="nc">&nbsp;        spnRear = new JSpinner[entity.locations()];</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(1, 10, 1, 1);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.location&quot;) + &quot;&lt;/b&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.points&quot;) + &quot;&lt;/b&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
&nbsp;
<b class="nc">&nbsp;        int si = Math.max(aero.getSI(), 0);</b>
<b class="nc">&nbsp;        spnInternal[0] = new JSpinner(new SpinnerNumberModel(si, 0,</b>
<b class="nc">&nbsp;                aero.get0SI(), 1));</b>
<b class="nc">&nbsp;        gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(1, 10, 1, 1);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(Messages.getString(&quot;UnitEditorDialog.structuralIntegrity&quot;)), gridBagConstraints);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        panArmor.add(spnInternal[0], gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; entity.locations(); i++) {</b>
&nbsp;            // some units have hidden locations, skip these
<b class="nc">&nbsp;            if (entity.getOArmor(i) &lt;= 0) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            int armor = Math.max(entity.getArmor(i, false), 0);</b>
<b class="nc">&nbsp;            spnArmor[i] = new JSpinner(new SpinnerNumberModel(armor, 0,</b>
<b class="nc">&nbsp;                    entity.getOArmor(i), 1));</b>
<b class="nc">&nbsp;            gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy = i + 2;</b>
<b class="nc">&nbsp;            gridBagConstraints.insets = new Insets(1, 10, 1, 1);</b>
<b class="nc">&nbsp;            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;            panArmor.add(new JLabel(entity.getLocationName(i)),</b>
&nbsp;                    gridBagConstraints);
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            panArmor.add(spnArmor[i], gridBagConstraints);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void initInfantryArmorPanel() {
&nbsp;        GridBagConstraints gridBagConstraints;
&nbsp;
<b class="nc">&nbsp;        Infantry infantry = (Infantry) entity;</b>
&nbsp;
<b class="nc">&nbsp;        panArmor = new JPanel(new GridBagLayout());</b>
<b class="nc">&nbsp;        panArmor.setBorder(BorderFactory.createTitledBorder(Messages.getString(&quot;UnitEditorDialog.troopersLeft&quot;)));</b>
&nbsp;
<b class="nc">&nbsp;        spnArmor = new JSpinner[entity.locations()];</b>
<b class="nc">&nbsp;        spnInternal = new JSpinner[entity.locations()];</b>
<b class="nc">&nbsp;        spnRear = new JSpinner[entity.locations()];</b>
&nbsp;
<b class="nc">&nbsp;        int men = Math.max(infantry.getShootingStrength(), 0);</b>
<b class="nc">&nbsp;        spnInternal[0] = new JSpinner(new SpinnerNumberModel(men, 0,</b>
<b class="nc">&nbsp;                infantry.getSquadN() * infantry.getSquadSize(), 1));</b>
<b class="nc">&nbsp;        gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(1, 10, 1, 1);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        panArmor.add(new JLabel(Messages.getString(&quot;UnitEditorDialog.menLeft&quot;)), gridBagConstraints);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        panArmor.add(spnInternal[0], gridBagConstraints);</b>
&nbsp;    }
&nbsp;
&nbsp;    private void initEquipPanel() {
<b class="nc">&nbsp;        equipCrits = new HashMap&lt;Integer, CheckCritPanel&gt;();</b>
<b class="nc">&nbsp;        panEquip = new JPanel();</b>
<b class="nc">&nbsp;        panEquip.setLayout(new GridBagLayout());</b>
<b class="nc">&nbsp;        panEquip.setBorder(BorderFactory.createTitledBorder(Messages.getString(&quot;UnitEditorDialog.equipment&quot;)));</b>
<b class="nc">&nbsp;        GridBagConstraints gridBagConstraints = new GridBagConstraints();</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(2, 2, 2, 2);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;        for (Mounted m : entity.getEquipment()) {</b>
<b class="nc">&nbsp;            if ((m.getLocation() == Entity.LOC_NONE)</b>
<b class="nc">&nbsp;                    || !m.getType().isHittable() || m.isWeaponGroup()) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            int nCrits = m.getCriticals();</b>
<b class="nc">&nbsp;            int eqNum = entity.getEquipmentNum(m);</b>
<b class="nc">&nbsp;            int hits = entity.getDamagedCriticals(CriticalSlot.TYPE_EQUIPMENT,</b>
<b class="nc">&nbsp;                    eqNum, m.getLocation());</b>
<b class="nc">&nbsp;            if (m.isSplit()) {</b>
<b class="nc">&nbsp;                hits += entity.getDamagedCriticals(CriticalSlot.TYPE_EQUIPMENT,</b>
<b class="nc">&nbsp;                        eqNum, m.getSecondLocation());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (!(entity instanceof Mech)) {</b>
<b class="nc">&nbsp;                nCrits = 1;</b>
<b class="nc">&nbsp;                if (hits &gt; 1) {</b>
<b class="nc">&nbsp;                    hits = 1;</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            CheckCritPanel crit = new CheckCritPanel(nCrits, hits);</b>
<b class="nc">&nbsp;            equipCrits.put(eqNum, crit);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;            panEquip.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + m.getName() + &quot;&lt;/b&gt;&lt;br&gt;&quot;</b>
<b class="nc">&nbsp;                    + entity.getLocationName(m.getLocation()) + &quot;&lt;/html&gt;&quot;),</b>
&nbsp;                    gridBagConstraints);
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panEquip.add(crit, gridBagConstraints);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    private void initSystemPanel() {
&nbsp;
&nbsp;        // systems are the hard part, because these are all unit specific
&nbsp;        // lets start with a mech
<b class="nc">&nbsp;        panSystem = new JPanel(new GridBagLayout());</b>
<b class="nc">&nbsp;        panSystem.setBorder(BorderFactory.createTitledBorder(Messages.getString(&quot;UnitEditorDialog.system&quot;)));</b>
&nbsp;
<b class="nc">&nbsp;        if (entity instanceof Mech) {</b>
<b class="nc">&nbsp;            setupMechSystemPanel();</b>
<b class="nc">&nbsp;        } else if (entity instanceof VTOL) {</b>
<b class="nc">&nbsp;            setupVtolSystemPanel();</b>
<b class="nc">&nbsp;        } else if (entity instanceof Tank) {</b>
<b class="nc">&nbsp;            setupTankSystemPanel();</b>
<b class="nc">&nbsp;        } else if (entity instanceof Aero) {</b>
<b class="nc">&nbsp;            setupAeroSystemPanel();</b>
<b class="nc">&nbsp;        } else if (entity instanceof Protomech) {</b>
<b class="nc">&nbsp;            setupProtoSystemPanel();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void setupMechSystemPanel() {
<b class="nc">&nbsp;        GridBagConstraints gridBagConstraints = new GridBagConstraints();</b>
&nbsp;        /*
&nbsp;         * For the moment, I am going to cap out the number of hits at what the
&nbsp;         * record sheets show (i.e. 3 for engines). If we want to switch this to
&nbsp;         * the actual number then we can, see
&nbsp;         * enginePart.updateConditionFromEntity in MekHQ for an example of how
&nbsp;         * to retrieve all of the available system crits
&nbsp;         */
<b class="nc">&nbsp;        int centerEngineHits = 0;</b>
<b class="nc">&nbsp;        int leftEngineHits = 0;</b>
<b class="nc">&nbsp;        int rightEngineHits = 0;</b>
<b class="nc">&nbsp;        int gyroHits = 0;</b>
<b class="nc">&nbsp;        int cockpitHits = 0;</b>
<b class="nc">&nbsp;        int sensorHits = 0;</b>
<b class="nc">&nbsp;        int lifeSupportHits = 0;</b>
&nbsp;
<b class="nc">&nbsp;        int centerEngineCrits = 0;</b>
<b class="nc">&nbsp;        int leftEngineCrits = 0;</b>
<b class="nc">&nbsp;        int rightEngineCrits = 0;</b>
<b class="nc">&nbsp;        int gyroCrits = 0;</b>
<b class="nc">&nbsp;        int cockpitCrits = 0;</b>
<b class="nc">&nbsp;        int sensorCrits = 0;</b>
<b class="nc">&nbsp;        int lifeSupportCrits = 0;</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; entity.locations(); i++) {</b>
<b class="nc">&nbsp;            if (i == Mech.LOC_CT) {</b>
<b class="nc">&nbsp;                centerEngineHits = entity.getDamagedCriticals(</b>
&nbsp;                        CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE, i);
<b class="nc">&nbsp;                centerEngineCrits = entity.getNumberOfCriticals(</b>
&nbsp;                        CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE, i);
&nbsp;            }
<b class="nc">&nbsp;            if (i == Mech.LOC_LT) {</b>
<b class="nc">&nbsp;                leftEngineHits = entity.getDamagedCriticals(</b>
&nbsp;                        CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE, i);
<b class="nc">&nbsp;                leftEngineCrits = entity.getNumberOfCriticals(</b>
&nbsp;                        CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE, i);
&nbsp;            }
<b class="nc">&nbsp;            if (i == Mech.LOC_RT) {</b>
<b class="nc">&nbsp;                rightEngineHits = entity.getDamagedCriticals(</b>
&nbsp;                        CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE, i);
<b class="nc">&nbsp;                rightEngineCrits = entity.getNumberOfCriticals(</b>
&nbsp;                        CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE, i);
&nbsp;            }
<b class="nc">&nbsp;            gyroHits += entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                    Mech.SYSTEM_GYRO, i);
<b class="nc">&nbsp;            gyroCrits += entity.getNumberOfCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                    Mech.SYSTEM_GYRO, i);
<b class="nc">&nbsp;            cockpitHits += entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                    Mech.SYSTEM_COCKPIT, i);
<b class="nc">&nbsp;            cockpitCrits += entity.getNumberOfCriticals(</b>
&nbsp;                    CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_COCKPIT, i);
<b class="nc">&nbsp;            sensorHits += entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                    Mech.SYSTEM_SENSORS, i);
<b class="nc">&nbsp;            sensorCrits += entity.getNumberOfCriticals(</b>
&nbsp;                    CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_SENSORS, i);
<b class="nc">&nbsp;            lifeSupportHits += entity.getDamagedCriticals(</b>
&nbsp;                    CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_LIFE_SUPPORT, i);
<b class="nc">&nbsp;            lifeSupportCrits += entity.getNumberOfCriticals(</b>
&nbsp;                    CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_LIFE_SUPPORT, i);
&nbsp;        }
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(2, 2, 2, 2);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.engine&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        centerEngineCrit = new CheckCritPanel(centerEngineCrits,</b>
&nbsp;                centerEngineHits);
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(centerEngineCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        if (entity.getNumberOfCriticals(CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE, Mech.LOC_RT) &gt; 0) {</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.engineLT&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                    gridBagConstraints);
<b class="nc">&nbsp;            leftEngineCrit = new CheckCritPanel(leftEngineCrits, leftEngineHits);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(leftEngineCrit, gridBagConstraints);</b>
&nbsp;    
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.engineRT&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                    gridBagConstraints);
<b class="nc">&nbsp;            rightEngineCrit = new CheckCritPanel(rightEngineCrits, rightEngineHits);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(rightEngineCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.gyro&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        gyroCrit = new CheckCritPanel(gyroCrits, gyroHits);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(gyroCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.sensor&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        sensorCrit = new CheckCritPanel(sensorCrits, sensorHits);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(sensorCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.lifeSupport&quot;)</b>
&nbsp;                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;        lifeSupportCrit = new CheckCritPanel(lifeSupportCrits, lifeSupportHits);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(lifeSupportCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.cockpit&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        cockpitCrit = new CheckCritPanel(cockpitCrits, cockpitHits);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        panSystem.add(cockpitCrit, gridBagConstraints);</b>
&nbsp;        
<b class="nc">&nbsp;        if (entity instanceof LandAirMech) {</b>
<b class="nc">&nbsp;            lamAvionicsCrit = new TreeMap&lt;&gt;();</b>
<b class="nc">&nbsp;            lamLandingGearCrit = new TreeMap&lt;&gt;();</b>
<b class="nc">&nbsp;            for (int loc = 0; loc &lt; entity.locations(); loc++) {</b>
<b class="nc">&nbsp;                int crits = entity.getNumberOfCriticals(CriticalSlot.TYPE_SYSTEM, LandAirMech.LAM_AVIONICS, loc);</b>
<b class="nc">&nbsp;                if (crits &gt; 0) {</b>
<b class="nc">&nbsp;                    int hits = entity.getBadCriticals(CriticalSlot.TYPE_SYSTEM, LandAirMech.LAM_AVIONICS, loc);</b>
<b class="nc">&nbsp;                    CheckCritPanel critPanel = new CheckCritPanel(crits, hits);</b>
<b class="nc">&nbsp;                    lamAvionicsCrit.put(loc, critPanel);</b>
&nbsp;                }
<b class="nc">&nbsp;                crits = entity.getNumberOfCriticals(CriticalSlot.TYPE_SYSTEM, LandAirMech.LAM_LANDING_GEAR, loc);</b>
<b class="nc">&nbsp;                if (crits &gt; 0) {</b>
<b class="nc">&nbsp;                    int hits = entity.getBadCriticals(CriticalSlot.TYPE_SYSTEM, LandAirMech.LAM_LANDING_GEAR, loc);</b>
<b class="nc">&nbsp;                    CheckCritPanel critPanel = new CheckCritPanel(crits, hits);</b>
<b class="nc">&nbsp;                    lamLandingGearCrit.put(loc, critPanel);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            BiConsumer&lt;Map.Entry&lt;Integer,CheckCritPanel&gt;, String&gt; addToPanel = (entry, critName) -&gt; {</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + </b>
<b class="nc">&nbsp;                        String.format(Messages.getString(&quot;UnitEditorDialog.critStringLocation&quot;), critName, entity.getLocationAbbr(entry.getKey())) </b>
&nbsp;                        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),
&nbsp;                        gridBagConstraints);
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;                panSystem.add(entry.getValue(), gridBagConstraints);</b>
&nbsp;            };
<b class="nc">&nbsp;            lamAvionicsCrit.entrySet().forEach(e -&gt; addToPanel.accept(e, Messages.getString(&quot;UnitEditorDialog.avionics&quot;)));</b>
<b class="nc">&nbsp;            lamLandingGearCrit.entrySet().forEach(e -&gt; addToPanel.accept(e, Messages.getString(&quot;UnitEditorDialog.landingGear&quot;)));</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (entity instanceof QuadVee) {</b>
<b class="nc">&nbsp;            actuatorCrits = new CheckCritPanel[4][5];</b>
&nbsp;        } else {
<b class="nc">&nbsp;            actuatorCrits = new CheckCritPanel[4][4];</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        for (int loc = Mech.LOC_RARM; loc &lt;= Mech.LOC_LLEG; loc++) {</b>
<b class="nc">&nbsp;            int start = Mech.ACTUATOR_SHOULDER;</b>
<b class="nc">&nbsp;            int end = Mech.ACTUATOR_HAND;</b>
<b class="nc">&nbsp;            if ((loc &gt;= Mech.LOC_RLEG) || (entity instanceof QuadMech)) {</b>
<b class="nc">&nbsp;                start = Mech.ACTUATOR_HIP;</b>
<b class="nc">&nbsp;                end = Mech.ACTUATOR_FOOT;</b>
&nbsp;            }
<b class="nc">&nbsp;            for (int i = start; i &lt;= end; i++) {</b>
<b class="nc">&nbsp;                if (!entity.hasSystem(i, loc)) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;                if ((loc == Mech.LOC_LLEG) &amp;&amp; (i == end) &amp;&amp; !(entity instanceof QuadVee)) {</b>
<b class="nc">&nbsp;                    gridBagConstraints.weighty = 1.0;</b>
&nbsp;                }
<b class="nc">&nbsp;                panSystem.add(</b>
&nbsp;                        new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + 
<b class="nc">&nbsp;                                String.format(Messages.getString(&quot;UnitEditorDialog.critString&quot;), </b>
<b class="nc">&nbsp;                                        entity.getLocationName(loc), </b>
<b class="nc">&nbsp;                                        ((Mech) entity).getSystemName(i))</b>
&nbsp;                                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                CheckCritPanel actuatorCrit = new CheckCritPanel(1,</b>
<b class="nc">&nbsp;                        entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM, i,</b>
&nbsp;                                loc));
<b class="nc">&nbsp;                actuatorCrits[loc - Mech.LOC_RARM][i - start] = actuatorCrit;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                panSystem.add(actuatorCrit, gridBagConstraints);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (entity instanceof QuadVee) {</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;                if (loc == Mech.LOC_LLEG) {</b>
<b class="nc">&nbsp;                    gridBagConstraints.weighty = 1.0;</b>
&nbsp;                }
<b class="nc">&nbsp;                panSystem.add(</b>
&nbsp;                        new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + 
<b class="nc">&nbsp;                                String.format(Messages.getString(&quot;UnitEditorDialog.critString&quot;), </b>
<b class="nc">&nbsp;                                        entity.getLocationName(loc), </b>
<b class="nc">&nbsp;                                        ((Mech) entity).getSystemName(QuadVee.SYSTEM_CONVERSION_GEAR))</b>
&nbsp;                                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                CheckCritPanel actuatorCrit = new CheckCritPanel(1,</b>
<b class="nc">&nbsp;                        entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM, QuadVee.SYSTEM_CONVERSION_GEAR,</b>
&nbsp;                                loc));
<b class="nc">&nbsp;                actuatorCrits[loc - Mech.LOC_RARM][Mech.ACTUATOR_FOOT - Mech.ACTUATOR_HIP + 1] = actuatorCrit;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                panSystem.add(actuatorCrit, gridBagConstraints);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    private void setupTankSystemPanel() {
<b class="nc">&nbsp;        GridBagConstraints gridBagConstraints = new GridBagConstraints();</b>
&nbsp;
<b class="nc">&nbsp;        Tank tank = (Tank) entity;</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(2, 2, 2, 2);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.turretLock&quot;)</b>
&nbsp;                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;        int lock = 0;</b>
<b class="nc">&nbsp;        if (tank.isTurretLocked(0)) {</b>
<b class="nc">&nbsp;            lock = 1;</b>
&nbsp;        }
<b class="nc">&nbsp;        turretlockCrit = new CheckCritPanel(1, lock);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(turretlockCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.engine&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        engineCrit = new CheckCritPanel(1, tank.getEngineHits());</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(engineCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 2;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.sensor&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        sensorCrit = new CheckCritPanel(4, tank.getSensorHits());</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(sensorCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 3;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.motiveDamage&quot;)</b>
&nbsp;                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;        int motiveHits = 0;</b>
&nbsp;        // Do not check the crew when determining if we&#39;re immobile here
<b class="nc">&nbsp;        if (tank.isImmobile(false)) {</b>
<b class="nc">&nbsp;            motiveHits = 4;</b>
<b class="nc">&nbsp;        } else if (tank.hasHeavyMovementDamage()) {</b>
<b class="nc">&nbsp;            motiveHits = 3;</b>
<b class="nc">&nbsp;        } else if (tank.hasModerateMovementDamage()) {</b>
<b class="nc">&nbsp;            motiveHits = 2;</b>
<b class="nc">&nbsp;        } else if (tank.hasMinorMovementDamage()) {</b>
<b class="nc">&nbsp;            motiveHits = 1;</b>
&nbsp;        }
<b class="nc">&nbsp;        motiveCrit = new CheckCritPanel(4, motiveHits);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(motiveCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        stabilizerCrits = new CheckCritPanel[tank.locations()];</b>
<b class="nc">&nbsp;        for (int loc = 0; loc &lt; tank.locations(); loc++) {</b>
<b class="nc">&nbsp;            if ((loc == Tank.LOC_BODY) || (loc == tank.getLocTurret())</b>
<b class="nc">&nbsp;                    || (loc == tank.getLocTurret2())) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;            if (loc == (tank.locations() - 1)) {</b>
<b class="nc">&nbsp;                gridBagConstraints.weighty = 1.0;</b>
&nbsp;            }
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + </b>
<b class="nc">&nbsp;                    String.format(Messages.getString(&quot;UnitEditorDialog.locationStabilizer&quot;), entity.getLocationName(loc)) </b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            int hits = 0;</b>
<b class="nc">&nbsp;            if (tank.isStabiliserHit(loc)) {</b>
<b class="nc">&nbsp;                hits = 1;</b>
&nbsp;            }
<b class="nc">&nbsp;            CheckCritPanel stabCrit = new CheckCritPanel(1, hits);</b>
<b class="nc">&nbsp;            stabilizerCrits[loc] = stabCrit;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            panSystem.add(stabCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    private void setupProtoSystemPanel() {
<b class="nc">&nbsp;        GridBagConstraints gridBagConstraints = new GridBagConstraints();</b>
&nbsp;
<b class="nc">&nbsp;        Protomech proto = (Protomech) entity;</b>
&nbsp;
<b class="nc">&nbsp;        protoCrits = new CheckCritPanel[proto.locations()];</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
&nbsp;
<b class="nc">&nbsp;        for (int loc = 0; loc &lt; proto.locations(); loc++) {</b>
<b class="nc">&nbsp;            if ((loc == Protomech.LOC_MAINGUN) || (loc == Protomech.LOC_NMISS)) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;            if (loc == (proto.locations() - 1)) {</b>
<b class="nc">&nbsp;                gridBagConstraints.weighty = 1.0;</b>
&nbsp;            }
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + </b>
<b class="nc">&nbsp;                    String.format(Messages.getString(&quot;UnitEditorDialog.protoCritString&quot;), entity.getLocationName(loc))  </b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            int hits = 0;</b>
<b class="nc">&nbsp;            if ((loc == Protomech.LOC_LARM) || (loc == Protomech.LOC_RARM)) {</b>
<b class="nc">&nbsp;                hits = entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                        Protomech.SYSTEM_ARMCRIT, loc);
&nbsp;            }
<b class="nc">&nbsp;            if (loc == Protomech.LOC_LEG) {</b>
<b class="nc">&nbsp;                hits = entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                        Protomech.SYSTEM_LEGCRIT, loc);
&nbsp;            }
<b class="nc">&nbsp;            if (loc == Protomech.LOC_HEAD) {</b>
<b class="nc">&nbsp;                hits = entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                        Protomech.SYSTEM_HEADCRIT, loc);
&nbsp;            }
<b class="nc">&nbsp;            if (loc == Protomech.LOC_TORSO) {</b>
<b class="nc">&nbsp;                hits = entity.getDamagedCriticals(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                        Protomech.SYSTEM_TORSOCRIT, loc);
&nbsp;            }
<b class="nc">&nbsp;            int nCrits = 2;</b>
<b class="nc">&nbsp;            if (loc == Protomech.LOC_LEG) {</b>
<b class="nc">&nbsp;                nCrits = 3;</b>
&nbsp;            }
<b class="nc">&nbsp;            CheckCritPanel protoCrit = new CheckCritPanel(nCrits, hits);</b>
<b class="nc">&nbsp;            protoCrits[loc] = protoCrit;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            panSystem.add(protoCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    private void setupVtolSystemPanel() {
<b class="nc">&nbsp;        GridBagConstraints gridBagConstraints = new GridBagConstraints();</b>
&nbsp;
<b class="nc">&nbsp;        VTOL vtol = (VTOL) entity;</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(2, 2, 2, 2);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.flightStabilizer&quot;)</b>
&nbsp;                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;        int flightStabHit = 0;</b>
<b class="nc">&nbsp;        if (vtol.isStabiliserHit(VTOL.LOC_ROTOR)) {</b>
<b class="nc">&nbsp;            flightStabHit = 1;</b>
&nbsp;        }
<b class="nc">&nbsp;        flightStabilizerCrit = new CheckCritPanel(1, flightStabHit);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(flightStabilizerCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;        gridBagConstraints.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.engine&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        engineCrit = new CheckCritPanel(1, vtol.getEngineHits());</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(engineCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 2;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.sensor&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        sensorCrit = new CheckCritPanel(4, vtol.getSensorHits());</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(sensorCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        stabilizerCrits = new CheckCritPanel[vtol.locations()];</b>
<b class="nc">&nbsp;        for (int loc = 0; loc &lt; vtol.locations(); loc++) {</b>
<b class="nc">&nbsp;            if ((loc == Tank.LOC_BODY) || (loc == VTOL.LOC_ROTOR)) {</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;            if (loc == (vtol.locations() - 1)) {</b>
<b class="nc">&nbsp;                gridBagConstraints.weighty = 1.0;</b>
&nbsp;            }
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + </b>
<b class="nc">&nbsp;                    String.format(Messages.getString(&quot;UnitEditorDialog.locationStabilizer&quot;), entity.getLocationName(loc))</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            int hits = 0;</b>
<b class="nc">&nbsp;            if (vtol.isStabiliserHit(loc)) {</b>
<b class="nc">&nbsp;                hits = 1;</b>
&nbsp;            }
<b class="nc">&nbsp;            CheckCritPanel stabCrit = new CheckCritPanel(1, hits);</b>
<b class="nc">&nbsp;            stabilizerCrits[loc] = stabCrit;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            panSystem.add(stabCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    private void setupAeroSystemPanel() {
<b class="nc">&nbsp;        GridBagConstraints gridBagConstraints = new GridBagConstraints();</b>
&nbsp;
<b class="nc">&nbsp;        Aero aero = (Aero) entity;</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.insets = new Insets(2, 2, 2, 2);</b>
<b class="nc">&nbsp;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.avionics&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        avionicsCrit = new CheckCritPanel(3, aero.getAvionicsHits());</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(avionicsCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        if (aero instanceof Jumpship) {</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.cic&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                    gridBagConstraints);
<b class="nc">&nbsp;            cicCrit = new CheckCritPanel(3, aero.getCICHits());</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(cicCrit, gridBagConstraints);</b>
&nbsp;        } else {
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.weighty = 0.0;</b>
<b class="nc">&nbsp;            gridBagConstraints.fill = GridBagConstraints.NONE;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.fcs&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                    gridBagConstraints);
<b class="nc">&nbsp;            fcsCrit = new CheckCritPanel(3, aero.getFCSHits());</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(fcsCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.sensor&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        sensorCrit = new CheckCritPanel(3, aero.getSensorHits());</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(sensorCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.engine&quot;) + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;),</b>
&nbsp;                gridBagConstraints);
<b class="nc">&nbsp;        engineCrit = new CheckCritPanel(3, aero.getEngineHits());</b>
<b class="nc">&nbsp;        if ((aero instanceof Dropship) || (aero instanceof Jumpship)) {</b>
<b class="nc">&nbsp;            engineCrit = new CheckCritPanel(6, aero.getEngineHits());</b>
&nbsp;        }
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(engineCrit, gridBagConstraints);</b>
&nbsp;        
<b class="nc">&nbsp;    if (!(aero instanceof Jumpship)) {</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.landingGear&quot;)</b>
&nbsp;                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;        int gearHits = 0;</b>
<b class="nc">&nbsp;        if (aero.isGearHit()) {</b>
<b class="nc">&nbsp;            gearHits = 1;</b>
&nbsp;        }
<b class="nc">&nbsp;        gearCrit = new CheckCritPanel(1, gearHits);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(gearCrit, gridBagConstraints);</b>
&nbsp;    }
&nbsp;    
<b class="nc">&nbsp;        gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.lifeSupport&quot;)</b>
&nbsp;                + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;        int lifeHits = 0;</b>
<b class="nc">&nbsp;        if (!aero.hasLifeSupport()) {</b>
<b class="nc">&nbsp;            lifeHits = 1;</b>
&nbsp;        }
<b class="nc">&nbsp;        lifeSupportCrit = new CheckCritPanel(1, lifeHits);</b>
<b class="nc">&nbsp;        gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        panSystem.add(lifeSupportCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;        if ((aero instanceof SmallCraft) || (aero instanceof Jumpship)) {</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.leftThruster&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            leftThrusterCrit = new CheckCritPanel(4, aero.getLeftThrustHits());</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(leftThrusterCrit, gridBagConstraints);</b>
&nbsp;
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.rightThruster&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            rightThrusterCrit = new CheckCritPanel(4, aero.getRightThrustHits());</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(rightThrusterCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        if (aero instanceof Jumpship) {</b>
<b class="nc">&nbsp;            Jumpship js = (Jumpship) aero;</b>
&nbsp;            //Grav Decks
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.gravDecks&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            gravDeckCrit = new CheckCritPanel(js.getTotalGravDeck(), js.getTotalDamagedGravDeck());</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(gravDeckCrit, gridBagConstraints);</b>
&nbsp;            
&nbsp;            //Docking Collars
&nbsp;            JSpinner collarCrit;
<b class="nc">&nbsp;            Vector&lt;DockingCollar&gt; collars = aero.getDockingCollars();</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.dockingCollars&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
&nbsp;            
<b class="nc">&nbsp;            int damagedCollars = 0;</b>
<b class="nc">&nbsp;            for (DockingCollar nextDC : aero.getDockingCollars()) {</b>
<b class="nc">&nbsp;                if (nextDC.isDamaged()) {</b>
<b class="nc">&nbsp;                    damagedCollars ++;</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            collarCrit = new JSpinner(new SpinnerNumberModel(collars.size() - damagedCollars, 0, collars.size(), 1.0));</b>
<b class="nc">&nbsp;            collarDamage = collarCrit;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(collarCrit, gridBagConstraints);</b>
&nbsp;            
&nbsp;            //K-F Drive Integrity
&nbsp;            JSpinner kfDriveCrit;
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.kfIntegrity&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            kfDriveCrit = new JSpinner(new SpinnerNumberModel(js.getKFIntegrity(), 0, js.getOKFIntegrity(), 1.0));</b>
<b class="nc">&nbsp;            kfDamage = kfDriveCrit;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(kfDriveCrit, gridBagConstraints);</b>
&nbsp;            
&nbsp;            //K-F Drive Components (Optional)
&nbsp;            //Drive Coil
<b class="nc">&nbsp;            if (entity.getGame().getOptions().booleanOption(OptionsConstants.ADVAERORULES_EXPANDED_KF_DRIVE_DAMAGE)) {</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.driveCoil&quot;)</b>
&nbsp;                        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                int driveCoilHits = 0;</b>
<b class="nc">&nbsp;                if (js.getKFDriveCoilHit()) {</b>
<b class="nc">&nbsp;                    driveCoilHits = 1;</b>
&nbsp;                }
<b class="nc">&nbsp;                driveCoilCrit = new CheckCritPanel(1, driveCoilHits);</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;                panSystem.add(driveCoilCrit, gridBagConstraints);</b>
&nbsp;                
&nbsp;                //Charging System
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.chargingSystem&quot;)</b>
&nbsp;                        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                int chargingSystemHits = 0;</b>
<b class="nc">&nbsp;                if (js.getKFChargingSystemHit()) {</b>
<b class="nc">&nbsp;                    chargingSystemHits = 1;</b>
&nbsp;                }
<b class="nc">&nbsp;                chargingSystemCrit = new CheckCritPanel(1, chargingSystemHits);</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;                panSystem.add(chargingSystemCrit, gridBagConstraints);</b>
&nbsp;                
&nbsp;                //Field Initiator
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.fieldInitiator&quot;)</b>
&nbsp;                        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                int fieldInitiatorHits = 0;</b>
<b class="nc">&nbsp;                if (js.getKFFieldInitiatorHit()) {</b>
<b class="nc">&nbsp;                    fieldInitiatorHits = 1;</b>
&nbsp;                }
<b class="nc">&nbsp;                fieldInitiatorCrit = new CheckCritPanel(1, fieldInitiatorHits);</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;                panSystem.add(fieldInitiatorCrit, gridBagConstraints);</b>
&nbsp;                
&nbsp;                //Drive Controller
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.driveController&quot;)</b>
&nbsp;                        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                int driveControllerHits = 0;</b>
<b class="nc">&nbsp;                if (js.getKFDriveControllerHit()) {</b>
<b class="nc">&nbsp;                    driveControllerHits = 1;</b>
&nbsp;                }
<b class="nc">&nbsp;                driveControllerCrit = new CheckCritPanel(1, driveControllerHits);</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;                panSystem.add(driveControllerCrit, gridBagConstraints);</b>
&nbsp;                
&nbsp;                //Helium Tank
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.heliumTank&quot;)</b>
&nbsp;                        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                int heliumTankHits = 0;</b>
<b class="nc">&nbsp;                if (js.getKFHeliumTankHit()) {</b>
<b class="nc">&nbsp;                    heliumTankHits = 1;</b>
&nbsp;                }
<b class="nc">&nbsp;                heliumTankCrit = new CheckCritPanel(1, heliumTankHits);</b>
<b class="nc">&nbsp;                gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;                panSystem.add(heliumTankCrit, gridBagConstraints);</b>
&nbsp;                
&nbsp;                //LF Battery
<b class="nc">&nbsp;                if (js.hasLF()) {</b>
<b class="nc">&nbsp;                    gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                    gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                    gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                    panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.lfBattery&quot;)</b>
&nbsp;                            + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;                    int lfBatteryHits = 0;</b>
<b class="nc">&nbsp;                    if (js.getLFBatteryHit()) {</b>
<b class="nc">&nbsp;                        lfBatteryHits = 1;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    lfBatteryCrit = new CheckCritPanel(1, lfBatteryHits);</b>
<b class="nc">&nbsp;                    gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;                    gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;                    panSystem.add(lfBatteryCrit, gridBagConstraints);</b>
&nbsp;                }
&nbsp;            }
&nbsp;            
&nbsp;            //Jump Sail Integrity
&nbsp;            JSpinner sailCrit;
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.sailIntegrity&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            sailCrit = new JSpinner(new SpinnerNumberModel(js.getSailIntegrity(), 0, js.getOSailIntegrity(), 1.0));</b>
<b class="nc">&nbsp;            sailDamage = sailCrit;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(sailCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (aero instanceof Dropship) {</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.dropshipCollar&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            int collarHits = 0;</b>
<b class="nc">&nbsp;            if (((Dropship) aero).isDockCollarDamaged()) {</b>
<b class="nc">&nbsp;                collarHits = 1;</b>
&nbsp;            }
<b class="nc">&nbsp;            dockCollarCrit = new CheckCritPanel(1, collarHits);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(dockCollarCrit, gridBagConstraints);</b>
&nbsp;            
<b class="nc">&nbsp;            gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;            gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;            panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + Messages.getString(&quot;UnitEditorDialog.kfBoom&quot;)</b>
&nbsp;                    + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
<b class="nc">&nbsp;            int kfboomHits = 0;</b>
<b class="nc">&nbsp;            if (((Dropship) aero).isKFBoomDamaged()) {</b>
<b class="nc">&nbsp;            	kfboomHits = 1;</b>
&nbsp;            }
<b class="nc">&nbsp;            kfboomCrit = new CheckCritPanel(1, kfboomHits);</b>
<b class="nc">&nbsp;            gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;            gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;            panSystem.add(kfboomCrit, gridBagConstraints);</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        if ((aero instanceof SmallCraft) || (aero instanceof Jumpship)) {</b>
<b class="nc">&nbsp;        	int b = 0;</b>
&nbsp;        	JSpinner bayCrit;
<b class="nc">&nbsp;        	Vector&lt;Bay&gt; bays = aero.getTransportBays();</b>
<b class="nc">&nbsp;        	bayDamage = new JSpinner[bays.size()];</b>
<b class="nc">&nbsp;        	bayDoorCrit = new CheckCritPanel [bays.size()];</b>
<b class="nc">&nbsp;        	for (Bay nextbay : bays) {</b>
<b class="nc">&nbsp;        		gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;        		gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;        		gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;        		panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + </b>
<b class="nc">&nbsp;        		        String.format(Messages.getString(&quot;UnitEditorDialog.bayCrit&quot;), nextbay.getType(), nextbay.getBayNumber())</b>
&nbsp;        		        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
&nbsp;    		
<b class="nc">&nbsp;        		bayCrit = new JSpinner(new SpinnerNumberModel(nextbay.getCapacity() - nextbay.getBayDamage(),</b>
<b class="nc">&nbsp;                        0, nextbay.getCapacity(), nextbay.isCargo()? 0.5: 1.0));</b>
<b class="nc">&nbsp;        		bayDamage[b] = bayCrit;</b>
<b class="nc">&nbsp;        		gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        		gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        		panSystem.add(bayCrit, gridBagConstraints);</b>
&nbsp;    		
<b class="nc">&nbsp;                gridBagConstraints.gridx = 0;</b>
<b class="nc">&nbsp;                gridBagConstraints.gridy++;</b>
<b class="nc">&nbsp;                gridBagConstraints.weightx = 0.0;</b>
<b class="nc">&nbsp;                panSystem.add(new JLabel(&quot;&lt;html&gt;&lt;b&gt;&quot; + </b>
<b class="nc">&nbsp;                        String.format(Messages.getString(&quot;UnitEditorDialog.bayDoorCrit&quot;), nextbay.getBayNumber())</b>
&nbsp;                        + &quot;&lt;/b&gt;&lt;br&gt;&lt;/html&gt;&quot;), gridBagConstraints);
&nbsp;    		
<b class="nc">&nbsp;        		CheckCritPanel doorCrit = new CheckCritPanel(nextbay.getDoors(), (nextbay.getDoors() - nextbay.getCurrentDoors()));</b>
<b class="nc">&nbsp;        		bayDoorCrit[b] = doorCrit;</b>
<b class="nc">&nbsp;        		gridBagConstraints.gridx = 1;</b>
<b class="nc">&nbsp;        		gridBagConstraints.weightx = 1.0;</b>
<b class="nc">&nbsp;        		panSystem.add(doorCrit, gridBagConstraints);</b>
<b class="nc">&nbsp;        		b++;</b>
<b class="nc">&nbsp;    		}</b>
&nbsp;    	}
&nbsp;    }
&nbsp;
&nbsp;    private void btnOkayActionPerformed(java.awt.event.ActionEvent evt) {
<b class="nc">&nbsp;        for (int i = 0; i &lt; entity.locations(); i++) {</b>
<b class="nc">&nbsp;            if (null != spnInternal[i]) {</b>
<b class="nc">&nbsp;                int internal = (Integer) spnInternal[i].getModel().getValue();</b>
<b class="nc">&nbsp;                if (internal &lt;= 0) {</b>
<b class="nc">&nbsp;                    internal = IArmorState.ARMOR_DESTROYED;</b>
&nbsp;                }
<b class="nc">&nbsp;                if ((entity instanceof Aero) &amp;&amp; (i == 0)) {</b>
<b class="nc">&nbsp;                    ((Aero) entity).setSI(internal);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    entity.setInternal(internal, i);</b>
&nbsp;                }
<b class="nc">&nbsp;                if ((entity instanceof Infantry)</b>
&nbsp;                        &amp;&amp; !(entity instanceof BattleArmor)) {
<b class="nc">&nbsp;                    ((Infantry) entity).applyDamage();</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (null != spnArmor[i]) {</b>
<b class="nc">&nbsp;                int armor = (Integer) spnArmor[i].getModel().getValue();</b>
<b class="nc">&nbsp;                if (armor &lt;= 0) {</b>
<b class="nc">&nbsp;                    armor = IArmorState.ARMOR_DESTROYED;</b>
&nbsp;                }
<b class="nc">&nbsp;                entity.setArmor(armor, i);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (entity.hasRearArmor(i) &amp;&amp; (null != spnRear[i])) {</b>
<b class="nc">&nbsp;                int rear = (Integer) spnRear[i].getModel().getValue();</b>
<b class="nc">&nbsp;                if (rear &lt;= 0) {</b>
<b class="nc">&nbsp;                    rear = IArmorState.ARMOR_DESTROYED;</b>
&nbsp;                }
<b class="nc">&nbsp;                entity.setArmor(rear, i, true);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        for (Mounted m : entity.getEquipment()) {</b>
<b class="nc">&nbsp;            int eqNum = entity.getEquipmentNum(m);</b>
<b class="nc">&nbsp;            CheckCritPanel crit = equipCrits.get(eqNum);</b>
<b class="nc">&nbsp;            if (null != crit) {</b>
<b class="nc">&nbsp;                int hits = crit.getHits();</b>
<b class="nc">&nbsp;                m.setDestroyed(hits &gt; 0);</b>
<b class="nc">&nbsp;                m.setHit(hits &gt; 0);</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_EQUIPMENT, eqNum, hits);</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // now systems
<b class="nc">&nbsp;        if (entity instanceof Mech) {</b>
<b class="nc">&nbsp;            if (null != centerEngineCrit) {</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                        Mech.SYSTEM_ENGINE, Mech.LOC_CT,
<b class="nc">&nbsp;                        centerEngineCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != leftEngineCrit) {</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                        Mech.SYSTEM_ENGINE, Mech.LOC_LT,
<b class="nc">&nbsp;                        leftEngineCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != rightEngineCrit) {</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                        Mech.SYSTEM_ENGINE, Mech.LOC_RT,
<b class="nc">&nbsp;                        rightEngineCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != gyroCrit) {</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_GYRO,</b>
<b class="nc">&nbsp;                        gyroCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != sensorCrit) {</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
<b class="nc">&nbsp;                        Mech.SYSTEM_SENSORS, sensorCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != lifeSupportCrit) {</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
<b class="nc">&nbsp;                        Mech.SYSTEM_LIFE_SUPPORT, lifeSupportCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != cockpitCrit) {</b>
<b class="nc">&nbsp;                entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
<b class="nc">&nbsp;                        Mech.SYSTEM_COCKPIT, cockpitCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != lamAvionicsCrit &amp;&amp; !lamAvionicsCrit.isEmpty()) {</b>
<b class="nc">&nbsp;                for (int loc : lamAvionicsCrit.keySet()) {</b>
<b class="nc">&nbsp;                    entity.damageSystem(CriticalSlot.TYPE_SYSTEM, LandAirMech.LAM_AVIONICS,</b>
<b class="nc">&nbsp;                            loc, lamAvionicsCrit.get(loc).getHits());</b>
<b class="nc">&nbsp;                }</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != lamLandingGearCrit &amp;&amp; !lamLandingGearCrit.isEmpty()) {</b>
<b class="nc">&nbsp;                for (int loc : lamLandingGearCrit.keySet()) {</b>
<b class="nc">&nbsp;                    entity.damageSystem(CriticalSlot.TYPE_SYSTEM, LandAirMech.LAM_LANDING_GEAR,</b>
<b class="nc">&nbsp;                            loc, lamLandingGearCrit.get(loc).getHits());</b>
<b class="nc">&nbsp;                }</b>
&nbsp;            }
<b class="nc">&nbsp;            for (int i = 0; i &lt; 4; i++) {</b>
<b class="nc">&nbsp;                for (int j = 0; j &lt; 4; j++) {</b>
<b class="nc">&nbsp;                    CheckCritPanel actuatorCrit = actuatorCrits[i][j];</b>
<b class="nc">&nbsp;                    if (null == actuatorCrit) {</b>
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    int loc = i + Mech.LOC_RARM;</b>
<b class="nc">&nbsp;                    int actuator = j + Mech.ACTUATOR_SHOULDER;</b>
<b class="nc">&nbsp;                    if ((loc &gt;= Mech.LOC_RLEG) || (entity instanceof QuadMech)) {</b>
<b class="nc">&nbsp;                        actuator = j + Mech.ACTUATOR_HIP;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    entity.damageSystem(CriticalSlot.TYPE_SYSTEM, actuator,</b>
<b class="nc">&nbsp;                            loc, actuatorCrit.getHits());</b>
&nbsp;                }
<b class="nc">&nbsp;                if (entity instanceof QuadVee) {</b>
<b class="nc">&nbsp;                    for (int j = 0; j &lt; 4; j++) {</b>
<b class="nc">&nbsp;                        CheckCritPanel actuatorCrit = actuatorCrits[i][4];</b>
<b class="nc">&nbsp;                        if (null == actuatorCrit) {</b>
<b class="nc">&nbsp;                            continue;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        int loc = i + Mech.LOC_RARM;</b>
<b class="nc">&nbsp;                        int actuator = QuadVee.SYSTEM_CONVERSION_GEAR;</b>
<b class="nc">&nbsp;                        entity.damageSystem(CriticalSlot.TYPE_SYSTEM, actuator,</b>
<b class="nc">&nbsp;                                loc, actuatorCrit.getHits());</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;        } else if (entity instanceof Protomech) {</b>
<b class="nc">&nbsp;            for (int loc = 0; loc &lt; entity.locations(); loc++) {</b>
<b class="nc">&nbsp;                if (null == protoCrits[loc]) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                if ((loc == Protomech.LOC_LARM) || (loc == Protomech.LOC_RARM)) {</b>
<b class="nc">&nbsp;                    entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                            Protomech.SYSTEM_ARMCRIT, loc,
<b class="nc">&nbsp;                            protoCrits[loc].getHits());</b>
&nbsp;                }
<b class="nc">&nbsp;                if (loc == Protomech.LOC_LEG) {</b>
<b class="nc">&nbsp;                    entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                            Protomech.SYSTEM_LEGCRIT, loc,
<b class="nc">&nbsp;                            protoCrits[loc].getHits());</b>
&nbsp;                }
<b class="nc">&nbsp;                if (loc == Protomech.LOC_HEAD) {</b>
<b class="nc">&nbsp;                    entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                            Protomech.SYSTEM_HEADCRIT, loc,
<b class="nc">&nbsp;                            protoCrits[loc].getHits());</b>
&nbsp;                }
<b class="nc">&nbsp;                if (loc == Protomech.LOC_TORSO) {</b>
<b class="nc">&nbsp;                    entity.damageSystem(CriticalSlot.TYPE_SYSTEM,</b>
&nbsp;                            Protomech.SYSTEM_TORSOCRIT, loc,
<b class="nc">&nbsp;                            protoCrits[loc].getHits());</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;        } else if (entity instanceof Tank) {</b>
<b class="nc">&nbsp;            Tank tank = (Tank) entity;</b>
<b class="nc">&nbsp;            if (null != engineCrit) {</b>
<b class="nc">&nbsp;                if (engineCrit.getHits() &gt; 0) {</b>
<b class="nc">&nbsp;                    tank.engineHit();</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    tank.engineFix();</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (null != turretlockCrit) {</b>
<b class="nc">&nbsp;                if (turretlockCrit.getHits() &gt; 0) {</b>
<b class="nc">&nbsp;                    tank.lockTurret(0);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    tank.unlockTurret();</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            if (null != sensorCrit) {</b>
<b class="nc">&nbsp;                tank.setSensorHits(sensorCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != motiveCrit) {</b>
<b class="nc">&nbsp;                tank.resetMovementDamage();</b>
<b class="nc">&nbsp;                tank.addMovementDamage(motiveCrit.getHits());</b>
&nbsp;
&nbsp;                // Apply movement damage immediately in case we&#39;ve decided to immobilize the tank
<b class="nc">&nbsp;                tank.applyMovementDamage();</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((tank instanceof VTOL) &amp;&amp; (null != flightStabilizerCrit)) {</b>
<b class="nc">&nbsp;                if (flightStabilizerCrit.getHits() &gt; 0) {</b>
<b class="nc">&nbsp;                    tank.setStabiliserHit(VTOL.LOC_ROTOR);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    tank.clearStabiliserHit(VTOL.LOC_ROTOR);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;            for (int loc = 0; loc &lt; tank.locations(); loc++) {</b>
<b class="nc">&nbsp;                CheckCritPanel stabCrit = stabilizerCrits[loc];</b>
<b class="nc">&nbsp;                if (null == stabCrit) {</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                if (stabCrit.getHits() &gt; 0) {</b>
<b class="nc">&nbsp;                    tank.setStabiliserHit(loc);</b>
&nbsp;                } else {
<b class="nc">&nbsp;                    tank.clearStabiliserHit(loc);</b>
&nbsp;                }
&nbsp;            }
<b class="nc">&nbsp;        } else if (entity instanceof Aero) {</b>
<b class="nc">&nbsp;            Aero aero = (Aero) entity;</b>
<b class="nc">&nbsp;            if (null != avionicsCrit) {</b>
<b class="nc">&nbsp;                aero.setAvionicsHits(avionicsCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != fcsCrit) {</b>
<b class="nc">&nbsp;                aero.setFCSHits(fcsCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != cicCrit) {</b>
<b class="nc">&nbsp;                aero.setCICHits(cicCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != engineCrit) {</b>
<b class="nc">&nbsp;                aero.setEngineHits(engineCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != sensorCrit) {</b>
<b class="nc">&nbsp;                aero.setSensorHits(sensorCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != gearCrit) {</b>
<b class="nc">&nbsp;                aero.setGearHit(gearCrit.getHits() &gt; 0);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != lifeSupportCrit) {</b>
<b class="nc">&nbsp;                aero.setLifeSupport(lifeSupportCrit.getHits() == 0);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != leftThrusterCrit) {</b>
<b class="nc">&nbsp;                aero.setLeftThrustHits(leftThrusterCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if (null != rightThrusterCrit) {</b>
<b class="nc">&nbsp;                aero.setRightThrustHits(rightThrusterCrit.getHits());</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((null != dockCollarCrit) &amp;&amp; (aero instanceof Dropship)) {</b>
<b class="nc">&nbsp;                ((Dropship) aero)</b>
<b class="nc">&nbsp;                        .setDamageDockCollar(dockCollarCrit.getHits() &gt; 0);</b>
&nbsp;            }
<b class="nc">&nbsp;            if ((null != kfboomCrit) &amp;&amp; (aero instanceof Dropship)) {</b>
<b class="nc">&nbsp;            	((Dropship) aero)</b>
<b class="nc">&nbsp;            			.setDamageKFBoom(kfboomCrit.getHits() &gt; 0);</b>
&nbsp;            }
&nbsp;            // cargo bays and bay doors
<b class="nc">&nbsp;            if ((aero instanceof Dropship) || (aero instanceof Jumpship)) {</b>
<b class="nc">&nbsp;            	int b = 0;</b>
<b class="nc">&nbsp;            	for (Bay bay : aero.getTransportBays()) {</b>
<b class="nc">&nbsp;            		JSpinner bayCrit = bayDamage[b];</b>
<b class="nc">&nbsp;            		if (null == bayCrit) {</b>
<b class="nc">&nbsp;            			continue;</b>
&nbsp;            		}
<b class="nc">&nbsp;            		bay.setBayDamage(bay.getCapacity() - (Double) bayCrit.getModel().getValue());</b>
<b class="nc">&nbsp;            		CheckCritPanel doorCrit = bayDoorCrit[b];</b>
<b class="nc">&nbsp;            		if (null == doorCrit) {</b>
<b class="nc">&nbsp;            			continue;</b>
&nbsp;            		}
<b class="nc">&nbsp;            		if ((bay.getCurrentDoors() &gt; 0) &amp;&amp; (doorCrit.getHits() &gt; 0)) {</b>
<b class="nc">&nbsp;            			bay.setCurrentDoors(bay.getDoors() - doorCrit.getHits());</b>
&nbsp;
<b class="nc">&nbsp;            		} else if (doorCrit.getHits() == 0) {</b>
<b class="nc">&nbsp;            			bay.setCurrentDoors(bay.getDoors());</b>
&nbsp;            		}
&nbsp;        			// for ASF and SC bays, we have to update recovery slots as doors are changed
<b class="nc">&nbsp;        			if (bay instanceof ASFBay) {</b>
<b class="nc">&nbsp;        				ASFBay a = (ASFBay) bay;</b>
<b class="nc">&nbsp;        				a.initializeRecoverySlots();        				</b>
&nbsp;        			} 
<b class="nc">&nbsp;        			if (bay instanceof SmallCraftBay) {</b>
<b class="nc">&nbsp;    					SmallCraftBay s = (SmallCraftBay) bay;</b>
<b class="nc">&nbsp;    					s.initializeRecoverySlots();    					</b>
&nbsp;        			}
<b class="nc">&nbsp;            	b++;</b>
<b class="nc">&nbsp;            	}</b>
&nbsp;            }
&nbsp;            // Jumpship Docking Collars, KF Drive, Sail and Grav Decks
<b class="nc">&nbsp;            if (aero instanceof Jumpship) {</b>
<b class="nc">&nbsp;                Jumpship js = (Jumpship) aero;</b>
<b class="nc">&nbsp;                JSpinner collarCrit = collarDamage;</b>
<b class="nc">&nbsp;                CheckCritPanel deckCrit = gravDeckCrit;</b>
<b class="nc">&nbsp;                double damagedCollars = 0.0;</b>
<b class="nc">&nbsp;                int damagedDecks = 0;</b>
<b class="nc">&nbsp;                if (null != collarCrit) {</b>
<b class="nc">&nbsp;                    damagedCollars = (aero.getDockingCollars().size() - (double) collarCrit.getModel().getValue());</b>
&nbsp;                }
&nbsp;                //First, reset damaged collars to undamaged. Otherwise you get weirdness when running this dialogue multiple times
<b class="nc">&nbsp;                for (DockingCollar collar : aero.getDockingCollars()) {</b>
<b class="nc">&nbsp;                    collar.setDamaged(false);</b>
<b class="nc">&nbsp;                }</b>
&nbsp;                //Otherwise, run through the list and damage one until the spinner value is satisfied
<b class="nc">&nbsp;                for (DockingCollar collar : aero.getDockingCollars()) {</b>
<b class="nc">&nbsp;                    if (damagedCollars &lt;= 0) {</b>
<b class="nc">&nbsp;                        break;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    collar.setDamaged(true);</b>
<b class="nc">&nbsp;                    damagedCollars --;</b>
<b class="nc">&nbsp;                }</b>
<b class="nc">&nbsp;                if (null != deckCrit) {</b>
<b class="nc">&nbsp;                    damagedDecks = deckCrit.getHits();</b>
&nbsp;                }
&nbsp;                //reset all grav decks to undamaged
<b class="nc">&nbsp;                for (int i = 0; i &lt; js.getTotalGravDeck(); i++) {</b>
<b class="nc">&nbsp;                    js.setGravDeckDamageFlag(i, 0);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (damagedDecks &gt; 0) {</b>
&nbsp;                    //loop through the grav decks from #1 and damage them
<b class="nc">&nbsp;                    for (int i = 0; i &lt; damagedDecks; i++) {</b>
<b class="nc">&nbsp;                        js.setGravDeckDamageFlag(i, 1);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;                //KF Drive and Sail
<b class="nc">&nbsp;                if (null != kfDamage) {</b>
<b class="nc">&nbsp;                    double kfIntegrity = (double) kfDamage.getModel().getValue();</b>
<b class="nc">&nbsp;                    js.setKFIntegrity((int) kfIntegrity);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (null != chargingSystemCrit) {</b>
<b class="nc">&nbsp;                    js.setKFChargingSystemHit(chargingSystemCrit.getHits() &gt; 0);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (null != driveCoilCrit) {</b>
<b class="nc">&nbsp;                    js.setKFDriveCoilHit(driveCoilCrit.getHits() &gt; 0);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (null != driveControllerCrit) {</b>
<b class="nc">&nbsp;                    js.setKFDriveControllerHit(driveControllerCrit.getHits() &gt; 0);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (null != fieldInitiatorCrit) {</b>
<b class="nc">&nbsp;                    js.setKFFieldInitiatorHit(fieldInitiatorCrit.getHits() &gt; 0);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (null != heliumTankCrit) {</b>
<b class="nc">&nbsp;                    js.setKFHeliumTankHit(heliumTankCrit.getHits() &gt; 0);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (null != lfBatteryCrit) {</b>
<b class="nc">&nbsp;                    js.setLFBatteryHit(lfBatteryCrit.getHits() &gt; 0);</b>
&nbsp;                }
<b class="nc">&nbsp;                if (null != sailDamage) {</b>
<b class="nc">&nbsp;                    double sailIntegrity = (double) sailDamage.getModel().getValue();</b>
<b class="nc">&nbsp;                    js.setSailIntegrity((int) sailIntegrity);</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    private class CheckCritPanel extends JPanel {</b>
&nbsp;
&nbsp;        /**
&nbsp;         *
&nbsp;         */
&nbsp;        private static final long serialVersionUID = 8662728291188274362L;
&nbsp;
<b class="nc">&nbsp;        private ArrayList&lt;JCheckBox&gt; checks = new ArrayList&lt;JCheckBox&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        public CheckCritPanel(int crits, int current) {</b>
<b class="nc">&nbsp;            setLayout(new BoxLayout(this, BoxLayout.LINE_AXIS));</b>
<b class="nc">&nbsp;            for (int i = 0; i &lt; crits; i++) {</b>
<b class="nc">&nbsp;                JCheckBox check = new JCheckBox(&quot;&quot;);</b>
<b class="nc">&nbsp;                check.setActionCommand(Integer.toString(i));</b>
<b class="nc">&nbsp;                check.addActionListener(new ActionListener() {</b>
&nbsp;                    public void actionPerformed(ActionEvent evt) {
<b class="nc">&nbsp;                        checkBoxes(evt);</b>
&nbsp;                    }
&nbsp;                });
<b class="nc">&nbsp;                checks.add(check);</b>
<b class="nc">&nbsp;                add(check);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (current &gt; 0) {</b>
<b class="nc">&nbsp;                for (int i = 0; i &lt; current; i++) {</b>
<b class="nc">&nbsp;                    checks.get(i).setSelected(true);</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        public int getHits() {
<b class="nc">&nbsp;            int hits = 0;</b>
<b class="nc">&nbsp;            for (JCheckBox check : checks) {</b>
<b class="nc">&nbsp;                if (check.isSelected()) {</b>
<b class="nc">&nbsp;                    hits++;</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            return hits;</b>
&nbsp;        }
&nbsp;
&nbsp;        private void checkBoxes(ActionEvent evt) {
<b class="nc">&nbsp;            int hits = Integer.parseInt(evt.getActionCommand());</b>
<b class="nc">&nbsp;            boolean selected = checks.get(hits).isSelected();</b>
<b class="nc">&nbsp;            if (selected) {</b>
&nbsp;                // check all those up to this one
<b class="nc">&nbsp;                for (int i = 0; i &lt; hits; i++) {</b>
<b class="nc">&nbsp;                    checks.get(i).setSelected(true);</b>
&nbsp;                }
<b class="nc">&nbsp;            } else if (hits &lt; checks.size()) {</b>
&nbsp;                // deselect any above this one
<b class="nc">&nbsp;                for (int i = hits; i &lt; checks.size(); i++) {</b>
<b class="nc">&nbsp;                    checks.get(i).setSelected(false);</b>
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
