


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > PacketTool</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.test</a>
</div>

<h1>Coverage Summary for Class: PacketTool (megamek.test)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">PacketTool</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/9)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/210)
  </span>
</td>
</tr>
  <tr>
    <td class="name">PacketTool$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PacketTool$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PacketTool$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PacketTool$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PacketTool$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PacketTool$6</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PacketTool$7</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PacketTool$8</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/231)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2003,2004 Ben Mazur (bmazur@sev.org)
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;
&nbsp;package megamek.test;
&nbsp;
&nbsp;import java.awt.Button;
&nbsp;import java.awt.FileDialog;
&nbsp;import java.awt.Frame;
&nbsp;import java.awt.GridLayout;
&nbsp;import java.awt.Label;
&nbsp;import java.awt.Panel;
&nbsp;import java.awt.TextField;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.awt.event.ActionListener;
&nbsp;import java.awt.event.WindowAdapter;
&nbsp;import java.awt.event.WindowEvent;
&nbsp;import java.io.File;
&nbsp;import java.io.FileInputStream;
&nbsp;import java.io.FileOutputStream;
&nbsp;import java.io.IOException;
&nbsp;import java.io.InputStream;
&nbsp;import java.io.OutputStream;
&nbsp;import java.net.ServerSocket;
&nbsp;import java.net.Socket;
&nbsp;import java.util.Timer;
&nbsp;import java.util.TimerTask;
&nbsp;
&nbsp;import javax.swing.SwingUtilities;
&nbsp;
&nbsp;import megamek.common.Board;
&nbsp;import megamek.common.net.ConnectionFactory;
&nbsp;import megamek.common.net.ConnectionListenerAdapter;
&nbsp;import megamek.common.net.DisconnectedEvent;
&nbsp;import megamek.common.net.IConnection;
&nbsp;import megamek.common.net.Packet;
&nbsp;import megamek.common.net.PacketReceivedEvent;
&nbsp;
&nbsp;/**
&nbsp; * This class provides an AWT GUI for testing the transmission and reception of
&nbsp; * &lt;code&gt;Packet&lt;/code&gt;s.
&nbsp; *
&nbsp; * @author James Damour &lt;suvarov454@users.sourceforge.net&gt;
&nbsp; */
&nbsp;public class PacketTool extends Frame implements Runnable {
&nbsp;
&nbsp;    /**
&nbsp;     *
&nbsp;     */
&nbsp;    private static final long serialVersionUID = 3249150110009720658L;
&nbsp;
&nbsp;    /**
&nbsp;     * The currently-loaded &lt;code&gt;Board&lt;/code&gt;. May be &lt;code&gt;null&lt;/code&gt;.
&nbsp;     */
<b class="nc">&nbsp;    private Board board = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The panel containing the connection controls.
&nbsp;     */
<b class="nc">&nbsp;    private Panel panConnect = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The panel containing the transimission controls.
&nbsp;     */
<b class="nc">&nbsp;    private Panel panXmit = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The text control where the host name is entered.
&nbsp;     */
<b class="nc">&nbsp;    private TextField hostName = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The text control where the host port is entered.
&nbsp;     */
<b class="nc">&nbsp;    private TextField hostPort = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The label where the board name is displayed.
&nbsp;     */
<b class="nc">&nbsp;    private Label boardName = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The button that sends the loaded board.
&nbsp;     */
<b class="nc">&nbsp;    private Button butSend = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * The connection to the other peer.
&nbsp;     */
<b class="nc">&nbsp;    IConnection conn = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Display a window for testing the transmission of boards.
&nbsp;     */
&nbsp;    public static void main(String[] args) {
<b class="nc">&nbsp;        Frame frame = new PacketTool();</b>
&nbsp;
&nbsp;        // set visible on middle of screen
<b class="nc">&nbsp;        frame.pack();</b>
<b class="nc">&nbsp;        frame.setLocationRelativeTo(null);</b>
&nbsp;
&nbsp;        // Show the window.
<b class="nc">&nbsp;        frame.setVisible(true);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Create a window for testing the transmission of boards. The window will
&nbsp;     * &lt;em&gt;not&lt;/em&gt; be displayed by this constructor; calling functions should
&nbsp;     * call &lt;code&gt;setVisible(true)&lt;/code&gt;.
&nbsp;     */
&nbsp;    public PacketTool() {
<b class="nc">&nbsp;        super(&quot;Board Transmition&quot;);</b>
<b class="nc">&nbsp;        Button button = null;</b>
<b class="nc">&nbsp;        Panel main = null;</b>
&nbsp;
&nbsp;        // Handle the frame stuff.
<b class="nc">&nbsp;        addWindowListener(new WindowAdapter() {</b>
&nbsp;            @Override
&nbsp;            public void windowClosing(WindowEvent e) {
<b class="nc">&nbsp;                quit();</b>
&nbsp;            }
&nbsp;        });
&nbsp;
&nbsp;        // Create the panels.
<b class="nc">&nbsp;        main = new Panel();</b>
<b class="nc">&nbsp;        main.setLayout(new GridLayout(0, 1));</b>
<b class="nc">&nbsp;        panConnect = new Panel();</b>
<b class="nc">&nbsp;        panConnect.setLayout(new GridLayout(0, 2));</b>
<b class="nc">&nbsp;        main.add(panConnect);</b>
<b class="nc">&nbsp;        panXmit = new Panel();</b>
<b class="nc">&nbsp;        panXmit.setLayout(new GridLayout(0, 1));</b>
<b class="nc">&nbsp;        panXmit.setEnabled(false);</b>
<b class="nc">&nbsp;        main.add(panXmit);</b>
<b class="nc">&nbsp;        this.add(main);</b>
&nbsp;
&nbsp;        // Populate the connection panel.
<b class="nc">&nbsp;        panConnect.add(new Label(&quot; Connect To:&quot;));</b>
<b class="nc">&nbsp;        hostName = new TextField(&quot;localhost&quot;, 10);</b>
<b class="nc">&nbsp;        panConnect.add(hostName);</b>
<b class="nc">&nbsp;        panConnect.add(new Label(&quot;Port Number:&quot;));</b>
<b class="nc">&nbsp;        hostPort = new TextField(&quot;2346&quot;, 10);</b>
<b class="nc">&nbsp;        panConnect.add(hostPort);</b>
<b class="nc">&nbsp;        button = new Button(&quot;Listen&quot;);</b>
<b class="nc">&nbsp;        button.addActionListener(new ActionListener() {</b>
&nbsp;            public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;                (new Thread(PacketTool.this, &quot;Packet Reader&quot;)).start();</b>
&nbsp;            }
&nbsp;        });
<b class="nc">&nbsp;        panConnect.add(button);</b>
<b class="nc">&nbsp;        button = new Button(&quot;Connect&quot;);</b>
<b class="nc">&nbsp;        button.addActionListener(new ActionListener() {</b>
&nbsp;            public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;                connect();</b>
&nbsp;            }
&nbsp;        });
<b class="nc">&nbsp;        panConnect.add(button);</b>
&nbsp;
&nbsp;        // Populate the transmission panel.
<b class="nc">&nbsp;        button = new Button(&quot;Load Board&quot;);</b>
<b class="nc">&nbsp;        button.addActionListener(new ActionListener() {</b>
&nbsp;            public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;                boardLoad();</b>
&nbsp;            }
&nbsp;        });
<b class="nc">&nbsp;        panXmit.add(button);</b>
<b class="nc">&nbsp;        boardName = new Label();</b>
<b class="nc">&nbsp;        boardName.setAlignment(Label.CENTER);</b>
<b class="nc">&nbsp;        panXmit.add(boardName);</b>
<b class="nc">&nbsp;        butSend = new Button(&quot;Send&quot;);</b>
<b class="nc">&nbsp;        butSend.addActionListener(new ActionListener() {</b>
&nbsp;            public void actionPerformed(ActionEvent e) {
<b class="nc">&nbsp;                send();</b>
&nbsp;            }
&nbsp;        });
<b class="nc">&nbsp;        butSend.setEnabled(false);</b>
<b class="nc">&nbsp;        panXmit.add(butSend);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Close this window.
&nbsp;     */
&nbsp;    public synchronized void quit() {
<b class="nc">&nbsp;        if (null != conn) {</b>
<b class="nc">&nbsp;            conn.close();</b>
&nbsp;        }
<b class="nc">&nbsp;        System.exit(0);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Connect to the specified host.
&nbsp;     */
&nbsp;    public void connect() {
<b class="nc">&nbsp;        String host = hostName.getText();</b>
<b class="nc">&nbsp;        int port = 0;</b>
&nbsp;        try {
<b class="nc">&nbsp;            port = Integer.parseInt(hostPort.getText());</b>
<b class="nc">&nbsp;            conn = ConnectionFactory.getInstance().createServerConnection(</b>
&nbsp;                    new Socket(host, port), 1);
<b class="nc">&nbsp;            Timer t = new Timer(true);</b>
<b class="nc">&nbsp;            final Runnable packetUpdate = new Runnable() {</b>
&nbsp;                public void run() {
<b class="nc">&nbsp;                    IConnection connection = conn;</b>
<b class="nc">&nbsp;                    if (connection != null) {</b>
<b class="nc">&nbsp;                        connection.update();</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            };
<b class="nc">&nbsp;            final TimerTask packetUpdate2 = new TimerTask() {</b>
&nbsp;                @Override
&nbsp;                public void run() {
&nbsp;                    try {
<b class="nc">&nbsp;                        SwingUtilities.invokeAndWait(packetUpdate);</b>
<b class="nc">&nbsp;                    } catch (Exception ie) {</b>
&nbsp;                        //this should never fail
<b class="nc">&nbsp;                    }</b>
&nbsp;                }
&nbsp;            };
<b class="nc">&nbsp;            t.schedule(packetUpdate2, 500, 150);</b>
&nbsp;
&nbsp;            // conn = new XmlConnection( this, new Socket(host, port), 1 );
<b class="nc">&nbsp;            System.out.println(&quot;Connected to peer.&quot;);</b>
<b class="nc">&nbsp;            conn.addConnectionListener(connectionListener);</b>
&nbsp;
<b class="nc">&nbsp;            board = new Board();</b>
<b class="nc">&nbsp;            panConnect.setEnabled(false);</b>
<b class="nc">&nbsp;            panXmit.setEnabled(true);</b>
<b class="nc">&nbsp;        } catch (Throwable err) {</b>
<b class="nc">&nbsp;            err.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Load a board from a file.
&nbsp;     */
&nbsp;    public void boardLoad() {
<b class="nc">&nbsp;        FileDialog fd = new FileDialog(this, &quot;Load Board...&quot;, FileDialog.LOAD);</b>
<b class="nc">&nbsp;        fd.setDirectory(&quot;data&quot; + File.separator + &quot;boards&quot;);</b>
<b class="nc">&nbsp;        if (boardName.getText().length() &gt; 0) {</b>
<b class="nc">&nbsp;            fd.setFile(boardName.getText());</b>
&nbsp;        }
<b class="nc">&nbsp;        fd.setLocation(this.getLocation().x + 150, this.getLocation().y + 100);</b>
<b class="nc">&nbsp;        fd.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;        if (fd.getFile() == null) {</b>
&nbsp;            // I want a file, y&#39;know!
&nbsp;            return;
&nbsp;        }
<b class="nc">&nbsp;        String curpath = fd.getDirectory();</b>
<b class="nc">&nbsp;        String curfile = fd.getFile();</b>
&nbsp;        // load!
&nbsp;        try {
<b class="nc">&nbsp;            InputStream is = new FileInputStream(new File(curpath, curfile));</b>
<b class="nc">&nbsp;            board.load(is);</b>
&nbsp;            // okay, done!
<b class="nc">&nbsp;            is.close();</b>
&nbsp;
&nbsp;            // Record the file&#39;s name.
<b class="nc">&nbsp;            boardName.setText(curfile);</b>
&nbsp;
&nbsp;            // Enable the send button.
<b class="nc">&nbsp;            butSend.setEnabled(true);</b>
<b class="nc">&nbsp;        } catch (IOException ex) {</b>
<b class="nc">&nbsp;            System.err.println(&quot;error opening file to save!&quot;);</b>
<b class="nc">&nbsp;            System.err.println(ex);</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Send the loaded board to the peer.
&nbsp;     */
&nbsp;    public void send() {
<b class="nc">&nbsp;        long start = conn.bytesSent();</b>
<b class="nc">&nbsp;        Packet packet = new Packet(Packet.COMMAND_SENDING_BOARD, board);</b>
&nbsp;        /*
&nbsp;         * 2003-12-21 : prove connectivity first, then add refinements * like
&nbsp;         * data compression. packet.zipData();
&nbsp;         */
<b class="nc">&nbsp;        conn.send(packet);</b>
<b class="nc">&nbsp;        System.out.print(&quot;Bytes sent: &quot;);</b>
<b class="nc">&nbsp;        System.out.print(conn.bytesSent() - start);</b>
<b class="nc">&nbsp;        System.out.print(&quot;, total sent: &quot;);</b>
<b class="nc">&nbsp;        System.out.println(conn.bytesSent());</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Listen for incoming clients.
&nbsp;     */
&nbsp;    public void run() {
<b class="nc">&nbsp;        int port = 0;</b>
&nbsp;        try {
<b class="nc">&nbsp;            port = Integer.parseInt(hostPort.getText());</b>
<b class="nc">&nbsp;            ServerSocket serverSocket = new ServerSocket(port);</b>
<b class="nc">&nbsp;            Socket s = serverSocket.accept();</b>
<b class="nc">&nbsp;            serverSocket.close();</b>
&nbsp;
<b class="nc">&nbsp;            System.out.println(&quot;Accepted peer connection.&quot;);</b>
&nbsp;
<b class="nc">&nbsp;            conn = ConnectionFactory.getInstance().createServerConnection(s, 0);</b>
&nbsp;            // conn = new XmlConnection(this, s, 0);
<b class="nc">&nbsp;            conn.addConnectionListener(connectionListener);</b>
&nbsp;
<b class="nc">&nbsp;            board = new Board();</b>
<b class="nc">&nbsp;            panConnect.setEnabled(false);</b>
<b class="nc">&nbsp;            panXmit.setEnabled(true);</b>
&nbsp;
<b class="nc">&nbsp;        } catch (Throwable err) {</b>
<b class="nc">&nbsp;            err.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Process a packet from a connection. &lt;p/&gt; Implements
&nbsp;     * &lt;code&gt;ConnectionHandler&lt;/code&gt;.
&nbsp;     *
&nbsp;     * @param id - the &lt;code&gt;int&lt;/code&gt; ID the connection that received the
&nbsp;     *            packet.
&nbsp;     * @param packet - the &lt;code&gt;Packet&lt;/code&gt; to be processed.
&nbsp;     */
&nbsp;    public synchronized void handle(int id, Packet packet) {
<b class="nc">&nbsp;        System.out.print(&quot;Connection #&quot;);</b>
<b class="nc">&nbsp;        System.out.print(id);</b>
<b class="nc">&nbsp;        System.out.print(&quot;, received a &quot;);</b>
<b class="nc">&nbsp;        if (null == packet) {</b>
<b class="nc">&nbsp;            System.out.print(&quot;null&quot;);</b>
&nbsp;        } else {
<b class="nc">&nbsp;            switch (packet.getCommand()) {</b>
&nbsp;                case Packet.COMMAND_SERVER_GREETING:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SERVER_GREETING&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_CLIENT_NAME:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_CLIENT_NAME&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_LOCAL_PN:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_LOCAL_PN&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_PLAYER_ADD:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_PLAYER_ADD&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_PLAYER_REMOVE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_PLAYER_REMOVE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_PLAYER_UPDATE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_PLAYER_UPDATE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_PLAYER_READY:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_PLAYER_READY&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_CHAT:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_CHAT&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_ADD:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_ADD&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_REMOVE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_REMOVE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_MOVE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_MOVE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_DEPLOY:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_DEPLOY&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_ATTACK:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_ATTACK&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_UPDATE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_UPDATE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_MODECHANGE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_MODECHANGE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_MOUNTED_FACINGCHANGE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_MOUNTED_FACINGCHANGE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_AMMOCHANGE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_AMMOCHANGE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ENTITY_VISIBILITY_INDICATOR:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ENTITY_VISIBILITY_INDICATOR&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_CHANGE_HEX:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_CHANGE_HEX&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_BLDG_ADD:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_BLDG_ADD&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_BLDG_REMOVE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_BLDG_REMOVE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_BLDG_UPDATE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_BLDG_UPDATE_CF&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_BLDG_COLLAPSE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_BLDG_COLLAPSE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_PHASE_CHANGE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_PHASE_CHANGE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_TURN:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_TURN&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_ROUND_UPDATE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_ROUND_UPDATE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_BOARD:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_BOARD&quot;);</b>
&nbsp;                    /*
&nbsp;                     * * Save the board here.
&nbsp;                     */
<b class="nc">&nbsp;                    Board recvBoard = (Board) packet.getObject(0);</b>
<b class="nc">&nbsp;                    try(OutputStream os = new FileOutputStream(&quot;xmit.board&quot;)) { //$NON-NLS-1$</b>
<b class="nc">&nbsp;                        recvBoard.save(os);</b>
<b class="nc">&nbsp;                    } catch (IOException ioErr) {</b>
<b class="nc">&nbsp;                        ioErr.printStackTrace();</b>
<b class="nc">&nbsp;                    }</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_ENTITIES:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_ENTITIES&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_PLAYERS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_PLAYERS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_TURNS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_TURNS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_REPORTS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_REPORTS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_GAME_SETTINGS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_GAME_SETTINGS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_MAP_SETTINGS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_MAP_SETTINGS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_MAP_DIMENSIONS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_MAP_SETTINGS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_END_OF_GAME:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_END_OF_GAME&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_DEPLOY_MINEFIELDS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_DEPLOY_MINEFIELDS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_REVEAL_MINEFIELD:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_REVEAL_MINEFIELD&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_REMOVE_MINEFIELD:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_REMOVE_MINEFIELD&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SENDING_MINEFIELDS:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SENDING_MINEFIELDS&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_REROLL_INITIATIVE:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_REROLL_INITIATIVE&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case Packet.COMMAND_SET_ARTYAUTOHITHEXES:
<b class="nc">&nbsp;                    System.out.print(&quot;COMMAND_SET_ARTYAUTOHITHEXES&quot;);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    System.out.print(&quot;unknown&quot;);</b>
&nbsp;                    break;
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        System.out.println(&quot; packet.&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Called when it is sensed that a connection has terminated. &lt;p/&gt;
&nbsp;     * Implements &lt;code&gt;ConnectionHandler&lt;/code&gt;.
&nbsp;     *
&nbsp;     * @param deadConn - the &lt;code&gt;Connection&lt;/code&gt; that has terminated.
&nbsp;     */
&nbsp;    public synchronized void disconnected(IConnection deadConn) {
&nbsp;        // write something in the log
<b class="nc">&nbsp;        System.out.println(&quot;s: connection &quot; + deadConn.getId() + &quot; disconnected&quot;);</b>
&nbsp;
&nbsp;        // kill the connection and remove it from any lists it might be on
<b class="nc">&nbsp;        panXmit.setEnabled(false);</b>
<b class="nc">&nbsp;        butSend.setEnabled(false);</b>
<b class="nc">&nbsp;        boardName.setText(&quot;&quot;);</b>
<b class="nc">&nbsp;        board = null;</b>
<b class="nc">&nbsp;        deadConn = null;</b>
<b class="nc">&nbsp;        panConnect.setEnabled(true);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    private ConnectionListenerAdapter connectionListener = new ConnectionListenerAdapter() {</b>
&nbsp;
&nbsp;        /**
&nbsp;         * Called when it is sensed that a connection has terminated.
&nbsp;         */
&nbsp;        @Override
&nbsp;        public void disconnected(DisconnectedEvent e) {
<b class="nc">&nbsp;            PacketTool.this.disconnected(e.getConnection());</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public void packetReceived(PacketReceivedEvent e) {
<b class="nc">&nbsp;            PacketTool.this.handle(e.getConnection().getId(), e.getPacket());</b>
&nbsp;        }
&nbsp;
&nbsp;    };
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
