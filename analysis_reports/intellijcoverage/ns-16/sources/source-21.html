


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > SkinXMLHandler</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.client.ui.swing.widget</a>
</div>

<h1>Coverage Summary for Class: SkinXMLHandler (megamek.client.ui.swing.widget)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SkinXMLHandler</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/18)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/496)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp;* MegaMek -
&nbsp;* Copyright (C) 2000, 2001, 2002, 2003, 2004, 2006 Ben Mazur (bmazur@sev.org)
&nbsp;* Copyright (C) 2015 Nicholas Walczak (walczak@cs.umn.edu)
&nbsp;* Copyright (C) 2018 The MegaMek Team
&nbsp;*
&nbsp;* This program is free software; you can redistribute it and/or modify it under
&nbsp;* the terms of the GNU General Public License as published by the Free Software
&nbsp;* Foundation; either version 2 of the License, or (at your option) any later
&nbsp;* version.
&nbsp;*
&nbsp;* This program is distributed in the hope that it will be useful, but WITHOUT
&nbsp;* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
&nbsp;* FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
&nbsp;* details.
&nbsp;*/
&nbsp;
&nbsp;package megamek.client.ui.swing.widget;
&nbsp;
&nbsp;import java.awt.Color;
&nbsp;import java.io.BufferedWriter;
&nbsp;import java.io.File;
&nbsp;import java.io.FileOutputStream;
&nbsp;import java.io.IOException;
&nbsp;import java.io.OutputStreamWriter;
&nbsp;import java.io.Writer;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Set;
&nbsp;import java.util.HashMap;
&nbsp;import java.util.Map;
&nbsp;
&nbsp;
&nbsp;import javax.xml.parsers.DocumentBuilder;
&nbsp;
&nbsp;import megamek.client.ui.swing.GUIPreferences;
&nbsp;import megamek.client.ui.swing.widget.SkinSpecification.UIComponents;
&nbsp;import megamek.common.Configuration;
&nbsp;import megamek.common.util.fileUtils.MegaMekFile;
&nbsp;import megamek.utils.MegaMekXmlUtil;
&nbsp;
&nbsp;import org.w3c.dom.Document;
&nbsp;import org.w3c.dom.Element;
&nbsp;import org.w3c.dom.NodeList;
&nbsp;
&nbsp;/**
&nbsp; * This class reads in an XML file that specifies different aspects of the
&nbsp; * visual skin for Megamek.
&nbsp; *
&nbsp; * @author arlith
&nbsp; *
&nbsp; */
<b class="nc">&nbsp;public class SkinXMLHandler {</b>
&nbsp;
<b class="nc">&nbsp;    public static String SKIN_FOOTER = &quot;&lt;/skin&gt;&quot;;</b>
&nbsp;    public static String SKIN_HEADER;
&nbsp;
&nbsp;    static {
<b class="nc">&nbsp;        StringBuffer sb = new StringBuffer();</b>
<b class="nc">&nbsp;        sb.append(&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;&lt;!--\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;  This is the default skin for Megamek\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;  New skins can be created by specifying UI_Element tags\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;  The defaultElement UI_Element specifies the default border to be used by UI\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;    components\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;  The defaultButton UI_Element specifies the default border and background\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;   images to use for Megamek buttons.  The first image is the base default\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;   image and the second image is the pressed image\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;  NOTE: All locations should be in data/images/widgets\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;--&gt;\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;&lt;skin xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot;\n&quot;);</b>
<b class="nc">&nbsp;        sb.append(&quot;    xsi:noNamespaceSchemaLocation=\&quot;skinSchema.xsl\&quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;        SKIN_HEADER = sb.toString();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * The file name for the default Skin XML file, found in the config dir.
&nbsp;     */
<b class="nc">&nbsp;    public static String defaultSkinXML = &quot;defaultSkin.xml&quot;;</b>
&nbsp;
&nbsp;    // General XML Tags
<b class="nc">&nbsp;    public static String UI_ELEMENT = &quot;UI_Element&quot;;</b>
<b class="nc">&nbsp;    public static String NAME = &quot;name&quot;;</b>
&nbsp;
&nbsp;    // Skin Specification XML Tags
&nbsp;    public static final String FONT_COLOR = &quot;font_color&quot;; //$NON-NLS-1$
&nbsp;    public static final String BORDER = &quot;border&quot;; //$NON-NLS-1$
&nbsp;    public static final String PLAIN = &quot;plain&quot;; //$NON-NLS-1$
&nbsp;    public static final String NO_BORDER = &quot;no_border&quot;; //$NON-NLS-1$
&nbsp;    public static final String TILE_BACKGROUND = &quot;tile_background&quot;; //$NON-NLS-1$
&nbsp;    public static final String TR_CORNER = &quot;corner_top_right&quot;; //$NON-NLS-1$
&nbsp;    public static final String TL_CORNER = &quot;corner_top_left&quot;; //$NON-NLS-1$
&nbsp;    public static final String BR_CORNER = &quot;corner_bottom_right&quot;; //$NON-NLS-1$
&nbsp;    public static final String BL_CORNER = &quot;corner_bottom_left&quot;; //$NON-NLS-1$
&nbsp;    public static final String EDGE = &quot;edge&quot;; //$NON-NLS-1$
&nbsp;    public static final String EDGE_NAME = &quot;edgeName&quot;; //$NON-NLS-1$
&nbsp;    public static final String EDGE_ICON = &quot;edgeIcon&quot;; //$NON-NLS-1$
&nbsp;    public static final String ICON = &quot;icon&quot;; //$NON-NLS-1$
&nbsp;    public static final String TILED = &quot;tiled&quot;; //$NON-NLS-1$
&nbsp;    public static final String TOP_LINE = &quot;line_top&quot;; //$NON-NLS-1$
&nbsp;    public static final String BOTTOM_LINE = &quot;line_bottom&quot;; //$NON-NLS-1$
&nbsp;    public static final String RIGHT_LINE = &quot;line_right&quot;; //$NON-NLS-1$
&nbsp;    public static final String LEFT_LINE = &quot;line_left&quot;; //$NON-NLS-1$
&nbsp;    public static final String BACKGROUND_IMAGE = &quot;background_image&quot;; //$NON-NLS-1$
&nbsp;    public static final String SHOW_SCROLL_BARS = &quot;show_scroll_bars&quot;; //$NON-NLS-1$
&nbsp;    public static final String SHOULD_BOLD = &quot;should_bold_mouseover&quot;; //$NON-NLS-1$
&nbsp;    public static final String FONT_NAME = &quot;font_name&quot;; //$NON-NLS-1$
&nbsp;    public static final String FONT_SIZE = &quot;font_size&quot;; //$NON-NLS-1$
&nbsp;
&nbsp;    // Unit Display Skin Specification XML tags
&nbsp;    public static final String GeneralTabIdle = &quot;tab_general_idle&quot;; //$NON-NLS-1$
&nbsp;    public static final String PilotTabIdle = &quot;tab_pilot_idle&quot;; //$NON-NLS-1$
&nbsp;    public static final String ArmorTabIdle = &quot;tab_armor_idle&quot;; //$NON-NLS-1$
&nbsp;    public static final String SystemsTabIdle = &quot;tab_systems_idle&quot;; //$NON-NLS-1$
&nbsp;    public static final String WeaponsTabIdle = &quot;tab_weapon_idle&quot;; //$NON-NLS-1$
&nbsp;    public static final String ExtrasTabIdle = &quot;tab_extras_idle&quot;; //$NON-NLS-1$
&nbsp;    public static final String GeneralTabActive = &quot;tab_general_active&quot;; //$NON-NLS-1$
&nbsp;    public static final String PilotTabActive = &quot;tab_pilot_active&quot;; //$NON-NLS-1$
&nbsp;    public static final String ArmorTabActive = &quot;tab_armor_active&quot;; //$NON-NLS-1$
&nbsp;    public static final String SystemsTabActive = &quot;tab_systems_active&quot;; //$NON-NLS-1$
&nbsp;    public static final String WeaponsTabActive = &quot;tab_weapon_active&quot;; //$NON-NLS-1$
&nbsp;    public static final String ExtraTabActive = &quot;tab_extras_active&quot;; //$NON-NLS-1$
&nbsp;    public static final String CornerIdle = &quot;idle_corner&quot;; //$NON-NLS-1$
&nbsp;    public static final String CornerActive = &quot;active_corner&quot;; //$NON-NLS-1$
&nbsp;
&nbsp;    public static final String BackgroundTile = &quot;background_tile&quot;; //$NON-NLS-1$
&nbsp;    public static final String TopLine = &quot;top_line&quot;; //$NON-NLS-1$
&nbsp;    public static final String BottomLine = &quot;bottom_line&quot;; //$NON-NLS-1$
&nbsp;    public static final String LeftLine = &quot;left_line&quot;; //$NON-NLS-1$
&nbsp;    public static final String RightLine = &quot;right_line&quot;; //$NON-NLS-1$
&nbsp;    public static final String TopLeftCorner = &quot;tl_corner&quot;; //$NON-NLS-1$
&nbsp;    public static final String BottomLeftCorner = &quot;bl_corner&quot;; //$NON-NLS-1$
&nbsp;    public static final String TopRightCorner = &quot;tr_corner&quot;; //$NON-NLS-1$
&nbsp;    public static final String BottomRightCorner = &quot;br_corner&quot;; //$NON-NLS-1$
&nbsp;
&nbsp;    public static final String MechOutline = &quot;mech_outline&quot;; //$NON-NLS-1$
&nbsp;
&nbsp;    private static Map&lt;String, SkinSpecification&gt; skinSpecs;
&nbsp;
<b class="nc">&nbsp;    private static UnitDisplaySkinSpecification udSpec = null;</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Checks whether the given path points to a file that is a valid skin
&nbsp;     * specification.
&nbsp;     *
&nbsp;     * @param fileName
&nbsp;     * @return
&nbsp;     */
&nbsp;    public static boolean validSkinSpecFile(String fileName) {
<b class="nc">&nbsp;        File file = new MegaMekFile(Configuration.skinsDir(), fileName).getFile();</b>
<b class="nc">&nbsp;        if (!file.exists() || !file.isFile()) {</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        try {
<b class="nc">&nbsp;            DocumentBuilder builder = MegaMekXmlUtil.newSafeDocumentBuilder();</b>
<b class="nc">&nbsp;            Document doc = builder.parse(file);</b>
&nbsp;            // TODO: Just validate against the XSD
&nbsp;            // Until that&#39;s done, just assume anything with UI_ELEMENT tags is
&nbsp;            //  valid
<b class="nc">&nbsp;            NodeList listOfComponents = doc.getElementsByTagName(UI_ELEMENT);</b>
<b class="nc">&nbsp;            if (listOfComponents.getLength() &gt; 0) {</b>
<b class="nc">&nbsp;                return true;</b>
&nbsp;            } else {
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Initializes using the default skin file.
&nbsp;     * @throws IOException
&nbsp;     */
&nbsp;    public static boolean initSkinXMLHandler() {
<b class="nc">&nbsp;        String skinFilePath = GUIPreferences.getInstance().getSkinFile();</b>
<b class="nc">&nbsp;        return initSkinXMLHandler(skinFilePath);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Initializes using the supplied skin file.
&nbsp;     * @throws IOException
&nbsp;     */
&nbsp;    public synchronized static boolean initSkinXMLHandler(String fileName) {
&nbsp;        // Reset UnitDisplay spec
<b class="nc">&nbsp;        udSpec = null;</b>
&nbsp;
<b class="nc">&nbsp;        if (fileName == null) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;ERROR: Bad skin specification file: &quot; +</b>
&nbsp;                    &quot;null filename!&quot;);
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        File file = new MegaMekFile(Configuration.skinsDir(), fileName).getFile();</b>
<b class="nc">&nbsp;        if (!file.exists() || !file.isFile()) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;ERROR: Bad skin specification file: &quot; +</b>
&nbsp;                    &quot;file doesn&#39;t exist!  File name: &quot; + fileName);
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;
&nbsp;        // Build the XML document.
&nbsp;        try {
<b class="nc">&nbsp;            DocumentBuilder builder = MegaMekXmlUtil.newSafeDocumentBuilder();</b>
<b class="nc">&nbsp;            System.out.println(&quot;Parsing &quot; + file.getName());</b>
<b class="nc">&nbsp;            Document doc = builder.parse(file);</b>
<b class="nc">&nbsp;            System.out.println(&quot;Parsing finished.&quot;);</b>
&nbsp;
&nbsp;            // Get the list of units.
<b class="nc">&nbsp;            NodeList listOfComponents = doc.getElementsByTagName(UI_ELEMENT);</b>
<b class="nc">&nbsp;            int totalComponents = listOfComponents.getLength();</b>
<b class="nc">&nbsp;            skinSpecs = new HashMap&lt;String, SkinSpecification&gt;(</b>
&nbsp;                    (int)(totalComponents * 1.25));
<b class="nc">&nbsp;            for (int comp = 0; comp &lt; totalComponents; comp++) {</b>
<b class="nc">&nbsp;                Element borderList = (Element) listOfComponents.item(comp);</b>
&nbsp;
<b class="nc">&nbsp;                String name = borderList.getElementsByTagName(NAME).</b>
<b class="nc">&nbsp;                        item(0).getTextContent();</b>
&nbsp;
<b class="nc">&nbsp;                if (name.equals(SkinSpecification.UIComponents.UnitDisplay.getComp())) {</b>
<b class="nc">&nbsp;                    parseUnitDisplaySkinSpec(borderList);</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;
&nbsp;                SkinSpecification skinSpec;
&nbsp;                // Parse no border
<b class="nc">&nbsp;                Element noBorderEle = (Element) borderList</b>
<b class="nc">&nbsp;                        .getElementsByTagName(NO_BORDER).item(0);</b>
<b class="nc">&nbsp;                boolean noBorder = false;</b>
<b class="nc">&nbsp;                if (noBorderEle != null) {</b>
<b class="nc">&nbsp;                    noBorder = Boolean</b>
<b class="nc">&nbsp;                            .parseBoolean(noBorderEle.getTextContent());</b>
&nbsp;                }
&nbsp;
&nbsp;                // Get the first element of this node.
<b class="nc">&nbsp;                Element plainTag = (Element)</b>
<b class="nc">&nbsp;                        borderList.getElementsByTagName(PLAIN).item(0);</b>
&nbsp;                // If there is no plain tag, load the icons
<b class="nc">&nbsp;                if (plainTag == null &amp;&amp; !noBorder) {</b>
&nbsp;                    // Get the border specs
<b class="nc">&nbsp;                    Element border = (Element)</b>
<b class="nc">&nbsp;                            borderList.getElementsByTagName(BORDER).item(0);</b>
<b class="nc">&nbsp;                    if (border == null) {</b>
<b class="nc">&nbsp;                        System.err.println(&quot;Missing &lt;&quot; + BORDER +</b>
&nbsp;                                &quot;&gt; tag in element #&quot; + comp);
<b class="nc">&nbsp;                        continue;</b>
&nbsp;                    }
&nbsp;
<b class="nc">&nbsp;                    skinSpec = parseBorderTag(name, border);</b>
<b class="nc">&nbsp;                } else { // Plain skin, no icons</b>
<b class="nc">&nbsp;                    skinSpec = new SkinSpecification(name);</b>
<b class="nc">&nbsp;                    skinSpec.noBorder = noBorder;</b>
&nbsp;                }
&nbsp;
&nbsp;                // Get the background specs
<b class="nc">&nbsp;                if (plainTag == null) {</b>
<b class="nc">&nbsp;                    NodeList backgrounds =</b>
<b class="nc">&nbsp;                            borderList.getElementsByTagName(BACKGROUND_IMAGE);</b>
<b class="nc">&nbsp;                    if (backgrounds != null){</b>
<b class="nc">&nbsp;                        for (int bg = 0; bg &lt; backgrounds.getLength(); bg++){</b>
<b class="nc">&nbsp;                            skinSpec.backgrounds.add(</b>
<b class="nc">&nbsp;                                    backgrounds.item(bg).getTextContent());</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
&nbsp;
&nbsp;                // Parse show scroll bars
<b class="nc">&nbsp;                Element showScrollEle = (Element) borderList</b>
<b class="nc">&nbsp;                        .getElementsByTagName(SHOW_SCROLL_BARS).item(0);</b>
<b class="nc">&nbsp;                if (showScrollEle != null) {</b>
<b class="nc">&nbsp;                    skinSpec.showScrollBars = Boolean</b>
<b class="nc">&nbsp;                            .parseBoolean(showScrollEle.getTextContent());</b>
&nbsp;                }
&nbsp;
&nbsp;                // Parse show should bold
<b class="nc">&nbsp;                Element shouldBoldEle = (Element) borderList</b>
<b class="nc">&nbsp;                        .getElementsByTagName(SHOULD_BOLD).item(0);</b>
<b class="nc">&nbsp;                if (shouldBoldEle != null) {</b>
<b class="nc">&nbsp;                    skinSpec.shouldBoldMouseOver = Boolean</b>
<b class="nc">&nbsp;                            .parseBoolean(shouldBoldEle.getTextContent());</b>
&nbsp;                }
&nbsp;
&nbsp;                // Parse font name
<b class="nc">&nbsp;                Element fontNameEle = (Element) borderList</b>
<b class="nc">&nbsp;                        .getElementsByTagName(FONT_NAME).item(0);</b>
<b class="nc">&nbsp;                if (fontNameEle != null) {</b>
<b class="nc">&nbsp;                    skinSpec.fontName = fontNameEle.getTextContent();</b>
&nbsp;                }
&nbsp;
&nbsp;                // Parse font size
<b class="nc">&nbsp;                Element fontSizeEle = (Element) borderList</b>
<b class="nc">&nbsp;                        .getElementsByTagName(FONT_SIZE).item(0);</b>
<b class="nc">&nbsp;                if (fontSizeEle != null) {</b>
<b class="nc">&nbsp;                    skinSpec.fontSize = Integer.parseInt(fontSizeEle.getTextContent());</b>
&nbsp;                }
&nbsp;
&nbsp;                // Parse font colors
<b class="nc">&nbsp;                NodeList fontColors = borderList</b>
<b class="nc">&nbsp;                        .getElementsByTagName(FONT_COLOR);</b>
<b class="nc">&nbsp;                if (fontColors.getLength() &gt; 0) {</b>
<b class="nc">&nbsp;                    skinSpec.fontColors.clear();</b>
<b class="nc">&nbsp;                    for (int fc = 0; fc &lt; fontColors.getLength(); fc++) {</b>
<b class="nc">&nbsp;                        String fontColorContent = fontColors.item(fc)</b>
<b class="nc">&nbsp;                                .getTextContent();</b>
<b class="nc">&nbsp;                        skinSpec.fontColors.add(Color.decode(fontColorContent));</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
&nbsp;                // Parse tile background
<b class="nc">&nbsp;                Element tileBGEle = (Element) borderList</b>
<b class="nc">&nbsp;                        .getElementsByTagName(TILE_BACKGROUND).item(0);</b>
<b class="nc">&nbsp;                if (tileBGEle != null) {</b>
<b class="nc">&nbsp;                    skinSpec.tileBackground = Boolean</b>
<b class="nc">&nbsp;                            .parseBoolean(tileBGEle.getTextContent());</b>
&nbsp;                }
&nbsp;
<b class="nc">&nbsp;                if (SkinSpecification.UIComponents.getUIComponent(name) == null) {</b>
<b class="nc">&nbsp;                    System.out.println(&quot;SKIN ERROR: &quot;</b>
&nbsp;                            + &quot;Unable to add unrecognized UI component: &quot;
&nbsp;                            + name + &quot;!&quot;);
&nbsp;                } else {
<b class="nc">&nbsp;                    skinSpecs.put(name, skinSpec);</b>
&nbsp;                }
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (!skinSpecs.containsKey(UIComponents.DefaultUIElement.getComp())</b>
<b class="nc">&nbsp;                    || !skinSpecs.containsKey(UIComponents.DefaultButton.getComp())) {</b>
<b class="nc">&nbsp;                System.out.println(&quot;SKIN ERROR: Bad skin specification file: &quot; +</b>
&nbsp;                        &quot;file doesn&#39;t specify &quot; + UIComponents.DefaultUIElement +
&nbsp;                        &quot; or &quot; + UIComponents.DefaultButton + &quot;!&quot;);
<b class="nc">&nbsp;                return false;</b>
&nbsp;            }
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            System.out.println(e.getMessage());</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;            return false;</b>
<b class="nc">&nbsp;        }</b>
&nbsp;        // Skin spec didn&#39;t specify UnitDisplay skin, use default
<b class="nc">&nbsp;        if (udSpec == null) {</b>
<b class="nc">&nbsp;            udSpec = new UnitDisplaySkinSpecification();</b>
&nbsp;        }
<b class="nc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     *  Create a new SkinSpecification and populate it from the supplied border
&nbsp;     *  tag
&nbsp;     *
&nbsp;     * @param border
&nbsp;     * @return
&nbsp;     */
&nbsp;    private static SkinSpecification parseBorderTag(String compName, Element border){
<b class="nc">&nbsp;        SkinSpecification skinSpec = new SkinSpecification(compName);</b>
&nbsp;
&nbsp;        // Parse Corner Icons
<b class="nc">&nbsp;        skinSpec.tr_corner = border.getElementsByTagName(TR_CORNER).</b>
<b class="nc">&nbsp;                item(0).getTextContent();</b>
<b class="nc">&nbsp;        skinSpec.tl_corner = border.getElementsByTagName(TL_CORNER).</b>
<b class="nc">&nbsp;                item(0).getTextContent();</b>
<b class="nc">&nbsp;        skinSpec.br_corner = border.getElementsByTagName(BR_CORNER).</b>
<b class="nc">&nbsp;                item(0).getTextContent();</b>
<b class="nc">&nbsp;        skinSpec.bl_corner = border.getElementsByTagName(BL_CORNER).</b>
<b class="nc">&nbsp;                item(0).getTextContent();</b>
&nbsp;
&nbsp;        // Parse Edge Icons from Edge tag
<b class="nc">&nbsp;        NodeList edgeNodes = border.getElementsByTagName(EDGE);</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; edgeNodes.getLength(); i++){</b>
&nbsp;            // An edge tag will have some number of icons
<b class="nc">&nbsp;            ArrayList&lt;String&gt; icons = new ArrayList&lt;String&gt;();</b>
&nbsp;            // And icon can be tiled or static
<b class="nc">&nbsp;            ArrayList&lt;Boolean&gt; shouldTile = new ArrayList&lt;Boolean&gt;();</b>
<b class="nc">&nbsp;            NodeList edgeIcons = ((Element) edgeNodes.item(i))</b>
<b class="nc">&nbsp;                    .getElementsByTagName(EDGE_ICON);</b>
&nbsp;            // Iterate through each icon/tiled pair
<b class="nc">&nbsp;            for (int j = 0; j &lt; edgeIcons.getLength(); j++){</b>
<b class="nc">&nbsp;                String icon = ((Element) edgeIcons.item(j))</b>
<b class="nc">&nbsp;                        .getElementsByTagName(ICON).item(0).getTextContent();</b>
<b class="nc">&nbsp;                String tiled = ((Element) edgeIcons.item(j))</b>
<b class="nc">&nbsp;                        .getElementsByTagName(TILED).item(0).getTextContent();</b>
&nbsp;
<b class="nc">&nbsp;                if (icon == null){</b>
<b class="nc">&nbsp;                    System.err.println(&quot;Missing &lt;&quot; + ICON + &quot;&gt; tag&quot;);</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                if (tiled == null){</b>
<b class="nc">&nbsp;                    System.err.println(&quot;Missing &lt;&quot; + TILED + &quot;&gt; tag&quot;);</b>
<b class="nc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="nc">&nbsp;                icons.add(icon);</b>
<b class="nc">&nbsp;                shouldTile.add(tiled.equalsIgnoreCase(&quot;true&quot;));</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            String edgeName = ((Element) edgeNodes.item(i))</b>
<b class="nc">&nbsp;                    .getElementsByTagName(EDGE_NAME).item(0).getTextContent();</b>
&nbsp;
<b class="nc">&nbsp;            if (edgeName == null){</b>
<b class="nc">&nbsp;                System.err.println(&quot;Missing &lt;&quot; + EDGE_NAME + &quot;&gt; tag&quot;);</b>
<b class="nc">&nbsp;                continue;</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            if (edgeName.equals(&quot;top&quot;)){</b>
<b class="nc">&nbsp;                skinSpec.topEdge = icons;</b>
<b class="nc">&nbsp;                skinSpec.topShouldTile = shouldTile;</b>
<b class="nc">&nbsp;            } else if (edgeName.equals(&quot;bottom&quot;)){</b>
<b class="nc">&nbsp;                skinSpec.bottomEdge = icons;</b>
<b class="nc">&nbsp;                skinSpec.bottomShouldTile = shouldTile;</b>
<b class="nc">&nbsp;            } else if (edgeName.equals(&quot;left&quot;)){</b>
<b class="nc">&nbsp;                skinSpec.leftEdge = icons;</b>
<b class="nc">&nbsp;                skinSpec.leftShouldTile = shouldTile;</b>
<b class="nc">&nbsp;            } else if (edgeName.equals(&quot;right&quot;)){</b>
<b class="nc">&nbsp;                skinSpec.rightEdge = icons;</b>
<b class="nc">&nbsp;                skinSpec.rightShouldTile = shouldTile;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return skinSpec;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Given a UI_Component component with a UnitDisplay name, parse it into
&nbsp;     * a new UnitDisplaySkinSpecification.  This tupe of UI_Element has a
&nbsp;     * different structure than other UI_Elements.
&nbsp;     *
&nbsp;     * @param border
&nbsp;     */
&nbsp;    private static void parseUnitDisplaySkinSpec(Element border) {
<b class="nc">&nbsp;        udSpec = new UnitDisplaySkinSpecification();</b>
&nbsp;
<b class="nc">&nbsp;        if (border.getElementsByTagName(GeneralTabIdle).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setGeneralTabIdle(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(GeneralTabIdle).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(PilotTabIdle).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setPilotTabIdle(border.getElementsByTagName(PilotTabIdle)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(ArmorTabIdle).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setArmorTabIdle(border.getElementsByTagName(ArmorTabIdle)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(SystemsTabIdle).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setSystemsTabIdle(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(SystemsTabIdle).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(WeaponsTabIdle).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setWeaponsTabIdle(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(WeaponsTabIdle).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(ExtrasTabIdle).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setExtrasTabIdle(border.getElementsByTagName(ExtrasTabIdle)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(GeneralTabActive).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setGeneralTabActive(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(GeneralTabActive).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(PilotTabActive).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setPilotTabActive(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(PilotTabActive).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(ArmorTabActive).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setArmorTabActive(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(ArmorTabActive).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(SystemsTabActive).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setSystemsTabActive(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(SystemsTabActive).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(WeaponsTabActive).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setWeaponsTabActive(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(WeaponsTabActive).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(ExtraTabActive).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setExtraTabActive(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(ExtraTabActive).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(CornerIdle).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setCornerIdle(border.getElementsByTagName(CornerIdle)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(CornerActive).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setCornerActive(border.getElementsByTagName(CornerActive)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (border.getElementsByTagName(BackgroundTile).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setBackgroundTile(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(BackgroundTile).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(TopLine).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setTopLine(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(TopLine).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(BottomLine).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setBottomLine(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(BottomLine).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(LeftLine).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setLeftLine(border.getElementsByTagName(LeftLine)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(RightLine).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setRightLine(border.getElementsByTagName(RightLine)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(TopLeftCorner).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setTopLeftCorner(border.getElementsByTagName(TopLeftCorner)</b>
<b class="nc">&nbsp;                    .item(0).getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(BottomLeftCorner).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setBottomLeftCorner(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(BottomLeftCorner).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(TopRightCorner).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setTopRightCorner(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(TopRightCorner).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
<b class="nc">&nbsp;        if (border.getElementsByTagName(BottomRightCorner).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setBottomRightCorner(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(BottomRightCorner).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        if (border.getElementsByTagName(MechOutline).getLength() &gt; 0) {</b>
<b class="nc">&nbsp;            udSpec.setMechOutline(border</b>
<b class="nc">&nbsp;                    .getElementsByTagName(MechOutline).item(0)</b>
<b class="nc">&nbsp;                    .getTextContent());</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Writes the current skin to the specified XML file.
&nbsp;     *
&nbsp;     * @param filename
&nbsp;     */
&nbsp;    public static void writeSkinToFile(String filename) {
<b class="nc">&nbsp;        File filePath = new MegaMekFile(Configuration.skinsDir(),</b>
<b class="nc">&nbsp;                filename).getFile();</b>
&nbsp;
<b class="nc">&nbsp;        try (Writer output = new BufferedWriter(new OutputStreamWriter(</b>
&nbsp;                new FileOutputStream(filePath)));){
<b class="nc">&nbsp;            output.write(SKIN_HEADER);</b>
<b class="nc">&nbsp;            for (String component : skinSpecs.keySet()) {</b>
<b class="nc">&nbsp;                writeSkinComponent(component, output);</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;            if (udSpec != null) {</b>
<b class="nc">&nbsp;                writeUnitDisplaySkinSpec(output);</b>
&nbsp;            }
<b class="nc">&nbsp;            output.write(SKIN_FOOTER);</b>
<b class="nc">&nbsp;            output.close();</b>
<b class="nc">&nbsp;        } catch (IOException e) {</b>
<b class="nc">&nbsp;            System.out.println(e.getMessage());</b>
<b class="nc">&nbsp;            e.printStackTrace();</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Helper method for writing the UI_Element tag related to a
&nbsp;     * UnitDisplaySkinSpecification.
&nbsp;     *
&nbsp;     * @param out
&nbsp;     * @throws IOException
&nbsp;     */
&nbsp;    private static void writeUnitDisplaySkinSpec(Writer out) throws IOException {
&nbsp;        // If the spec is null, nothing to do
<b class="nc">&nbsp;        if (udSpec == null) {</b>
&nbsp;            return;
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t&lt;&quot; + UI_ELEMENT + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Write Component name
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;&quot; + NAME + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(SkinSpecification.UIComponents.UnitDisplay.getComp());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + NAME + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + GeneralTabIdle + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getGeneralTabIdle());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + GeneralTabIdle + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + PilotTabIdle + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getPilotTabIdle());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + PilotTabIdle + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + ArmorTabIdle + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getArmorTabIdle());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + ArmorTabIdle + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + SystemsTabIdle + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getSystemsTabIdle());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + SystemsTabIdle + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + WeaponsTabIdle + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getWeaponsTabIdle());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + WeaponsTabIdle + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + ExtrasTabIdle + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getExtrasTabIdle());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + ExtrasTabIdle + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + GeneralTabActive + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getGeneralTabActive());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + GeneralTabActive + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + PilotTabActive + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getPilotTabActive());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + PilotTabActive + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + ArmorTabActive + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getArmorTabActive());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + ArmorTabActive + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + SystemsTabActive + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getSystemsTabActive());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + SystemsTabActive + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + WeaponsTabActive + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getWeaponsTabActive());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + WeaponsTabActive + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + ExtraTabActive + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getExtraTabActive());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + ExtraTabActive + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + CornerIdle + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getCornerIdle());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + CornerIdle + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + CornerActive + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getCornerActive());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + CornerActive + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + BackgroundTile + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getBackgroundTile());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + BackgroundTile + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + TopLine + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getTopLine());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + TopLine + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + BottomLine + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getBottomLine());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + BottomLine + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + LeftLine + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getLeftLine());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + LeftLine + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + RightLine + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getRightLine());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + RightLine + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + TopLeftCorner + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getTopLeftCorner());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + TopLeftCorner + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + BottomLeftCorner + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getBottomLeftCorner());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + BottomLeftCorner + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + TopRightCorner + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getTopRightCorner());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + TopRightCorner + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + BottomRightCorner + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getBottomRightCorner());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + BottomRightCorner + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + MechOutline + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(udSpec.getMechOutline());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + MechOutline + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Close UI_ELEMENT tag
<b class="nc">&nbsp;        out.write(&quot;\t&lt;/&quot; + UI_ELEMENT + &quot;&gt;\n\n&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Convenience method for writing out the UI_ELEMENT tag.
&nbsp;     * @param component
&nbsp;     * @param out
&nbsp;     * @throws IOException
&nbsp;     */
&nbsp;    private static void writeSkinComponent(String component, Writer out)
&nbsp;            throws IOException {
<b class="nc">&nbsp;        out.write(&quot;\t&lt;&quot; + UI_ELEMENT + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Write Component name
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;&quot; + NAME + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(component);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + NAME + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        SkinSpecification skinSpec = getSkin(component);</b>
&nbsp;
&nbsp;        // Write Border
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;&quot; + NO_BORDER + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(((Boolean)skinSpec.noBorder).toString());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + NO_BORDER + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;        writeBorder(skinSpec, out);</b>
&nbsp;
&nbsp;        // Write background
<b class="nc">&nbsp;        for (String bgImg : skinSpec.backgrounds) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t&lt;&quot; + BACKGROUND_IMAGE + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(bgImg);</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + BACKGROUND_IMAGE + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;&quot; + TILE_BACKGROUND + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(((Boolean)skinSpec.tileBackground).toString());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + TILE_BACKGROUND + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Write colors
<b class="nc">&nbsp;        for (Color fontColor : skinSpec.fontColors) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t&lt;&quot; + FONT_COLOR + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(&quot;#&quot;</b>
<b class="nc">&nbsp;                    + Integer.toHexString(fontColor.getRGB()).substring(2));</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + FONT_COLOR + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // Write show scroll bars
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;&quot; + SHOW_SCROLL_BARS + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(((Boolean)skinSpec.showScrollBars).toString());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + SHOW_SCROLL_BARS + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Write should bold mouseover
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;&quot; + SHOULD_BOLD + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(((Boolean)skinSpec.shouldBoldMouseOver).toString());</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + SHOULD_BOLD + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Write font name
<b class="nc">&nbsp;        if (skinSpec.fontName != null) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t&lt;&quot; + FONT_NAME + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(skinSpec.fontName);</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + FONT_NAME + &quot;&gt;\n&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Write font name
<b class="nc">&nbsp;        if (skinSpec.fontName != null) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t&lt;&quot; + FONT_SIZE + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(skinSpec.fontSize);</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + FONT_SIZE + &quot;&gt;\n&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Close UI_ELEMENT tag
<b class="nc">&nbsp;        out.write(&quot;\t&lt;/&quot; + UI_ELEMENT + &quot;&gt;\n\n&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Convenience method for writing out the BORDER element.
&nbsp;     *
&nbsp;     * @param skinSpec
&nbsp;     * @param out
&nbsp;     * @throws IOException
&nbsp;     */
&nbsp;    private static void writeBorder(SkinSpecification skinSpec, Writer out)
&nbsp;            throws IOException {
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;!-- Specification of border images --&gt;\n&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;&quot; + BORDER + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;!-- Corner images --&gt;\n&quot;);</b>
&nbsp;        // Top Left Corner
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + TL_CORNER + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(skinSpec.tl_corner);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + TL_CORNER + &quot;&gt;\n&quot;);</b>
&nbsp;        // Top Right Corner
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + TR_CORNER + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(skinSpec.tr_corner);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + TR_CORNER + &quot;&gt;\n&quot;);</b>
&nbsp;        // Bottom Left Corner
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + BL_CORNER + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(skinSpec.bl_corner);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + BL_CORNER + &quot;&gt;\n&quot;);</b>
&nbsp;        // Bottom Right Corner
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + BR_CORNER + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(skinSpec.br_corner);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + BR_CORNER + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Edges
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;!-- Border lines: these images will be tiled --&gt;\n&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + EDGE + &quot;&gt;\n&quot;);</b>
&nbsp;        // Top Edge
<b class="nc">&nbsp;        for (int i = 0; i &lt; skinSpec.topEdge.size(); i++) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Edge Icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + ICON + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(skinSpec.topEdge.get(i));</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Tile state of icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + TILED + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(((Boolean)skinSpec.topShouldTile.get(i)).toString());</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + TILED + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;/&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_NAME + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;top&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + EDGE_NAME + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;/&quot; + EDGE + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Bottom Edge
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + EDGE + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; skinSpec.bottomEdge.size(); i++) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Edge Icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + ICON + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(skinSpec.bottomEdge.get(i));</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Tile state of icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + TILED + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(((Boolean)skinSpec.bottomShouldTile.get(i)).toString());</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + TILED + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;/&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;        }
<b class="nc">&nbsp;        out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_NAME + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;bottom&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + EDGE_NAME + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;/&quot; + EDGE + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Left Edge
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + EDGE + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; skinSpec.leftEdge.size(); i++) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Edge Icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + ICON + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(skinSpec.leftEdge.get(i));</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Tile state of icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + TILED + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(((Boolean)skinSpec.leftShouldTile.get(i)).toString());</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + TILED + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;/&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;        }
<b class="nc">&nbsp;        out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_NAME + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;left&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + EDGE_NAME + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;/&quot; + EDGE + &quot;&gt;\n&quot;);</b>
&nbsp;
&nbsp;        // Right Edge
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;&quot; + EDGE + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; skinSpec.rightEdge.size(); i++) {</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Edge Icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + ICON + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(skinSpec.rightEdge.get(i));</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + ICON + &quot;&gt;\n&quot;);</b>
&nbsp;            // Tile state of icon
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t\t&lt;&quot; + TILED + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;            out.write(((Boolean)skinSpec.rightShouldTile.get(i)).toString());</b>
<b class="nc">&nbsp;            out.write(&quot;&lt;/&quot; + TILED + &quot;&gt;\n&quot;);</b>
<b class="nc">&nbsp;            out.write(&quot;\t\t\t\t&lt;/&quot; + EDGE_ICON + &quot;&gt;\n&quot;);</b>
&nbsp;        }
<b class="nc">&nbsp;        out.write(&quot;\t\t\t\t&lt;&quot; + EDGE_NAME + &quot;&gt;&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;right&quot;);</b>
<b class="nc">&nbsp;        out.write(&quot;&lt;/&quot; + EDGE_NAME + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t\t&lt;/&quot; + EDGE + &quot;&gt;\n&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        out.write(&quot;\t\t&lt;/&quot; + BORDER + &quot;&gt;\n&quot;);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static SkinSpecification getSkin(String component){
<b class="nc">&nbsp;        return getSkin(component,false, false);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static SkinSpecification getSkin(String component, boolean defaultToPlain){
<b class="nc">&nbsp;        return getSkin(component, defaultToPlain, false);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Returns the list of components that have SkinSpecifications.
&nbsp;     * @return
&nbsp;     */
&nbsp;    public synchronized static Set&lt;String&gt; getSkinnedComponents() {
<b class="nc">&nbsp;        return skinSpecs.keySet();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Get a &lt;code&gt;SkinSpecification&lt;/code&gt; for a given component.
&nbsp;     *
&nbsp;     * @param component
&nbsp;     *            The name of the component to get skin info for.
&nbsp;     * @param defaultToPlain
&nbsp;     *            Determines if a default component should be used if no match,
&nbsp;     *            or a plain component
&nbsp;     * @return
&nbsp;     */
&nbsp;    public synchronized static SkinSpecification getSkin(String component,
&nbsp;            boolean defaultToPlain, boolean isBtn){
<b class="nc">&nbsp;        if (skinSpecs == null ){</b>
<b class="nc">&nbsp;            boolean rv = initSkinXMLHandler();</b>
<b class="nc">&nbsp;            if (!rv) {</b>
&nbsp;                // This will return a blank skin spec file, which will act like
&nbsp;                // a plain skin.
<b class="nc">&nbsp;                return new SkinSpecification(&quot;Plain&quot;);</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        SkinSpecification spec = skinSpecs.get(component);</b>
<b class="nc">&nbsp;        if (spec == null){</b>
<b class="nc">&nbsp;            if (defaultToPlain) {</b>
<b class="nc">&nbsp;                spec = new SkinSpecification(&quot;Plain&quot;); //$NON-NLS-1$</b>
<b class="nc">&nbsp;            } else if (isBtn){</b>
<b class="nc">&nbsp;                spec = skinSpecs.get(UIComponents.DefaultButton.getComp());</b>
&nbsp;            } else {
<b class="nc">&nbsp;                spec = skinSpecs.get(UIComponents.DefaultUIElement.getComp());</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return spec;</b>
&nbsp;    }
&nbsp;
&nbsp;    public synchronized static UnitDisplaySkinSpecification getUnitDisplaySkin() {
<b class="nc">&nbsp;        if (udSpec == null) {</b>
<b class="nc">&nbsp;            boolean rv = initSkinXMLHandler();</b>
<b class="nc">&nbsp;            if (!rv || (udSpec == null)) {</b>
&nbsp;                // This will return a blank ud skin spec file, which will show
&nbsp;                // the default skin for the unit display
<b class="nc">&nbsp;                return new UnitDisplaySkinSpecification();</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return udSpec;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Adds a new component to the SkinSpecs map.
&nbsp;     *
&nbsp;     * @param component
&nbsp;     */
&nbsp;    public synchronized static void addNewComp(String component) {
<b class="nc">&nbsp;        if (skinSpecs == null ){</b>
<b class="nc">&nbsp;            boolean rv = initSkinXMLHandler();</b>
<b class="nc">&nbsp;            if (!rv) {</b>
&nbsp;                return ;
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        SkinSpecification newSpec = new SkinSpecification(component);</b>
<b class="nc">&nbsp;        skinSpecs.put(component, newSpec);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Remove the specified componenet from the SkinSpecs map.
&nbsp;     *
&nbsp;     * @param component
&nbsp;     */
&nbsp;    public synchronized static void removeComp(String component) {
<b class="nc">&nbsp;        skinSpecs.remove(component);</b>
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
