


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > TdbFile</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">megamek.common.loaders</a>
</div>

<h1>Coverage Summary for Class: TdbFile (megamek.common.loaders)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">TdbFile</td>
<td class="coverageStat">
  <span class="percent">
    83.3%
  </span>
  <span class="absValue">
    (5/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    56.3%
  </span>
  <span class="absValue">
    (116/206)
  </span>
</td>
</tr>
  <tr>
    <td class="name">TdbFile$BasicInformation</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$BooleanAdapter</td>
<td class="coverageStat">
  <span class="percent">
    66.7%
  </span>
  <span class="absValue">
    (2/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    66.7%
  </span>
  <span class="absValue">
    (2/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$Creator</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (4/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$CriticalDefinitions</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$CriticalSlot</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (13/13)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$Engine</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$HeatSink</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$Location</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (9/9)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$LocationAdapter</td>
<td class="coverageStat">
  <span class="percent">
    66.7%
  </span>
  <span class="absValue">
    (2/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    83.3%
  </span>
  <span class="absValue">
    (10/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$MountedItem</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$MountedItems</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$MovementModifier</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$Structure</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">TdbFile$Technology</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    86.7%
  </span>
  <span class="absValue">
    (26/30)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    65.3%
  </span>
  <span class="absValue">
    (179/274)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * MegaMek - Copyright (C) 2000-2004 Ben Mazur (bmazur@sev.org)
&nbsp; *
&nbsp; *  This program is free software; you can redistribute it and/or modify it
&nbsp; *  under the terms of the GNU General Public License as published by the Free
&nbsp; *  Software Foundation; either version 2 of the License, or (at your option)
&nbsp; *  any later version.
&nbsp; *
&nbsp; *  This program is distributed in the hope that it will be useful, but
&nbsp; *  WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
&nbsp; *  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License
&nbsp; *  for more details.
&nbsp; */
&nbsp;package megamek.common.loaders;
&nbsp;
&nbsp;import java.io.InputStream;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Collections;
&nbsp;import java.util.HashMap;
&nbsp;import java.util.List;
&nbsp;import java.util.Map;
&nbsp;import java.util.Objects;
&nbsp;
&nbsp;import javax.xml.bind.JAXBContext;
&nbsp;import javax.xml.bind.JAXBException;
&nbsp;import javax.xml.bind.Unmarshaller;
&nbsp;import javax.xml.bind.annotation.XmlAccessType;
&nbsp;import javax.xml.bind.annotation.XmlAccessorType;
&nbsp;import javax.xml.bind.annotation.XmlAttribute;
&nbsp;import javax.xml.bind.annotation.XmlElement;
&nbsp;import javax.xml.bind.annotation.XmlRootElement;
&nbsp;import javax.xml.bind.annotation.XmlType;
&nbsp;import javax.xml.bind.annotation.XmlValue;
&nbsp;import javax.xml.bind.annotation.adapters.XmlAdapter;
&nbsp;import javax.xml.bind.annotation.adapters.XmlJavaTypeAdapter;
&nbsp;import javax.xml.parsers.ParserConfigurationException;
&nbsp;
&nbsp;import org.xml.sax.SAXException;
&nbsp;
&nbsp;import megamek.common.BipedMech;
&nbsp;import megamek.common.Entity;
&nbsp;import megamek.common.EquipmentType;
&nbsp;import megamek.common.LocationFullException;
&nbsp;import megamek.common.Mech;
&nbsp;import megamek.common.MiscType;
&nbsp;import megamek.common.Mounted;
&nbsp;import megamek.common.QuadMech;
&nbsp;import megamek.common.TechConstants;
&nbsp;import megamek.common.WeaponType;
&nbsp;import megamek.utils.MegaMekXmlUtil;
&nbsp;
&nbsp;/**
&nbsp; * TdbFile.java
&nbsp; *  -based on MtfFile.java, modifications by Ryan McConnell
&nbsp; * Created on April 1, 2003, 2:48 PM
&nbsp; */
&nbsp;@XmlRootElement(name = &quot;mech&quot;)
&nbsp;@XmlAccessorType(XmlAccessType.NONE)
&nbsp;public class TdbFile implements IMechLoader {
&nbsp;
&nbsp;    private static final String DOUBLE = &quot;Double&quot;;
&nbsp;
&nbsp;    private static final int TECHYEAR = 3068; // TDB doesn&#39;t have era
&nbsp;
&nbsp;    @XmlElement
&nbsp;    private Creator creator;
&nbsp;    
&nbsp;    @XmlElement(name = &quot;basics&quot;)
&nbsp;    private BasicInformation basics;
&nbsp;    
&nbsp;    @XmlElement(name = &quot;mounteditems&quot;)
&nbsp;    MountedItems mounted;
&nbsp;    
&nbsp;    @XmlElement(name = &quot;critdefs&quot;)
&nbsp;    private CriticalDefinitions critdefs;
&nbsp;    
<b class="fc">&nbsp;    private Map&lt;EquipmentType, Mounted&gt; hSharedEquip = new HashMap&lt;&gt;();</b>
<b class="fc">&nbsp;    private List&lt;Mounted&gt; vSplitWeapons = new ArrayList&lt;&gt;();</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Creates new TdbFile.
&nbsp;     * 
&nbsp;     * @param is an input stream that contains a &quot;The Drawing Board&quot; generated XML file.
&nbsp;     * @return an instance of a parsed file
&nbsp;     * @throws megamek.common.loaders.EntityLoadingException
&nbsp;     */
&nbsp;    public static TdbFile getInstance(final InputStream is) throws EntityLoadingException {
&nbsp;        try {
<b class="fc">&nbsp;            JAXBContext jc = JAXBContext.newInstance(TdbFile.class);</b>
&nbsp;            
<b class="fc">&nbsp;            Unmarshaller um = jc.createUnmarshaller();</b>
<b class="fc">&nbsp;            TdbFile tdbFile = (TdbFile) um.unmarshal(MegaMekXmlUtil.createSafeXmlSource(is));</b>
&nbsp;            
<b class="fc">&nbsp;            return tdbFile;</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            throw new EntityLoadingException(&quot;   Failure to parse XML (&quot;</b>
<b class="nc">&nbsp;                    + e.getLocalizedMessage() + &quot;)&quot;, e);</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * JAXB required constructor.
&nbsp;     */
<b class="fc">&nbsp;    private TdbFile() {</b>
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    @Override
&nbsp;    public Entity getEntity() throws EntityLoadingException {
&nbsp;        try {
&nbsp;            Mech mech;
&nbsp;
<b class="fc">&nbsp;            if ((&quot;Unknown&quot;.equals(creator.creatorName))</b>
<b class="fc">&nbsp;                    || !&quot;The Drawing Board&quot;.equals(creator.creatorName)</b>
<b class="fc">&nbsp;                    || (Integer.parseInt(creator.creatorVersion) != 2)) {</b>
&nbsp;                // MegaMek no longer supports older versions of The
&nbsp;                // Drawing Board (pre 2.0.23) due to incomplete xml
&nbsp;                // file information in those versions.
<b class="nc">&nbsp;                throw new EntityLoadingException(</b>
&nbsp;                        &quot;This xml file is not a valid Drawing Board mech.  Make sure you are using version 2.0.23 or later of The Drawing Board.&quot;);
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            String gyroType = basics.structure.gyroType;</b>
<b class="fc">&nbsp;            if (&quot;Extra-Light&quot;.equals(gyroType)) {</b>
<b class="nc">&nbsp;                gyroType = &quot;XL&quot;;</b>
<b class="fc">&nbsp;            } else if (&quot;Heavy-Duty&quot;.equals(gyroType)) {</b>
<b class="nc">&nbsp;                gyroType = &quot;Heavy Duty&quot;;</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            String cockpitType = basics.structure.cockpitType;</b>
<b class="fc">&nbsp;            if (&quot;Torso-Mounted&quot;.equals(cockpitType)) {</b>
<b class="nc">&nbsp;                cockpitType = &quot;Torso Mounted&quot;;</b>
&nbsp;            }
&nbsp;            
<b class="fc">&nbsp;            if (&quot;Quad&quot;.equals(basics.chassisConfig)) {</b>
<b class="fc">&nbsp;                mech = new QuadMech(gyroType, cockpitType);</b>
&nbsp;            } else {
<b class="fc">&nbsp;                mech = new BipedMech(gyroType, cockpitType);</b>
&nbsp;            }
&nbsp;
&nbsp;            // aarg! those stupid sub-names in parenthesis screw everything up
&nbsp;            // we may do something different in the future, but for now, I&#39;m
&nbsp;            // going to strip them out
<b class="fc">&nbsp;            int pindex = basics.name.indexOf(&#39;(&#39;);</b>
<b class="fc">&nbsp;            if (pindex == -1) {</b>
<b class="fc">&nbsp;                mech.setChassis(basics.name);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                mech.setChassis(basics.name.substring(0, pindex - 1));</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            if (basics.variant != null) {</b>
<b class="nc">&nbsp;                mech.setModel(basics.variant);</b>
<b class="fc">&nbsp;            } else if (basics.model != null) {</b>
<b class="fc">&nbsp;                mech.setModel(basics.model);</b>
&nbsp;            } else {
&nbsp;                // Do mechs need a model?
<b class="nc">&nbsp;                mech.setModel(&quot;&quot;);</b>
&nbsp;            }
<b class="fc">&nbsp;            mech.setYear(TECHYEAR);</b>
<b class="fc">&nbsp;            mech.setOmni(basics.omni);</b>
&nbsp;
<b class="fc">&nbsp;            switch (basics.technology.techBase) {</b>
&nbsp;                case &quot;Inner Sphere&quot;:
<b class="fc">&nbsp;                    switch (basics.technology.rulesLevel) {</b>
&nbsp;                        case 1:
<b class="fc">&nbsp;                            mech.setTechLevel(TechConstants.T_INTRO_BOXSET);</b>
<b class="fc">&nbsp;                            break;</b>
&nbsp;                        case 2:
<b class="fc">&nbsp;                            mech.setTechLevel(TechConstants.T_IS_TW_NON_BOX);</b>
<b class="fc">&nbsp;                            break;</b>
&nbsp;                        case 3:
<b class="nc">&nbsp;                            mech.setTechLevel(TechConstants.T_IS_ADVANCED);</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        default:
<b class="nc">&nbsp;                            throw new EntityLoadingException(</b>
&nbsp;                                    &quot;Unsupported tech level: &quot; + basics.technology.rulesLevel);
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case &quot;Clan&quot;:
<b class="nc">&nbsp;                    switch (basics.technology.rulesLevel) {</b>
&nbsp;                        case 2:
<b class="nc">&nbsp;                            mech.setTechLevel(TechConstants.T_CLAN_TW);</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        case 3:
<b class="nc">&nbsp;                            mech.setTechLevel(TechConstants.T_CLAN_ADVANCED);</b>
<b class="nc">&nbsp;                            break;</b>
&nbsp;                        default:
<b class="nc">&nbsp;                            throw new EntityLoadingException(</b>
&nbsp;                                    &quot;Unsupported tech level: &quot; + basics.technology.rulesLevel);
&nbsp;                    }
&nbsp;                    break;
&nbsp;                case &quot;Mixed (IS Chassis)&quot;:
&nbsp;                case &quot;Inner Sphere &#39;C&#39;&quot;:
<b class="nc">&nbsp;                    mech.setTechLevel(TechConstants.T_IS_ADVANCED);</b>
<b class="nc">&nbsp;                    mech.setMixedTech(true);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                case &quot;Mixed (Clan Chassis)&quot;:
<b class="nc">&nbsp;                    mech.setTechLevel(TechConstants.T_CLAN_ADVANCED);</b>
<b class="nc">&nbsp;                    mech.setMixedTech(true);</b>
<b class="nc">&nbsp;                    break;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    throw new EntityLoadingException(&quot;Unsupported tech base: &quot;</b>
&nbsp;                            + basics.technology.techBase);
&nbsp;            }
&nbsp;            
<b class="fc">&nbsp;            if (basics.structure.structureType.substring(0, 3).equals(&quot;(C)&quot;)) {</b>
<b class="nc">&nbsp;                basics.structure.structureType = basics.structure.structureType.substring(4);</b>
&nbsp;            }
<b class="fc">&nbsp;            mech.setStructureType(basics.structure.structureType);</b>
&nbsp;
<b class="fc">&nbsp;            if (basics.structure.armorType.substring(0, 3).equals(&quot;(C)&quot;)) {</b>
<b class="nc">&nbsp;                basics.structure.armorType = basics.structure.armorType.substring(4);</b>
&nbsp;            }
<b class="fc">&nbsp;            mech.setArmorType(basics.structure.armorType);</b>
&nbsp;
<b class="fc">&nbsp;            mech.setWeight(basics.tonnage);</b>
<b class="fc">&nbsp;            if (basics.jumpMP != null) {</b>
<b class="nc">&nbsp;                mech.setOriginalJumpMP(basics.jumpMP);</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            int engineFlags = 0;</b>
<b class="fc">&nbsp;            if ((mech.isClan() &amp;&amp; !mech.isMixedTech())</b>
<b class="fc">&nbsp;                    || (mech.isMixedTech() &amp;&amp; mech.isClan() &amp;&amp; !mech.itemOppositeTech(basics.structure.engine.engineType))) {</b>
<b class="nc">&nbsp;                engineFlags = megamek.common.Engine.CLAN_ENGINE;</b>
&nbsp;            }
<b class="fc">&nbsp;            mech.setEngine(new megamek.common.Engine(basics.structure.engine.engineRating, </b>
<b class="fc">&nbsp;                    megamek.common.Engine.getEngineTypeByString(basics.structure.engine.engineType), engineFlags));</b>
&nbsp;
<b class="fc">&nbsp;            mech.autoSetInternal();</b>
&nbsp;
<b class="fc">&nbsp;            Collections.sort(critdefs.locations);</b>
&nbsp;            
<b class="fc">&nbsp;            for (Location loc : critdefs.locations) {</b>
<b class="fc">&nbsp;                mech.initializeArmor(loc.armor, loc.bodyPart);</b>
&nbsp;                
<b class="fc">&nbsp;                if (Mech.LOC_LT == loc.bodyPart || Mech.LOC_RT == loc.bodyPart || Mech.LOC_CT == loc.bodyPart) {</b>
<b class="fc">&nbsp;                    mech.initializeRearArmor(loc.rearArmor, loc.bodyPart);</b>
&nbsp;                }
&nbsp;                
&nbsp;                // Don&#39;t sort the Head criticals, the empty slot (if there) needs to stay
&nbsp;                // right where it is.
<b class="fc">&nbsp;                if (Mech.LOC_HEAD != loc.bodyPart) {</b>
<b class="fc">&nbsp;                    Collections.sort(loc.criticalSlots);</b>
&nbsp;                }
<b class="fc">&nbsp;            }</b>
&nbsp;
&nbsp;            // we do these in reverse order to get the outermost
&nbsp;            // locations first, which is necessary for split crits to work
<b class="fc">&nbsp;            for (int i = mech.locations() - 1; i &gt;= 0; i--) {</b>
<b class="fc">&nbsp;                parseCrits(mech, i);</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            if (mech.isClan()) {</b>
<b class="nc">&nbsp;                mech.addClanCase();</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            mech.setArmorTonnage(mech.getArmorWeight());</b>
&nbsp;
&nbsp;            // add any heat sinks not allocated
<b class="fc">&nbsp;            mech.addEngineSinks(basics.structure.heatSink.count - mech.heatSinks(), </b>
<b class="fc">&nbsp;                    basics.structure.heatSink.isDouble() ? MiscType.F_DOUBLE_HEAT_SINK : MiscType.F_HEAT_SINK);</b>
&nbsp;
<b class="fc">&nbsp;            return mech;</b>
<b class="nc">&nbsp;        } catch (NumberFormatException ex) {</b>
<b class="nc">&nbsp;            throw new EntityLoadingException(</b>
&nbsp;                    &quot;NumberFormatException parsing file&quot;, ex);
<b class="nc">&nbsp;        } catch (NullPointerException ex) {</b>
<b class="nc">&nbsp;            throw new EntityLoadingException(</b>
&nbsp;                    &quot;NullPointerException parsing file&quot;, ex);
<b class="nc">&nbsp;        } catch (StringIndexOutOfBoundsException ex) {</b>
<b class="nc">&nbsp;            throw new EntityLoadingException(</b>
&nbsp;                    &quot;StringIndexOutOfBoundsException parsing file&quot;, ex);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void parseCrits(Mech mech, int loc) throws EntityLoadingException {
&nbsp;        // check for removed arm actuators
<b class="fc">&nbsp;        if (!(mech instanceof QuadMech)) {</b>
<b class="fc">&nbsp;            if ((loc == Mech.LOC_LARM) || (loc == Mech.LOC_RARM)) {</b>
<b class="fc">&nbsp;                for (Location l : critdefs.locations) {</b>
<b class="fc">&nbsp;                    if (l.bodyPart == loc) {</b>
<b class="fc">&nbsp;                        if (!&quot;Lower Arm Actuator&quot;.equals(l.criticalSlots.get(2).content)) {</b>
<b class="fc">&nbsp;                            mech.setCritical(loc, 2, null);</b>
&nbsp;                        }
&nbsp;                        
<b class="fc">&nbsp;                        if (!&quot;Hand Actuator&quot;.equals(l.criticalSlots.get(3).content)) {</b>
<b class="fc">&nbsp;                            mech.setCritical(loc, 3, null);</b>
&nbsp;                        }
&nbsp;                    }
<b class="fc">&nbsp;                }</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        Location location = findLocation(loc);</b>
&nbsp;        
&nbsp;        // go thru file, add weapons
<b class="fc">&nbsp;        for (int i = 0; i &lt; mech.getNumberOfCriticals(loc); i++) {</b>
&nbsp;
&nbsp;            // if the slot&#39;s full already, skip it.
<b class="fc">&nbsp;            if (mech.getCritical(loc, i) != null) {</b>
<b class="fc">&nbsp;                continue;</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            CriticalSlot crit = location.criticalSlots.get(i);</b>
&nbsp;            
&nbsp;            // parse out and add the critical
<b class="fc">&nbsp;            if (basics.structure.isClanTC() &amp;&amp; &quot;Targeting Computer&quot;.equals(crit.content)) {</b>
<b class="nc">&nbsp;                crit.content = &quot;(C) &quot; + crit.content;</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            boolean rearMounted = false;</b>
<b class="fc">&nbsp;            for (MountedItem mi : mounted.items) {</b>
<b class="fc">&nbsp;                if (Objects.equals(mi.location, location.bodyPart) &amp;&amp; Objects.equals(mi.itemIndex, crit.itemIndex)) {</b>
<b class="fc">&nbsp;                    rearMounted = mi.rearMounted;</b>
&nbsp;                }
<b class="fc">&nbsp;            }</b>
&nbsp;
<b class="fc">&nbsp;            if (crit.content.contains(&quot;Engine&quot;)) {</b>
<b class="fc">&nbsp;                mech.setCritical(loc, i, new megamek.common.CriticalSlot(</b>
&nbsp;                        megamek.common.CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_ENGINE));
<b class="fc">&nbsp;                continue;</b>
&nbsp;            }
<b class="fc">&nbsp;            if (crit.content.contains(&quot;Gyro&quot;)) {</b>
<b class="fc">&nbsp;                mech.setCritical(loc, i, new megamek.common.CriticalSlot(</b>
&nbsp;                        megamek.common.CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_GYRO));
<b class="fc">&nbsp;                continue;</b>
&nbsp;            }
<b class="fc">&nbsp;            if (crit.content.contains(&quot;Life Support&quot;)) {</b>
<b class="fc">&nbsp;                mech.setCritical(loc, i, new megamek.common.CriticalSlot(</b>
&nbsp;                        megamek.common.CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_LIFE_SUPPORT));
<b class="fc">&nbsp;                continue;</b>
&nbsp;            }
<b class="fc">&nbsp;            if (crit.content.contains(&quot;Sensors&quot;)) {</b>
<b class="fc">&nbsp;                mech.setCritical(loc, i, new megamek.common.CriticalSlot(</b>
&nbsp;                        megamek.common.CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_SENSORS));
<b class="fc">&nbsp;                continue;</b>
&nbsp;            }
<b class="fc">&nbsp;            if (crit.content.contains(&quot;Cockpit&quot;)) {</b>
<b class="fc">&nbsp;                mech.setCritical(loc, i, new megamek.common.CriticalSlot(</b>
&nbsp;                        megamek.common.CriticalSlot.TYPE_SYSTEM, Mech.SYSTEM_COCKPIT));
<b class="fc">&nbsp;                continue;</b>
&nbsp;            }
<b class="fc">&nbsp;            if (crit.content.endsWith(&quot;[LRM]&quot;) || crit.content.endsWith(&quot;[SRM]&quot;)) {</b>
&nbsp;                // This is a lame kludge for The Drawing Board, which
&nbsp;                // identifies which type of missle weapon an
&nbsp;                // Artemis IV system goes with.
<b class="nc">&nbsp;                crit.content = crit.content.substring(0, 14);</b>
&nbsp;            }
<b class="fc">&nbsp;            if (crit.content.endsWith(&quot;- Artemis IV&quot;)) {</b>
&nbsp;                // Ugh, another lame kludge to allow for loading of
&nbsp;                // The Drawing Board&#39;s specially marked Artemis IV
&nbsp;                // missle ammo. The only real game difference is
&nbsp;                // c-bill cost, which we don&#39;t care about anyway.
<b class="nc">&nbsp;                crit.content = crit.content.substring(0, crit.content.indexOf(&quot; - Artemis IV&quot;));</b>
&nbsp;            }
<b class="fc">&nbsp;            if (crit.content.endsWith(&quot;- Narc&quot;)) {</b>
&nbsp;                // Yet another lame kludge to allow for loading of
&nbsp;                // The Drawing Board&#39;s specially marked Narc
&nbsp;                // missle ammo.
<b class="nc">&nbsp;                crit.content = crit.content.substring(0, crit.content.indexOf(&quot; - Narc&quot;));</b>
&nbsp;            }
&nbsp;            try {
&nbsp;                String hashPrefix;
<b class="fc">&nbsp;                if (crit.content.startsWith(&quot;(C)&quot;)) {</b>
&nbsp;                    // equipment specifically marked as clan
<b class="nc">&nbsp;                    hashPrefix = &quot;Clan &quot;;</b>
<b class="nc">&nbsp;                    crit.content = crit.content.substring(4);</b>
<b class="fc">&nbsp;                } else if (crit.content.startsWith(&quot;(IS)&quot;)) {</b>
&nbsp;                    // equipment specifically marked as inner sphere
<b class="nc">&nbsp;                    hashPrefix = &quot;IS &quot;;</b>
<b class="nc">&nbsp;                    crit.content = crit.content.substring(5);</b>
<b class="fc">&nbsp;                } else if (mech.isClan()) {</b>
&nbsp;                    // assume equipment is clan because mech is clan
<b class="nc">&nbsp;                    hashPrefix = &quot;Clan &quot;;</b>
&nbsp;                } else {
&nbsp;                    // assume equipment is inner sphere
<b class="fc">&nbsp;                    hashPrefix = &quot;IS &quot;;</b>
&nbsp;                }
<b class="fc">&nbsp;                EquipmentType etype = EquipmentType.get(hashPrefix + crit.content);</b>
<b class="fc">&nbsp;                if (etype == null) {</b>
&nbsp;                    // try without prefix
<b class="fc">&nbsp;                    etype = EquipmentType.get(crit.content);</b>
&nbsp;                }
<b class="fc">&nbsp;                if (etype != null) {</b>
<b class="fc">&nbsp;                    if (etype.isSpreadable()) {</b>
&nbsp;                        // do we already have one of these? Key on Type
<b class="nc">&nbsp;                        Mounted m = hSharedEquip.get(etype);</b>
<b class="nc">&nbsp;                        if (m != null) {</b>
&nbsp;                            // use the existing one
<b class="nc">&nbsp;                            mech.addCritical(loc, new megamek.common.CriticalSlot(m));</b>
<b class="nc">&nbsp;                            continue;</b>
&nbsp;                        }
<b class="nc">&nbsp;                        m = mech.addEquipment(etype, loc, rearMounted);</b>
<b class="nc">&nbsp;                        hSharedEquip.put(etype, m);</b>
<b class="nc">&nbsp;                    } else if (((etype instanceof WeaponType) &amp;&amp; ((WeaponType)etype).isSplitable()) </b>
<b class="fc">&nbsp;                            || ((etype instanceof MiscType) &amp;&amp; etype.hasFlag(MiscType.F_SPLITABLE))) {</b>
&nbsp;                        // do we already have this one in this or an outer
&nbsp;                        // location?
<b class="nc">&nbsp;                        Mounted m = null;</b>
<b class="nc">&nbsp;                        boolean bFound = false;</b>
<b class="nc">&nbsp;                        for (int x = 0, n = vSplitWeapons.size(); x &lt; n; x++) {</b>
<b class="nc">&nbsp;                            m = vSplitWeapons.get(x);</b>
<b class="nc">&nbsp;                            int nLoc = m.getLocation();</b>
<b class="nc">&nbsp;                            if (((nLoc == loc) || (loc == Mech</b>
<b class="nc">&nbsp;                                    .getInnerLocation(nLoc)))</b>
<b class="nc">&nbsp;                                    &amp;&amp; (m.getType() == etype)) {</b>
<b class="nc">&nbsp;                                bFound = true;</b>
<b class="nc">&nbsp;                                break;</b>
&nbsp;                            }
&nbsp;                        }
<b class="nc">&nbsp;                        if (bFound) {</b>
<b class="nc">&nbsp;                            m.setFoundCrits(m.getFoundCrits() + 1);</b>
<b class="nc">&nbsp;                            if (m.getFoundCrits() &gt;= m.getCriticals()) {</b>
<b class="nc">&nbsp;                                vSplitWeapons.remove(m);</b>
&nbsp;                            }
&nbsp;                            // if we&#39;re in a new location, set the
&nbsp;                            // weapon as split
<b class="nc">&nbsp;                            if (loc != m.getLocation()) {</b>
<b class="nc">&nbsp;                                m.setSplit(true);</b>
&nbsp;                            }
&nbsp;                            // give the most restrictive location for arcs
<b class="nc">&nbsp;                            int help = m.getLocation();</b>
<b class="nc">&nbsp;                            m.setLocation(Mech.mostRestrictiveLoc(loc, help));</b>
<b class="nc">&nbsp;                            if (loc != help) {</b>
<b class="nc">&nbsp;                                m.setSecondLocation(Mech.leastRestrictiveLoc(</b>
&nbsp;                                        loc, help));
&nbsp;                            }
<b class="nc">&nbsp;                        } else {</b>
&nbsp;                            // make a new one
<b class="nc">&nbsp;                            m = new Mounted(mech, etype);</b>
<b class="nc">&nbsp;                            m.setFoundCrits(1);</b>
<b class="nc">&nbsp;                            vSplitWeapons.add(m);</b>
&nbsp;                        }
<b class="nc">&nbsp;                        mech.addEquipment(m, loc, rearMounted);</b>
<b class="nc">&nbsp;                    } else {</b>
<b class="fc">&nbsp;                        mech.addEquipment(etype, loc, rearMounted);</b>
&nbsp;                    }
&nbsp;                } else {
<b class="fc">&nbsp;                    if (!crit.content.equals(&quot;Empty&quot;)) {</b>
&nbsp;                        // Can&#39;t load this piece of equipment!
&nbsp;                        // Add it to the list so we can show the user.
<b class="nc">&nbsp;                        mech.addFailedEquipment(crit.content);</b>
&nbsp;                        // Make the failed equipment an empty slot
<b class="nc">&nbsp;                        crit.content = &quot;Empty&quot;;</b>
&nbsp;                        // Compact criticals again
<b class="nc">&nbsp;                        compactCriticals(location);</b>
&nbsp;                        // Re-parse the same slot, since the compacting
&nbsp;                        // could have moved new equipment to this slot
<b class="nc">&nbsp;                        i--;</b>
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            } catch (LocationFullException ex) {</b>
<b class="nc">&nbsp;                throw new EntityLoadingException(ex.getMessage());</b>
<b class="fc">&nbsp;            }</b>
&nbsp;        }
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    private void compactCriticals(final Location loc) {
<b class="nc">&nbsp;        if (loc.bodyPart == Mech.LOC_HEAD) {</b>
&nbsp;            // This location has an empty slot inbetween systems crits
&nbsp;            // which will mess up parsing if compacted.
<b class="nc">&nbsp;            return;</b>
&nbsp;        }
&nbsp;        
<b class="nc">&nbsp;        Collections.sort(loc.criticalSlots);</b>
<b class="nc">&nbsp;    }</b>
&nbsp;    
&nbsp;    private Location findLocation(final int loc) {
<b class="fc">&nbsp;        for (Location l : critdefs.locations) {</b>
<b class="fc">&nbsp;            if (l.bodyPart == loc) {</b>
<b class="fc">&nbsp;                return l;</b>
&nbsp;            }
<b class="fc">&nbsp;        }</b>
&nbsp;        
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB helper class for the creator tag.
&nbsp;     */
&nbsp;    private static class Creator {
&nbsp;
<b class="fc">&nbsp;        @XmlElement(name = &quot;name&quot;)</b>
&nbsp;        String creatorName = &quot;Unknown&quot;;
&nbsp;
<b class="fc">&nbsp;        @XmlElement(name = &quot;version&quot;)</b>
&nbsp;        String creatorVersion = &quot;Unknown&quot;;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private Creator() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAX helper class for the basics tag.
&nbsp;     */
&nbsp;    private static class BasicInformation {
&nbsp;
&nbsp;        @XmlElement
&nbsp;        String name;
&nbsp;
&nbsp;        @XmlElement
&nbsp;        String model;
&nbsp;
<b class="fc">&nbsp;        @XmlElement(name = &quot;isomni&quot;)</b>
&nbsp;        Boolean omni = Boolean.FALSE;
&nbsp;
&nbsp;        @XmlElement
&nbsp;        String variant;
&nbsp;
&nbsp;        @XmlElement
&nbsp;        Technology technology;
&nbsp;
&nbsp;        @XmlElement
&nbsp;        Integer tonnage;
&nbsp;
&nbsp;        @XmlElement(name = &quot;type&quot;)
&nbsp;        String chassisConfig;
&nbsp;
&nbsp;        @XmlElement(name = &quot;movemechmod&quot;)
&nbsp;        MovementModifier moveMeKMod;
&nbsp;
&nbsp;        @XmlElement(name = &quot;jump&quot;)
&nbsp;        Integer jumpMP;
&nbsp;
&nbsp;        @XmlElement(name = &quot;structural&quot;)
&nbsp;        Structure structure;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private BasicInformation() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * JAXB helper class for the structural tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    private static class Structure {
&nbsp;
&nbsp;        @XmlElement(name = &quot;engine&quot;)
&nbsp;        Engine engine;
&nbsp;
<b class="fc">&nbsp;        @XmlElement(name = &quot;gyro&quot;)</b>
&nbsp;        String gyroType = &quot;Standard&quot;;
&nbsp;
<b class="fc">&nbsp;        @XmlElement(name = &quot;cockpit&quot;)</b>
&nbsp;        String cockpitType = &quot;Standard&quot;;
&nbsp;
&nbsp;        @XmlElement(name = &quot;targsys&quot;)
&nbsp;        String targSysStr;
&nbsp;
&nbsp;        @XmlElement(name = &quot;heatsinks&quot;)
&nbsp;        HeatSink heatSink;
&nbsp;
&nbsp;        @XmlElement(name = &quot;armor&quot;)
&nbsp;        String armorType;
&nbsp;
&nbsp;        @XmlElement(name = &quot;internal&quot;)
&nbsp;        String structureType;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private Structure() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;        boolean isClanTC() {
<b class="fc">&nbsp;            return (targSysStr.length() &gt;= 3)</b>
<b class="fc">&nbsp;                    &amp;&amp; (targSysStr.substring(0, 3).equals(&quot;(C)&quot;));</b>
&nbsp;        }
&nbsp;        
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB helper class for the technology tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    private static class Technology {
&nbsp;
&nbsp;        @XmlValue
&nbsp;        String techBase;
&nbsp;
&nbsp;        @XmlAttribute(name = &quot;level&quot;)
&nbsp;        Integer rulesLevel;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private Technology() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB helper class for the movemechmod tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    private static class MovementModifier {
&nbsp;
&nbsp;        @XmlAttribute
&nbsp;        String LAMTonnage;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="nc">&nbsp;        private MovementModifier() {</b>
<b class="nc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB helper class for the heatsinks tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    private static class HeatSink {
&nbsp;
&nbsp;        @XmlValue
&nbsp;        private String dblSinks;
&nbsp;
&nbsp;        @XmlAttribute
&nbsp;        Integer count;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private HeatSink() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;        public boolean isDouble() {
<b class="fc">&nbsp;            return DOUBLE.equals(dblSinks);</b>
&nbsp;        }
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB helper for the engine tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    private static class Engine {
&nbsp;
&nbsp;        @XmlValue
&nbsp;        String engineType;
&nbsp;
&nbsp;        @XmlAttribute(name = &quot;rating&quot;)
&nbsp;        Integer engineRating;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private Engine() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * JAXB helper class for the mounteditems tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    static class MountedItems {
&nbsp;    
<b class="fc">&nbsp;        @XmlElement(name = &quot;mounteditem&quot;)</b>
&nbsp;        List&lt;MountedItem&gt; items = new ArrayList&lt;&gt;();
&nbsp;
<b class="fc">&nbsp;        MountedItems() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB helper class for the mounteditem tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    private static class MountedItem {
&nbsp;
&nbsp;        @XmlAttribute(name = &quot;itemindex&quot;)
&nbsp;        Integer itemIndex;
&nbsp;
<b class="fc">&nbsp;        @XmlAttribute(name = &quot;rearmounted&quot;)</b>
&nbsp;        @XmlJavaTypeAdapter(BooleanAdapter.class)
&nbsp;        Boolean rearMounted = Boolean.FALSE;
&nbsp;
&nbsp;        @XmlAttribute
&nbsp;        @XmlJavaTypeAdapter(LocationAdapter.class)
&nbsp;        Integer location;
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private MountedItem() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * JAXB helper class for the critdefs tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    private static class CriticalDefinitions {
&nbsp;        
<b class="fc">&nbsp;        @XmlElement(name = &quot;location&quot;)</b>
&nbsp;        List&lt;Location&gt; locations = new ArrayList&lt;&gt;();
&nbsp;
&nbsp;        /**
&nbsp;         * Required for JAXB.
&nbsp;         */
<b class="fc">&nbsp;        private CriticalDefinitions() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB helper class for the location tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    static class Location implements Comparable&lt;Location&gt; {
&nbsp;
&nbsp;        @XmlAttribute
&nbsp;        Integer armor;
&nbsp;
&nbsp;        @XmlAttribute(name = &quot;reararmor&quot;)
&nbsp;        Integer rearArmor;
&nbsp;
&nbsp;        @XmlAttribute(name = &quot;name&quot;)
&nbsp;        @XmlJavaTypeAdapter(LocationAdapter.class)
&nbsp;        Integer bodyPart;
&nbsp;        
<b class="fc">&nbsp;        @XmlElement(name = &quot;criticalslot&quot;)</b>
&nbsp;        List&lt;CriticalSlot&gt; criticalSlots = new ArrayList&lt;&gt;();
&nbsp;
<b class="fc">&nbsp;        Location(final Integer bodyPart, final Integer armor, final Integer rearArmor) {</b>
<b class="fc">&nbsp;            this.bodyPart = bodyPart;</b>
<b class="fc">&nbsp;            this.armor = armor;</b>
<b class="fc">&nbsp;            this.rearArmor = rearArmor;</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
<b class="fc">&nbsp;        Location() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;        @Override
&nbsp;        public int compareTo(final Location o) {
<b class="fc">&nbsp;            return bodyPart.compareTo(o.bodyPart);</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    /**
&nbsp;     * JAXB helper class for the criticalslot tag.
&nbsp;     */
&nbsp;    @XmlType
&nbsp;    static class CriticalSlot implements Comparable&lt;CriticalSlot&gt; {
&nbsp;
&nbsp;        private static final String EMPTY = &quot;Empty&quot;;
&nbsp;        
&nbsp;        @XmlAttribute(name = &quot;slotindex&quot;)
&nbsp;        Integer itemIndex;
&nbsp;
&nbsp;        @XmlValue
&nbsp;        String content;
&nbsp;
<b class="fc">&nbsp;        CriticalSlot(final Integer itemIndex, final String content) {</b>
<b class="fc">&nbsp;            this.itemIndex = itemIndex;</b>
<b class="fc">&nbsp;            this.content = content;</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
<b class="fc">&nbsp;        CriticalSlot() {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;        @Override
&nbsp;        public int compareTo(final CriticalSlot o) {
&nbsp;            // Both empty slots, then compare the itemIndex
<b class="fc">&nbsp;            if (EMPTY.equals(this.content) &amp;&amp; (EMPTY.equals(o.content))) {</b>
<b class="fc">&nbsp;                return this.itemIndex.compareTo(o.itemIndex);</b>
&nbsp;            }
&nbsp;
&nbsp;            // This is empty, it&#39;s always &quot;less&quot; than something else
<b class="fc">&nbsp;            if (EMPTY.equals(this.content)) {</b>
<b class="fc">&nbsp;                return 1;</b>
&nbsp;            }
&nbsp;            
&nbsp;            // The other is empty, so this is always &quot;more&quot;
<b class="fc">&nbsp;            if (EMPTY.equals(o.content)) {</b>
<b class="fc">&nbsp;                return -1;</b>
&nbsp;            }
&nbsp;
&nbsp;            // Neither is empty, maintain the original sort
<b class="fc">&nbsp;            return this.itemIndex.compareTo(o.itemIndex);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * JAXB translator for the TDB location constants to Mech.LOC_* constants.
&nbsp;     */
<b class="fc">&nbsp;    private static class LocationAdapter extends XmlAdapter&lt;String, Integer&gt; {</b>
&nbsp;
&nbsp;        @Override
&nbsp;        public String marshal(final Integer v) throws Exception {
<b class="nc">&nbsp;            throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public Integer unmarshal(final String v) throws Exception {
<b class="fc">&nbsp;            switch (v) {</b>
&nbsp;                case &quot;H&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_HEAD;</b>
&nbsp;                case &quot;CT&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_CT;</b>
&nbsp;                case &quot;RT&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_RT;</b>
&nbsp;                case &quot;LT&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_LT;</b>
&nbsp;                case &quot;RA&quot;:
&nbsp;                case &quot;FRL&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_RARM;</b>
&nbsp;                case &quot;LA&quot;:
&nbsp;                case &quot;FLL&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_LARM;</b>
&nbsp;                case &quot;RL&quot;:
&nbsp;                case &quot;RRL&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_RLEG;</b>
&nbsp;                case &quot;LL&quot;:
&nbsp;                case &quot;RLL&quot;:
<b class="fc">&nbsp;                    return Mech.LOC_LLEG;</b>
&nbsp;                default:
<b class="nc">&nbsp;                    return Mech.LOC_NONE;</b>
&nbsp;            }
&nbsp;        }
&nbsp;        
&nbsp;    }
&nbsp;    
<b class="fc">&nbsp;    private static class BooleanAdapter extends XmlAdapter&lt;String, Boolean&gt; {</b>
&nbsp;
&nbsp;        @Override
&nbsp;        public String marshal(final Boolean v) throws Exception {
<b class="nc">&nbsp;            throw new UnsupportedOperationException(&quot;Not supported yet.&quot;);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public Boolean unmarshal(final String v) throws Exception {
<b class="fc">&nbsp;            return Boolean.getBoolean(v);</b>
&nbsp;        }
&nbsp;        
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-05-16 16:28</div>
</div>
</body>
</html>
